<?php

if (!defined('BASEPATH'))
    exit('No direct script access allowed');


class Akuntansi extends CI_Controller
{

    function __contruct()
    {
        parent::__construct();

    }

	function ttd_kd() {
        $lccr = $this->input->post('q');
        $sql = "SELECT nip,nama,jabatan,kd_skpd FROM ms_ttd where kode ='PPKD' ";
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
           
            $result[] = array(
                        'id' => $ii,        
                        'nip' => $resulte['nip'],  
                        'nama' => $resulte['nama'],  
                        'jabatan' => $resulte['jabatan'],
                        'kd_skpd' => $resulte['kd_skpd']
                        );
                        $ii++;
        }
           
        echo json_encode($result);
     $query1->free_result();	   
	}	

	function bp_ro_penerimaan(){
	
        $data['page_title']= 'CETAK BUKU PEMBANTU PER RINCIAN OBYEK PENERIMAAN';
        $this->template->set('title', 'CETAK BUKU PEMBANTU PER RINCIAN OBYEK PENERIMAAN');   
        $this->template->load('template','akuntansi/bp_ro_penerimaan',$data) ; 	
	
	}
	
	function get_status($tgl,$skpd){
        $n_status = '';
        $tanggal = $tgl;
        $sql = "select case when '$tanggal'>=tgl_dpa_ubah then 'nilai_ubah' 
                    when '$tanggal'>=tgl_dpa_sempurna then 'nilai_sempurna' 
                    when '$tanggal'<=tgl_dpa 
                    then 'nilai' else 'nilai' end as anggaran from trhrka where kd_skpd ='$skpd' ";
        
        $q_trhrka = $this->db->query($sql);
        $num_rows = $q_trhrka->num_rows();
        
        foreach ($q_trhrka->result() as $r_trhrka){
             $n_status = $r_trhrka->anggaran;                   
        }    
        return $n_status;                         
    }

	function cetak_bp_ro_penerimaan($dcetak='',$ttd='',$skpd='',$rek5='',$dcetak2='', $jenis='', $ttd2='', $tgl_ctk=''){ 
        $thn_ang = $this->session->userdata('pcThang');
		$ang = $this->get_status($dcetak2,$skpd);

		$lcttd = str_replace('a',' ',$ttd);	
		$sqlttd1="SELECT TOP 1 nama as nm,nip as nip,jabatan as jab,pangkat FROM ms_ttd where nip='$lcttd'";
		$sqlttd=$this->db->query($sqlttd1);
		 foreach ($sqlttd->result() as $rowttd)
			{
				$nip=$rowttd->nip;                    
				$nama= $rowttd->nm;
				$jabatan  = $rowttd->jab;
				$pangkat=$rowttd->pangkat;
			}
			
		$lcttd2 = str_replace('a',' ',$ttd2);	
		$sqlttd2="SELECT TOP 1 nama as nm,nip as nip,jabatan as jab,pangkat FROM ms_ttd where nip='$lcttd2'";
		$sqlttd_2=$this->db->query($sqlttd2);
		 foreach ($sqlttd_2->result() as $rowttd)
			{
				$nip2=$rowttd->nip;                    
				$nama2= $rowttd->nm;
				$jabatan2  = $rowttd->jab;
				$pangkat2=$rowttd->pangkat;
			}
		
		$prv = $this->db->query("select SUM($ang) anggaran from trdrka_pend where kd_skpd='$skpd' and kd_rek5='$rek5'");
			$prvn = $prv->row();          
			$anggaran = $prvn->anggaran; 
		
		
		
		
		 $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$skpd'";
		 $sqlskpd=$this->db->query($sqldns);
         foreach ($sqlskpd->result() as $rowdns)
        {
           
            $kd_urusan=$rowdns->kd_u;                    
            $nm_urusan= $rowdns->nm_u;
            $kd_skpd  = $rowdns->kd_sk;
            $nm_skpd  = $rowdns->nm_sk;
        }
		
		 $sqlorg="SELECT * FROM ms_organisasi WHERE kd_org=left('$skpd',7)";
                 $sqlorg1=$this->db->query($sqlorg);
                 foreach ($sqlorg1->result() as $rowdns)
                {
                   
                    $kd_org=$rowdns->kd_org;                    
                    $nm_org= $rowdns->nm_org;
                }
		 $sqlurusan1="SELECT * FROM ms_urusan1 WHERE kd_urusan1=left('$kd_urusan',1)";
                 $sqlskpd=$this->db->query($sqlurusan1);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                   
                    $kd_urusan1=$rowdns->kd_urusan1;                    
                    $nm_urusan1= $rowdns->nm_urusan1;
                }
		
			$cRet ="<TABLE style=\"border-collapse:collapse;font-family:Arial\" width=\"100%\" border=\"0\">
					<TR>
						<td width=\"5%\" rowspan=\"2\" align=\"center\"><img src=\"".base_url()."/image/logoHP.bmp\"  width=\"100\" height=\"100\" /></td>
						<TD width=\"95%\" align=\"center\" ><B>PEMERINTAH PROVINSI KALIMANTAN BARAT<br>
											   BUKU PEMBANTU<br>
											   PER RINCIAN OBYEK PENERIMAAN</B>
						</TD>
					</TR>
					<TR>
						<TD align=\"center\" colspan=\"2\"><i>Periode ".$this->tukd_model->tanggal_format_indonesia($dcetak)." s/d ".$this->tukd_model->tanggal_format_indonesia($dcetak2)."</i></TD>
					</TR>
					</TABLE><br>";

			$cRet .='<TABLE style="border-collapse:collapse;font-family:Arial;font-size:12px;"  width="100%">
					 <TR>
						<TD align="left" width="20%" >Urusan Pemerintahan</TD>
						<TD align="left" width="80%" >: '.$kd_urusan1.' - '.$nm_urusan1.'</TD>
					 </TR>
					 <TR>
						<TD align="left" width="20%" >Bidang Pemerintahan</TD>
						<TD align="left" width="80%" >: '.$kd_urusan.' - '.$nm_urusan.'</TD>
					 </TR>
					 <TR>
						<TD align="left" width="20%" >Unit Organisasi</TD>
						<TD align="left" width="80%" >: '.$kd_org.' - '.$nm_org.'</TD>
					 </TR>
					 <TR>
						<TD align="left" width="20%" >Sub Unit Organisasi</TD>
						<TD align="left" width="80%" >: '.$kd_skpd.' - '.$nm_skpd.'</TD>
					 </TR>
					 <TR>
						<TD align="left" width="20%" >Kode Rekening</TD>
						<TD align="left" width="80%" >: '.$rek5.'</TD>
					 </TR>
					  <TR>
						<TD align="left" width="20%" >Nama Rekening</TD>
						<TD align="left" width="80%" >: '.$this->tukd_model->get_nama($rek5,'nm_rek5','ms_rek5','kd_rek5').'</TD>
					 </TR>
					 <TR>
						<TD align="left" width="20%" >Jumlah Anggaran</TD>
						<TD align="left" width="80%" >: Rp. '.number_format($anggaran,"2",",",".").'</TD>
					 </TR>
					 <TR>
						<TD align="left" width="20%" >Tahun Anggaran</TD>
						<TD align="left" width="80%" >: '.$thn_ang.'</TD>
					 </TR>
					 </TABLE>';

			$cRet .='<TABLE style="border-collapse:collapse;font-family:Arial;font-size:12px" width="100%" align="center" border="1" cellspacing="0" cellpadding="4">
					 <THEAD>
					 <TR>
						<TD width="5%"  bgcolor="#CCCCCC" align="center" ><b>NO</b></TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" ><b>NO BKU</b></TD>
						<TD width="25%" bgcolor="#CCCCCC" align="center" ><b>TGL SETOR</b></TD>
						<TD width="35%" bgcolor="#CCCCCC" align="center" ><b>NO. STS & BUKTI PENERIMAAN LAINNYA</b></TD>
						<TD width="20%" bgcolor="#CCCCCC" align="center" ><b>JUMLAH</b></TD>
					 </TR>
					 </THEAD>';
			
			//isi
			$sql = "select b.no_sts, a.tgl_sts, a.keterangan, b.rupiah from trhkasin_pkd a inner join trdkasin_pkd b on a.kd_skpd=b.kd_skpd and a.no_sts=b.no_sts where b.kd_skpd='$skpd' and b.kd_rek5='$rek5' AND a.jns_trans=4 AND (a.tgl_sts BETWEEN '$dcetak' AND '$dcetak2') order by tgl_sts, no_sts, rupiah";
			$no=1;
			$tot = 0;
			$hasil = $this->db->query($sql);
			foreach ($hasil->result() as $rows){  
                    $no_sts     = $rows->no_sts;                    
                    $tgl_sts    = $rows->tgl_sts;
                    $keterangan = $rows->keterangan;
                    $rupiah     = $rows->rupiah;
			
					$cRet .='<TR>
								<TD align="center" >'.$no++.'</TD>
								<TD align="center" >'.$no_sts.'</TD>
								<TD align="center" >'.$this->tukd_model->tanggal_format_indonesia($tgl_sts).'</TD>
								<TD align="left" >'.$keterangan.'</TD>
								<TD  align="right" >'.number_format($rupiah,"2",",",".").'</TD>
							 </TR>';
					
					$tot=$tot+$rupiah;
			}	
			
			$lalu = $this->db->query("select SUM(b.rupiah) tot from trhkasin_pkd a inner join trdkasin_pkd b on a.kd_skpd=b.kd_skpd and a.no_sts=b.no_sts where b.kd_skpd='$skpd' and b.kd_rek5='$rek5 ' AND a.jns_trans=4 AND a.tgl_sts<'$dcetak'");
			$nlalu = $lalu->row();          
			$tot_lalu = $nlalu->tot; 
			
			$cRet .='<TR>
						<TD style="border-top:none" align="left" colspan="3" >Jumlah Periode Ini</TD>
						<TD style="border-top:none" colspan="2" align="center" >Rp. '.number_format($tot,"2",",",".").'</TD>
					 </TR>
					 <TR>
						<TD style="border-top:none" align="left" colspan="3" >Jumlah Periode lalu</TD>
						<TD style="border-top:none" colspan="2" align="center" >Rp. '.number_format($tot_lalu,"2",",",".").'</TD>
					 </TR>
					  <TR>
						<TD style="border-top:none" align="left" colspan="3" >Jumlah Sampai Dengan Periode Ini</TD>
						<TD style="border-top:none" colspan="2" align="center" >Rp. '.number_format($tot_lalu+$tot,"2",",",".").'</TD>
					 </TR>';
			
			$cRet .='</TABLE><br>';	

			$cRet .="<table style=\"font-size:12px;border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">
                    <tr>
						<td align=\"center\" width=\"50%\">Mengetahui,</td>
						<td align=\"center\" width=\"50%\">Pontianak, ".$this->tukd_model->tanggal_format_indonesia($tgl_ctk)."</td>
					</tr>
					<tr>
						<td align=\"center\" width=\"50%\"><b>$jabatan</b></td>
					    <td align=\"center\" width=\"50%\"><b>$jabatan2</b></td>
					</tr>
                    <tr>
						<td align=\"center\" width=\"50%\">&nbsp;</td>
						<td align=\"center\" width=\"50%\">&nbsp;</td>
					</tr>
					<tr>
						<td align=\"center\" width=\"50%\">&nbsp;</td>
						<td align=\"center\" width=\"50%\">&nbsp;</td>
					</tr>                              
                    <tr>
						<td align=\"center\" width=\"50%\">&nbsp;</td>
						<td align=\"center\" width=\"50%\">&nbsp;</td>
					</tr>                                       
                    <tr>
						<td align=\"center\" width=\"50%\"><u>$nama</u></td>
						<td align=\"center\" width=\"50%\"><u>$nama2</u></td>
					</tr>
                    <tr>
						<td align=\"center\" width=\"50%\">$pangkat</td>
						<td align=\"center\" width=\"50%\">$pangkat2</td>
					</tr>
					<tr>
						<td align=\"center\" width=\"50%\">NIP. $nip</td>
						<td align=\"center\" width=\"50%\">NIP. $nip2</td>
					</tr>
                    
                  </table>";
				
			if($jenis == 1){
			echo '<title>CETAK BUKU PEMBANTU PER RINCIAN OBYEK PENERIMAAN</title>';
			echo $cRet;
			}
			if($jenis ==2){
            $this->tukd_model->_mpdf('',$cRet,10,5,10,'0');	
			}
	}

	
	function load_status_sumberdana() {
        $sql = "SELECT * from status_sumberdana order by triwulan";
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
            if ($resulte['status']=='1'){
				$s='&#10008';
			}else{
				$s='&#10004';			
			}  
			
            $result[] = array(
                        'id' => $ii,        
                        'triwulan' => $resulte['triwulan'],
                        'status' => $resulte['status'],
						'keterangan' => $resulte['keterangan'],
						'simbol' => $s 
                        );
                        $ii++;
        }
           
        echo json_encode($result);
    	   
	}
    
	function status_sumberdana()
    {
        $data['page_title']= 'INPUT PENERIMAAN';
        $this->template->set('title', 'INPUT PENERIMAAN');   
        $this->template->load('template','akuntansi/status_sumberdana',$data) ; 
    }
	
	function rekap_bel_peg_brg()
    {
        $data['page_title']= 'REKAP BELANJA PEGAWAI DAN BELANJA BARANG';
        $this->template->set('title', 'REKAP BELANJA PEGAWAI DAN BELANJA BARANG');   
        $this->template->load('template','akuntansi/bel_peg_brg',$data) ; 
    }
	
	function rekap_beban()
    {
        $data['page_title']= 'REKAP BEBAN';
        $this->template->set('title', 'REKAP BEBAN');   
        $this->template->load('template','akuntansi/rekap_beban',$data) ; 
    }
	
	function rekap_pend()
    {
        $data['page_title']= 'REKAP PENDAPATAN';
        $this->template->set('title', 'REKAP PENDAPATAN');   
        $this->template->load('template','akuntansi/rekap_pend',$data) ; 
    }
	
	function cetak_rekap_bel_peg_brg(){
		$ctk = $this->uri->segment(3);		
        $spasi = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;
        
        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" align=\"right\">LAMPIRAN II</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" align=\"right\">&nbsp;</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" align=\"center\">REKAP BELANJA PEGAWAI DAN BELANJA BARANG TAHUN $thn</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" align=\"right\">&nbsp;</td>      
                  </tr>
                 </table>";
				  
				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\"><tr>
											  <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE REKENING</td>
											  <td bgcolor=\"#CCCCCC\" width=\"65%\" align=\"center\">NAMA UNIT KERJA</td>
											  <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">BELANJA PEGAWAI</td>                        
                    						  <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">BELANJA BARANG</td>
                    				</tr>"; 		  

				$sql = "SELECT a.kd_skpd, (SELECT nm_skpd from trdrka where kd_skpd=a.kd_skpd group by nm_skpd) nm_skpd,
						SUM(CASE WHEN LEFT(b.map_real,3) in ('511','521') THEN (debet-kredit) ELSE 0 END) as belanja_pegawai,
						SUM(CASE WHEN LEFT(b.map_real,3) in ('522') THEN (debet-kredit) ELSE 0 END) as belanja_brg
						FROM trhju_calk a 
						INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
						WHERE LEFT(b.map_real,3) IN ('511','521','522') AND YEAR(a.tgl_voucher)=$thn
						GROUP BY kd_skpd
						order by kd_skpd";
					$sqlsclient=$this->db->query($sql);
					
					$no=1;
					foreach ($sqlsclient->result() as $row)
					{
						$kd_skpd=$row->kd_skpd;
						$nm_skpd=$row->nm_skpd;
						$belanja_pegawai=$row->belanja_pegawai;
						$belanja_brg=$row->belanja_brg;
						
						$cRet .= "<tr>
											 <td align=\"center\">".$kd_skpd."</td>
											 <td align=\"left\">".$nm_skpd."</td>
                    						 <td align=\"right\">".number_format($belanja_pegawai,"2",",",".")."</td>
                    						 <td align=\"right\">".number_format($belanja_brg,"2",",",".")."</td>
                    			  </tr>"; 
					}
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("rekap_belanja_pegawai_barang");
        $this->template->set('title', 'rekap_belanja_pegawai_barang');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename=$judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename=$judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        }
	}
	
	function cetak_rekap_beban(){
		$ctk = $this->uri->segment(3);		
        $spasi = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;
        
        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
				  <tr>
                    <td style=\"font-weight:bold;\" align=\"center\">REKAP BEBAN TAHUN $thn</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" align=\"right\">&nbsp;</td>      
                  </tr>
                 </table>";
				  
				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\"><tr>
											  <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE REKENING</td>
											  <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\">NAMA UNIT KERJA</td>
											  <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">PEGAWAI</td>                        
                    						  <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">BARANG JASA</td>
                    						  <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">PERSEDIAAN</td>
                    						  <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">PEMELIHARAAN</td>
                    						  <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">PERJALANAN DINAS</td>
                    				</tr>"; 		  

				$tot_bbn_pegawai=0;
				$tot_bbn_brg_jsa=0;
				$tot_bbn_persediaan=0;
				$tot_bbn_pemeliharaan=0;
				$tot_bbn_prj_dns=0;
				
				$sql = "SELECT a.kd_skpd, a.nm_skpd, ISNULL(b.bbn_pegawai,0) bbn_pegawai, ISNULL(c.bbn_brg_jsa,0) bbn_brg_jsa, ISNULL(d.bbn_persediaan,0) bbn_persediaan  , ISNULL(e.bbn_pemeliharaan,0) bbn_pemeliharaan, ISNULL(f.bbn_prj_dns,0) bbn_prj_dns FROM ms_skpd a
						LEFT JOIN
						(select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) bbn_pegawai 
						from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where LEFT(b.kd_rek5,3) IN ('911') AND YEAR(tgl_voucher)=$thn
						group by b.kd_unit) b
						on a.kd_skpd=b.kd_skpd
						LEFT JOIN
						(select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) bbn_brg_jsa 
						from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where b.kd_rek5 IN ('9120301','9120302','9120303','9120304','9120305','9120306',
											'9120307','9120308','9120309','9120311','9120312','9120314','9120401',
											'9120402','9120501','9120502','9120503','9120504','9120505','9120602',
											'9120702','9120703','9120705','9120801','9120802','9120803','9121001',
											'9121003','9121004','9121005','9121006','9121007','9121101','9121102',
											'9121103','9121105','9121201','9121202','9121203','9121204','9121301',
											'9121401','9121403','9121404','9121405','9122202','9122203','9122205',
											'9122206','9122301','9122302','9122303','9122502','9122700','9122801',
											'9120403','9122702','9121104','9120903','9122901') 
						AND YEAR(tgl_voucher)=$thn
						group by b.kd_unit) c
						on a.kd_skpd=c.kd_skpd
						LEFT JOIN 
						(select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) bbn_persediaan 
						from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where b.kd_rek5 IN ('9120101','9120102','9120103','9120104','9120105','9120106','9120107',
											'9120108','9120109','9120201','9120202','9120203','9120204','9120205',
											'9120206','9120207','9120601','9122000','9122002','9122001','9122101','9123001') 
						AND YEAR(tgl_voucher)=$thn
						group by b.kd_unit) d
						on a.kd_skpd=d.kd_skpd
						LEFT JOIN
						(select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) bbn_pemeliharaan 
						from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where b.kd_rek5 IN ('9121801','9121802','9121803','9121804','9121805','9121806','9121901',
											'9121902','9121903','9121904') 
						AND YEAR(tgl_voucher)=$thn
						group by b.kd_unit) e
						on a.kd_skpd=e.kd_skpd
						LEFT JOIN 
						(select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) bbn_prj_dns 
						from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where b.kd_rek5 IN ('9121501','9121502','9121503','9121604','9121700') 
						AND YEAR(tgl_voucher)=$thn
						group by b.kd_unit) f
						on a.kd_skpd=f.kd_skpd
						order by a.kd_skpd";
					$sqlsclient=$this->db->query($sql);
					
					$no=1;
					foreach ($sqlsclient->result() as $row)
					{
						$kd_skpd=$row->kd_skpd;
						$nm_skpd=$row->nm_skpd;
						$bbn_pegawai=$row->bbn_pegawai;
						$bbn_brg_jsa=$row->bbn_brg_jsa;
						$bbn_persediaan=$row->bbn_persediaan;
						$bbn_pemeliharaan=$row->bbn_pemeliharaan;
						$bbn_prj_dns=$row->bbn_prj_dns;
						
						$tot_bbn_pegawai=$tot_bbn_pegawai+$bbn_pegawai;
						$tot_bbn_brg_jsa=$tot_bbn_brg_jsa+$bbn_brg_jsa;
						$tot_bbn_persediaan=$tot_bbn_persediaan+$bbn_persediaan;
						$tot_bbn_pemeliharaan=$tot_bbn_pemeliharaan+$bbn_pemeliharaan;
						$tot_bbn_prj_dns=$tot_bbn_prj_dns+$bbn_prj_dns;
						
						$cRet .= "<tr>
											 <td align=\"center\">".$kd_skpd."</td>
											 <td align=\"left\">".$nm_skpd."</td>
                    						 <td align=\"right\">".number_format($bbn_pegawai,"2",",",".")."</td>
                    						 <td align=\"right\">".number_format($bbn_brg_jsa,"2",",",".")."</td>
                    						 <td align=\"right\">".number_format($bbn_persediaan,"2",",",".")."</td>
                    						 <td align=\"right\">".number_format($bbn_pemeliharaan,"2",",",".")."</td>
                    						 <td align=\"right\">".number_format($bbn_prj_dns,"2",",",".")."</td>
                    			  </tr>"; 
					}
                             
						$cRet .= "<tr>
											 <td align=\"left\" colspan=\"2\"><b>Total</b></td>
                    						 <td align=\"right\"><b>".number_format($tot_bbn_pegawai,"2",",",".")."</b></td>
                    						 <td align=\"right\"><b>".number_format($tot_bbn_brg_jsa,"2",",",".")."</b></td>
                    						 <td align=\"right\"><b>".number_format($tot_bbn_persediaan,"2",",",".")."</b></td>
                    						 <td align=\"right\"><b>".number_format($tot_bbn_pemeliharaan,"2",",",".")."</b></td>
                    						 <td align=\"right\"><b>".number_format($tot_bbn_prj_dns,"2",",",".")."</b></td>
                    			  </tr>"; 
								  
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("rekap_beban");
        $this->template->set('title', 'rekap_beban');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename=$judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename=$judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        }
	}
	
	
	function cetak_rekap_pendapatan(){
		$ctk = $this->uri->segment(3);		
        $spasi = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;
        
        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" align=\"right\">LAMPIRAN I</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" align=\"right\">&nbsp;</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" align=\"center\">REKAP PENDAPATAN TAHUN $thn</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" align=\"right\">&nbsp;</td>      
                  </tr>
                 </table>";
				  
				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\"><tr>
											  <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE REKENING</td>
											  <td bgcolor=\"#CCCCCC\" width=\"65%\" align=\"center\">NAMA UNIT KERJA</td>
											  <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">PENDAPATAN</td>                        
                    				</tr>"; 		  

				$sql = "SELECT a.kd_skpd, (SELECT nm_skpd from trdrka where kd_skpd=a.kd_skpd group by nm_skpd) nm_skpd,
						SUM(CASE WHEN LEFT(b.map_real,1) in ('4') THEN (kredit-debet) ELSE 0 END) as pendapatan
						FROM trhju_calk a 
						INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
						WHERE LEFT(b.map_real,1) IN ('4') AND YEAR(a.tgl_voucher)=$thn
						GROUP BY kd_skpd
						ORDER BY kd_skpd";
					$sqlsclient=$this->db->query($sql);
					
					$no=1;
					foreach ($sqlsclient->result() as $row)
					{
						$kd_skpd=$row->kd_skpd;
						$nm_skpd=$row->nm_skpd;
						$pendapatan=$row->pendapatan;
						
						$cRet .= "<tr>
											 <td align=\"center\">".$kd_skpd."</td>
											 <td align=\"left\">".$nm_skpd."</td>
                    						 <td align=\"right\">".number_format($pendapatan,"2",",",".")."</td>
                    			  </tr>"; 
					}
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("rekap_pendapatan");
        $this->template->set('title', 'rekap_pendapatan');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename=$judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename=$judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        }
	}
	
	
	function simpan_st_sumberdana(){
        $usernm = $this->session->userdata('pcNama');
        $update = date('Y-m-d');
        $triwulan  = $this->input->post('triwulan');
        $status  = $this->input->post('status');
        
        $sql = "update status_sumberdana set status='$status', username='$usernm', tgl_update='$update' where triwulan='$triwulan'";
        $asg = $this->db->query($sql);
       
    }
	
	function bukubesar_kasda(){
	
        $data['page_title']= 'CETAK BUKU BESAR';
        $this->template->set('title', 'BUKU BESAR');   
        $this->template->load('template','akuntansi/bukubesar_kasda',$data) ; 	
	
	}

	function rekening_kasda() {
        $lccr    = $this->input->post('q');
		$kd_skpd = $this->input->post('kd_skpd');

        $sql = " SELECT DISTINCT kd_rek5,nm_rek5 FROM trdrka_pend where kd_skpd='$kd_skpd' AND kd_rek5 like '$lccr%' group by kd_skpd,kd_rek5,nm_rek5";
 
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
           
            $result[] = array(
                        'id' => $ii,        
                        'kd_rek5' => $resulte['kd_rek5'],  
                        'nm_rek5' => $resulte['nm_rek5'],                   
                        );
                        $ii++;
        }
           
        echo json_encode($result);
	} 
	
	function cetakbb_kasda($dcetak='',$ttd='',$skpd='',$rek5='',$dcetak2='', $jenis=''){ //ANgoez
        $thn_ang = $this->session->userdata('pcThang');
		$ppkd = "3.13.01.17";
		
			$cRet ='<TABLE style="border-collapse:collapse;font-family:Arial" width="100%">
					<TR>
						<TD align="center" ><B>BUKU BESAR </B></TD>
					</TR>
					</TABLE>';

			$cRet .='<TABLE style="border-collapse:collapse;font-family:Arial"  width="100%">
					 <TR>
						<TD align="left" width="20%" >SKPD</TD>
						<TD align="left" width="80%" >: '.$skpd.' '.$this->tukd_model->get_nama($skpd,'nm_skpd','ms_skpd','kd_skpd').'</TD>
					 </TR>
					 <TR>
						<TD align="left" width="20%" >Rekening</TD>
						<TD align="left" width="80%" >: '.$rek5.' '.$this->tukd_model->get_nama($rek5,'nm_rek5','ms_rek5','kd_rek5').'</TD>
					 </TR>
					 <TR>
						<TD align="left" width="20%" >Periode</TD>
						<TD align="left" width="80%" >: '.$this->tukd_model->tanggal_format_indonesia($dcetak).' s/d '.$this->tukd_model->tanggal_format_indonesia($dcetak2).'</TD>
					 </TR>
					 </TABLE>';

			$cRet .='<TABLE style="border-collapse:collapse;font-family:Arial;font-size:12px" width="100%" align="center" border="1" cellspacing="0" cellpadding="4">
					 <THEAD>
					 <TR>
						<TD width="15%"  bgcolor="#CCCCCC" align="center" >TANGGAL</TD>
						<TD width="10%" bgcolor="#CCCCCC" align="center" >NO BUKTI</TD>
						<TD width="25%" bgcolor="#CCCCCC" align="center" >URAIAN</TD>
						<TD width="5%" bgcolor="#CCCCCC" align="center" >REF</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >DEBET</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >KREDIT</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >SALDO</TD>
					 </TR>
					 </THEAD>';
			$saldo_awal=0;
			$cRet .='<TR>
					<TD width="15%" align="left" ></TD>
					<TD width="10%" align="right" ></TD>
					<TD width="25%" align="left" >SALDO AWAL</TD>
					<TD width="5%" align="left" ></TD>
					<TD width="15%" align="right" ></TD>
					<TD width="15%" align="right" ></TD>
					<TD width="15%" align="right" >'.number_format($saldo_awal,"2",",",".").'</TD>
					
				 </TR>';
			$jumlah=0;	
			//isi
			/* $sql = "select tgl_kas, no_kas,keterangan,0 as debet, kredit from (
					select a.kd_skpd, a.tgl_kas, a.no_kas, b.kd_rek5, keterangan+', '+(select nm_skpd from ms_skpd where kd_skpd=a.kd_skpd) keterangan,0 as debet, rupiah as kredit 
					from trhkasin_ppkd a INNER JOIN trdkasin_ppkd b ON a.kd_skpd=b.kd_skpd AND a.no_sts=b.no_sts AND a.no_kas=b.no_kas
					where pot_khusus<>3 AND b.kd_rek5 = '$rek5'
					union all 
					select '3.13.01.17' kd_skpd, a.tgl_kas, a.no_kas, '4141003' kd_rek5, keterangan+', '+(select nm_skpd from ms_skpd where kd_skpd=a.kd_skpd) keterangan,0 as debet, rupiah as kredit 
					from trhkasin_ppkd a INNER JOIN trdkasin_ppkd b ON a.kd_skpd=b.kd_skpd AND a.no_sts=b.no_sts and a.no_kas=b.no_kas
					where jns_trans IN ('5') AND jns_cp='1' AND pot_khusus='3' ) a 
					where kd_skpd='$skpd' and kd_rek5='$rek5' and tgl_kas between '$dcetak' AND '$dcetak2'
					UNION ALL
					select a.tgl_kas, a.no_kas, keterangan+', '+(select nm_skpd from ms_skpd where kd_skpd=a.kd_skpd) keterangan,0 as debet, rupiah as kredit 
					from trhkasin_ppkd a INNER JOIN trdkasin_ppkd b ON a.kd_skpd=b.kd_skpd AND a.no_sts=b.no_sts AND a.no_kas=b.no_kas
					where jns_trans='2' and b.kd_skpd='$skpd' and tgl_kas between '$dcetak' AND '$dcetak2'
					order by tgl_kas, no_kas"; */
			
			$sql = "select tgl_kas, no_kas,keterangan,0 as debet, kredit from (
					select a.kd_skpd, a.tgl_kas, a.no_kas, b.kd_rek5, keterangan+', '+(select nm_skpd from ms_skpd where kd_skpd=a.kd_skpd) keterangan,0 as debet, rupiah as kredit 
					from trhkasin_ppkd a INNER JOIN trdkasin_ppkd b ON a.kd_skpd=b.kd_skpd AND a.no_sts=b.no_sts AND a.no_kas=b.no_kas
					where pot_khusus<>3 AND jns_trans NOT IN ('2') AND b.kd_rek5 = '$rek5'
					union all 
					select '3.13.01.17' kd_skpd, a.tgl_kas, a.no_kas, '4141003' kd_rek5, keterangan+', '+(select nm_skpd from ms_skpd where kd_skpd=a.kd_skpd) keterangan,0 as debet, rupiah as kredit 
					from trhkasin_ppkd a INNER JOIN trdkasin_ppkd b ON a.kd_skpd=b.kd_skpd AND a.no_sts=b.no_sts and a.no_kas=b.no_kas
					where jns_trans IN ('5') AND jns_cp='1' AND pot_khusus='3' 
					union all 
					select '3.13.01.17' kd_skpd, a.tgl_kas, a.no_kas, '4141009' kd_rek5, keterangan+', '+(select nm_skpd from ms_skpd where kd_skpd=a.kd_skpd) keterangan,0 as debet, rupiah as kredit 
					from trhkasin_ppkd a INNER JOIN trdkasin_ppkd b ON a.kd_skpd=b.kd_skpd AND a.no_sts=b.no_sts and a.no_kas=b.no_kas
					where jns_trans IN ('2')
					) a 
					where kd_skpd='$skpd' and kd_rek5='$rek5' and tgl_kas between '$dcetak' AND '$dcetak2'
					order by tgl_kas, no_kas";
			
			$hasil = $this->db->query($sql);
			foreach ($hasil->result() as $rows)
                {  
                    $tgl_kas    = $rows->tgl_kas;                    
                    $no_kas     = $rows->no_kas;
                    $keterangan = $rows->keterangan;
                    $debet      = $rows->debet;
					$kredit     = $rows->kredit;
					$jumlah		= $jumlah+$kredit;
					$saldo_awal = $saldo_awal+$kredit;
			
			
			$cRet .='<TR>
						<TD align="left" >'.$this->tukd_model->tanggal_format_indonesia($tgl_kas).'</TD>
						<TD align="left" >'.$no_kas.'</TD>
						<TD align="left" >'.$keterangan.'</TD>
						<TD align="center" ></TD>
						<TD  align="right" >'.number_format($debet,"2",",",".").'</TD>
						<TD  align="right" >'.number_format($kredit,"2",",",".").'</TD>
						<TD  align="right" >'.number_format($saldo_awal,"2",",",".").'</TD>
					 </TR>';
				}	
				$cRet .='<TR>
					<TD width="15%" align="left" ></TD>
					<TD width="10%" align="right" ></TD>
					<TD width="25%" align="left" >JUMLAH</TD>
					<TD width="5%" align="left" ></TD>
					<TD  align="right" >'.number_format($jumlah,"2",",",".").'</TD>
					<TD  align="right" >'.number_format(0,"2",",",".").'</TD>
					<TD  align="right" >'.number_format(0,"2",",",".").'</TD>
					
				 </TR>';
				$cRet .='</TABLE>';				 
				
			$jenis='1';

			//$data['prev']= 'BUKU BESAR';
			if($jenis == 1){
			echo '<title> Buku Besar </title>';
			echo $cRet;
			}
			if($jenis ==2){
            $this->tukd_model->_mpdf('',$cRet,10,5,10,'0');	
			}
	}


	
    function rekal()
    {
        $data['page_title'] = 'REKAL TRANSAKSI';
        $this->template->set('title', 'REKAL TRANSAKSI');
        $this->template->load('template', 'akuntansi/rekal', $data);
    }
    
    function neraca_saldo()
    {
        $data['page_title']= 'Neraca Saldo';
        $this->template->set('title', 'Neraca Saldo');   
        $this->template->load('template','akuntansi/neraca_saldo',$data) ; 
    }

    function proses_rekal()
    {
		$skpd     = $this->session->userdata('kdskpd');
	
		$this->db->query("exec recall");
	    echo '1';
    }

    function mapping()
    {
        $data['page_title'] = 'MAPPING REALISASI';
        $this->template->set('title', 'MAPPING REALISASI');
        $this->template->load('template', 'akuntansi/mapping', $data);
    }
    
    
	
    function proses_mapping()
    {
		$user     = $this->session->userdata('pcNama');
		$skpd     = $this->session->userdata('kdskpd');
		$thn	  = $this->session->userdata('pcThang');
		
		$this->db->query("exec jurnal_brewok_ppkd '$skpd','$user',$thn");

		echo '1';	
	}
	
	function proses_mapping_skpd()
    {
		$user     = $this->session->userdata('pcNama');
		$skpd     = $this->session->userdata('kdskpd');
		$thn	  = $this->session->userdata('pcThang');
		
		$this->db->query("exec jurnal_brewok_skpd '$user',$thn");

		echo '1';	
	}
	
	function proses_konsol()
    {
		$user     = $this->session->userdata('pcNama');
		$skpd     = $this->session->userdata('kdskpd');
		$thn	  = $this->session->userdata('pcThang');
		
		$this->db->query("exec transfer_lk '$thn'");

		echo '1';	
	}
	
	function proses_restore_unit(){
		$dir = $this->input->post('dir');
        $simakda = $this->input->post('simakda');
        $siadinda = $this->input->post('siadinda');
        $nama = $this->input->post('nama');
		
		$sql = " 
			BACKUP DATABASE [$simakda]
				TO
				  DISK = N'$dir:/backupskpd_otomatis.bak'
				WITH
				  NOFORMAT, NOINIT, SKIP,
				  STATS = 5;
				  
			USE master 
			ALTER DATABASE $siadinda
			SET SINGLE_USER
			WITH ROLLBACK IMMEDIATE;

			RESTORE DATABASE [$siadinda]
			FROM
			  DISK = N'$dir:/$nama'
			WITH
			  NOUNLOAD,  REPLACE,  STATS = 10
			ALTER DATABASE $siadinda
			SET MULTI_USER";
		$asg = $this->db->query($sql);
		echo '1';			
       
    }
	
	function proses_transfer_unit(){
        $user	  = $this->session->userdata('pcNama');
        $dir 	  = $this->input->post('dir');
        $simakda  = $this->input->post('simakda');
        $siadinda = $this->input->post('siadinda');
        $nama 	  = $this->input->post('nama');
        $skpd 	  = $this->input->post('skpd');
		$sql = " exec transfer_konsolidasi '$skpd'";
        $asg = $this->db->query($sql);
		echo '1';	
	}
	
	
	
	/* {
        $this->db->query(" delete from realisasi_anggaran  where left(kd_rek5,1) in('4','5','6')  ");

        $sql = " select * from trdrka order by kd_skpd,kd_kegiatan,kd_rek5 ";
        $query1 = $this->db->query($sql);
        $ii = 0;
        foreach ($query1->result_array() as $res)
        {

            $in = 0;
            $out = 0;
            $cp = 0;
            $real_in = 0;
            $real_out = 0;

            $kd_skpd = $res['kd_skpd'];
            $kd_kegiatan = $res['kd_kegiatan'];
            $kd_rek5 = $res['kd_rek5'];
            $anggaran = $res['nilai_ubah'];

            $gt = substr($kd_kegiatan, 5, strlen($kd_kegiatan) - 5);

            //get_nama($kode,$hasil,$tabel,$field)
            $nm_skpd = $this->tukd_model->get_nama($kd_skpd, 'nm_skpd', 'ms_skpd', 'kd_skpd');
            //$nm_kegiatan=$this->tukd_model->get_nama($gt,'nm_kegiatan','m_giat','kd_kegiatan');
            $nm_rek5 = $this->tukd_model->get_nama($kd_rek5, 'nm_rek5', 'ms_rek5', 'kd_rek5');
            //$nm_skpd="";
            $nm_kegiatan = "";
            //$nm_rek5	="";


           

            //hitung pengeluaran / kas out
            $query2 = $this->db->query(" SELECT SUM(a.debet) AS debet FROM trdju a INNER JOIN trhju b ON a.no_voucher = b.no_voucher WHERE b.kd_skpd='$kd_skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5' ");
            foreach ($query2->result_array() as $res2)
            {
                $debet = $res2['debet'];

            }
            $query3 = $this->db->query(" SELECT SUM(a.kredit) AS kredit FROM trdju a INNER JOIN trhju b ON a.no_voucher = b.no_voucher WHERE b.kd_skpd='$kd_skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5' ");
            foreach ($query3->result_array() as $res3)
            {
                $kredit = $res3['kredit'];

            }
          
            $real_in = $kredit  - $debet;
            $real_out = $debet - $kredit ;
          

            if (((substr($kd_rek5, 0, 1) == '4') or (substr($kd_rek5, 0, 2) == '61')))
            {
                $this->db->query(" insert into realisasi_anggaran(kd_skpd,kd_kegiatan,kd_rek5,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5) values('$kd_skpd','$kd_kegiatan','$kd_rek5',$anggaran,$real_in,'$nm_skpd','$nm_kegiatan','$nm_rek5') ");
            } else
            {
                $this->db->query(" insert into realisasi_anggaran(kd_skpd,kd_kegiatan,kd_rek5,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5) values('$kd_skpd','$kd_kegiatan','$kd_rek5',$anggaran,$real_out,'$nm_skpd','$nm_kegiatan','$nm_rek5') ");
            }
        }

        $this->db->query(" delete from realisasi_anggaran where left(kd_rek5,1) in('7','8','9') ");

        $sql3 = " SELECT  a.kd_skpd AS kd_skpd,b.kd_rek5 AS kd_rek5 FROM trdju b INNER JOIN trhju a ON a.no_voucher=b.no_voucher WHERE LEFT(b.kd_rek5,1) IN('7','8','9') 
                  GROUP BY a.kd_skpd,b.kd_rek5  ORDER BY a.kd_skpd";
        $query5 = $this->db->query($sql3);
        //$ii = 0;
        foreach ($query5->result_array() as $res1)
        {
            //echo 'sdsdsd';
            //hitung pengeluaran / kas out
            $kd_skpd = $res1['kd_skpd'];
            $kd_rek5 = $res1['kd_rek5'];
            $query6 = $this->db->query(" SELECT SUM(a.debet) AS debet FROM trdju a INNER JOIN trhju b ON a.no_voucher = b.no_voucher WHERE b.kd_skpd='$kd_skpd' AND a.kd_rek5='$kd_rek5' ");
            foreach ($query6->result_array() as $res6)
            {
                $debet = $res6['debet'];

            }
            $query7 = $this->db->query(" SELECT SUM(a.kredit) AS kredit FROM trdju a INNER JOIN trhju b ON a.no_voucher = b.no_voucher WHERE b.kd_skpd='$kd_skpd'  AND a.kd_rek5='$kd_rek5' ");

            foreach ($query7->result_array() as $res7)
            {
                //echo 'dsdsd';
                $kredit = $res7['kredit'];

            }

            
            if (substr($kd_rek5, 0, 2) == '71' || substr($kd_rek5, 0, 1) == '8')
            {
                $real = $kredit  - $debet ;
            } else
            {
                $real = $debet - $kredit;
                //$real_ppkd=$debet_ppkd- $kredit_ppkd;
            }
            $this->db->query(" insert into realisasi_anggaran(kd_skpd,kd_rek5,real_spj) values('$kd_skpd','$kd_rek5','$real') ");
            //$this->db->query(" insert into realisasi_ppkd(kd_skpd,kd_rek5,real_spj) values('$kd_skpd','$kd_rek5','$real_ppkd') ");
        }


    
        ///realisasi_laporan
        $this->db->query(" delete from realisasi  where left(kd_rek5,1) in('4','5','6')  ");

        $sql = " select * from trdrka order by kd_skpd,kd_kegiatan,kd_rek5 ";
        $query1 = $this->db->query($sql);
        $ii = 0;
        foreach ($query1->result_array() as $res)
        {

            $in = 0;
            $out = 0;
            $cp = 0;
            $real_in = 0;
            $real_out = 0;

            $kd_skpd = $res['kd_skpd'];
            $kd_kegiatan = $res['kd_kegiatan'];
            $kd_rek5 = $res['kd_rek5'];
            $rek64= $this->tukd_model->get_nama($kd_rek5,'kd_rek64','ms_rek5','kd_rek5');
            $anggaran = $res['nilai_ubah'];

            $gt = substr($kd_kegiatan, 5, strlen($kd_kegiatan) - 5);

            //get_nama($kode,$hasil,$tabel,$field)
            $nm_skpd = $this->tukd_model->get_nama($kd_skpd, 'nm_skpd', 'ms_skpd', 'kd_skpd');
            //$nm_kegiatan=$this->tukd_model->get_nama($gt,'nm_kegiatan','m_giat','kd_kegiatan');
            $nm_rek5 = $this->tukd_model->get_nama($rek64, 'nm_rek64', 'ms_rek5', 'kd_rek64');
            //$nm_skpd="";
            $nm_kegiatan = "";
            //$nm_rek5	="";


           

            //hitung pengeluaran / kas out
            $query2 = $this->db->query(" SELECT SUM(a.debet) AS debet FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher WHERE b.kd_skpd='$kd_skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$rek64' ");
            foreach ($query2->result_array() as $res2)
            {
                $debet = $res2['debet'];

            }
            $query3 = $this->db->query(" SELECT SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher WHERE b.kd_skpd='$kd_skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$rek64' ");
            foreach ($query3->result_array() as $res3)
            {
                $kredit = $res3['kredit'];

            }
          
            $real_in = $kredit  - $debet;
            $real_out = $debet - $kredit ;
          

            if (((substr($kd_rek5, 0, 1) == '4') or (substr($kd_rek5, 0, 2) == '61')))
            {
                $this->db->query(" insert into realisasi(kd_skpd,kd_kegiatan,kd_rek5,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5) values('$kd_skpd','$kd_kegiatan','$rek64',$anggaran,$real_in,'$nm_skpd','$nm_kegiatan','$nm_rek5') ");
            } else
            {
                $this->db->query(" insert into realisasi(kd_skpd,kd_kegiatan,kd_rek5,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5) values('$kd_skpd','$kd_kegiatan','$rek64',$anggaran,$real_out,'$nm_skpd','$nm_kegiatan','$nm_rek5') ");
            }
        }

        $this->db->query(" delete from realisasi where left(kd_rek5,1) in('7','8','9') ");

        $sql3 = " SELECT  a.kd_skpd AS kd_skpd,b.kd_rek5 AS kd_rek5 FROM trdju_pkd b INNER JOIN trhju_pkd a ON a.no_voucher=b.no_voucher WHERE LEFT(b.kd_rek5,1) IN('7','8','9') 
                  GROUP BY a.kd_skpd,b.kd_rek5  ORDER BY a.kd_skpd";
        $query5 = $this->db->query($sql3);
        //$ii = 0;
        foreach ($query5->result_array() as $res1)
        {
            //echo 'sdsdsd';
            //hitung pengeluaran / kas out
            $kd_skpd = $res1['kd_skpd'];
            $kd_rek5 = $res1['kd_rek5'];
            $query6 = $this->db->query(" SELECT SUM(a.debet) AS debet FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher WHERE b.kd_skpd='$kd_skpd' AND a.kd_rek5='$kd_rek5' ");
            foreach ($query6->result_array() as $res6)
            {
                $debet = $res6['debet'];

            }
            $query7 = $this->db->query(" SELECT SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher WHERE b.kd_skpd='$kd_skpd'  AND a.kd_rek5='$kd_rek5' ");

            foreach ($query7->result_array() as $res7)
            {
                //echo 'dsdsd';
                $kredit = $res7['kredit'];

            }

            
            if (substr($kd_rek5, 0, 2) == '71' || substr($kd_rek5, 0, 1) == '8')
            {
                $real = $kredit  - $debet ;
            } else
            {
                $real = $debet - $kredit;
                //$real_ppkd=$debet_ppkd- $kredit_ppkd;
            }
            $this->db->query(" insert into realisasi(kd_skpd,kd_rek5,real_spj) values('$kd_skpd','$kd_rek5','$real') ");
            //$this->db->query(" insert into realisasi_ppkd(kd_skpd,kd_rek5,real_spj) values('$kd_skpd','$kd_rek5','$real_ppkd') ");
        }

        echo '1';
    }

 */
    
	function skpd_unit() {
        $lccr = $this->input->post('q');
        $sql = "SELECT kd_skpd,nm_skpd FROM simakdatransfer_2015.dbo.ms_skpd where upper(kd_skpd) like upper('%$lccr%') or upper(nm_skpd) like upper('%$lccr%') order by kd_skpd ";
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
           
            $result[] = array(
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],  
                        'nm_skpd' => $resulte['nm_skpd']
                        );
                        $ii++;
        }
           
        echo json_encode($result);
    	    $query1->free_result();
	}
    
	
	
	function bukubesar()
    {

        $data['page_title'] = 'CETAK BUKU BESAR';
        $this->template->set('title', 'BUKU BESAR');
        $this->template->load('template', 'akuntansi/bukubesar', $data);

    }
    
    

    function skpd()
    {
		$id  = $this->session->userdata('pcUser'); 
		$usernm      = $this->session->userdata('pcNama');
        $lccr = $this->input->post('q');
        
		if($usernm=='pajak'){
			$sql = "SELECT a.kd_skpd,a.nm_skpd,b.statu,b.status_sempurna,b.status_ubah FROM ms_skpd a join trhrka b on a.kd_skpd=b.kd_skpd where a.kd_skpd IN  
					(SELECT kd_skpd FROM user_akt WHERE user_id='$id') AND (upper(kd_skpd) like upper('%$lccr%') or upper(nm_skpd) like upper('%$lccr%')) order by kd_skpd";
		}else{
			$sql = "SELECT a.kd_skpd,a.nm_skpd,b.statu,status_sempurna,status_ubah FROM ms_skpd a join trhrka b on a.kd_skpd=b.kd_skpd where upper(a.kd_skpd) 
					like upper('%$lccr%') or upper(nm_skpd) like upper('%$lccr%') ";
        }
		$query1 = $this->db->query($sql);
        $result = array();
        $ii = 0;
        foreach ($query1->result_array() as $resulte)
        {

            $result[] = array('id' => $ii, 'kd_skpd' => $resulte['kd_skpd'], 'nm_skpd' => $resulte['nm_skpd'],'statu' => $resulte['statu'],
						'status_sempurna' => $resulte['status_sempurna'],'status_ubah' => $resulte['status_ubah'] );
            $ii++;
        }

        echo json_encode($result);
    }

    function rekening() {
        $lccr = $this->input->post('q');
		$cskpd = $this->input->post('kd');
//        $sql = " SELECT kd_rek5,nm_rek5 FROM ms_rek5 where kd_rek5 like '$lccr%' limit 20";
        $sql = " SELECT DISTINCT isnull(kd_rek5,'') kd_rek5 , isnull(nm_rek5,'') nm_rek5 FROM trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
				 where kd_skpd='$cskpd' and (upper(kd_rek5) like upper('%$lccr%') or upper(nm_rek5) like upper('%$lccr%')) group by kd_rek5,nm_rek5 order by kd_rek5";
 
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
           
            $result[] = array(
                        'id' => $ii,        
                        'kd_rek5' => $resulte['kd_rek5'],  
                        'nm_rek5' => $resulte['nm_rek5'],                   
                        );
                        $ii++;
        }
           
        echo json_encode($result);
	}      

	function cetakbb($dcetak='',$ttd='',$skpd='',$rek5='',$dcetak2='', $jenis=''){ //ANgoez
        $thn_ang = $this->session->userdata('pcThang');
			$cRet ='<TABLE width="100%">
					<TR>
						<TD align="center" ><B>BUKU BESAR </B></TD>
					</TR>
					</TABLE>';

			$cRet .='<TABLE width="100%">
					 <TR>
						<TD align="left" width="20%" >SKPD</TD>
						<TD align="left" width="80%" >: '.$skpd.' '.$this->tukd_model->get_nama($skpd,'nm_skpd','ms_skpd','kd_skpd').'</TD>
					 </TR>
					 <TR>
						<TD align="left" width="20%" >Rekening</TD>
						<TD align="left" width="80%" >: '.$rek5.' '.$this->tukd_model->get_nama($rek5,'nm_rek64','ms_rek5','kd_rek64').'</TD>
					 </TR>
					 <TR>
						<TD align="left" width="20%" >Periode</TD>
						<TD align="left" width="80%" >: '.$this->tukd_model->tanggal_format_indonesia($dcetak).' s/d '.$this->tukd_model->tanggal_format_indonesia($dcetak2).'</TD>
					 </TR>
					 </TABLE>';

			$cRet .='<TABLE style="border-collapse:collapse;" width="100%" align="center" border="1" cellspacing="0" cellpadding="4">
					 <THEAD>
					 <TR>
						<TD width="15%"  bgcolor="#CCCCCC" align="center" >TANGGAL</TD>
						<TD width="35%" bgcolor="#CCCCCC" align="center" >URAIAN</TD>
						<TD width="5%" bgcolor="#CCCCCC" align="center" >REF</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >DEBET</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >KREDIT</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >SALDO</TD>
					 </TR>
					 </THEAD>';
	if ((substr($rek5,0,1)=='9') or (substr($rek5,0,1)=='8') or (substr($rek5,0,1)=='4') or (substr($rek5,0,1)=='5') or (substr($rek5,0,1)=='7')){
		$csql3 = "SELECT sum(a.debet) as debet,sum(a.kredit) as kredit FROM trdju_pkd a LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_unit=b.kd_skpd WHERE a.kd_rek5='$rek5' AND b.kd_skpd='$skpd' and b.tgl_voucher < '$dcetak'   AND YEAR(b.tgl_voucher)='$thn_ang'";
		} else if ($rek5=='3110101'){
		$csql3 = "SELECT sum(a.debet) as debet,sum(a.kredit) as kredit from (
					select sum(debet) debet, sum(kredit) kredit 
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('8','9') and kd_skpd='$skpd' and tgl_voucher < '$dcetak'
					union all
					select sum(debet) debet, sum(kredit) kredit 
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='0' and kd_skpd='$skpd' and tgl_voucher < '$dcetak'
					union all
					select sum(debet) debet, sum(kredit) kredit 
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev not in ('0') and kd_skpd='$skpd' and tgl_voucher < '$dcetak'
					) a ";
		}
		else {
         $csql3 = "SELECT sum(a.debet) as debet,sum(a.kredit) as kredit FROM trdju_pkd a LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_unit=b.kd_skpd WHERE a.kd_rek5='$rek5' AND b.kd_skpd='$skpd' and b.tgl_voucher < '$dcetak'   ";
		}
         
         $hasil = $this->db->query($csql3);
         $trh4 = $hasil->row(); 
         $awaldebet = $trh4->debet;
         $awalkredit = $trh4->kredit;
                    if ((substr($rek5,0,1)=='9') or (substr($rek5,0,1)=='5') or (substr($rek5,0,2)=='62') or (substr($rek5,0,2)=='72') or (substr($rek5,0,1)=='1')){					
						$saldo=$awaldebet-$awalkredit;
					}else{
						$saldo=$awalkredit-$awaldebet;
					} 
                    if($saldo<0){
					$a='(';
					$saldox=$saldo*-1;
					$b=')';
					} else{
					$a='';
					$saldox=$saldo;
					$b='';	
					}
                    $cRet .='<TR>
								<TD width="15%" align="left" ></TD>
								<TD width="35%" align="left" >saldo awal</TD>
								<TD width="5%" align="left" ></TD>
								<TD width="15%" align="right" ></TD>
								<TD width="15%" align="right" ></TD>
								<TD width="15%" align="right" >'.$a.''.number_format($saldox,"2",",",".").''.$b.'</TD>
							 </TR>';	      
                
				$idx=1;
				if($rek5=='3110101'){
				$query = $this->db->query("SELECT kd_rek5, debet, kredit, tgl_voucher, ket, no_voucher FROM (
										   SELECT a.kd_rek5,a.debet,a.kredit,b.tgl_voucher,b.ket,b.no_voucher FROM trdju_pkd a LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND b.kd_skpd='$skpd' AND b.tgl_voucher>='$dcetak' AND b.tgl_voucher<='$dcetak2'  
										   UNION ALL
										   SELECT '3110101' kd_rek5, SUM(a.debet) debet, SUM(a.kredit) kredit, b.tgl_voucher, 'SURPLUS/DEFISIT LO ('+b.ket+' )' ket, 'SURPLUS/DEFISIT LO - '+b.no_voucher FROM trdju_pkd a LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_unit=b.kd_skpd WHERE LEFT(a.kd_rek5,1) IN ('8','9') AND b.kd_skpd='$skpd' AND b.tgl_voucher>='$dcetak' AND b.tgl_voucher<='$dcetak2'
										   GROUP BY b.tgl_voucher, b.no_voucher, b.ket) a
										   ORDER BY tgl_voucher, debet-kredit");  
				}else{
				$query = $this->db->query("SELECT a.kd_rek5,a.debet,a.kredit,b.tgl_voucher,b.ket,b.no_voucher FROM trdju_pkd a LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_unit=b.kd_skpd WHERE a.kd_rek5='$rek5' AND b.kd_skpd='$skpd' AND b.tgl_voucher>='$dcetak' AND b.tgl_voucher<='$dcetak2'  ORDER BY b.tgl_voucher, 
										   case when left('$rek5',1) in (1,5,6,9) then kredit-debet else debet-kredit end");  
				//$query = $this->db->query("SELECT a.kd_rek5,a.debet,a.kredit,b.tgl_voucher,b.ket,b.no_voucher FROM trdju_pkd a LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher WHERE a.kd_rek5='$rek5' AND b.kd_skpd='$skpd' and b.tgl_voucher>='$dcetak' and b.tgl_voucher<='$dcetak2' and a.pos='1' ORDER by b.tgl_voucher, convert(b.no_voucher,unsigned)");  
				}
				
				if ($query->num_rows() > 0){
				$jdebet=0;
				$jkredit=0;
				foreach($query->result_array() as $res){
										
					$tgl_voucher=$res['tgl_voucher'];
					$ket=$res['ket'];
					$ref=$res['no_voucher'];
					$debet=$res['debet'];
					$kredit=$res['kredit'];
					$idx++;
					if($debet<0){
						$debet1=$debet*-1;
						$c='(';
						$d=')';
						}else{
						$c='';
						$d='';	
						$debet1=$debet;
						}
					if($kredit<0){
						$kredit1=$kredit*-1;
						$e='(';
						$f=')';
						}else{
						$e='';
						$f='';	
						$kredit1=$kredit;
						}	
					$saldo=$saldo;
					if ((substr($rek5,0,1)=='9') or (substr($rek5,0,1)=='5') or (substr($rek5,0,2)=='62') or (substr($rek5,0,2)=='72') or (substr($rek5,0,1)=='1')){					
						$saldo=$saldo+$debet-$kredit;
						
					}else{
						$saldo=$saldo+$kredit-$debet;
						
					}
					if($saldo<0){
						$saldo1=$saldo*-1;
						$i='(';
						$j=')';
						}else{
						$saldo1=$saldo;
						$i='';
						$j='';	
						}
					$cRet .='<TR>
								<TD width="15%" align="left" >'.$this->tukd_model->tanggal_format_indonesia($tgl_voucher).'</TD>
								<TD width="35%" align="left" >'.$ket.'</TD>
								<TD width="5%" align="left" >'.$ref.'</TD>
								<TD width="15%" align="right" >'.$c.''.number_format($debet1,"2",",",".").''.$d.'</TD>
								<TD width="15%" align="right" >'.$e.''.number_format($kredit1,"2",",",".").''.$f.'</TD>
								<TD width="15%" align="right" >'.$i.''.number_format($saldo1,"2",",",".").''.$j.'</TD>
							 </TR>';
							 
					$jdebet=$jdebet+$debet;
					$jkredit = $jkredit + $kredit;
	
				}
				if($jdebet<0){
						$jdebet1=$jdebet*-1;
						$k='(';
						$l=')';
						}else{
						$jdebet1=$jdebet;
						$k='';
						$l='';	
						}
				if($jkredit<0){
						$jkredit1=$jkredit*-1;
						$m='(';
						$n=')';
						}else{
						$jkredit1=$jkredit;
						$m='';
						$n='';	
						}
				
				$cRet .='<TR>
					<TD width="15%" align="left" ></TD>
					<TD width="35%" align="left" >JUMLAH</TD>
					<TD width="5%" align="left" ></TD>
					<TD width="15%" align="right" >'.$k.''.number_format($jdebet1,"2",",",".").''.$l.'</TD>
					<TD width="15%" align="right" >'.$m.''.number_format($jkredit1,"2",",",".").''.$n.'</TD>
					<TD width="15%" align="right" >'.$i.''.number_format($saldo1,"2",",",".").''.$j.'</TD>
				 </TR>';
				$cRet .='</TABLE>';				 
				} else{
				
				$cRet .='</TABLE>';
				}
			$jenis='1';

			//$data['prev']= 'BUKU BESAR';
			if($jenis == 1){
			echo '<title> Buku Besar </title>';
			echo $cRet;
			}
			if($jenis ==2){
            $this->tukd_model->_mpdf('',$cRet,10,5,10,'0');	
			}
	}

    /*
    function cetakbb($dcetak='',$ttd='',$skpd='',$rek5='',$dcetak2=''){

    $cRet ='<TABLE width="100%">
    <TR>
    <TD align="center" >BUKU BESAR </TD>
    </TR>
    </TABLE>';

    $cRet .='<TABLE width="100%">
    <TR>
    <TD align="left" width="100" >SKPD</TD>
    <TD align="left" width="100" >: '.$skpd.' '.$this->tukd_model->get_nama($skpd,'nm_skpd','ms_skpd','kd_skpd').'</TD>
    </TR>
    <TR>
    <TD align="left" width="100" >Rekening</TD>
    <TD align="left" width="100" >: '.$rek5.' '.$this->tukd_model->get_nama($rek5,'nm_rek5','ms_rek5','kd_rek5').'</TD>
    </TR>
    <TR>
    <TD align="left" width="100" >Periode</TD>
    <TD align="left" width="100" >: '.$this->tukd_model->tanggal_format_indonesia($dcetak).' s/d '.$this->tukd_model->tanggal_format_indonesia($dcetak2).'</TD>
    </TR>
    </TABLE>';

    $cRet .='<TABLE border="1" cellspacing="0" cellpadding="0" >
    <TR>
    <TD width="90" align="center" >TANGGAL</TD>
    <TD width="350" align="center" >URAIAN</TD>
    <TD width="80" align="center" >REF</TD>
    <TD width="100" align="center" >DEBET</TD>
    <TD width="100" align="center" >KREDIT</TD>
    <TD width="120" align="center" >SALDO</TD>
    </TR>';
    

    $idx=1;
    $query = $this->db->query("SELECT a.kd_rek5,a.nilai,b.tgl_kas,b.ket,b.no_kas FROM trdkasout_pkd a LEFT JOIN trhkasout_pkd b ON a.no_kas=b.no_kas WHERE a.kd_rek5='$rek5' AND b.kd_skpd='$skpd' and b.tgl_kas>='$dcetak' and b.tgl_kas<='$dcetak2' ");  
    foreach($query->result_array() as $res){
    
    $cetak[$idx][1]=$res['tgl_kas'];
    $cetak[$idx][2]=$res['ket'];
    $cetak[$idx][3]=$res['no_kas'];
    $cetak[$idx][4]=$res['nilai'];
    $cetak[$idx][5]=0;
    $idx++;

    }

    $query = $this->db->query(" SELECT b.tgl_sts,b.keterangan,a.no_sts,a.rupiah AS nilai FROM trdkasin_pkd a LEFT JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE a.kd_rek5='$rek5' AND b.kd_skpd='$skpd' AND b.tgl_sts>='$dcetak' and b.tgl_sts<='$dcetak2' ");  
    foreach($query->result_array() as $res){

    $cetak[$idx][1]=$res['tgl_sts'];
    $cetak[$idx][2]=$res['keterangan'];
    $cetak[$idx][3]=$res['no_sts'];
    $cetak[$idx][4]=0;
    $cetak[$idx][5]=$res['nilai'];
    $idx++;

    }

    asort($cetak);
    $i=0;
    $saldo=0;
    $jdebet=0;
    $jkredit=0;
    foreach ($cetak as $key => $val) {
    $i++;
    if ((substr($rek5,0,1)=='5') or (substr($rek5,0,2)=='62')){					
    $saldo=$saldo+$cetak[$key][4]-$cetak[$key][5];
    }else{
    $saldo=$saldo+$cetak[$key][5]-$cetak[$key][4];
    }

    $cRet .='<TR>
    <TD width="90" align="left" >'.$this->tukd_model->rev_date($cetak[$key][1]).'</TD>
    <TD width="350" align="left" >'.$cetak[$key][2].'</TD>
    <TD width="80" align="left" >'.$cetak[$key][3].'</TD>
    <TD width="100" align="right" >'.number_format($cetak[$key][4]).'</TD>
    <TD width="100" align="right" >'.number_format($cetak[$key][5]).'</TD>
    <TD width="120" align="right" >'.number_format($saldo).'</TD>
    </TR>';					
    $jdebet=$jdebet+$cetak[$key][4];
    $jkredit=$jkredit+$cetak[$key][5];
    }

    $cRet .='<TR>
    <TD width="90" align="left" ></TD>
    <TD width="350" align="left" >JUMLAH</TD>
    <TD width="80" align="left" ></TD>
    <TD width="100" align="right" >'.number_format($jdebet).'</TD>
    <TD width="100" align="right" >'.number_format($jkredit).'</TD>
    <TD width="120" align="right" ></TD>
    </TR>';					

    $cRet .='</TABLE>';

    $data['prev']= 'BUKU BESAR';
    $this->tukd_model->_mpdf('',$cRet,10,5,10,'0');	
    
    }
    */

    function jukeluar()
    {
        $data['page_title'] = 'JURNAL PENGELUARAN';
        $this->template->set('title', 'JURNAL PENGELUARAN');
        $this->template->load('template', 'akuntansi/jukeluar', $data);
    }

    function jumasuk()
    {
        $data['page_title'] = 'JURNAL PENERIMAAN';
        $this->template->set('title', 'JURNAL PENERIMAAN');
        $this->template->load('template', 'akuntansi/jumasuk', $data);
    }


    function ctk_jukeluar($dcetak = '', $ttd = '', $skpd = '', $dcetak2 = '')
    {

        $cRet = '<TABLE width="100%">
					<TR>
						<TD align="center" >JURNAL PENGELUARAN</TD>
					</TR>
					</TABLE>';

        $cRet .= '<TABLE width="100%">
					 <TR>
						<TD align="left" width="100" >SKPD</TD>
						<TD align="left" width="100" >: ' . $skpd . ' ' . $this->tukd_model->
            get_nama($skpd, 'nm_skpd', 'ms_skpd', 'kd_skpd') . '</TD>
					 </TR>
					 <TR>
						<TD  align="left" width="100" >PERIODE</TD>
						<TD align="left" width="100" >: ' . $this->tukd_model->
            tanggal_format_indonesia($dcetak) . ' s/d ' . $this->tukd_model->
            tanggal_format_indonesia($dcetak2) . '</TD>
					 </TR>
					 </TABLE>';

        $cRet .= '<TABLE border="1" cellspacing="0" cellpadding="0" >
					 <TR>
						<TD width="90" align="center" rowspan="2" >TANGGAL</TD>
						<TD width="200" align="center" colspan="2" >NOMOR</TD>
						<TD width="100" align="center" rowspan="2" >KODE REKENING</TD>
						<TD width="200" align="center" rowspan="2" >URAIAN</TD>
						<TD width="80" align="center"  rowspan="2" >REF</TD>
						<TD width="100" align="center" rowspan="2" >JUMLAH</TD>
						<TD width="100" align="center" rowspan="2" >AKUMULASI</TD>
					 </TR>';

        $cRet .= '<TR>
						<TD width="100" align="center" >No.Bukti</TD>
						<TD width="100" align="center" >Bukti Lain</TD>
					 </TR>';

        $idx = 1;
        $saldo = 0;
        $tbukti = '';
        $tgl = '';
        $query = $this->db->query(" SELECT a.kd_rek5,a.nilai,a.nm_rek5,b.tgl_kas,b.ket,b.no_kas FROM trdkasout_pkd a LEFT JOIN trhkasout_pkd b ON a.no_kas=b.no_kas WHERE b.kd_skpd='$skpd' and b.tgl_kas>='$dcetak' and b.tgl_kas<='$dcetak2' order by b.tgl_kas ");
        foreach ($query->result_array() as $res)
        {
            if ($tbukti != $res['no_kas'])
            {
                $nokas = $res['no_kas'];
            } else
            {
                $nokas = '';
            }
            if ($tgl != $res['tgl_kas'])
            {
                $tanggal = $res['tgl_kas'];
            } else
            {
                $tanggal = '';
            }
            $saldo = $saldo + $res['nilai'];
            $cRet .= '<TR>
								<TD  align="left" >' . $this->tukd_model->rev_date($res['tgl_kas']) .
                '</TD>
								<TD  align="left" >' . $nokas . '</TD>
								<TD  align="left" ></TD>
								<TD  align="center" >' . $res['kd_rek5'] . '</TD>
								<TD  align="left" >' . $res['nm_rek5'] . '</TD>
								<TD  align="left" ></TD>
								<TD  align="right" >' . number_format($res['nilai']) . '</TD>
								<TD  align="right" >' . number_format($saldo) . '</TD>
							 </TR>';
            $idx++;
            $tbukti = $res['no_kas'];
            $tgl = $res['tgl_kas'];
        }


        $cRet .= '</TABLE>';

        $data['prev'] = 'JURNAL PENGELUARAN';
        $this->tukd_model->_mpdf('', $cRet, 5, 5, 10, '0');

    }


    function ctk_jumasuk($dcetak = '', $ttd = '', $skpd = '', $dcetak2 = '')
    {

        $cRet = '<TABLE width="100%">
					<TR>
						<TD align="center" >JURNAL PENERIMAAN</TD>
					</TR>
					</TABLE>';

        $cRet .= '<TABLE width="100%">
					 <TR>
						<TD align="left" width="100" >SKPD</TD>
						<TD align="left" width="100" >: ' . $skpd . ' ' . $this->tukd_model->
            get_nama($skpd, 'nm_skpd', 'ms_skpd', 'kd_skpd') . '</TD>
					 </TR>
					 <TR>
						<TD  align="left" width="100" >PERIODE</TD>
						<TD align="left" width="100" >: ' . $this->tukd_model->
            tanggal_format_indonesia($dcetak) . ' s/d ' . $this->tukd_model->
            tanggal_format_indonesia($dcetak2) . '</TD>
					 </TR>
					 </TABLE>';

        $cRet .= '<TABLE border="1" cellspacing="0" cellpadding="0" >
					 <TR>
						<TD width="90" align="center" rowspan="2" >TANGGAL</TD>
						<TD width="200" align="center" colspan="2" >NOMOR</TD>
						<TD width="100" align="center" rowspan="2" >KODE REKENING</TD>
						<TD width="200" align="center" rowspan="2" >URAIAN</TD>
						<TD width="80" align="center"  rowspan="2" >REF</TD>
						<TD width="100" align="center" rowspan="2" >JUMLAH</TD>
						<TD width="100" align="center" rowspan="2" >AKUMULASI</TD>
					 </TR>';

        $cRet .= '<TR>
						<TD width="100" align="center" >No.Bukti</TD>
						<TD width="100" align="center" >Bukti Lain</TD>
					 </TR>';

        $idx = 1;
        $saldo = 0;
        $tbukti = '';
        $query = $this->db->query(" SELECT a.kd_rek5,a.rupiah AS nilai,c.nm_rek5,b.tgl_sts,b.no_sts as no_kas FROM trdkasin_pkd a LEFT JOIN trhkasin_pkd b ON a.no_sts=b.no_sts LEFT JOIN ms_rek5 c ON a.kd_rek5=c.kd_rek5 WHERE  b.kd_skpd='$skpd' and b.tgl_sts>='$dcetak' and b.tgl_sts<='$dcetak2' ");
        foreach ($query->result_array() as $res)
        {
            if ($tbukti != $res['no_kas'])
            {
                $nokas = $res['no_kas'];
            } else
            {
                $nokas = '';
            }
            $saldo = $saldo + $res['nilai'];
            $cRet .= '<TR>
								<TD  align="left" >' . $this->tukd_model->rev_date($res['tgl_sts']) .
                '</TD>
								<TD  align="left" >' . $nokas . '</TD>
								<TD  align="left" ></TD>
								<TD  align="center" >' . $res['kd_rek5'] . '</TD>
								<TD  align="left" >' . $res['nm_rek5'] . '</TD>
								<TD  align="left" ></TD>
								<TD  align="right" >' . number_format($res['nilai']) . '</TD>
								<TD  align="right" >' . number_format($saldo) . '</TD>
							 </TR>';
            $idx++;
            $tbukti = $res['no_kas'];
        }


        $cRet .= '</TABLE>';

        $data['prev'] = 'JURNAL PENERIMAAN';
        $this->tukd_model->_mpdf('', $cRet, 5, 5, 10, '0');

    }

    function jumum()
    {
        $data['page_title'] = 'INPUT JURNAL UMUM';
        $this->template->set('title', 'INPUT JURNAL UMUM');
        $this->template->load('template', 'akuntansi/jumum', $data);
    }

    function jumum_ppkd()
    {
        $data['page_title'] = 'INPUT JURNAL UMUM';
        $this->template->set('title', 'INPUT JURNAL UMUM');
        $this->template->load('template', 'akuntansi/jumum_ppkd', $data);
    }

    function load_ju()
    {
        $result = array();
        $row = array();
        $page = isset($_POST['page']) ? intval($_POST['page']) : 1;
        $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
        $offset = ($page - 1) * $rows;
        $kriteria = $this->input->post('cari');
        $where = "where tabel='1'";
        if ($kriteria <> '')
        {
            $where = "where tabel='1' and (upper(no_voucher) like upper('%$kriteria%') or tgl_voucher like '%$kriteria%' or upper(ket) like upper('%$kriteria%')) ";
        }

        $sql = "SELECT count(*) as total from trhju_pkd $where";
        $query1 = $this->db->query($sql);
        $total = $query1->row();
        $result["total"] = $total->total;
        $query1->free_result();

        $sql = " select * from trhju_pkd $where order by tgl_voucher,no_voucher,kd_skpd limit $offset,$rows";
        $query1 = $this->db->query($sql);
        $ii = 0;
        foreach ($query1->result_array() as $resulte)
        {
            $row[] = array('no_voucher' => $resulte['no_voucher'], 'tgl_voucher' => $resulte['tgl_voucher'],
                'kd_skpd' => $resulte['kd_skpd'], 'nm_skpd' => $resulte['nm_skpd'], 'ket' =>
                trim($resulte['ket']), 'total_d' => $resulte['total_d'], 'total_k' => $resulte['total_k']);
            $ii++;
        }
        $result["rows"] = $row;
        echo json_encode($result);
        $query1->free_result();
    }

    function load_ju_ppkd()
    {
        $result = array();
        $row = array();
        $page = isset($_POST['page']) ? intval($_POST['page']) : 1;
        $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
        $offset = ($page - 1) * $rows;
        $kriteria = $this->input->post('cari');
        $where = "where tabel='1'";
        if ($kriteria <> '')
        {
            $where = "where tabel='1' and (upper(no_voucher) like upper('%$kriteria%') or tgl_voucher like '%$kriteria%' or upper(ket) like upper('%$kriteria%')) ";
        }

        $sql = "SELECT count(*) as total from trhju_ppkd $where";
        $query1 = $this->db->query($sql);
        $total = $query1->row();
        $result["total"] = $total->total;
        $query1->free_result();

        $sql = " select * from trhju_ppkd $where order by tgl_voucher,no_voucher,kd_skpd limit $offset,$rows";
        $query1 = $this->db->query($sql);
        $ii = 0;
        foreach ($query1->result_array() as $resulte)
        {
            $row[] = array('no_voucher' => $resulte['no_voucher'], 'tgl_voucher' => $resulte['tgl_voucher'],
                'kd_skpd' => $resulte['kd_skpd'], 'nm_skpd' => $resulte['nm_skpd'], 'ket' =>
                trim($resulte['ket']), 'total_d' => $resulte['total_d'], 'total_k' => $resulte['total_k']);
            $ii++;
        }
        $result["rows"] = $row;
        echo json_encode($result);
        $query1->free_result();
    }

    function load_dju()
    {
        $nomor = $this->input->post('no');
        $sql = "SELECT a.no_voucher,b.kd_kegiatan,b.nm_kegiatan,b.kd_rek5,IF(rk='D',b.nm_rek5,CONCAT(SPACE(4),b.nm_rek5)) AS nm_rek5,b.debet,b.kredit,b.rk,b.jns,b.pos FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher WHERE a.no_voucher='$nomor'";
        $query1 = $this->db->query($sql);
        $result = array();
        $ii = 0;
        foreach ($query1->result_array() as $resulte)
        {
            $result[] = array('no_voucher' => $resulte['no_voucher'], 'kd_kegiatan' => $resulte['kd_kegiatan'],
                'nm_kegiatan' => $resulte['nm_kegiatan'], 'kd_rek5' => $resulte['kd_rek5'],
                'nm_rek5' => $resulte['nm_rek5'], 'debet' => $resulte['debet'], 'kredit' => $resulte['kredit'],
                'rk' => $resulte['rk'], 'jns' => $resulte['jns'], 'post' => $resulte['pos']);
            $ii++;
        }
        echo json_encode($result);
        $query1->free_result();
    }

    function load_dju_ppkd()
    {
        $nomor = $this->input->post('no');
        $sql = "SELECT a.no_voucher,b.kd_kegiatan,b.nm_kegiatan,b.kd_rek5,IF(rk='D',b.nm_rek5,CONCAT(SPACE(4),b.nm_rek5)) AS nm_rek5,b.debet,b.kredit,b.rk,b.jns,b.pos FROM trhju_ppkd a INNER JOIN trdju_ppkd b ON a.no_voucher=b.no_voucher WHERE a.no_voucher='$nomor'";
        $query1 = $this->db->query($sql);
        $result = array();
        $ii = 0;
        foreach ($query1->result_array() as $resulte)
        {
            $result[] = array('no_voucher' => $resulte['no_voucher'], 'kd_kegiatan' => $resulte['kd_kegiatan'],
                'nm_kegiatan' => $resulte['nm_kegiatan'], 'kd_rek5' => $resulte['kd_rek5'],
                'nm_rek5' => $resulte['nm_rek5'], 'debet' => $resulte['debet'], 'kredit' => $resulte['kredit'],
                'rk' => $resulte['rk'], 'jns' => $resulte['jns'], 'post' => $resulte['pos']);
            $ii++;
        }
        echo json_encode($result);
        $query1->free_result();
    }

    function load_ju_trskpd()
    {
        $jenis = $this->input->post('jenis');
        $len = strlen($jenis);
        $giat = $this->input->post('giat');
        $cskpd = $this->input->post('kd');

        $jns_beban = '';
        $cgiat = '';
        if ($jenis != '')
        {
            $jns_beban = "and left(a.jns_kegiatan,$len)='$jenis'";
        }
        if ($giat != '')
        {
            $cgiat = " and a.kd_kegiatan not in ($giat) ";
        }
        $lccr = $this->input->post('q');
        $sql = "SELECT a.kd_kegiatan,b.nm_kegiatan,a.kd_program,(select nm_program from m_prog where kd_program=a.kd_program) as nm_program,a.total FROM trskpd a INNER JOIN m_giat b ON a.kd_kegiatan1=b.kd_kegiatan
                WHERE LEFT(a.kd_kegiatan,4)= LEFT('$cskpd',4) $jns_beban $cgiat AND (UPPER(a.kd_kegiatan) LIKE UPPER('%$lccr%') OR UPPER(b.nm_kegiatan) LIKE UPPER('%$lccr%'))";
        $query1 = $this->db->query($sql);
        $result = array();
        $ii = 0;
        foreach ($query1->result_array() as $resulte)
        {

            $result[] = array('id' => $ii, 'kd_kegiatan' => $resulte['kd_kegiatan'],
                'nm_kegiatan' => $resulte['nm_kegiatan'], 'kd_program' => $resulte['kd_program'],
                'nm_program' => $resulte['nm_program'], 'total' => $resulte['total']);
            $ii++;
        }

        echo json_encode($result);
        $query1->free_result();
    }

    function load_ju_rek()
    {
        //$jenis = $this->uri->segment(3);
        $jenis = $this->input->post('jenis');
        $len = strlen($jenis);
        $giat = $this->input->post('giat');
        $kode = $this->input->post('kd');
        $rek = $this->input->post('rek');
        $lccr = $this->input->post('q');


        if ($rek != '')
        {
            //if($jenis == '7' || $jenis == '8'  ||  $jenis == '9'){
            //$notIn = " and kd_rek4 not in ($rek) " ;
            //}else{
            $notIn = " and kd_rek5 not in ($rek) ";
            //}
        } else
        {
            $notIn = "";
        }
        //echo $jenis;

        if ($jenis == '4' || $jenis == '5' || $jenis == '6')
        {
            $sql = "SELECT kd_rek5,nm_rek5 FROM trdrka  WHERE kd_kegiatan= '$giat' AND kd_skpd = '$kode' $notIn ";
        } else
        {
            //if ($jenis == '7' || $jenis == '8'  ||  $jenis == '9'){

            //$sql = "SELECT  kd_rek5,nm_rek4 as nm_rek5 FROM ms_rek4 where left(kd_rek4,$len)='$jenis' $notIn";
            //}else{

            $sql = "SELECT kd_rek5,nm_rek5 FROM ms_rek5 where left(kd_rek5,$len)='$jenis' $notIn";
            //}
        }
        $query1 = $this->db->query($sql);
        $result = array();
        $ii = 0;
        foreach ($query1->result_array() as $resulte)
        {
            $result[] = array('kd_rek5' => $resulte['kd_rek5'], 'nm_rek5' => $resulte['nm_rek5']);
            $ii++;
        }
        echo json_encode($result);
        $query1->free_result();
    }

    function simpan_ju()
    {
        $tabel = $this->input->post('tabel');
        $nomor = $this->input->post('no');
        $tgl = $this->input->post('tgl');
        $skpd = $this->input->post('skpd');
        $nmskpd = $this->input->post('nmskpd');
        $ket = $this->input->post('ket');
        $total_d = $this->input->post('total_d');
        $total_k = $this->input->post('total_k');
        $csql = $this->input->post('sql');

        $usernm = $this->session->userdata('pcNama');
        $update = date('y-m-d H:i:s');
        $msg = array();

        if ($tabel == 'trhju_pkd')
        {
            $sql = "delete from trhju_pkd where kd_skpd='$skpd' and no_voucher='$nomor'";
            $asg = $this->db->query($sql);
            if ($asg)
            {
                $sql = "insert into trhju_pkd(no_voucher,tgl_voucher,ket,username,tgl_update,kd_skpd,nm_skpd,total_d,total_k,tabel) 
                        values('$nomor','$tgl','$ket','$usernm','$update','$skpd','$nmskpd','$total_d','$total_k','1')";
                $asg = $this->db->query($sql);
                if (!($asg))
                {
                    $msg = array('pesan' => '0');
                    echo json_encode($msg);
                    exit();
                } else
                {
                    $msg = array('pesan' => '1');
                    echo json_encode($msg);
                }
            } else
            {
                $msg = array('pesan' => '0');
                echo json_encode($msg);
                exit();
            }

        } else
            if ($tabel == 'trdju_pkd')
            {

                // Simpan Detail //
                $sql = "delete from trdju_pkd where no_voucher='$nomor'";
                $asg = $this->db->query($sql);
                if (!($asg))
                {
                    $msg = array('pesan' => '0');
                    echo json_encode($msg);
                    exit();
                } else
                {
                    $sql = "insert into trdju_pkd(no_voucher,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,debet,kredit,rk,jns,pos,urut)";

                    $asg = $this->db->query($sql . $csql);
                    if (!($asg))
                    {
                        $msg = array('pesan' => '0');
                        echo json_encode($msg);
                        exit();
                    } else
                    {
                        $msg = array('pesan' => '1');
                        echo json_encode($msg);
                    }
                }
            }
    }

    function simpan_ju_ppkd()
    {
        $tabel = $this->input->post('tabel');
        $nomor = $this->input->post('no');
        $tgl = $this->input->post('tgl');
        $skpd = $this->input->post('skpd');
        $nmskpd = $this->input->post('nmskpd');
        $ket = $this->input->post('ket');
        $total_d = $this->input->post('total_d');
        $total_k = $this->input->post('total_k');
        $csql = $this->input->post('sql');

        $usernm = $this->session->userdata('pcNama');
        $update = date('y-m-d H:i:s');
        $msg = array();

        if ($tabel == 'trhju_ppkd')
        {
            $sql = "delete from trhju_ppkd where kd_skpd='$skpd' and no_voucher='$nomor'";
            $asg = $this->db->query($sql);
            if ($asg)
            {
                $sql = "insert into trhju_ppkd(no_voucher,tgl_voucher,ket,username,tgl_update,kd_skpd,nm_skpd,total_d,total_k,tabel) 
                        values('$nomor','$tgl','$ket','$usernm','$update','$skpd','$nmskpd','$total_d','$total_k','1')";
                $asg = $this->db->query($sql);
                if (!($asg))
                {
                    $msg = array('pesan' => '0');
                    echo json_encode($msg);
                    exit();
                } else
                {
                    $msg = array('pesan' => '1');
                    echo json_encode($msg);
                }
            } else
            {
                $msg = array('pesan' => '0');
                echo json_encode($msg);
                exit();
            }

        } else
            if ($tabel == 'trdju_ppkd')
            {

                // Simpan Detail //
                $sql = "delete from trdju_ppkd where no_voucher='$nomor'";
                $asg = $this->db->query($sql);
                if (!($asg))
                {
                    $msg = array('pesan' => '0');
                    echo json_encode($msg);
                    exit();
                } else
                {
                    $sql = "insert into trdju_ppkd(no_voucher,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,debet,kredit,rk,jns,pos,urut)";

                    $asg = $this->db->query($sql . $csql);
                    if (!($asg))
                    {
                        $msg = array('pesan' => '0');
                        echo json_encode($msg);
                        exit();
                    } else
                    {
                        $msg = array('pesan' => '1');
                        echo json_encode($msg);
                    }
                }
            }
    }

    function hapus_ju()
    {
        $nomor = $this->input->post('no');
        $msg = array();
        $sql = "delete from trdju_pkd where no_voucher='$nomor'";
        $asg = $this->db->query($sql);
        if ($asg)
        {
            $sql = "delete from trhju_pkd where no_voucher='$nomor'";
            $asg = $this->db->query($sql);
            if (!($asg))
            {
                $msg = array('pesan' => '0');
                echo json_encode($msg);
                exit();
            }
        } else
        {
            $msg = array('pesan' => '0');
            echo json_encode($msg);
            exit();
        }
        $msg = array('pesan' => '1');
        echo json_encode($msg);
    }

    function hapus_ju_ppkd()
    {
        $nomor = $this->input->post('no');
        $msg = array();
        $sql = "delete from trdju_ppkd where no_voucher='$nomor'";
        $asg = $this->db->query($sql);
        if ($asg)
        {
            $sql = "delete from trhju_ppkd where no_voucher='$nomor'";
            $asg = $this->db->query($sql);
            if (!($asg))
            {
                $msg = array('pesan' => '0');
                echo json_encode($msg);
                exit();
            }
        } else
        {
            $msg = array('pesan' => '0');
            echo json_encode($msg);
            exit();
        }
        $msg = array('pesan' => '1');
        echo json_encode($msg);
    }


    function penjabaran()
    {
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/penjabaran', $data);
    }
    function cetak_perkada_real($ctk = '', $skpd = '', $awal = '', $akhir = '')
    {

        $cetak = $ctk;
        $id = $skpd;
        $date_awal = $awal;
        $date_akhir = $akhir;
        if ($cetak == 2)
        {
            $tgl_awal = $this->tukd_model->tanggal_format_indonesia($date_awal);
            $tgl_akhir = $this->tukd_model->tanggal_format_indonesia($date_akhir);
        }
        $sqldns = "SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
        $sqlskpd = $this->db->query($sqldns);
        foreach ($sqlskpd->result() as $rowdns)
        {

            $kd_urusan = $rowdns->kd_u;
            $nm_urusan = $rowdns->nm_u;
            $kd_skpd = $rowdns->kd_sk;
            $nm_skpd = $rowdns->nm_sk;
        }

        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc)
        {

            $tgl = $rowsc->tgl_rka;
            $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
            $kab = $rowsc->kab_kota;
            $daerah = $rowsc->daerah;
            $thn = $rowsc->thn_ang;
        }


        $cRet = '';
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>RINCIAN LAPORAN REALISASI ANGGARAN MENURUT URUSAN PEMERINTAHAN DAERAH,ORGANISASI<br/>PENDAPATAN,BELANJA DAN PEMBIAYAAN </strong></td>
                    </tr>
                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table>";
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                    <tr>
                        <td width=\"20%\">Urusan Organisasi </td>
                        <td width=\"80%\">:$kd_urusan - $nm_urusan</td>
                    </tr>
                    <tr>
                        <td>Organisasi</td>
                        <td>:$kd_skpd - $nm_skpd</td>
                    </tr>";
        if ($cetak == 2)
        {
            $cRet .= "<TR>                        
						<TD  align=\"left\" width=\"20%\" >PERIODE</TD>
						<TD align=\"left\" width=\"80%\" >:$tgl_awal s/d $tgl_akhir </TD>                      
					 </TR>";
        }
        $cRet .= "</table>";

        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Kode Rekening</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"26%\" align=\"center\"><b>Uraian</b></td>                            
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\"><b>Jumlah (Rp.)</b></td>
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>Bertambah/ (berkurang)</b></td>
                            <td  rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"13%\" align=\"center\"><b>Dasar Hukum</b></td>                            
                            </tr>
                        <tr>
 		                     <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Anggaran </td>
                             <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Realisasi</td>
                             <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Jumlah</td>
                             <td width=\"3%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
                             
                        </tr>    
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>  
                            <td style=\"border-top: none;\"></td>
                                                                                   
                         </tr>
                     </tfoot>
                    
                     
                        <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"26%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"14%\">&nbsp;</td>
                            </tr>
                        ";
        if ($cetak == 1)
        {
            $sqltp = "SELECT SUM(a.nilai) AS totp,SUM(a.nilai_ubah) AS totp_u, 
                        (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='4' AND a.kd_skpd='$id') AS cp,
                        (SELECT SUM(debet) FROM trdju_calk c INNER JOIN trhju_calk d ON c.no_voucher = d.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND LEFT(c.kd_rek5,1)='4' AND d.kd_skpd='$id') AS debet,
                        (SELECT SUM(kredit) FROM trdju_calk e INNER JOIN trhju_calk f ON e.no_voucher = f.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND LEFT(e.kd_rek5,1)='4' AND f.kd_skpd='$id') AS kredit FROM trdrka a
                         WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'";
        }
        if ($cetak == 2)
        {
            $sqltp = "SELECT SUM(a.nilai) AS totp,SUM(a.nilai_ubah) AS totp_u, 
                        (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='4' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,1)='4' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,1)='4' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
                         WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'";
        }

        $sqlp = $this->db->query($sqltp);
        foreach ($sqlp->result() as $rowp)
        {
            $angp = number_format($rowp->totp_u, "2", ".", ",");
            $angaranp = $rowp->totp_u;
            $penp = $rowp->cp;
            $debetp = $rowp->debet;
            $kreditp = $rowp->kredit;
            $realp = ($penp + $kreditp) - $debetp;
            $nrealp = number_format($realp, "2", ".", ",");
            $real_sp = $realp - $angaranp;
            if ($real_sp < 0)
            {
                $x1 = "(";
                $real_sp = $real_sp * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisihp = number_format($real_sp, "2", ".", ",");
            $per1p = ($real_sp != 0) ? ($real_sp / $rowp->totp_u) * 100 : 0;
            $persen1p = number_format($per1p);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pendapatan Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        }
        if ($cetak == 1)
        {
            $sql_p = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                        ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,24)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,25)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,27)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan)AS cp,
                        (SELECT SUM(e.debet) FROM trdju_calk e INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a                     
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu ";
        }
        if ($cetak == 2)
        {
            $sql_p = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE  h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,24)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,25)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,27)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a                     
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu ";
        }
        $pend = $this->db->query($sql_p);
        //$query = $this->skpd_model->getAllc();

        foreach ($pend->result() as $row)
        {
            $kode = $row->kd_rek;
            $nama = $row->nm_rek;
            $ang = number_format($row->nilai_u, "2", ".", ",");
            $angaran = $row->nilai_u;
            $pen = $row->cp;
            $debet = $row->debet;
            $kredit = $row->kredit;
            $real = ($pen + $kredit) - $debet;
            $nreal = number_format($real, "2", ".", ",");
            $real_s = $real - $angaran;
            if ($real_s < 0)
            {
                $x1 = "(";
                $real_s = $real_s * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisih = number_format($real_s, "2", ".", ",");
            $per1 = ($real_s != 0) ? ($real_s / $row->nilai_u) * 100 : 0;
            $persen1 = number_format($per1);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>
                                     ";


        }

        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";


        if ($cetak == 1)
        {
            $sqltb = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
            (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='5' AND a.kd_skpd='$id' ) AS cp,
            (SELECT SUM(debet) FROM trdju_calk c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND LEFT(c.kd_rek5,1)='5' AND d.kd_skpd='$id' ) AS debet,
            (SELECT SUM(kredit) FROM trdju_calk e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND LEFT(e.kd_rek5,1)='5' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
            WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";
        }
        if ($cetak == 2)
        {
            $sqltb = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
            (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='5' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
            (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,1)='5' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
            (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,1)='5' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
            WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";
        }
        $sqlb = $this->db->query($sqltb);
        foreach ($sqlb->result() as $rowb_5)
        {
            $ang_5 = number_format($rowb_5->totb_u, "2", ".", ",");
            $angaran_5 = $rowb_5->totb_u;
            $in_5 = $rowb_5->cp;
            $debet_5 = $rowb_5->debet;
            $kredit_5 = $rowb_5->kredit;
            $real_5 = $debet_5 - ($in_5 + $kredit_5);
            $nreal_5 = number_format($real_5, "2", ".", ",");
            $real_s_5 = $real_5 - $angaran_5;
            if ($real_s_5 < 0)
            {
                $x1 = "(";
                $real_s_5 = $real_s_5 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_5 = number_format($real_s_5, "2", ".", ",");
            $per_5 = ($real_s_5 != 0) ? ($real_s_5 / $rowb_5->totb_u) * 100 : 0;
            $persen_5 = number_format($per_5);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_5$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_5</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";


        }
        if ($cetak == 1)
        {
            $sqltbtl = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
                            (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='51' AND a.kd_skpd='$id' ) AS cp,
                            (SELECT SUM(debet) FROM trdju_calk c INNER JOIN trhju_calk d ON c.no_voucher = d.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND LEFT(c.kd_rek5,2)='51' AND d.kd_skpd='$id' ) AS debet,
                            (SELECT SUM(kredit) FROM trdju_calk e INNER JOIN trhju_calk f ON e.no_voucher = f.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND LEFT(e.kd_rek5,2)='51' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
                            WHERE LEFT(kd_rek5,2)='51' AND kd_skpd='$id'";
        }
        if ($cetak == 2)
        {
            $sqltbtl = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
                            (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='51' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
                            (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='51' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
                            (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='51' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
                            WHERE LEFT(kd_rek5,2)='51' AND kd_skpd='$id'";
        }
        $sqlbtl = $this->db->query($sqltbtl);
        foreach ($sqlbtl->result() as $rowbtl)
        {
            $ang_51 = number_format($rowbtl->totb_u, "2", ".", ",");
            $angaran_51 = $rowbtl->totb_u;
            $in_51 = $rowbtl->cp;
            $debet_51 = $rowbtl->debet;
            $kredit_51 = $rowbtl->kredit;
            $real_51 = $debet_51 - ($in_51 + $kredit_51);
            $nreal_51 = number_format($real_51, "2", ".", ",");
            $real_s_51 = $real_51 - $angaran_51;
            if ($real_s_51 < 0)
            {
                $x1 = "(";
                $real_s_51 = $real_s_51 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_51 = number_format($real_s_51, "2", ".", ",");
            $per_51 = ($real_s_51 != 0) ? ($real_s_51 / $rowbtl->totb_u) * 100 : 0;
            $persen_51 = number_format($per_51);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Tidak Langsung</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_51</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_51</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_51$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_51</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        }


        if ($cetak == 1)
        {
            $sql_btl = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,25)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,27)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_calk e INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a                     
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
        }
        if ($cetak == 2)
        {
            $sql_btl = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,25)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,27)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a                     
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
        }
        $btl = $this->db->query($sql_btl);

        foreach ($btl->result() as $row_btl)
        {
            $kode = $row_btl->kd_rek;
            $nama = $row_btl->nm_rek;
            $ang_511 = number_format($row_btl->nilai_u, "2", ".", ",");
            $angaran_511 = $row_btl->nilai_u;
            $in_511 = $row_btl->cp;
            $debet_511 = $row_btl->debet;
            $kredit_511 = $row_btl->kredit;
            $real_511 = $debet_511 - ($in_511 + $kredit_511);
            $nreal_511 = number_format($real_511, "2", ".", ",");
            $real_s_511 = $real_511 - $angaran_511;
            if ($real_s_511 < 0)
            {
                $x1 = "(";
                $real_s_511 = $real_s_511 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_511 = number_format($real_s_511, "2", ".", ",");
            $per_511 = ($real_s_5 != 0) ? ($real_s_511 / $row_btl->nilai_u) * 100 : 0;
            $persen_511 = number_format($per_511);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_511</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_511</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_511$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_511</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>
                                     ";


        }
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

        if ($cetak == 1)
        {
            $sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                        (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='52' AND a.kd_skpd='$id') AS cp,
                        (SELECT SUM(debet) FROM trdju_calk c INNER JOIN trhju_calk d ON c.no_voucher = d.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND LEFT(c.kd_rek5,2)='52' AND d.kd_skpd='$id') AS debet,
                        (SELECT SUM(kredit) FROM trdju_calk e INNER JOIN trhju_calk f ON e.no_voucher = f.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND LEFT(e.kd_rek5,2)='52' AND f.kd_skpd='$id') AS kredit FROM trdrka a
                        WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='$id'";
        }
        if ($cetak == 2)
        {
            $sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                        (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='52' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='52' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='52' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
                        WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='$id'";
        }
        $sqlbl = $this->db->query($sqltbl);
        foreach ($sqlbl->result() as $rowbl)
        {
            $ang_52 = number_format($rowbl->totbl_u, "2", ".", ",");
            $angaran_52 = $rowbl->totbl_u;
            $in_52 = $rowbl->cp;
            $debet_52 = $rowbl->debet;
            $kredit_52 = $rowbl->kredit;
            $real_52 = $debet_52 - ($in_52 + $kredit_52);
            $nreal_52 = number_format($real_52, "2", ".", ",");
            $real_s_52 = $real_52 - $angaran_52;
            if ($real_s_52 < 0)
            {
                $x1 = "(";
                $real_s_52 = $real_s_52 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_52 = number_format($real_s_51, "2", ".", ",");
            $per_52 = ($real_s_5 != 0) ? ($real_s_51 / $rowbl->totbl_u) * 100 : 0;
            $persen_52 = number_format($per_52);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Langsung</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_52</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_52</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_52$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_52</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        }
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";


        if ($cetak == 1)
        {
            $sql_bl = "SELECT * FROM (SELECT a.kd_program AS kd_rek, c.nm_program AS nm_rek,(SELECT SUM(nilai) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai_u,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND LEFT(h.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program ) AS cp,
                        (SELECT SUM(debet) FROM trdju_calk i  INNER JOIN trhju_calk j ON i.no_voucher = j.no_voucher  WHERE YEAR(tgl_voucher)='$thn' AND j.kd_skpd='$id' AND LEFT(i.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program ) AS debet,
                        (SELECT SUM(kredit) FROM trdju_calk k  INNER JOIN trhju_calk l ON k.no_voucher = l.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND l.kd_skpd='$id' AND LEFT(k.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program ) AS kredit,'1' AS nu FROM trskpd a INNER JOIN m_prog c ON a.kd_program1=c.kd_program
                        LEFT JOIN trdrka b ON a.kd_program=LEFT(b.kd_kegiatan,(LENGTH(a.kd_program))) WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_program,c.nm_program 
                        UNION ALL
                        SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND h.kd_kegiatan = a.kd_kegiatan ) AS cp,
                        (SELECT SUM(debet) FROM trdju_calk i  INNER JOIN trhju_calk j ON i.no_voucher = j.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND j.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS debet,
                        (SELECT SUM(kredit) FROM trdju_calk k  INNER JOIN trhju_calk l ON k.no_voucher = l.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND l.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS kredit,'2' AS nu FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
                        LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_kegiatan,c.nm_kegiatan
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3   
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,24)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3                   
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,25)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4                      
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,27)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_calk e INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a                     
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
        }
        if ($cetak == 2)
        {
            $sql_bl = "SELECT * FROM (SELECT a.kd_program AS kd_rek, c.nm_program AS nm_rek,(SELECT SUM(nilai) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai_u,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND LEFT(h.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program AND h.tgl_sts>='$date_awal' AND h.tgl_sts<='$date_akhir') AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND LEFT(i.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program AND j.tgl_voucher>='$date_awal' AND j.tgl_voucher<='$date_akhir') AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND LEFT(k.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program AND l.tgl_voucher>='$date_awal' AND l.tgl_voucher<='2$date_akhir') AS kredit,'1' AS nu FROM trskpd a INNER JOIN m_prog c ON a.kd_program1=c.kd_program
                        LEFT JOIN trdrka b ON a.kd_program=LEFT(b.kd_kegiatan,(LENGTH(a.kd_program))) WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_program,c.nm_program 
                        UNION ALL
                        SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND h.kd_kegiatan = a.kd_kegiatan AND h.tgl_sts>='2012-11-01' AND h.tgl_sts <='$date_akhir') AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan AND j.tgl_voucher>='$date_awal' AND j.tgl_voucher<='$date_akhir') AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan AND l.tgl_voucher>='$date_awal' AND l.tgl_voucher<='$date_akhir') AS kredit,'2' AS nu FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
                        LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_kegiatan,c.nm_kegiatan
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3   
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,24)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='2012-11-01' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3                   
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,25)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4                      
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,27)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a                     
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
        }
        $bl = $this->db->query($sql_bl);
        foreach ($bl->result() as $row_bl)
        {
            $kode = $row_bl->kd_rek;
            $nama = $row_bl->nm_rek;
            $ang_522 = number_format($row_bl->nilai_u, "2", ".", ",");
            $angaran_522 = $row_bl->nilai_u;
            $in_522 = $row_bl->cp;
            $debet_522 = $row_bl->debet;
            $kredit_522 = $row_bl->kredit;
            $real_522 = $debet_522 - ($in_522 + $kredit_522);
            $nreal_522 = number_format($real_522, "2", ".", ",");
            $real_s_522 = $real_522 - $angaran_522;
            if ($real_s_522 < 0)
            {
                $x1 = "(";
                $real_s_522 = $real_s_522 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_522 = number_format($real_s_522, "2", ".", ",");
            $per_522 = ($real_s_522 != 0) ? ($real_s_522 / $row_bl->nilai_u) * 100 : 0;
            $persen_522 = number_format($per_522);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_522</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_522</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_522$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_522</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>
                                     ";


        }
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";


        $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_5$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_5</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        if($id=='1.20.05.01')
        {
                if ($cetak == 1)
                {
                    $sqltpm = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                                (SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='61' AND a.kd_skpd='$id' ) AS cp,
                                (SELECT SUM(IFNULL(debet,0)) FROM trdju_calk c INNER JOIN trhju_calk d ON c.no_voucher = d.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND LEFT(c.kd_rek5,2)='61' AND d.kd_skpd='$id' ) AS debet,
                                (SELECT SUM(IFNULL(kredit,0)) FROM trdju_calk e INNER JOIN trhju_calk f ON e.no_voucher = f.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND LEFT(e.kd_rek5,2)='61' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
                                WHERE LEFT(kd_rek5,2)='61' AND kd_skpd='$id'";
                }
                if ($cetak == 2)
                {
                    $sqltpm = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                                (SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='61' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
                                (SELECT SUM(IFNULL(debet,0)) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='61' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
                                (SELECT SUM(IFNULL(kredit,0)) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='61' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
                                WHERE LEFT(kd_rek5,2)='61' AND kd_skpd='$id'";
                }
                $sqlpm = $this->db->query($sqltpm);
                foreach ($sqlpm->result() as $rowpm)
                {
                    $ang_61 = number_format($rowpm->totbl_u, "2", ".", ",");
                    $angaran_61 = $rowpm->totbl_u;
                    $in_61 = $rowpm->cp;
                    $debet_61 = $rowpm->debet;
                    $kredit_61 = $rowpm->kredit;
                    $real_61 = $debet_61 - ($in_61 + $kredit_61);
                    $nreal_61 = number_format($real_61, "2", ".", ",");
                    $real_s_61 = $real_61 - $angaran_61;
                    if ($real_s_61 < 0)
                    {
                        $x1 = "(";
                        $real_s_61 = $real_s_61 * -1;
                        $y1 = ")";
                    } else
                    {
                        $x1 = "";
                        $y1 = "";
                    }
                    $selisih_61 = number_format($real_s_61, "2", ".", ",");
                    $per_61 = ($real_s_61 != 0) ? ($real_s_61 / $rowpm->totbl_u) * 100 : 0;
                    $persen_61 = number_format($per_61);
                    //
                    //                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Masuk</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_61</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_61</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_61$y1</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_61</td>
                    //                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                    //                                     </tr>";
                }
        
        
                if ($cetak == 1)
                {
                    $sqlpm = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                                ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,24)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                                ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,25)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                                ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,27)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_calk e INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a                     
                                WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
                }
                if ($cetak == 2)
                {
                    $sqlpm = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='<strong>$date_awal</strong>' AND g.tgl_voucher<='$date_akhir' )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                                ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,24)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='2012-10-01' AND d.tgl_sts<='$date_akhir' )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                                ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,25)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                                ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,27)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a                     
                                WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
                }
                $sql611 = $this->db->query($sqlpm);
                foreach ($sql611->result() as $row_61)
                {
                    $kd = $row_61->kd_rek;
                    $nm = $row_61->nm_rek;
                    $ang_611 = number_format($row_61->nilai_u, "2", ".", ",");
                    $angaran_611 = $row_61->nilai_u;
                    $in_611 = $row_61->cp;
                    $debet_611 = $row_61->debet;
                    $kredit_611 = $row_61->kredit;
                    $real_611 = $debet_611 - ($in_611 + $kredit_611);
                    $nreal_611 = number_format($real_611, "2", ".", ",");
                    $real_s_611 = $real_611 - $angaran_611;
                    if ($real_s_611 < 0)
                    {
                        $x1 = "(";
                        $real_s_611 = $real_s_611 * -1;
                        $y1 = ")";
                    } else
                    {
                        $x1 = "";
                        $y1 = "";
                    }
                    $selisih_611 = number_format($real_s_611, "2", ".", ",");
                    $per_611 = ($real_s_611 != 0) ? ($real_s_611 / $row_61->nilai_u) * 100 : 0;
                    $persen_611 = number_format($per_611);
        
                    $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\">$kd</td>                                     
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\">$nm</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$ang_611</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$nreal_611</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$x1$selisih_611$y1</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\">$persen_611</td>
                                             <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             </tr>";
                }
                $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             </tr>";
                if ($cetak == 1)
                {
                    $sqltpk = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                                (SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='62' AND a.kd_skpd='$id' ) AS cp,
                                (SELECT SUM(IFNULL(debet,0)) FROM trdju_calk c INNER JOIN trhju_calk d ON c.no_voucher = d.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND LEFT(c.kd_rek5,2)='62' AND d.kd_skpd='$id' ) AS debet,
                                (SELECT SUM(IFNULL(kredit,0)) FROM trdju_calk e INNER JOIN trhju_calk f ON e.no_voucher = f.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND LEFT(e.kd_rek5,2)='62' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
                                WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id' ";
                }
                if ($cetak == 2)
                {
                    $sqltpk = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                                (SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='62' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
                                (SELECT SUM(IFNULL(debet,0)) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='62' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
                                (SELECT SUM(IFNULL(kredit,0)) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='62' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
                                WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id' ";
                }
                $sqlpk = $this->db->query($sqltpk);
                foreach ($sqlpk->result() as $rowpk)
                {
                    $ang_62 = number_format($rowpk->totbl_u, "2", ".", ",");
                    $angaran_62 = $rowpk->totbl_u;
                    //echo($angaran_62);
                    $in_62 = $rowpk->cp;
                    $debet_62 = $rowpk->debet;
                    $kredit_62 = $rowpk->kredit;
                    $real_62 = $debet_62 - ($in_62 + $kredit_62);
                    $nreal_62 = number_format($real_62, "2", ".", ",");
                    $real_s_62 = $real_62 - $angaran_62;
                    if ($real_s_62 < 0)
                    {
                        $x1 = "(";
                        $real_s_62 = $real_s_62 * -1;
                        $y1 = ")";
                    } else
                    {
                        $x1 = "";
                        $y1 = "";
                    }
                    $selisih_62 = number_format($real_s_62, "2", ".", ",");
                    $per_62 = ($real_s_62 != 0) ? ($real_s_62 / $rowpk->totbl_u) * 100 : 0;
                    $persen_62 = number_format($per_62);
        
                    //                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Keluar</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_62</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_62</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_62$y1</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_62</td>
                    //                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                    //                                     </tr>";
                }
                if ($cetak == 1)
                {
                    $sqlpk = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                                ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,24)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                                ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,25)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_calk e  INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                                ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,27)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_calk e INNER JOIN trhju_calk g ON e.no_voucher = g.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_calk f INNER JOIN trhju_calk h ON f.no_voucher = h.no_voucher WHERE YEAR(tgl_voucher)='$thn' AND h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a                     
                                WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
                }
                if ($cetak == 2)
                {
                    $sqlpk = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='<strong>$date_awal</strong>' AND g.tgl_voucher<='$date_akhir' )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                                ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,24)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='2012-10-01' AND d.tgl_sts<='$date_akhir' )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                                ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,25)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                                ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,27)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a                     
                                WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
                }
                $sql62 = $this->db->query($sqlpk);
                foreach ($sql62->result() as $row_62)
                {
                    $kd = $row_62->kd_rek;
                    $nm = $row_62->nm_rek;
                    $ang_622 = number_format($row_62->nilai_u, "2", ".", ",");
                    $angaran_622 = $row_62->nilai_u;
                    $in_622 = $row_62->cp;
                    $debet_622 = $row_62->debet;
                    $kredit_622 = $row_62->kredit;
                    $real_622 = $debet_622 - ($in_622 + $kredit_622);
                    $nreal_622 = number_format($real_622, "2", ".", ",");
                    $real_s_622 = $real_622 - $angaran_622;
                    if ($real_s_622 < 0)
                    {
                        $x1 = "(";
                        $real_s_622 = $real_s_622 * -1;
                        $y1 = ")";
                    } else
                    {
                        $x1 = "";
                        $y1 = "";
                    }
                    $selisih_622 = number_format($real_s_622, "2", ".", ",");
                    $per_622 = ($real_s_611 != 0) ? ($real_s_622 / $row_62->nilai_u) * 100 : 0;
                    $persen_622 = number_format($per_622);
        
                    $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\">$kd</td>                                     
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\">$nm</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$ang_622</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$nreal_622</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$x1$selisih_622$y1</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\">$persen_622</td>
                                             <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             </tr>";
                }
                $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             </tr>";
        
                $netto = $angaran_61 - $angaran_62;
                $net = number_format($netto, "2", ",", ".");
                $netto_r = $real_61 - $real_62;
                $net_r = number_format($netto_r, "2", ",", ".");
                $netto_s = $netto_r - $netto;
                if ($netto_s < 0)
                {
                    $x1 = "(";
                    $netto_s = $netto_s * -1;
                    $y1 = ")";
                } else
                {
                    $x1 = "";
                    $y1 = "";
                }
                $netto_selisih = number_format($netto_s, "2", ",", ".");
                $perpnet = ($netto_s != 0) ? ($netto_s / $netto) * 100 : 0;
                $persennet = number_format($perpnet);
        
        
                $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
                                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Netto</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$net</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$net_r</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$netto_selisih$y1</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persennet</td>
                                             <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             </tr>";
        
                $silpa = ($angaranp + $angaran_61) - ($angaran_5 + $angaran_62);
                if ($silpa < 0)
                {
                    $a = "(";
                    $silpa = $silpa * -1;
                    $b = ")";
                } else
                {
                    $a = "";
                    $b = "";
                }
                $silp = number_format($silpa, "2", ",", ".");
                $silpa_real = ($realp + $real_61) - ($real_5 + $real_62);
                if ($silpa_real < 0)
                {
                    $c = "(";
                    $silpa_real = $silpa_real * -1;
                    $d = ")";
                } else
                {
                    $c = "";
                    $d = "";
                }
                $silp_real = number_format($silpa_real, "2", ",", ".");
                $silpa_s = $silpa_real - $silpa;
                if ($silpa_s < 0)
                {
                    $x = "(";
                    $silpa_s = $silpa_s * -1;
                    $y = ")";
                } else
                {
                    $x = "";
                    $y = "";
                }
                $silpa_selisih = number_format($silpa_s, "2", ",", ".");
                $persil = ($silpa_s != 0) ? ($silpa_s / $silpa) * 100 : 0;
                $persensilpa = number_format($persil);
            
                $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
                                                    <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">SILPA</td>
                                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$a$silp$b</td>
                                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$c$silp_real$d</td>
                                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x$silpa_selisih$y</td>
                                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persensilpa</td>
                                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                  
                                                   </tr>";
        }else{
            $silpa = $angaranp  - $angaran_5 ;
        if ($silpa < 0)
        {
            $a = "(";
            $silpa = $silpa * -1;
            $b = ")";
        } else
        {
            $a = "";
            $b = "";
        }
        $silp = number_format($silpa, "2", ",", ".");
        $silpa_real = $realp  - $real_5;
        if ($silpa_real < 0)
        {
            $c = "(";
            $silpa_real = $silpa_real * -1;
            $d = ")";
        } else
        {
            $c = "";
            $d = "";
        }
        $silp_real = number_format($silpa_real, "2", ",", ".");
        $silpa_s = $silpa_real - $silpa;
        if ($silpa_s < 0)
        {
            $x = "(";
            $silpa_s = $silpa_s * -1;
            $y = ")";
        } else
        {
            $x = "";
            $y = "";
        }
        $silpa_selisih = number_format($silpa_s, "2", ",", ".");
        $persil = ($silpa_s != 0) ? ($silpa_s / $silpa) * 100 : 0;
        $persensilpa = number_format($persil);
    
        $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
                                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">SILPA</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$a$silp$b</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$c$silp_real$d</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x$silpa_selisih$y</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persensilpa</td>
                                             <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
          
                                           </tr>";
            
        }                                   
        $cRet .= " </table>";
        $data['prev'] = $cRet;
        echo ("$cRet");
        // $this->template->set('title', 'CETAK RINCIAN REALISASI');
        //        $this->tukd_model->_mpdf('',$cRet,10,10,10,1);


    }

    function lampiran_I()
    {
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/perda_real_1', $data);
    }
    
	function lampiran_I_smstr()
    {
        $data['page_title']= 'LAPORAN SEMESTER SKPD';
        $this->template->set('title', 'LAPORAN SEMESTER SKPD');   
        //$this->template->load('template','akuntansi/perda_real_smstr',$data) ; 
        $this->template->load('template','akuntansi/cetak_semester',$data); 
    }
	
	function lampiran_I_smstr_ppkd()
    {
        $data['page_title']= 'LAPORAN SEMESTER PPKD';
        $this->template->set('title', 'LAPORAN SEMESTER PPKD');   
        //$this->template->load('template','akuntansi/perda_real_smstr',$data) ; 
        $this->template->load('template','akuntansi/cetak_semester_ppkd',$data) ; 
    }
	
	function cetak_semester($cbulan="", $pilih=1){
	$id  = $this->session->userdata('kdskpd');
    $thn = $this->session->userdata('pcThang');
	
	if($cbulan== 12){
	$sumber_data= "_at";
	}else{
	$sumber_data= "";
	}
	
	$cbulan==6 ? $smstr = "SEMESTER I" : $smstr="SEMESTER II";
	$sqlanggaran1="select case when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_ubah) then 2 
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_sempurna) and $cbulan<month(tgl_dpa_ubah) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan>=month(tgl_dpa_sempurna) then 1 
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=0 and status_ubah=0 and $cbulan>=month(tgl_dpa) then 1
					   else 1 end as anggaran from trhrka where kd_skpd='$id'";
    $sqlanggaran=$this->db->query($sqlanggaran1);
	foreach ($sqlanggaran->result() as $rowttd)
        {
            $anggaran=$rowttd->anggaran;
        }

	$ag_tox=$anggaran;
	 
	 

    //function cetak_lra(){
        $sql41="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,1)='4' and kd_skpd<>'$id' ";
                    $query41 = $this->db->query($sql41);
                    $jmlp = $query41->row();
                    $jmlpendapatan = $jmlp->nilai;
                    $jmlangpendapatan = $jmlp->anggaran;
                    $jmlangpendapatan1= number_format($jmlp->anggaran,"2",",",".");
                    $jmlpendapatan1= number_format($jmlp->nilai,"2",",",".");
                    
					$real_pend = $jmlangpendapatan - $jmlpendapatan;
                    if ($real_pend < 0){
                    	$x001="("; $real_pendx=$real_pend*-1; $y001=")";}
                    else {
                    	$x001=""; $real_pendx=$real_pend; $y001="";}
                    $selisihpend = number_format($real_pendx,"2",",",".");
                    if ($jmlpendapatan==0){
                        $tmp001=1;
                    }else{
                        $tmp001=$jmlpendapatan;
                    }
					
                    $per001     = ($jmlangpendapatan!=0)?($jmlpendapatan / $jmlangpendapatan ) * 100:0; 
                    $persen001  = number_format($per001,"2",",",".");
					
        $sql51="SELECT SUM(anggaran) as angaran,SUM(real_spj)as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,1)='5' and kd_skpd<>'$id' ";
                    $query51 = $this->db->query($sql51);
                    $jmlb = $query51->row();
                    $jmlangbelanja = $jmlb->angaran;
                    $jmlbelanja = $jmlb->nilai;
                    $jmlbelanja1= number_format($jmlb->nilai,"2",",",".");
                    $jmlangbelanja1= number_format($jmlb->angaran,"2",",",".");
					
					$real_belanja = $jmlangbelanja - $jmlbelanja;
                    if ($real_belanja < 0){
                    	$x002="("; $real_belanjax=$real_belanja*-1; $y002=")";}
                    else {
                    	$x002=""; $real_belanjax=$real_belanja; $y002="";}
                    $selisihbelanja = number_format($real_belanjax,"2",",",".");
                    if ($jmlbelanja==0){
                        $tmp002=1;
                    }else{
                        $tmp002=$jmlbelanja;
                    }
					
                    $per002     = ($jmlangbelanja!=0)?($jmlbelanja / $jmlangbelanja ) * 100:0; 
                    $persen002  = number_format($per002,"2",",",".");
					
        $sql523="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,3)='523' and kd_skpd<>'$id' ";
                    $query523 = $this->db->query($sql523);
                    $jmlbm = $query523->row();
                    $jmlbmbelanja = $jmlbm->nilai;
                    $jmlangbmbelanja = $jmlbm->anggaran;
                    $jmlbmbelanja1= number_format($jmlbmbelanja,"2",",",".");
                    $jmlangbmbelanja1= number_format($jmlangbmbelanja,"2",",",".");
        $sql61="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='61' and kd_skpd<>'$id' ";
                    $query61 = $this->db->query($sql61);
                    $jmlpm = $query61->row();
                    $jmlpmasuk = $jmlpm->nilai;
                    $jmlangpmasuk = $jmlpm->anggaran;
        $sql62="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='62' and kd_skpd<>'$id' ";
                    $query62 = $this->db->query($sql62);
                    $jmlpk = $query62->row();
                    $jmlpkeluar = $jmlpk->nilai;
                    $jmlangpkeluar = $jmlpk->anggaran;
        $surplus =  $jmlpendapatan- $jmlbelanja;
        $angsurplus = $jmlangpendapatan- $jmlangbelanja;        
        if ($surplus < 0){
                    	$x="("; $surplusx=$surplus*-1; $y=")";
                        }else {
                    	$x=""; $surplusx=$surplus; $y="";
                        }
        if ($angsurplus < 0){
                    	$e="("; $angsurplusx=$angsurplus*-1; $f=")";
                        }else {
                    	$e=""; $angsurplusx=$angsurplus; $f="";
                        }
        $surplus1= number_format($surplusx,"2",",",".");
        $angsurplus1= number_format($angsurplusx,"2",",",".");
		
		$real_surplus = $angsurplus - $surplus;
                    if ($real_surplus < 0){
                    	$x003="("; $real_surplusx=$real_surplus*-1; $y003=")";}
                    else {
                    	$x003=""; $real_surplusx=$real_surplus; $y003="";}
        $selisihsurplus = number_format($real_surplusx,"2",",",".");
                    if ($surplus==0){
                        $tmp003=1;
                    }else{
                        $tmp003=$surplus;
                    }
					
                    $per003     = ($angsurplus!=0)?($surplus / $angsurplus ) * 100:0; 
                    $persen003  = number_format($per003,"2",",",".");
		
        $biaya_net =  $jmlpmasuk- $jmlpkeluar;
        $angbiaya_net =  $jmlangpmasuk- $jmlangpkeluar;        
        if ($biaya_net < 0){
                    	$a="("; $biaya_netx=$biaya_net*-1; $b=")";
                        }else {
                    	$a=""; $biaya_netx=$biaya_net; $b="";
                        }
        if ($angbiaya_net < 0){
                    	$g="("; $angbiaya_netx=$angbiaya_net*-1; $h=")";
                        }else {
                    	$g=""; $angbiaya_netx=$angbiaya_net; $h="";
                        }
        $biaya_net1 =   number_format($biaya_netx,"2",",",".");
        $angbiaya_net1 =   number_format($angbiaya_netx,"2",",",".");
        $silpa= ($jmlpendapatan+$jmlpmasuk)-($jmlbelanja+$jmlpkeluar);
        $angsilpa= ($jmlangpendapatan+$jmlangpmasuk)-($jmlangbelanja+$jmlangpkeluar);                
        if ($silpa < 0){
                    	$c="("; $silpax=$silpa*-1; $d=")";
                        }else {
                    	$c=""; $silpax=$silpa; $d="";
                        }
        if ($angsilpa < 0){
                    	$i="("; $angsilpax=$angsilpa*-1; $j=")";
                        }else {
                    	$i=""; $angsilpax=$angsilpa; $j="";
                        }
        $silpa1 =number_format($silpax,"2",",","."); 
        $angsilpa1 =number_format($angsilpax,"2",",",".");
       $sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$id' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
		$nm_skpd	= strtoupper ($nmskpd);
        $jk=$this->rka_model->combo_skpd();
       
        $cRet='';
        
	 $modtahun= $thn%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>				
                    <tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $smstr $thn</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>ANGGARAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>LEBIH</br>(KURANG)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                        </tr>";
               
                   $sql4="SELECT a.seq,a.nor,a.uraian,isnull(a.kode_1,'-') as kode_1,isnull(a.kode_2,'-') as kode_2,isnull(a.kode_3,'-') as kode_3,thn_m1 AS lalu FROM map_lra_skpd a 
				   GROUP BY a.seq,a.nor,a.uraian,isnull(a.kode_1,'-'),isnull(a.kode_2,'-'),isnull(a.kode_3,'-'),thn_m1 ORDER BY a.seq";
                // isnull(a.kode_1,\"'-'\")
                $query4 = $this->db->query($sql4);
                $no     = 0;                                  
               
                foreach ($query4->result() as $row4)
                {
                    
                    $nama      = $row4->uraian;   
                    $real_lalu = number_format($row4->lalu,"2",",",".");
                    $n         = $row4->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$n2         = $row4->kode_2;
					$n2		   = ($n2=="-"?"'-'":$n2);
					$n3         = $row4->kode_3;
					$n3		   = ($n3=="-"?"'-'":$n3);

//                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi( $bulan,$ag_tox) b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (".$n.") ";
                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) b WHERE kd_skpd<>'$id' and (left(b.kd_rek5,3) in ($n) or left(b.kd_rek5,5) in ($n2) or left(b.kd_rek5,7) in ($n3))";
//					                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM realisasi b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (\"'.$n.'\") ";
                    $query5 = $this->db->query($sql5);
                    $trh    = $query5->row();
                    $nil    = $trh->nilai;
                    $angnil = $trh->anggaran;
                    
                    $real_s = $trh->anggaran - $trh->nilai;
                    if ($real_s < 0){
                    	$x1="("; $real_sx=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $real_sx=$real_s; $y1="";}
                    $selisih = number_format($real_sx,"2",",",".");
                    if ($trh->nilai==0){
                        $tmp=1;
                    }else{
                        $tmp=$trh->nilai;
                    }
                    $nilai    = number_format($trh->nilai,"2",",",".");
                    $angnilai = number_format($trh->anggaran,"2",",",".");
                    $per1     = ($angnil!=0)?($nil / $angnil ) * 100:0; 
                    $persen1  = number_format($per1,"2",",",".");
                    $no       = $no + 1;
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;					
					case 35:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 40:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlangpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x001$selisihpend$y001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen001</td>
                                 </tr>";
                        break;
					case 45:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 50:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td	 style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 55:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 70:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;						
					case 75:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 80:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;						
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 120:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlangbelanja1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlbelanja1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x002$selisihbelanja$y002</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen002</td>
                                 </tr>";
                        break;
					case 125:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 130:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$e$angsurplus1$f</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$x$surplus1$y</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x003$selisihsurplus$y003</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen003</td>
                                 </tr>";
                        break;
                   
                    default:
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                }
                }
        $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN SEMESTER SKPD Keseluruhan / $smstr");
        $this->template->set('title', 'LAPORAN SEMESTER SKPD Keseluruhan / $smstr');        
        switch($pilih) {       
        case 1;
			echo ("<title>$smstr SKPD</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        } 
    }
    
	
	function cetak_semester_ppkd($cbulan="", $pilih=1){
	$kd_skpd  = $this->session->userdata('kdskpd');
    $thn = $this->session->userdata('pcThang');
	$cbulan==6 ? $smstr= "SEMESTER I" : $smstr="SEMESTER II";
	
	if($cbulan== 12){
	$sumber_data= "_at";
	}else{
	$sumber_data= "";
	}
	
	$sqlanggaran1="select case when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_ubah) then 2 
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_sempurna) and $cbulan<month(tgl_dpa_ubah) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan>=month(tgl_dpa_sempurna) then 1 
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=0 and status_ubah=0 and $cbulan>=month(tgl_dpa) then 1
					   else 1 end as anggaran from trhrka where kd_skpd='$kd_skpd'";
    $sqlanggaran=$this->db->query($sqlanggaran1);
	foreach ($sqlanggaran->result() as $rowttd)
        {
            $anggaran=$rowttd->anggaran;
        }

	$ag_tox=$anggaran;
	 
	 

    //function cetak_lra(){
        $sql41="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,1)='4' and kd_skpd='$kd_skpd' ";
                    $query41 = $this->db->query($sql41);
                    $jmlp = $query41->row();
                    $jmlpendapatan = $jmlp->nilai;
                    $jmlangpendapatan = $jmlp->anggaran;
                    $jmlangpendapatan1= number_format($jmlp->anggaran,"2",",",".");
                    $jmlpendapatan1= number_format($jmlp->nilai,"2",",",".");
                    
					$real_pend = $jmlangpendapatan - $jmlpendapatan;
                    if ($real_pend < 0){
                    	$x001="("; $real_pendx=$real_pend*-1; $y001=")";}
                    else {
                    	$x001=""; $real_pendx=$real_pend; $y001="";}
                    $selisihpend = number_format($real_pendx,"2",",",".");
                    if ($jmlpendapatan==0){
                        $tmp001=1;
                    }else{
                        $tmp001=$jmlpendapatan;
                    }
					
                    $per001     = ($jmlangpendapatan!=0)?($jmlpendapatan / $jmlangpendapatan ) * 100:0; 
                    $persen001  = number_format($per001,"2",",",".");
					
        $sql51="SELECT SUM(anggaran) as angaran,SUM(real_spj)as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,1)='5' and kd_skpd='$kd_skpd' ";
                    $query51 = $this->db->query($sql51);
                    $jmlb = $query51->row();
                    $jmlangbelanja = $jmlb->angaran;
                    $jmlbelanja = $jmlb->nilai;
                    $jmlbelanja1= number_format($jmlb->nilai,"2",",",".");
                    $jmlangbelanja1= number_format($jmlb->angaran,"2",",",".");
					
					$real_belanja = $jmlangbelanja - $jmlbelanja;
                    if ($real_belanja < 0){
                    	$x002="("; $real_belanjax=$real_belanja*-1; $y002=")";}
                    else {
                    	$x002=""; $real_belanjax=$real_belanja; $y002="";}
                    $selisihbelanja = number_format($real_belanjax,"2",",",".");
                    if ($jmlbelanja==0){
                        $tmp002=1;
                    }else{
                        $tmp002=$jmlbelanja;
                    }
					
                    $per002     = ($jmlangbelanja!=0)?($jmlbelanja / $jmlangbelanja ) * 100:0; 
                    $persen002  = number_format($per002,"2",",",".");
					
        $sql523="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,3)='523' and kd_skpd='$kd_skpd' ";
                    $query523 = $this->db->query($sql523);
                    $jmlbm = $query523->row();
                    $jmlbmbelanja = $jmlbm->nilai;
                    $jmlangbmbelanja = $jmlbm->anggaran;
                    $jmlbmbelanja1= number_format($jmlbmbelanja,"2",",",".");
                    $jmlangbmbelanja1= number_format($jmlangbmbelanja,"2",",",".");
        $sql61="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='61' and kd_skpd='$kd_skpd' ";
                    $query61 = $this->db->query($sql61);
                    $jmlpm = $query61->row();
                    $jmlpmasuk = $jmlpm->nilai;
                    $jmlangpmasuk = $jmlpm->anggaran;
        $sql62="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='62' and kd_skpd='$kd_skpd' ";
                    $query62 = $this->db->query($sql62);
                    $jmlpk = $query62->row();
                    $jmlpkeluar = $jmlpk->nilai;
                    $jmlangpkeluar = $jmlpk->anggaran;
        $surplus =  $jmlpendapatan- $jmlbelanja;
        $angsurplus = $jmlangpendapatan- $jmlangbelanja;        
        if ($surplus < 0){
                    	$x="("; $surplusx=$surplus*-1; $y=")";
                        }else {
                    	$x=""; $surplusx=$surplus; $y="";
                        }
        if ($angsurplus < 0){
                    	$e="("; $angsurplusx=$angsurplus*-1; $f=")";
                        }else {
                    	$e=""; $angsurplusx=$angsurplus; $f="";
                        }
        $surplus1= number_format($surplusx,"2",",",".");
        $angsurplus1= number_format($angsurplusx,"2",",",".");
		
		$real_surplus = $angsurplus - $surplus;
                    if ($real_surplus < 0){
                    	$x003="("; $real_surplusx=$real_surplus*-1; $y003=")";}
                    else {
                    	$x003=""; $real_surplusx=$real_surplus; $y003="";}
        $selisihsurplus = number_format($real_surplusx,"2",",",".");
                    if ($surplus==0){
                        $tmp003=1;
                    }else{
                        $tmp003=$surplus;
                    }
					
                    $per003     = ($angsurplus!=0)?($surplus / $angsurplus ) * 100:0; 
                    $persen003  = number_format($per003,"2",",",".");
		
        $biaya_net =  $jmlpmasuk- $jmlpkeluar;
        $angbiaya_net =  $jmlangpmasuk- $jmlangpkeluar;        
        if ($biaya_net < 0){
                    	$a="("; $biaya_netx=$biaya_net*-1; $b=")";
                        }else {
                    	$a=""; $biaya_netx=$biaya_net; $b="";
                        }
        if ($angbiaya_net < 0){
                    	$g="("; $angbiaya_netx=$angbiaya_net*-1; $h=")";
                        }else {
                    	$g=""; $angbiaya_netx=$angbiaya_net; $h="";
                        }
        $biaya_net1 =   number_format($biaya_netx,"2",",",".");
        $angbiaya_net1 =   number_format($angbiaya_netx,"2",",",".");
        $silpa= ($jmlpendapatan+$jmlpmasuk)-($jmlbelanja+$jmlpkeluar);
        $angsilpa= ($jmlangpendapatan+$jmlangpmasuk)-($jmlangbelanja+$jmlangpkeluar);                
        if ($silpa < 0){
                    	$c="("; $silpax=$silpa*-1; $d=")";
                        }else {
                    	$c=""; $silpax=$silpa; $d="";
                        }
        if ($angsilpa < 0){
                    	$i="("; $angsilpax=$angsilpa*-1; $j=")";
                        }else {
                    	$i=""; $angsilpax=$angsilpa; $j="";
                        }
        $silpa1 =number_format($silpax,"2",",","."); 
        $angsilpa1 =number_format($angsilpax,"2",",",".");
       $sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
		$nm_skpd	= strtoupper ($nmskpd);
        $jk=$this->rka_model->combo_skpd();
       
        $cRet='';
        
	 $modtahun= $thn%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>					
                    <tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $smstr $thn</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>ANGGARAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>LEBIH</br>(KURANG)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                        </tr>";
               
                   $sql4="SELECT a.seq,a.nor,a.uraian,isnull(a.kode_1,'-') as kode_1,isnull(a.kode_2,'-') as kode_2,isnull(a.kode_3,'-') as kode_3,thn_m1 AS lalu FROM map_lra_skpd a 
				   GROUP BY a.seq,a.nor,a.uraian,isnull(a.kode_1,'-'),isnull(a.kode_2,'-'),isnull(a.kode_3,'-'),thn_m1 ORDER BY a.seq";
                // isnull(a.kode_1,\"'-'\")
                $query4 = $this->db->query($sql4);
                $no     = 0;                                  
               
                foreach ($query4->result() as $row4)
                {
                    
                    $nama      = $row4->uraian;   
                    $real_lalu = number_format($row4->lalu,"2",",",".");
                    $n         = $row4->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$n2         = $row4->kode_2;
					$n2		   = ($n2=="-"?"'-'":$n2);
					$n3         = $row4->kode_3;
					$n3		   = ($n3=="-"?"'-'":$n3);

//                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi( $bulan,$ag_tox) b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (".$n.") ";
                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) b WHERE kd_skpd='$kd_skpd' and (left(b.kd_rek5,3) in ($n) or left(b.kd_rek5,5) in ($n2) or left(b.kd_rek5,7) in ($n3))";
//					                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM realisasi b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (\"'.$n.'\") ";
                    $query5 = $this->db->query($sql5);
                    $trh    = $query5->row();
                    $nil    = $trh->nilai;
                    $angnil = $trh->anggaran;
                    
                    $real_s = $trh->anggaran - $trh->nilai;
                    if ($real_s < 0){
                    	$x1="("; $real_sx=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $real_sx=$real_s; $y1="";}
                    $selisih = number_format($real_sx,"2",",",".");
                    if ($trh->nilai==0){
                        $tmp=1;
                    }else{
                        $tmp=$trh->nilai;
                    }
                    $nilai    = number_format($trh->nilai,"2",",",".");
                    $angnilai = number_format($trh->anggaran,"2",",",".");
                    $per1     = ($angnil!=0)?($nil / $angnil ) * 100:0; 
                    $persen1  = number_format($per1,"2",",",".");
                    $no       = $no + 1;
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;					
					case 35:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 40:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlangpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x001$selisihpend$y001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen001</td>
                                 </tr>";
                        break;
					case 45:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 50:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td	 style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 55:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 70:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;						
					case 75:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 80:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;						
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 120:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlangbelanja1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlbelanja1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x002$selisihbelanja$y002</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen002</td>
                                 </tr>";
                        break;
					case 125:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 130:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$e$angsurplus1$f</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$x$surplus1$y</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x003$selisihsurplus$y003</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen003</td>
                                 </tr>";
                        break;
                   
                    default:
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                }
                }
        $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN SEMESTER $kd_skpd / $smstr");
        $this->template->set('title', 'LAPORAN SEMESTER $kd_skpd / $smstr');        
        switch($pilih) {       
        case 1;
			echo ("<title>$smstr UNIT</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        } 
    }
    
	
	
	function cetak_semester_unit($cbulan="", $kd_skpd="", $pilih=1){
	$id  = $this->session->userdata('kdskpd');
    $thn = $this->session->userdata('pcThang');
	$cbulan==6 ? $smstr= "SEMESTER I" : $smstr="SEMESTER II";
	$sqlanggaran1="select case when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_ubah) then 2 
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_sempurna) and $cbulan<month(tgl_dpa_ubah) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan>=month(tgl_dpa_sempurna) then 1 
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=0 and status_ubah=0 and $cbulan>=month(tgl_dpa) then 1
					   else 1 end as anggaran from trhrka where kd_skpd='$kd_skpd'";
    $sqlanggaran=$this->db->query($sqlanggaran1);
	foreach ($sqlanggaran->result() as $rowttd)
        {
            $anggaran=$rowttd->anggaran;
        }

	$ag_tox=$anggaran;
	 
	 

    //function cetak_lra(){
        $sql41="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,1)='4' and kd_skpd='$kd_skpd' ";
                    $query41 = $this->db->query($sql41);
                    $jmlp = $query41->row();
                    $jmlpendapatan = $jmlp->nilai;
                    $jmlangpendapatan = $jmlp->anggaran;
                    $jmlangpendapatan1= number_format($jmlp->anggaran,"2",",",".");
                    $jmlpendapatan1= number_format($jmlp->nilai,"2",",",".");
                    
					$real_pend = $jmlangpendapatan - $jmlpendapatan;
                    if ($real_pend < 0){
                    	$x001="("; $real_pendx=$real_pend*-1; $y001=")";}
                    else {
                    	$x001=""; $real_pendx=$real_pend; $y001="";}
                    $selisihpend = number_format($real_pendx,"2",",",".");
                    if ($jmlpendapatan==0){
                        $tmp001=1;
                    }else{
                        $tmp001=$jmlpendapatan;
                    }
					
                    $per001     = ($jmlangpendapatan!=0)?($jmlpendapatan / $jmlangpendapatan ) * 100:0; 
                    $persen001  = number_format($per001,"2",",",".");
					
        $sql51="SELECT SUM(anggaran) as angaran,SUM(real_spj)as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,1)='5' and kd_skpd='$kd_skpd' ";
                    $query51 = $this->db->query($sql51);
                    $jmlb = $query51->row();
                    $jmlangbelanja = $jmlb->angaran;
                    $jmlbelanja = $jmlb->nilai;
                    $jmlbelanja1= number_format($jmlb->nilai,"2",",",".");
                    $jmlangbelanja1= number_format($jmlb->angaran,"2",",",".");
					
					$real_belanja = $jmlangbelanja - $jmlbelanja;
                    if ($real_belanja < 0){
                    	$x002="("; $real_belanjax=$real_belanja*-1; $y002=")";}
                    else {
                    	$x002=""; $real_belanjax=$real_belanja; $y002="";}
                    $selisihbelanja = number_format($real_belanjax,"2",",",".");
                    if ($jmlbelanja==0){
                        $tmp002=1;
                    }else{
                        $tmp002=$jmlbelanja;
                    }
					
                    $per002     = ($jmlangbelanja!=0)?($jmlbelanja / $jmlangbelanja ) * 100:0; 
                    $persen002  = number_format($per002,"2",",",".");
					
        $sql523="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,3)='523' and kd_skpd='$kd_skpd' ";
                    $query523 = $this->db->query($sql523);
                    $jmlbm = $query523->row();
                    $jmlbmbelanja = $jmlbm->nilai;
                    $jmlangbmbelanja = $jmlbm->anggaran;
                    $jmlbmbelanja1= number_format($jmlbmbelanja,"2",",",".");
                    $jmlangbmbelanja1= number_format($jmlangbmbelanja,"2",",",".");
        $sql61="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='61' and kd_skpd='$kd_skpd' ";
                    $query61 = $this->db->query($sql61);
                    $jmlpm = $query61->row();
                    $jmlpmasuk = $jmlpm->nilai;
                    $jmlangpmasuk = $jmlpm->anggaran;
        $sql62="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='62' and kd_skpd='$kd_skpd' ";
                    $query62 = $this->db->query($sql62);
                    $jmlpk = $query62->row();
                    $jmlpkeluar = $jmlpk->nilai;
                    $jmlangpkeluar = $jmlpk->anggaran;
        $surplus =  $jmlpendapatan- $jmlbelanja;
        $angsurplus = $jmlangpendapatan- $jmlangbelanja;        
        if ($surplus < 0){
                    	$x="("; $surplusx=$surplus*-1; $y=")";
                        }else {
                    	$x=""; $surplusx=$surplus; $y="";
                        }
        if ($angsurplus < 0){
                    	$e="("; $angsurplusx=$angsurplus*-1; $f=")";
                        }else {
                    	$e=""; $angsurplusx=$angsurplus; $f="";
                        }
        $surplus1= number_format($surplusx,"2",",",".");
        $angsurplus1= number_format($angsurplusx,"2",",",".");
		
		$real_surplus = $angsurplus - $surplus;
                    if ($real_surplus < 0){
                    	$x003="("; $real_surplusx=$real_surplus*-1; $y003=")";}
                    else {
                    	$x003=""; $real_surplusx=$real_surplus; $y003="";}
        $selisihsurplus = number_format($real_surplusx,"2",",",".");
                    if ($surplus==0){
                        $tmp003=1;
                    }else{
                        $tmp003=$surplus;
                    }
					
                    $per003     = ($angsurplus!=0)?($surplus / $angsurplus ) * 100:0; 
                    $persen003  = number_format($per003,"2",",",".");
		
        $biaya_net =  $jmlpmasuk- $jmlpkeluar;
        $angbiaya_net =  $jmlangpmasuk- $jmlangpkeluar;        
        if ($biaya_net < 0){
                    	$a="("; $biaya_netx=$biaya_net*-1; $b=")";
                        }else {
                    	$a=""; $biaya_netx=$biaya_net; $b="";
                        }
        if ($angbiaya_net < 0){
                    	$g="("; $angbiaya_netx=$angbiaya_net*-1; $h=")";
                        }else {
                    	$g=""; $angbiaya_netx=$angbiaya_net; $h="";
                        }
        $biaya_net1 =   number_format($biaya_netx,"2",",",".");
        $angbiaya_net1 =   number_format($angbiaya_netx,"2",",",".");
        $silpa= ($jmlpendapatan+$jmlpmasuk)-($jmlbelanja+$jmlpkeluar);
        $angsilpa= ($jmlangpendapatan+$jmlangpmasuk)-($jmlangbelanja+$jmlangpkeluar);                
        if ($silpa < 0){
                    	$c="("; $silpax=$silpa*-1; $d=")";
                        }else {
                    	$c=""; $silpax=$silpa; $d="";
                        }
        if ($angsilpa < 0){
                    	$i="("; $angsilpax=$angsilpa*-1; $j=")";
                        }else {
                    	$i=""; $angsilpax=$angsilpa; $j="";
                        }
        $silpa1 =number_format($silpax,"2",",","."); 
        $angsilpa1 =number_format($angsilpax,"2",",",".");
       $sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
		$nm_skpd	= strtoupper ($nmskpd);
        $jk=$this->rka_model->combo_skpd();
       
        $cRet='';
        
	 $modtahun= $thn%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>					
                    <tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $smstr $thn</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>ANGGARAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>LEBIH</br>(KURANG)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                        </tr>";
               
                   $sql4="SELECT a.seq,a.nor,a.uraian,isnull(a.kode_1,'-') as kode_1,isnull(a.kode_2,'-') as kode_2,isnull(a.kode_3,'-') as kode_3,thn_m1 AS lalu FROM map_lra_skpd a 
				   GROUP BY a.seq,a.nor,a.uraian,isnull(a.kode_1,'-'),isnull(a.kode_2,'-'),isnull(a.kode_3,'-'),thn_m1 ORDER BY a.seq";
                // isnull(a.kode_1,\"'-'\")
                $query4 = $this->db->query($sql4);
                $no     = 0;                                  
               
                foreach ($query4->result() as $row4)
                {
                    
                    $nama      = $row4->uraian;   
                    $real_lalu = number_format($row4->lalu,"2",",",".");
                    $n         = $row4->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$n2         = $row4->kode_2;
					$n2		   = ($n2=="-"?"'-'":$n2);
					$n3         = $row4->kode_3;
					$n3		   = ($n3=="-"?"'-'":$n3);

//                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi( $bulan,$ag_tox) b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (".$n.") ";
                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) b WHERE kd_skpd='$kd_skpd' and (left(b.kd_rek5,3) in ($n) or left(b.kd_rek5,5) in ($n2) or left(b.kd_rek5,7) in ($n3))";
//					                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM realisasi b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (\"'.$n.'\") ";
                    $query5 = $this->db->query($sql5);
                    $trh    = $query5->row();
                    $nil    = $trh->nilai;
                    $angnil = $trh->anggaran;
                    
                    $real_s = $trh->anggaran - $trh->nilai;
                    if ($real_s < 0){
                    	$x1="("; $real_sx=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $real_sx=$real_s; $y1="";}
                    $selisih = number_format($real_sx,"2",",",".");
                    if ($trh->nilai==0){
                        $tmp=1;
                    }else{
                        $tmp=$trh->nilai;
                    }
                    $nilai    = number_format($trh->nilai,"2",",",".");
                    $angnilai = number_format($trh->anggaran,"2",",",".");
                    $per1     = ($angnil!=0)?($nil / $angnil ) * 100:0; 
                    $persen1  = number_format($per1,"2",",",".");
                    $no       = $no + 1;
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;					
					case 35:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 40:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlangpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x001$selisihpend$y001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen001</td>
                                 </tr>";
                        break;
					case 45:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 50:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td	 style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 55:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 70:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;						
					case 75:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 80:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;						
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 120:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlangbelanja1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlbelanja1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x002$selisihbelanja$y002</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen002</td>
                                 </tr>";
                        break;
					case 125:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 130:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$e$angsurplus1$f</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$x$surplus1$y</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x003$selisihsurplus$y003</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen003</td>
                                 </tr>";
                        break;
                   
                    default:
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                }
                }
        $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN SEMESTER $kd_skpd / $smstr");
        $this->template->set('title', 'LAPORAN SEMESTER $kd_skpd / $smstr');        
        switch($pilih) {       
        case 1;
			echo ("<title>$smstr UNIT</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        } 
    }
    
	
    function cetak_perda1_real($lap = '', $ctk = '', $skpd = '')
    {
        $id = $skpd;
        $cetak = $ctk;
        $laporan = $lap;

        if ($laporan <> '2')
        {
            $sts = '';
            $jurnal = '';
        } else
        {
            $sts = "AND MONTH(d.tgl_sts)<='12'";
            $jurnal = "AND MONTH(d.tgl_voucher)<='12'";

        }
        $sqldns = "SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
        $sqlskpd = $this->db->query($sqldns);
        foreach ($sqlskpd->result() as $rowdns)
        {
            $kd_urusan = $rowdns->kd_u;
            $nm_urusan = $rowdns->nm_u;
            $kd_skpd = $rowdns->kd_sk;
            $nm_skpd = $rowdns->nm_sk;
        }

        $sqlttd1 = "SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$id' and kode='PA'";
        $sqlttd = $this->db->query($sqlttd1);
        foreach ($sqlttd->result() as $rowttd)
        {
            $nip = $rowttd->nip;
            $nama = $rowttd->nm;
            $jabatan = $rowttd->jab;
        }

        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc)
        {

            $tgl = $rowsc->tgl_rka;
            $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
            $kab = $rowsc->kab_kota;
            $daerah = $rowsc->daerah;
            $thn = $rowsc->thn_ang;
        }

        $jk = $this->rka_model->combo_skpd();

        $cRet = '';

        if ($cetak == '2')
        {
            $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"55%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN I  :</h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
                    </tr>                                     
                   
                  </table>";
        }

        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>RINGKASAN REALISASI APBD </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";
        if ($cetak == '2')
        {
            $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
                            <td width=\"20%\">Urusan Organisasi </td>
                            <td width=\"80%\">: $kd_urusan - $nm_urusan</td>
                        </tr>
                        <tr>
                            <td>Organisasi</td>
                            <td>: $kd_skpd - $nm_skpd </td>
                        </tr>
                    
                    </table>";
        }

        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NOMOR URUT</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\" colspan=\"2\" ><b>JUMLAH (Rp.)</b></td>
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>LEBIH</br>(KURANG)</b></td>
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        <tr >
                             <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Anggaran</b></td>
                             <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Realisasi</b></td>                             
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                        </tr>";


        if ($cetak == '1')
        {
            $sql4 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
                        ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='4'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
                        UNION ALL 
                        SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='4'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='4'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
        }
        if ($cetak == '2')
        {
            $sql4 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(kd_rek5,1)= a.kd_rek1 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
                        ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='4' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
                        UNION ALL 
                        SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM  trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='4' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='4' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
        }

        $query4 = $this->db->query($sql4);
        //$query = $this->skpd_model->getAllc();

        foreach ($query4->result() as $row4)
        {
            $kode = $row4->rek;
            $nama = $row4->nm_rek;
            $ang = number_format($row4->nilai, "2", ".", ",");
            $angaran = $row4->nilai;
            $pen = $row4->cp;
            $debet = $row4->debet;
            $kredit = $row4->kredit;
            $real = ($pen + $kredit) - $debet;
            $nreal = number_format($real, "2", ".", ",");
            $real_s = $real - $angaran;
            if ($real_s < 0)
            {
                $x1 = "(";
                $real_s = $real_s * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisih = number_format($real_s, "2", ".", ",");
            $per1 = ($real != 0) ? ($real / $row4->nilai) * 100 : 0;
            $persen1 = number_format($per1, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
        }
        if ($cetak == '1')
        {
            $sqltp = "SELECT SUM(nilai) AS totp,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,1)='4' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,1)='4' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,1)='4' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,1)='4' ";
        }
        if ($cetak == '2')
        {
            $sqltp = "SELECT SUM(nilai) AS totp,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='4' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='4' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='4' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'";
        }
        $sqlp = $this->db->query($sqltp);
        foreach ($sqlp->result() as $rowp)
        {
            $angp = number_format($rowp->totp, "2", ".", ",");
            $angaranp = $rowp->totp;
            $penp = $rowp->cp;
            $debetp = $rowp->debet;
            $kreditp = $rowp->kredit;
            $realp = ($penp + $kreditp) - $debetp;
            $nrealp = number_format($realp, "2", ".", ",");
            $real_sp = $realp - $angaranp;
            if ($real_sp < 0)
            {
                $x1 = "(";
                $real_sp = $real_sp * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisihp = number_format($real_sp, "2", ".", ",");
            $per1p = ($realp != 0) ? ($realp / $rowp->totp) * 100 : 0;
            $persen1p = number_format($per1p, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Jumlah Pendapatan</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1p</td>
                                 </tr>";
        }

        if ($cetak == '1')
        {
            $sql5 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
                        ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='5'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
                        UNION ALL 
                        SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='5'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='5'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
        }
        if ($cetak == '2')
        {
            $sql5 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(kd_rek5,1)= a.kd_rek1 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
                        ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='5' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
                        UNION ALL 
                        SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM  trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='5' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='5' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
        }


        $query5 = $this->db->query($sql5);
        //$query = $this->skpd_model->getAllc();

        foreach ($query5->result() as $row5)
        {
            $kode5 = $row5->rek;
            $nama5 = $row5->nm_rek;
            $ang5 = number_format($row5->nilai, "2", ".", ",");
            $angaran5 = $row5->nilai;
            $pen5 = $row5->cp;
            $debet5 = $row5->debet;
            $kredit5 = $row5->kredit;
            $real5 = $debet5 - ($pen5 + $kredit5);
            $nreal5 = number_format($real5, "2", ".", ",");
            $real_s5 = $real5 - $angaran5;
            if ($real_s5 < 0)
            {
                $x1 = "(";
                $real_s5 = $real_s5 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisih5 = number_format($real_s5, "2", ".", ",");
            $per15 = ($real5 != 0) ? ($real5 / $row5->nilai) * 100 : 0;
            $persen15 = number_format($per15, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode5</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisih5$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen15</td>
                                     
                                 </tr>";
        }

        if ($cetak == '1')
        {
            $sqltb = "SELECT SUM(nilai) AS totb,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,1)='5' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,1)='5' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,1)='5' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,1)='5' ";
        }
        if ($cetak == '2')
        {
            $sqltb = "SELECT SUM(nilai) AS totb,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='5' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='5' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='5' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";
        }
        $sqlb = $this->db->query($sqltb);
        foreach ($sqlb->result() as $rowb)
        {
            $angb = number_format($rowb->totb, "2", ".", ",");
            $angaranb = $rowb->totb;
            $penb = $rowb->cp;
            $debetb = $rowb->debet;
            $kreditb = $rowb->kredit;
            $realb = $debetb - ($penb + $kreditb);
            $nrealb = number_format($realb, "2", ".", ",");
            $real_sb = $realb - $angaranb;
            if ($real_sb < 0)
            {
                $x1 = "(";
                $real_sb = $real_sb * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisihb = number_format($real_sb, "2", ".", ",");
            $per1b = ($realb != 0) ? ($realb / $rowb->totb) * 100 : 0;
            $persen1b = number_format($per1b, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Jumlah Belanja</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angb</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nrealb</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisihb$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1b</td>
                                 </tr>";
        }

        $suplus = $angaranp - $angaranb;

        if ($suplus < 0)
        {
            $s = "(";
            $suplus = $suplus * -1;
            $d = ")";
        } else
        {
            $s = "";
            $d = "";
        }
        $surp = number_format($suplus, 2, ',', '.');
        $suplusr = $realp - $realb;

        if ($suplusr < 0)
        {
            $j = "(";
            $suplusr = $suplusr * -1;
            $k = ")";
        } else
        {
            $j = "";
            $k = "";
        }
        $surpr = number_format($suplusr, 2, ',', '.');

        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Surplus/Defisit</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$s$surp$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$j$surpr$k</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                </tr>";
        if ($cetak == '1')
        {
            $sqlpm = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
                        ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='6'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
                        UNION ALL 
                        SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='61'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='61'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
        }
        if ($cetak == '2')
        {
            $sqlpm = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(kd_rek5,1)= a.kd_rek1 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
                        ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='6' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
                        UNION ALL 
                        SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM  trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='61' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='61' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
        }
        $query61 = $this->db->query($sqlpm);

        foreach ($query61->result() as $row61)
        {
            $kode61 = $row61->rek;
            $nama61 = $row61->nm_rek;
            $ang61 = number_format($row61->nilai, "2", ".", ",");
            $angaran61 = $row61->nilai;
            //echo($angaran61);
            $pen61 = $row61->cp;
            $debet61 = $row61->debet;
            $kredit61 = $row61->kredit;
            $real61 = ($pen61 + $kredit61) - $debet61;
            $nreal61 = number_format($real61, "2", ".", ",");
            $real_s61 = $real61 - $angaran61;
            if ($real_s61 < 0)
            {
                $x1 = "(";
                $real_s61 = $real_s61 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisih61 = number_format($real_s61, "2", ".", ",");
            $per161 = ($real61 != 0) ? ($real61 / $row61->nilai) * 100 : 0;
            $persen161 = number_format($per161, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode61</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama61</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang61</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal61</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisih61$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen161</td>
                                 </tr>";
        }

        if ($cetak == '1')
        {
            $sqltpm = "SELECT SUM(nilai) AS totpm,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,2)='61' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,2)='61' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,2)='61' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,2)='61' ";
        }
        if ($cetak == '2')
        {
            $sqltpm = "SELECT SUM(nilai) AS totpm,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='61' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='61' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='61' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,2)='61' AND kd_skpd='$id'";
        }
        $sqlpmasuk = $this->db->query($sqltpm);
        foreach ($sqlpmasuk->result() as $rowpm)
        {
            $angpm = number_format($rowpm->totpm, "2", ".", ",");
            $angaranpm = $rowpm->totpm;
            $penpm = $rowpm->cp;
            $debetpm = $rowpm->debet;
            $kreditpm = $rowpm->kredit;
            $realpm = ($penpm + $kreditpm) - $debetpm;
            $nrealpm = number_format($realpm, "2", ".", ",");
            $real_spm = $realpm - $angaranpm;
            if ($real_spm < 0)
            {
                $x1 = "(";
                $real_spm = $real_spm * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisihpm = number_format($real_spm, "2", ".", ",");
            $per1pm = ($realpm != 0) ? ($realpm / $rowpm->totpm) * 100 : 0;
            $persen1pm = number_format($per1pm, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Jumlah Pembiayaan masuk</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angpm</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nrealpm</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisihpm$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1pm</td>
                                 </tr>";
        }
        if ($cetak == '1')
        {
            $sqlpk = "SELECT * FROM(SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='62'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='62'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3) a ORDER BY kd_rek";
        }
        if ($cetak == '2')
        {
            $sqlpk = "SELECT * FROM(SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM  trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='62' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='62' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3) a ORDER BY kd_rek";
        }
        $query62 = $this->db->query($sqlpk);

        foreach ($query62->result() as $row62)
        {
            $kode62 = $row62->rek;
            $nama62 = $row62->nm_rek;
            $ang62 = number_format($row62->nilai, "2", ".", ",");
            $angaran62 = $row62->nilai;
            $pen62 = $row62->cp;
            $debet62 = $row62->debet;
            $kredit62 = $row62->kredit;
            $real62 = $debet62 - ($pen62 + $kredit62);
            $nreal62 = number_format($real62, "2", ".", ",");
            $real_s62 = $real62 - $angaran62;
            if ($real_s62 < 0)
            {
                $x1 = "(";
                $real_s62 = $real_s62 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisih62 = number_format($real_s62, "2", ".", ",");
            $per162 = ($real62 != 0) ? ($real62 / $row62->nilai) * 100 : 0;
            $persen162 = number_format($per162, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode62</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama62</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang62</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal62</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisih62$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen162</td>
                                 </tr>";
        }

        if ($cetak == '1')
        {
            $sqltpk = "SELECT SUM(nilai) AS totpk,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,2)='62' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,2)='62' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,2)='62' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,2)='62' ";
        }
        if ($cetak == '2')
        {
            $sqltpk = "SELECT SUM(nilai) AS totpk,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='62' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='62' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='62' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id'";
        }
        $sqlpkeluar = $this->db->query($sqltpk);
        foreach ($sqlpkeluar->result() as $rowpk)
        {
            $angpk = number_format($rowpk->totpk, "2", ".", ",");
            $angaranpk = $rowpk->totpk;
            $penpk = $rowpk->cp;
            $debetpk = $rowpk->debet;
            $kreditpk = $rowpk->kredit;
            $realpk = ($penpk + $kreditpk) - $debetpk;
            $nrealpk = number_format($realpm, "2", ".", ",");
            $real_spk = $realpk - $angaranpk;
            if ($real_spk < 0)
            {
                $x1 = "(";
                $real_spk = $real_spk * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisihpk = number_format($real_spk, "2", ".", ",");
            $per1pk = ($realpk != 0) ? ($realpk / $rowpk->totpk) * 100 : 0;
            $persen1pk = number_format($per1pk, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Jumlah Pembiayaan Keluar</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angpk</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nrealpk</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisihpk$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1pk</td>
                                 </tr>";
        }
        //echo($angaran62);
        $netto = $angaranpm - $angaranpk;
        $net = number_format($netto, 2, ',', '.');
        if ($netto < 0)
        {
            $x4 = "(";
            $netto = $netto * -1;
            $y4 = ")";
        } else
        {
            $x4 = "";
            $y4 = "";
        }

        $nettor = $realpm - $realpk;
        $netr = number_format($nettor, 2, ',', '.');
        if ($nettor < 0)
        {
            $x5 = "(";
            $nettor = $nettor * -1;
            $y5 = ")";
        } else
        {
            $x5 = "";
            $y5 = "";
        }

        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Pembiayaan Netto</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$x4$net$y4</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$x5$netr$y5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                </tr>";
        $silpa = ($angaranp + $angaranpm) - ($angaranpk + $angaranb);
        if ($silpa < 0)
        {
            $c = "(";
            $silpa = $silpa * -1;
            $d = ")";
        } else
        {
            $c = "";
            $d = "";
        }
        $silp = number_format($silpa, 2, ',', '.');
        $silpar = ($realp + $realpm) - ($realb + $realpk);
        if ($silpar < 0)
        {
            $c1 = "(";
            $silpar = $silpar * -1;
            $d1 = ")";
        } else
        {
            $c1 = "";
            $d1 = "";
        }
        $silpr = number_format($silpar, 2, ',', '.');

        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">SILPA</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c$silp$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$silpr$d1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                </tr>";

        $cRet .= "</table>";
        $data['prev'] = $cRet;
        $data['sikap'] = 'preview';


        $this->template->set('title', 'CETAK PERDA REALISASI SEMESTER LAMPIRAN I');
        $this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
    }

    function cetak_perda1_semester($lap = '', $ctk = '', $skpd = '')
    {
        $id = $skpd;
        $cetak = $ctk;
        $laporan = $lap;

        if ($laporan <> '2')
        {
            $sts = '';
            $jurnal = '';
        } else
        {
            $sts = "AND MONTH(d.tgl_sts)<='6'";
            $jurnal = "AND MONTH(d.tgl_voucher)<='6'";

        }
        $sqldns = "SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
        $sqlskpd = $this->db->query($sqldns);
        foreach ($sqlskpd->result() as $rowdns)
        {
            $kd_urusan = $rowdns->kd_u;
            $nm_urusan = $rowdns->nm_u;
            $kd_skpd = $rowdns->kd_sk;
            $nm_skpd = $rowdns->nm_sk;
        }

        $sqlttd1 = "SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$id' and kode='PA'";
        $sqlttd = $this->db->query($sqlttd1);
        foreach ($sqlttd->result() as $rowttd)
        {
            $nip = $rowttd->nip;
            $nama = $rowttd->nm;
            $jabatan = $rowttd->jab;
        }

        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc)
        {

            $tgl = $rowsc->tgl_rka;
            $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
            $kab = $rowsc->kab_kota;
            $daerah = $rowsc->daerah;
            $thn = $rowsc->thn_ang;
        }

        $jk = $this->rka_model->combo_skpd();

        $cRet = '';

        if ($cetak == '2')
        {
            $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"55%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN I  :</h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
                    </tr>                                     
                   
                  </table>";
        }

        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>RINGKASAN REALISASI APBD SEMESTER I </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";
        if ($cetak == '2')
        {
            $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
                            <td width=\"20%\">Urusan Organisasi </td>
                            <td width=\"80%\">: $kd_urusan - $nm_urusan</td>
                        </tr>
                        <tr>
                            <td>Organisasi</td>
                            <td>: $kd_skpd - $nm_skpd </td>
                        </tr>
                    
                    </table>";
        }

        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NOMOR URUT</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\" colspan=\"2\" ><b>JUMLAH (Rp.)</b></td>
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>PROGNOSIS</b></td>
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        <tr >
                             <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Anggaran</b></td>
                             <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Realisasi</b></td>                             
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                        </tr>";


        if ($cetak == '1')
        {
            $sql4 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
                        ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='4'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
                        UNION ALL 
                        SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='4'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='4'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
        }
        if ($cetak == '2')
        {
            $sql4 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(kd_rek5,1)= a.kd_rek1 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
                        ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='4' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
                        UNION ALL 
                        SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM  trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='4' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='4' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
        }

        $query4 = $this->db->query($sql4);
        //$query = $this->skpd_model->getAllc();

        foreach ($query4->result() as $row4)
        {
            $kode = $row4->rek;
            $nama = $row4->nm_rek;
            $ang = number_format($row4->nilai, "2", ".", ",");
            $angaran = $row4->nilai;
            $pen = $row4->cp;
            $debet = $row4->debet;
            $kredit = $row4->kredit;
            $real = ($pen + $kredit) - $debet;
            $nreal = number_format($real, "2", ".", ",");
            $real_s = $real - $angaran;
            if ($real_s < 0)
            {
                $x1 = "(";
                $real_s = $real_s * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisih = number_format($real_s, "2", ".", ",");
            $per1 = ($real != 0) ? ($real / $row4->nilai) * 100 : 0;
            $persen1 = number_format($per1, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisih</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
        }
        if ($cetak == '1')
        {
            $sqltp = "SELECT SUM(nilai) AS totp,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,1)='4' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,1)='4' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,1)='4' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,1)='4' ";
        }
        if ($cetak == '2')
        {
            $sqltp = "SELECT SUM(nilai) AS totp,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='4' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='4' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='4' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'";
        }
        $sqlp = $this->db->query($sqltp);
        foreach ($sqlp->result() as $rowp)
        {
            $angp = number_format($rowp->totp, "2", ".", ",");
            $angaranp = $rowp->totp;
            $penp = $rowp->cp;
            $debetp = $rowp->debet;
            $kreditp = $rowp->kredit;
            $realp = ($penp + $kreditp) - $debetp;
            $nrealp = number_format($realp, "2", ".", ",");
            $real_sp = $realp - $angaranp;
            if ($real_sp < 0)
            {
                $x1 = "(";
                $real_sp = $real_sp * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisihp = number_format($real_sp, "2", ".", ",");
            $per1p = ($realp != 0) ? ($realp / $rowp->totp) * 100 : 0;
            $persen1p = number_format($per1p, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Jumlah Pendapatan</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisihp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1p</td>
                                 </tr>";
        }

        if ($cetak == '1')
        {
            $sql5 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
                        ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='5'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
                        UNION ALL 
                        SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='5'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='5'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
        }
        if ($cetak == '2')
        {
            $sql5 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(kd_rek5,1)= a.kd_rek1 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
                        ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='5' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
                        UNION ALL 
                        SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM  trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='5' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='5' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
        }


        $query5 = $this->db->query($sql5);
        //$query = $this->skpd_model->getAllc();

        foreach ($query5->result() as $row5)
        {
            $kode5 = $row5->rek;
            $nama5 = $row5->nm_rek;
            $ang5 = number_format($row5->nilai, "2", ".", ",");
            $angaran5 = $row5->nilai;
            $pen5 = $row5->cp;
            $debet5 = $row5->debet;
            $kredit5 = $row5->kredit;
            $real5 = $debet5 - ($pen5 + $kredit5);
            $nreal5 = number_format($real5, "2", ".", ",");
            $real_s5 = $real5 - $angaran5;
            if ($real_s5 < 0)
            {
                $x1 = "(";
                $real_s5 = $real_s5 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisih5 = number_format($real_s5, "2", ".", ",");
            $per15 = ($real5 != 0) ? ($real5 / $row5->nilai) * 100 : 0;
            $persen15 = number_format($per15, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode5</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisih5$</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen15</td>
                                     
                                 </tr>";
        }

        if ($cetak == '1')
        {
            $sqltb = "SELECT SUM(nilai) AS totb,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,1)='5' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,1)='5' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,1)='5' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,1)='5' ";
        }
        if ($cetak == '2')
        {
            $sqltb = "SELECT SUM(nilai) AS totb,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='5' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='5' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='5' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";
        }
        $sqlb = $this->db->query($sqltb);
        foreach ($sqlb->result() as $rowb)
        {
            $angb = number_format($rowb->totb, "2", ".", ",");
            $angaranb = $rowb->totb;
            $penb = $rowb->cp;
            $debetb = $rowb->debet;
            $kreditb = $rowb->kredit;
            $realb = $debetb - ($penb + $kreditb);
            $nrealb = number_format($realb, "2", ".", ",");
            $real_sb = $realb - $angaranb;
            if ($real_sb < 0)
            {
                $x1 = "(";
                $real_sb = $real_sb * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisihb = number_format($real_sb, "2", ".", ",");
            $per1b = ($realb != 0) ? ($realb / $rowb->totb) * 100 : 0;
            $persen1b = number_format($per1b, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Jumlah Belanja</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angb</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nrealb</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisihb</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1b</td>
                                 </tr>";
        }

        $suplus = $angaranp - $angaranb;

        if ($suplus < 0)
        {
            $s = "(";
            $suplus = $suplus * -1;
            $d = ")";
        } else
        {
            $s = "";
            $d = "";
        }
        $surp = number_format($suplus, 2, ',', '.');
        $suplusr = $realp - $realb;

        if ($suplusr < 0)
        {
            $j = "(";
            $suplusr = $suplusr * -1;
            $k = ")";
        } else
        {
            $j = "";
            $k = "";
        }
        $surpr = number_format($suplusr, 2, ',', '.');

        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Surplus/Defisit</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$s$surp$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$j$surpr$k</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                </tr>";
        if ($cetak == '1')
        {
            $sqlpm = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
                        ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='6'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
                        UNION ALL 
                        SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='61'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='61'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
        }
        if ($cetak == '2')
        {
            $sqlpm = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(kd_rek5,1)= a.kd_rek1 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
                        ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='6' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
                        UNION ALL 
                        SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM  trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='61' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='61' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
        }
        $query61 = $this->db->query($sqlpm);

        foreach ($query61->result() as $row61)
        {
            $kode61 = $row61->rek;
            $nama61 = $row61->nm_rek;
            $ang61 = number_format($row61->nilai, "2", ".", ",");
            $angaran61 = $row61->nilai;
            //echo($angaran61);
            $pen61 = $row61->cp;
            $debet61 = $row61->debet;
            $kredit61 = $row61->kredit;
            $real61 = ($pen61 + $kredit61) - $debet61;
            $nreal61 = number_format($real61, "2", ".", ",");
            $real_s61 = $real61 - $angaran61;
            if ($real_s61 < 0)
            {
                $x1 = "(";
                $real_s61 = $real_s61 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisih61 = number_format($real_s61, "2", ".", ",");
            $per161 = ($real61 != 0) ? ($real61 / $row61->nilai) * 100 : 0;
            $persen161 = number_format($per161, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode61</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama61</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang61</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal61</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisih61</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen161</td>
                                 </tr>";
        }

        if ($cetak == '1')
        {
            $sqltpm = "SELECT SUM(nilai) AS totpm,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,2)='61' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,2)='61' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,2)='61' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,2)='61' ";
        }
        if ($cetak == '2')
        {
            $sqltpm = "SELECT SUM(nilai) AS totpm,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='61' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='61' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='61' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,2)='61' AND kd_skpd='$id'";
        }
        $sqlpmasuk = $this->db->query($sqltpm);
        foreach ($sqlpmasuk->result() as $rowpm)
        {
            $angpm = number_format($rowpm->totpm, "2", ".", ",");
            $angaranpm = $rowpm->totpm;
            $penpm = $rowpm->cp;
            $debetpm = $rowpm->debet;
            $kreditpm = $rowpm->kredit;
            $realpm = ($penpm + $kreditpm) - $debetpm;
            $nrealpm = number_format($realpm, "2", ".", ",");
            $real_spm = $realpm - $angaranpm;
            if ($real_spm < 0)
            {
                $x1 = "(";
                $real_spm = $real_spm * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisihpm = number_format($real_spm, "2", ".", ",");
            $per1pm = ($realpm != 0) ? ($realpm / $rowpm->totpm) * 100 : 0;
            $persen1pm = number_format($per1pm, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Jumlah Pembiayaan masuk</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angpm</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nrealpm</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisihpm</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1pm</td>
                                 </tr>";
        }
        if ($cetak == '1')
        {
            $sqlpk = "SELECT * FROM(SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='62'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='62'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3) a ORDER BY kd_rek";
        }
        if ($cetak == '2')
        {
            $sqlpk = "SELECT * FROM(SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM  trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
                        ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='62' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
                        UNION ALL 
                        SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $sts)AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
                        ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='62' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3) a ORDER BY kd_rek";
        }
        $query62 = $this->db->query($sqlpk);

        foreach ($query62->result() as $row62)
        {
            $kode62 = $row62->rek;
            $nama62 = $row62->nm_rek;
            $ang62 = number_format($row62->nilai, "2", ".", ",");
            $angaran62 = $row62->nilai;
            $pen62 = $row62->cp;
            $debet62 = $row62->debet;
            $kredit62 = $row62->kredit;
            $real62 = $debet62 - ($pen62 + $kredit62);
            $nreal62 = number_format($real62, "2", ".", ",");
            $real_s62 = $real62 - $angaran62;
            if ($real_s62 < 0)
            {
                $x1 = "(";
                $real_s62 = $real_s62 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisih62 = number_format($real_s62, "2", ".", ",");
            $per162 = ($real62 != 0) ? ($real62 / $row62->nilai) * 100 : 0;
            $persen162 = number_format($per162, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode62</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama62</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang62</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal62</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisih62</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen162</td>
                                 </tr>";
        }

        if ($cetak == '1')
        {
            $sqltpk = "SELECT SUM(nilai) AS totpk,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,2)='62' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,2)='62' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5,2)='62' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,2)='62' ";
        }
        if ($cetak == '2')
        {
            $sqltpk = "SELECT SUM(nilai) AS totpk,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='62' $sts)AS cp,
                        (SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='62' $jurnal)AS debet,
                        (SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='62' $jurnal)AS kredit  
                        FROM trdrka WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id'";
        }
        $sqlpkeluar = $this->db->query($sqltpk);
        foreach ($sqlpkeluar->result() as $rowpk)
        {
            $angpk = number_format($rowpk->totpk, "2", ".", ",");
            $angaranpk = $rowpk->totpk;
            $penpk = $rowpk->cp;
            $debetpk = $rowpk->debet;
            $kreditpk = $rowpk->kredit;
            $realpk = ($penpk + $kreditpk) - $debetpk;
            $nrealpk = number_format($realpm, "2", ".", ",");
            $real_spk = $realpk - $angaranpk;
            if ($real_spk < 0)
            {
                $x1 = "(";
                $real_spk = $real_spk * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisihpk = number_format($real_spk, "2", ".", ",");
            $per1pk = ($realpk != 0) ? ($realpk / $rowpk->totpk) * 100 : 0;
            $persen1pk = number_format($per1pk, "2", ".", ",");

            $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Jumlah Pembiayaan Keluar</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angpk</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nrealpk</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisihpk</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1pk</td>
                                 </tr>";
        }
        //echo($angaran62);
        $netto = $angaranpm - $angaranpk;
        $net = number_format($netto, 2, ',', '.');
        if ($netto < 0)
        {
            $x4 = "(";
            $netto = $netto * -1;
            $y4 = ")";
        } else
        {
            $x4 = "";
            $y4 = "";
        }

        $nettor = $realpm - $realpk;
        $netr = number_format($nettor, 2, ',', '.');
        if ($nettor < 0)
        {
            $x5 = "(";
            $nettor = $nettor * -1;
            $y5 = ")";
        } else
        {
            $x5 = "";
            $y5 = "";
        }

        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Pembiayaan Netto</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$x4$net$y4</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$x5$netr$y5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                </tr>";
        $silpa = ($angaranp + $angaranpm) - ($angaranpk + $angaranb);
        if ($silpa < 0)
        {
            $c = "(";
            $silpa = $silpa * -1;
            $d = ")";
        } else
        {
            $c = "";
            $d = "";
        }
        $silp = number_format($silpa, 2, ',', '.');
        $silpar = ($realp + $realpm) - ($realb + $realpk);
        if ($silpar < 0)
        {
            $c1 = "(";
            $silpar = $silpar * -1;
            $d1 = ")";
        } else
        {
            $c1 = "";
            $d1 = "";
        }
        $silpr = number_format($silpar, 2, ',', '.');

        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">SILPA</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c$silp$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$silpr$d1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                </tr>";

        $cRet .= "</table>";
        $data['prev'] = $cRet;
        $data['sikap'] = 'preview';


        $this->template->set('title', 'CETAK PERDA REALISASI SEMESTER LAMPIRAN I');
        $this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
        //$this->template->load('template','anggaran/rka/perkadaII',$data);
    }

	
	function cetak_lra_ppkd($cetak=1){
	 $bulan= $_REQUEST['tgl1'];
	 $ag_tox=2;
	 
	if($cbulan== 12){
	$sumber_data= "_at";
	}else{
	$sumber_data= "";
	}
	 
	 $id  = $this->session->userdata('kdskpd');
     $thn = $this->session->userdata('pcThang');

    //function cetak_lra(){
        $sql41="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thn) WHERE left(kd_rek5,1)='4' and kd_skpd='$id' ";
                    $query41 = $this->db->query($sql41);
                    $jmlp = $query41->row();
                    $jmlpendapatan = $jmlp->nilai;
                    $jmlangpendapatan = $jmlp->anggaran;
                    $jmlangpendapatan1= number_format($jmlp->anggaran,"2",",",".");
                    $jmlpendapatan1= number_format($jmlp->nilai,"2",",",".");
                    
					$real_pend = $jmlangpendapatan - $jmlpendapatan;
                    if ($real_pend < 0){
                    	$x001="("; $real_pendx=$real_pend*-1; $y001=")";}
                    else {
                    	$x001=""; $real_pendx=$real_pend; $y001="";}
                    $selisihpend = number_format($real_pendx,"2",",",".");
                    if ($jmlpendapatan==0){
                        $tmp001=1;
                    }else{
                        $tmp001=$jmlpendapatan;
                    }
					
                    $per001     = ($jmlangpendapatan!=0)?($jmlpendapatan / $jmlangpendapatan ) * 100:0; 
                    $persen001  = number_format($per001,"2",",",".");
					
        $sql51="SELECT SUM(anggaran) as angaran,SUM(real_spj)as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thn) WHERE left(kd_rek5,1) in ('5','6') and kd_skpd='$id' ";
                    $query51 = $this->db->query($sql51);
                    $jmlb = $query51->row();
                    $jmlangbelanja = $jmlb->angaran;
                    $jmlbelanja = $jmlb->nilai;
                    $jmlbelanja1= number_format($jmlb->nilai,"2",",",".");
                    $jmlangbelanja1= number_format($jmlb->angaran,"2",",",".");
					
					$real_belanja = $jmlangbelanja - $jmlbelanja;
                    if ($real_belanja < 0){
                    	$x002="("; $real_belanjax=$real_belanja*-1; $y002=")";}
                    else {
                    	$x002=""; $real_belanjax=$real_belanja; $y002="";}
                    $selisihbelanja = number_format($real_belanjax,"2",",",".");
                    if ($jmlbelanja==0){
                        $tmp002=1;
                    }else{
                        $tmp002=$jmlbelanja;
                    }
					
                    $per002     = ($jmlangbelanja!=0)?($jmlbelanja / $jmlangbelanja ) * 100:0; 
                    $persen002  = number_format($per002,"2",",",".");
					
        $sql523="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thn) WHERE left(kd_rek5,3)='523' and kd_skpd='$id' ";
                    $query523 = $this->db->query($sql523);
                    $jmlbm = $query523->row();
                    $jmlbmbelanja = $jmlbm->nilai;
                    $jmlangbmbelanja = $jmlbm->anggaran;
                    $jmlbmbelanja1= number_format($jmlbmbelanja,"2",",",".");
                    $jmlangbmbelanja1= number_format($jmlangbmbelanja,"2",",",".");
        $sql61="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='71' and kd_skpd='$id' ";
                    $query61 = $this->db->query($sql61);
                    $jmlpm = $query61->row();
                    $jmlpmasuk = $jmlpm->nilai;
                    $jmlangpmasuk = $jmlpm->anggaran;
        $sql62="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='72' and kd_skpd='$id' ";
                    $query62 = $this->db->query($sql62);
                    $jmlpk = $query62->row();
                    $jmlpkeluar = $jmlpk->nilai;
                    $jmlangpkeluar = $jmlpk->anggaran;
        $surplus =  $jmlpendapatan- $jmlbelanja;
        $angsurplus = $jmlangpendapatan- $jmlangbelanja;        
        if ($surplus < 0){
                    	$x="("; $surplusx=$surplus*-1; $y=")";
                        }else {
                    	$x=""; $surplusx=$surplus; $y="";
                        }
        if ($angsurplus < 0){
                    	$e="("; $angsurplusx=$angsurplus*-1; $f=")";
                        }else {
                    	$e=""; $angsurplusx=$angsurplus; $f="";
                        }
        $surplus1= number_format($surplusx,"2",",",".");
        $angsurplus1= number_format($angsurplusx,"2",",",".");
		
		$real_surplus = $angsurplus - $surplus;
                    if ($real_surplus < 0){
                    	$x003="("; $real_surplusx=$real_surplus*-1; $y003=")";}
                    else {
                    	$x003=""; $real_surplusx=$real_surplus; $y003="";}
        $selisihsurplus = number_format($real_surplusx,"2",",",".");
                    if ($surplus==0){
                        $tmp003=1;
                    }else{
                        $tmp003=$surplus;
                    }
					
                    $per003     = ($angsurplus!=0)?($surplus / $angsurplus ) * 100:0; 
                    $persen003  = number_format($per003,"2",",",".");
		
        $biaya_net = $jmlpmasuk- $jmlpkeluar;
        $angbiaya_net =  $jmlangpmasuk- $jmlangpkeluar;        
        if ($biaya_net < 0){
                    	$a="("; $biaya_netx=$biaya_net*-1; $b=")";
                        }else {
                    	$a=""; $biaya_netx=$biaya_net; $b="";
                        }
        if ($angbiaya_net < 0){
                    	$g="("; $angbiaya_netx=$angbiaya_net*-1; $h=")";
                        }else {
                    	$g=""; $angbiaya_netx=$angbiaya_net; $h="";
                        }
        $biaya_net1 =   number_format($biaya_netx,"2",",",".");
        $angbiaya_net1 =   number_format($angbiaya_netx,"2",",",".");
        $silpa= ($jmlpendapatan+$jmlpmasuk)-($jmlbelanja+$jmlpkeluar);
        $angsilpa= ($jmlangpendapatan+$jmlangpmasuk)-($jmlangbelanja+$jmlangpkeluar);                
        if ($silpa < 0){
                    	$c="("; $silpax=$silpa*-1; $d=")";
                        }else {
                    	$c=""; $silpax=$silpa; $d="";
                        }
        if ($angsilpa < 0){
                    	$i="("; $angsilpax=$angsilpa*-1; $j=")";
                        }else {
                    	$i=""; $angsilpax=$angsilpa; $j="";
                        }
        $silpa1 =number_format($silpax,"2",",","."); 
        $angsilpa1 =number_format($angsilpax,"2",",",".");

		$selisih_biaya = $angbiaya_net- $biaya_net;		
		if ($selisih_biaya < 0){
                    	$xy="("; $selisih_biayax=$selisih_biaya*-1; $yx=")";
                        }else {
                    	$xy=""; $selisih_biayax=$selisih_biaya; $yx="";
                        }
		$selisih_biaya1 = number_format($selisih_biayax,"2",",",".");
                    
                    $per004     = ($angbiaya_net!=0)?($biaya_net / $angbiaya_net ) * 100:0; 
                    $persen004  = number_format($per004,"2",",",".");
		
		$selisih_silpa = $angsilpa - $silpa;		
		if ($selisih_silpa < 0){
                    	$az="("; $selisih_silpax=$selisih_silpa*-1; $za=")";
                        }else {
                    	$az=""; $selisih_silpax=$selisih_silpa; $za="";
                        }
						
		$selisih_silpa1 = number_format($selisih_silpax,"2",",",".");
                    $per005     = ($angsilpa!=0)?($silpa / $angsilpa) * 100:0; 
                    $persen005  = number_format($per005,"2",",",".");
		
		$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$id' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
		
		$nm_skpd	= strtoupper ($nmskpd);
        $jk=$this->rka_model->combo_skpd();
       
        $cRet='';
        
	 $modtahun= $thn%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>					
                    <tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$bulan] $thn</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td colspan =\"6\" bgcolor=\"#CCCCCC\" width=\"60%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>ANGGARAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" ><b>LEBIH</br>(KURANG)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td colspan =\"6\" style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td colspan =\"6\" style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"60%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                        </tr>";
               
                   $sql4="SELECT a.seq,a.nor,a.uraian,isnull(a.kode_1,'-') as kode_1,isnull(a.kode_2,'-') as kode_2,isnull(a.kode_3,'-') as kode_3,thn_m1 AS lalu FROM map_lra_ppkd_prov a 
				   GROUP BY a.seq,a.nor,a.uraian,isnull(a.kode_1,'-'),isnull(a.kode_2,'-'),isnull(a.kode_3,'-'),thn_m1 ORDER BY a.seq";
                // isnull(a.kode_1,\"'-'\")
                $query4 = $this->db->query($sql4);
                $no     = 0;                                  
               
                foreach ($query4->result() as $row4)
                {
                    
                    $nama      = $row4->uraian;   
                    $real_lalu = number_format($row4->lalu,"2",",",".");
                    $n         = $row4->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$n2         = $row4->kode_2;
					$n2		   = ($n2=="-"?"'-'":$n2);
					$n3         = $row4->kode_3;
					$n3		   = ($n3=="-"?"'-'":$n3);

//                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi( $bulan,$ag_tox) b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (".$n.") ";
                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thn) b WHERE kd_skpd='$id' and (left(b.kd_rek5,3) in ($n) or left(b.kd_rek5,5) in ($n2) or left(b.kd_rek5,7) in ($n3))";
//					                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM realisasi b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (\"'.$n.'\") ";
                    $query5 = $this->db->query($sql5);
                    $trh    = $query5->row();
                    $nil    = $trh->nilai;
                    $angnil = $trh->anggaran;
                    
                    $real_s = $trh->anggaran - $trh->nilai;
                    if ($real_s < 0){
                    	$x1="("; $real_sx=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $real_sx=$real_s; $y1="";}
                    $selisih = number_format($real_sx,"2",",",".");
                    if ($trh->nilai==0){
                        $tmp=1;
                    }else{
                        $tmp=$trh->nilai;
                    }
                    $nilai    = number_format($trh->nilai,"2",",",".");
                    $angnilai = number_format($trh->anggaran,"2",",",".");
                    $per1     = ($angnil!=0)?($nil / $angnil ) * 100:0; 
                    $persen1  = number_format($per1,"2",",",".");
                    $no       = $no + 1;
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"5\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 30:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"3\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 35:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 40:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan=\"5\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 45:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"4\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 70:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"3\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 75:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 80:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan=\"4\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 95:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"3\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 100:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"2\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 105:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan=\"5\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 125:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"3\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 130:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 135:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 140:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 145:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"5\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 170:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"3\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 175:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 180:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan=\"5\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 190:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"4\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 195:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"2\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 200:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
									 <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 205:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 210:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"5\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 225:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"3\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 230:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 235:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan=\"5\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 255:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"3\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 260:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"2\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 265:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 270:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"50%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 275:
                         $cRet    .= "<tr>
									 <tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 280:
                         $cRet    .= "<tr>
									 <tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"50%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$e$angsurplus1$f</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$x$surplus1$y</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x003$selisihsurplus$y003</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen003</td>
                                 </tr>";
                        break;
					case 285:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 290:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 295:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"5\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 370:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"3\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 375:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 380:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan=\"5\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 440:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"3\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 445:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"2\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$g$angbiaya_net1$h</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$a$biaya_net1$b</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$xy$selisih_biaya1$yx</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen004</td>
                                 </tr>";
                        break;
					case 450:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan=\"6\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 455:
                         $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"2\" style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$i$angsilpa1$j</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c$silpa1$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$az$selisih_silpa1$za</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen005</td>
                                 </tr>";
                        break;	
                    default:
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan=\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"54%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
				}
                }
        $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = 'LAPORAN REALISASI ANGGARAN';
        $this->template->set('title', 'CETAK LAPORAN REALISASI ANGGARAN');        
        switch($cetak) {       
        case 1;
			echo ("<title>LRA $bulan</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        } 
    }
    
	function cetak_lra_lo_unit($cbulan="", $kd_skpd="", $pilih=1){
        //$id = $skpd;
        $cetak='2';//$ctk; 
        $id     = $this->session->userdata('kdskpd');
        $thn_ang = $this->session->userdata('pcThang');
        $thn_ang_1= $thn_ang-1;  
        //$laporan=$lap; 
       
       // if ($cetak == '1') {
//           $skpd = '';
//           $skpd1 = '';           
//       } else {             
           $skpd = "AND kd_skpd='$id'";
           $skpd1 = "AND b.kd_skpd='$id'"; 
       //}  

       $y123=")";
	   $x123="(";       
	    $sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$id'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $nmskpd     = $rowsc->nm_skpd;
                } 
		$nm_skpd = strtoupper($nmskpd);		
	   // INSERT DATA
	   
       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$kd_skpd'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
     
// created by henri_tb
			
		$sqllo1="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(kd_rek5,2) in ('81','82','83') and month(b.tgl_voucher)<=$cbulan and b.kd_skpd='$kd_skpd'";
                    $querylo1= $this->db->query($sqllo1);
                    $penlo = $querylo1->row();
                    $pen_lo = $penlo->nilai;
                    $pen_lo1= number_format($penlo->nilai,"2",",",".");
        
		$sqllo2="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('81','82','83') and b.kd_skpd='$kd_skpd'";
                    $querylo2= $this->db->query($sqllo2);
                    $penlo2 = $querylo2->row();
                    $pen_lo_lalu = $penlo2->nilai;
                    $pen_lo_lalu1= number_format($penlo2->nilai,"2",",",".");
		
		$sqllo3="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(kd_rek5,2) in ('91','92') and month(b.tgl_voucher)<=$cbulan and b.kd_skpd='$kd_skpd'";
                    $querylo3= $this->db->query($sqllo3);
                    $bello = $querylo3->row();
                    $bel_lo = $bello->nilai;
                    $bel_lo1= number_format($bello->nilai,"2",",",".");
        
		$sqllo4="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('91','92') and b.kd_skpd='$kd_skpd'";
                    $querylo4= $this->db->query($sqllo4);
                    $bello2 = $querylo4->row();
                    $bel_lo_lalu = $bello2->nilai;
                    $bel_lo_lalu1= number_format($bello2->nilai,"2",",",".");		

					$surplus_lo = $pen_lo - $bel_lo;
                    if ($surplus_lo < 0){
                    	$lo1="("; $surplus_lox=$surplus_lo*-1; $lo2=")";}
                    else {
                    	$lo1=""; $surplus_lox=$surplus_lo; $lo2="";}		
                    $surplus_lo1 = number_format($surplus_lox,"2",",",".");
                    
					$surplus_lo_lalu = $pen_lo_lalu - $bel_lo_lalu;
                    if ($surplus_lo_lalu < 0){
                    	$lo3="("; $surplus_lo_lalux=$surplus_lo_lalu*-1; $lo4=")";}
                    else {
                    	$lo3=""; $surplus_lo_lalux=$surplus_lo_lalu; $lo4="";}						
                    $surplus_lo_lalu1 = number_format($surplus_lo_lalux,"2",",",".");

					$selisih_surplus_lo = $surplus_lo - $surplus_lo_lalu;
                    if ($selisih_surplus_lo < 0){
                    	$lo5="("; $selisih_surplus_lox=$selisih_surplus_lo*-1; $lo6=")";}
                    else {
                    	$lo5=""; $selisih_surplus_lox=$selisih_surplus_lo; $lo6="";}
                    $selisih_surplus_lo1 = number_format($selisih_surplus_lox,"2",",",".");
                    
					if( $surplus_lo_lalu=='' or $surplus_lo_lalu==0){
					$persen2 = '0,00';
					}else{
					$persen2 = ($surplus_lo/$surplus_lo_lalu)*100;
					$persen2 = number_format($persen2,"2",",",".");
					}
					
		$sqllo5="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(kd_rek5,2) in ('81','82','83','84') and month(b.tgl_voucher)<=$cbulan and b.kd_skpd='$kd_skpd'";
                    $querylo5= $this->db->query($sqllo5);
                    $penlo3 = $querylo5->row();
                    $pen_lo3 = $penlo3->nilai;
                    $pen_lo31= number_format($penlo3->nilai,"2",",",".");
        
		$sqllo6="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('81','82','83','84') and b.kd_skpd='$kd_skpd'";
                    $querylo6= $this->db->query($sqllo6);
                    $penlo4 = $querylo6->row();
                    $pen_lo_lalu4 = $penlo4->nilai;
                    $pen_lo_lalu41= number_format($penlo4->nilai,"2",",",".");
		
		$sqllo7="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(kd_rek5,2) in ('91','92','93') and month(b.tgl_voucher)<=$cbulan and b.kd_skpd='$kd_skpd'";
                    $querylo7= $this->db->query($sqllo7);
                    $bello5 = $querylo7->row();
                    $bel_lo5 = $bello5->nilai;
                    $bel_lo51= number_format($bello5->nilai,"2",",",".");
		
		$sqllo8="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('91','92','93') and b.kd_skpd='$kd_skpd'";
                    $querylo8= $this->db->query($sqllo8);
                    $bello6 = $querylo8->row();
                    $bel_lo_lalu6 = $bello6->nilai;
                    $bel_lo_lalu61= number_format($bello6->nilai,"2",",",".");		

					$surplus_lo2 = $pen_lo3 - $bel_lo5;
                    if ($surplus_lo2 < 0){
                    	$lo7="("; $surplus_lo2x=$surplus_lo2*-1; $lo8=")";}
                    else {
                    	$lo7=""; $surplus_lo2x=$surplus_lo2; $lo8="";}		
                    $surplus_lo21 = number_format($surplus_lo2x,"2",",",".");
                    
					$surplus_lo_lalu2 = $pen_lo_lalu4 - $bel_lo_lalu6;
                    if ($surplus_lo_lalu2 < 0){
                    	$lo9="("; $surplus_lo_lalu2x=$surplus_lo_lalu2*-1; $lo10=")";}
                    else {
                    	$lo9=""; $surplus_lo_lalu2x=$surplus_lo_lalu2; $lo10="";}						
                    $surplus_lo_lalu21 = number_format($surplus_lo_lalu2x,"2",",",".");

					$selisih_surplus_lo2 = $surplus_lo2 - $surplus_lo_lalu2;
                    if ($selisih_surplus_lo2 < 0){
                    	$lo11="("; $selisih_surplus_lo2x=$selisih_surplus_lo2*-1; $lo12=")";}
                    else {
                    	$lo11=""; $selisih_surplus_lo2x=$selisih_surplus_lo2; $lo12="";}
                    $selisih_surplus_lo21 = number_format($selisih_surplus_lo2x,"2",",",".");
                    
					if( $surplus_lo_lalu2=='' or $surplus_lo_lalu2==0){
					$persen3 = '0,00';
					}else{
					$persen3 = ($surplus_lo2/$surplus_lo_lalu2)*100;
					$persen3 = number_format($persen3,"2",",",".");
					}
		
		$sqllo9="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(kd_rek5,1) in ('8') and month(b.tgl_voucher)<=$cbulan and b.kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(kd_rek5,1) in ('9') and month(b.tgl_voucher)<=$cbulan and b.kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    if ($surplus_lo3 < 0){
                    	$lo13="("; $surplus_lo3x=$surplus_lo3*-1; $lo14=")";}
                    else {
                    	$lo13=""; $surplus_lo3x=$surplus_lo3; $lo14="";}		
                    $surplus_lo31 = number_format($surplus_lo3x,"2",",",".");
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    if ($surplus_lo_lalu3 < 0){
                    	$lo15="("; $surplus_lo_lalu3x=$surplus_lo_lalu3*-1; $lo16=")";}
                    else {
                    	$lo15=""; $surplus_lo_lalu3x=$surplus_lo_lalu3; $lo16="";}						
                    $surplus_lo_lalu31 = number_format($surplus_lo_lalu3x,"2",",",".");

					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
                    if ($selisih_surplus_lo3 < 0){
                    	$lo17="("; $selisih_surplus_lo3x=$selisih_surplus_lo3*-1; $lo18=")";}
                    else {
                    	$lo17=""; $selisih_surplus_lo3x=$selisih_surplus_lo3; $lo18="";}
                    $selisih_surplus_lo31 = number_format($selisih_surplus_lo3x,"2",",",".");
                    
					if( $surplus_lo_lalu3=='' or $surplus_lo_lalu3==0){
					$persen4 = '0,00';
					}else{
					$persen4 = ($surplus_lo3/$surplus_lo_lalu3)*100;
					$persen4 = number_format($persen4,"2",",",".");
					}
	 
	 $modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
        $cRet='';
        
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong> $nm_skpd</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>LAPORAN OPERASIONAL </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan] $thn_ang DAN $thn_ang_1</strong></td>
                    </tr>
					<tr>
                         <td align=\"center\"><strong>&nbsp</strong></td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>Kenaikan</br>(Penurunan)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                        </tr>";

        $sqlmaplo="SELECT seq, nor, uraian, isnull(kode_1,'-') as kode_1, isnull(cetak,'debet-debet') as cetak FROM map_lo_skpd 
				   GROUP BY seq, nor, uraian, isnull(kode_1,'-'), isnull(cetak,'debet-debet') ORDER BY seq";
				   
                $querymaplo = $this->db->query($sqlmaplo);
                $no     = 0;                                  
               
                foreach ($querymaplo->result() as $loquery)
                {
                    
                    $nama      = $loquery->uraian;   
                    $n         = $loquery->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$normal    = $loquery->cetak;
					
		$quelo01   = "SELECT SUM($normal) as nilai FROM trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE left(kd_rek5,3) in ($n) and year(tgl_voucher)=$thn_ang and month(b.tgl_voucher)<=$cbulan and b.kd_skpd='$kd_skpd'";
                    $quelo02 = $this->db->query($quelo01);
                    $quelo03 = $quelo02->row();
                    $nil     = $quelo03->nilai;
                    $nilai    = number_format($quelo03->nilai,"2",",",".");
					
		$quelo04   = "SELECT SUM($normal) as nilai FROM trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE left(kd_rek5,3) in ($n) and year(tgl_voucher)=$thn_ang_1 and b.kd_skpd='$kd_skpd'";
                    $quelo05 = $this->db->query($quelo04);
                    $quelo06 = $quelo05->row();
                    $nil_lalu     = $quelo06->nilai;
                    $nilai_lalu    = number_format($quelo06->nilai,"2",",",".");
					
                    $real_nilai = $nil - $nil_lalu;
                    if ($real_nilai < 0){
                    	$lo0="("; $real_nilaix=$real_nilai*-1; $lo00=")";}
                    else {
                    	$lo0=""; $real_nilaix=$real_nilai; $lo00="";}
                    $real_nilai1 = number_format($real_nilaix,"2",",",".");
                    
					if( $nil_lalu=='' or $nil_lalu==0){
					$persen1 = '0,00';
					}else{
					$persen1 = ($nil/$nil_lalu)*100;
					$persen1 = number_format($persen1,"2",",",".");
					}
                    $no       = $no + 1;
                    switch ($loquery->seq) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 30:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 45:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 50:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 55:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 105:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;	
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 120:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 125:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo13$surplus_lo31$lo14</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo15$surplus_lo_lalu31$lo16</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo17$selisih_surplus_lo31$lo18</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen4</td>
                                 </tr>";
                        break;	
					default:
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
               
				}
                              
                    
                }
				
       // $cRet         .= "</table>";
//        $data['prev']  = $cRet;
//        $data['sikap'] = 'preview';
//        
//        
//        
//        $this->template->set('title', 'LAPORAN OPERASIONAL'); 
//        $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
        //$this->template->load('template','anggaran/rka/perkadaII',$data); 
        
        $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LO UNIT $kd_skpd / $cbulan");
        $this->template->set('title', ("LO UNIT $kd_skpd / $cbulan"));        
        switch($pilih) {       
        case 1;
			echo ("<title>LO UNIT $cbulan</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        } 
        
                 
    }
    
	
	function cetak_lra_lo($cbulan="", $pilih=1){
        //$id = $skpd;
        $cetak='2';//$ctk;
        $id     = $this->session->userdata('kdskpd');
        $thn_ang = $this->session->userdata('pcThang');
        $thn_ang_1= $thn_ang-1;  
        //$laporan=$lap; 
       
       // if ($cetak == '1') {
//           $skpd = '';
//           $skpd1 = '';           
//       } else {             
           $skpd = "AND kd_skpd='$id'";
           $skpd1 = "AND b.kd_skpd='$id'"; 
       //}  

       $y123=")";
	   $x123="(";       
	    $sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$id'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $nmskpd     = $rowsc->nm_skpd;
                } 
		$nm_skpd = strtoupper($nmskpd);		
	   // INSERT DATA
	   
       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
     
// created by henri_tb
			
		$sqllo1="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(kd_rek5,2) in ('81','82','83') and month(b.tgl_voucher)<=$cbulan and kd_skpd<>'$id'";
                    $querylo1= $this->db->query($sqllo1);
                    $penlo = $querylo1->row();
                    $pen_lo = $penlo->nilai;
                    $pen_lo1= number_format($penlo->nilai,"2",",",".");
        
		$sqllo2="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('81','82','83') and kd_skpd<>'$id'";
                    $querylo2= $this->db->query($sqllo2);
                    $penlo2 = $querylo2->row();
                    $pen_lo_lalu = $penlo2->nilai;
                    $pen_lo_lalu1= number_format($penlo2->nilai,"2",",",".");
		
		$sqllo3="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(kd_rek5,2) in ('91','92') and month(b.tgl_voucher)<=$cbulan and kd_skpd<>'$id'";
                    $querylo3= $this->db->query($sqllo3);
                    $bello = $querylo3->row();
                    $bel_lo = $bello->nilai;
                    $bel_lo1= number_format($bello->nilai,"2",",",".");
        
		$sqllo4="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('91','92') and kd_skpd<>'$id'";
                    $querylo4= $this->db->query($sqllo4);
                    $bello2 = $querylo4->row();
                    $bel_lo_lalu = $bello2->nilai;
                    $bel_lo_lalu1= number_format($bello2->nilai,"2",",",".");		

					$surplus_lo = $pen_lo - $bel_lo;
                    if ($surplus_lo < 0){
                    	$lo1="("; $surplus_lox=$surplus_lo*-1; $lo2=")";}
                    else {
                    	$lo1=""; $surplus_lox=$surplus_lo; $lo2="";}		
                    $surplus_lo1 = number_format($surplus_lox,"2",",",".");
                    
					$surplus_lo_lalu = $pen_lo_lalu - $bel_lo_lalu;
                    if ($surplus_lo_lalu < 0){
                    	$lo3="("; $surplus_lo_lalux=$surplus_lo_lalu*-1; $lo4=")";}
                    else {
                    	$lo3=""; $surplus_lo_lalux=$surplus_lo_lalu; $lo4="";}						
                    $surplus_lo_lalu1 = number_format($surplus_lo_lalux,"2",",",".");

					$selisih_surplus_lo = $surplus_lo - $surplus_lo_lalu;
                    if ($selisih_surplus_lo < 0){
                    	$lo5="("; $selisih_surplus_lox=$selisih_surplus_lo*-1; $lo6=")";}
                    else {
                    	$lo5=""; $selisih_surplus_lox=$selisih_surplus_lo; $lo6="";}
                    $selisih_surplus_lo1 = number_format($selisih_surplus_lox,"2",",",".");
                    
					if( $surplus_lo_lalu=='' or $surplus_lo_lalu==0){
					$persen2 = '0,00';
					}else{
					$persen2 = ($surplus_lo/$surplus_lo_lalu)*100;
					$persen2 = number_format($persen2,"2",",",".");
					}
					
		$sqllo5="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(kd_rek5,2) in ('81','82','83','84') and month(b.tgl_voucher)<=$cbulan and kd_skpd<>'$id'";
                    $querylo5= $this->db->query($sqllo5);
                    $penlo3 = $querylo5->row();
                    $pen_lo3 = $penlo3->nilai;
                    $pen_lo31= number_format($penlo3->nilai,"2",",",".");
        
		$sqllo6="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('81','82','83','84') and kd_skpd<>'$id'";
                    $querylo6= $this->db->query($sqllo6);
                    $penlo4 = $querylo6->row();
                    $pen_lo_lalu4 = $penlo4->nilai;
                    $pen_lo_lalu41= number_format($penlo4->nilai,"2",",",".");
		
		$sqllo7="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(kd_rek5,2) in ('91','92','93') and month(b.tgl_voucher)<=$cbulan and kd_skpd<>'$id'";
                    $querylo7= $this->db->query($sqllo7);
                    $bello5 = $querylo7->row();
                    $bel_lo5 = $bello5->nilai;
                    $bel_lo51= number_format($bello5->nilai,"2",",",".");
		
		$sqllo8="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('91','92','93') and kd_skpd<>'$id'";
                    $querylo8= $this->db->query($sqllo8);
                    $bello6 = $querylo8->row();
                    $bel_lo_lalu6 = $bello6->nilai;
                    $bel_lo_lalu61= number_format($bello6->nilai,"2",",",".");		

					$surplus_lo2 = $pen_lo3 - $bel_lo5;
                    if ($surplus_lo2 < 0){
                    	$lo7="("; $surplus_lo2x=$surplus_lo2*-1; $lo8=")";}
                    else {
                    	$lo7=""; $surplus_lo2x=$surplus_lo2; $lo8="";}		
                    $surplus_lo21 = number_format($surplus_lo2x,"2",",",".");
                    
					$surplus_lo_lalu2 = $pen_lo_lalu4 - $bel_lo_lalu6;
                    if ($surplus_lo_lalu2 < 0){
                    	$lo9="("; $surplus_lo_lalu2x=$surplus_lo_lalu2*-1; $lo10=")";}
                    else {
                    	$lo9=""; $surplus_lo_lalu2x=$surplus_lo_lalu2; $lo10="";}						
                    $surplus_lo_lalu21 = number_format($surplus_lo_lalu2x,"2",",",".");

					$selisih_surplus_lo2 = $surplus_lo2 - $surplus_lo_lalu2;
                    if ($selisih_surplus_lo2 < 0){
                    	$lo11="("; $selisih_surplus_lo2x=$selisih_surplus_lo2*-1; $lo12=")";}
                    else {
                    	$lo11=""; $selisih_surplus_lo2x=$selisih_surplus_lo2; $lo12="";}
                    $selisih_surplus_lo21 = number_format($selisih_surplus_lo2x,"2",",",".");
                    
					if( $surplus_lo_lalu2=='' or $surplus_lo_lalu2==0){
					$persen3 = '0,00';
					}else{
					$persen3 = ($surplus_lo2/$surplus_lo_lalu2)*100;
					$persen3 = number_format($persen3,"2",",",".");
					}
		
		$sqllo9="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(kd_rek5,1) in ('8') and month(b.tgl_voucher)<=$cbulan and kd_skpd<>'$id'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(kd_rek5,1) in ('9') and month(b.tgl_voucher)<=$cbulan and kd_skpd<>'$id'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    if ($surplus_lo3 < 0){
                    	$lo13="("; $surplus_lo3x=$surplus_lo3*-1; $lo14=")";}
                    else {
                    	$lo13=""; $surplus_lo3x=$surplus_lo3; $lo14="";}		
                    $surplus_lo31 = number_format($surplus_lo3x,"2",",",".");
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    if ($surplus_lo_lalu3 < 0){
                    	$lo15="("; $surplus_lo_lalu3x=$surplus_lo_lalu3*-1; $lo16=")";}
                    else {
                    	$lo15=""; $surplus_lo_lalu3x=$surplus_lo_lalu3; $lo16="";}						
                    $surplus_lo_lalu31 = number_format($surplus_lo_lalu3x,"2",",",".");

					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
                    if ($selisih_surplus_lo3 < 0){
                    	$lo17="("; $selisih_surplus_lo3x=$selisih_surplus_lo3*-1; $lo18=")";}
                    else {
                    	$lo17=""; $selisih_surplus_lo3x=$selisih_surplus_lo3; $lo18="";}
                    $selisih_surplus_lo31 = number_format($selisih_surplus_lo3x,"2",",",".");
                    
					if( $surplus_lo_lalu3=='' or $surplus_lo_lalu3==0){
					$persen4 = '0,00';
					}else{
					$persen4 = ($surplus_lo3/$surplus_lo_lalu3)*100;
					$persen4 = number_format($persen4,"2",",",".");
					}
	 
	 $modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
        $cRet='';
        
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>LAPORAN OPERASIONAL </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan] $thn_ang DAN $thn_ang_1</strong></td>
                    </tr>
					<tr>
                         <td align=\"center\"><strong>&nbsp</strong></td>
                    </tr>
                  </table>";   
     
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>Kenaikan</br>(Penurunan)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                        </tr>";

        $sqlmaplo="SELECT seq, nor, uraian, isnull(kode_1,'-') as kode_1, isnull(cetak,'debet-debet') as cetak FROM map_lo_skpd 
				   GROUP BY seq, nor, uraian, isnull(kode_1,'-'), isnull(cetak,'debet-debet') ORDER BY seq";
				   
                $querymaplo = $this->db->query($sqlmaplo);
                $no     = 0;                                  
               
                foreach ($querymaplo->result() as $loquery)
                {
                    
                    $nama      = $loquery->uraian;   
                    $n         = $loquery->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$normal    = $loquery->cetak;
					
		$quelo01   = "SELECT SUM($normal) as nilai FROM trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE left(kd_rek5,3) in ($n) and year(tgl_voucher)=$thn_ang and month(b.tgl_voucher)<=$cbulan and kd_skpd<>'$id'";
                    $quelo02 = $this->db->query($quelo01);
                    $quelo03 = $quelo02->row();
                    $nil     = $quelo03->nilai;
                    $nilai    = number_format($quelo03->nilai,"2",",",".");
					
		$quelo04   = "SELECT SUM($normal) as nilai FROM trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE left(kd_rek5,3) in ($n) and year(tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";
                    $quelo05 = $this->db->query($quelo04);
                    $quelo06 = $quelo05->row();
                    $nil_lalu     = $quelo06->nilai;
                    $nilai_lalu    = number_format($quelo06->nilai,"2",",",".");
					
                    $real_nilai = $nil - $nil_lalu;
                    if ($real_nilai < 0){
                    	$lo0="("; $real_nilaix=$real_nilai*-1; $lo00=")";}
                    else {
                    	$lo0=""; $real_nilaix=$real_nilai; $lo00="";}
                    $real_nilai1 = number_format($real_nilaix,"2",",",".");
                    
					if( $nil_lalu=='' or $nil_lalu==0){
					$persen1 = '0,00';
					}else{
					$persen1 = ($nil/$nil_lalu)*100;
					$persen1 = number_format($persen1,"2",",",".");
					}
                    $no       = $no + 1;
                    switch ($loquery->seq) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 30:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 45:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 50:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 55:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 105:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;	
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 120:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 125:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo13$surplus_lo31$lo14</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo15$surplus_lo_lalu31$lo16</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo17$selisih_surplus_lo31$lo18</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen4</td>
                                 </tr>";
                        break;	
					default:
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
               
				}
                              
                    
                }
				
       // $cRet         .= "</table>";
//        $data['prev']  = $cRet;
//        $data['sikap'] = 'preview';
//        
//        
//        
//        $this->template->set('title', 'LAPORAN OPERASIONAL'); 
//        $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
        //$this->template->load('template','anggaran/rka/perkadaII',$data); 
        
        $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LO SKPD Keseluruhan / $cbulan");
        $this->template->set('title', 'LO SKPD Keseluruhan / $cbulan');        
        switch($pilih) {       
        case 1;
			echo ("<title>LO SKPD $cbulan</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        } 
        
                 
    }
    
	
	
	function cetak_lra_lo_ppkd($pilih=1){
        //$id = $skpd;
        $cetak='2';//$ctk; 
        $bulan= $_REQUEST['tgl1'];
		$id     = $this->session->userdata('kdskpd');
        $thn_ang = $this->session->userdata('pcThang');
        $thn_ang_1= $thn_ang-1;  
        
		$bulan<10 ? $xbulan = "0$bulan" : $xbulan=$bulan;
		
		//$laporan=$lap; 
       
       // if ($cetak == '1') {
//           $skpd = '';
//           $skpd1 = '';           
//       } else {             
           $skpd = "AND kd_skpd='$id'";
           $skpd1 = "AND b.kd_skpd='$id'"; 
       //}  

       $y123=")";
	   $x123="(";       
	    $sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$id'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $nmskpd     = $rowsc->nm_skpd;
                } 
		$nm_skpd = strtoupper($nmskpd);		
	   // INSERT DATA
	   
       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
     
// created by henri_tb
			
		$sqllo1="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,2) in ('81','82','83') and b.kd_skpd='$id'";
                    $querylo1= $this->db->query($sqllo1);
                    $penlo = $querylo1->row();
                    $pen_lo = $penlo->nilai;
                    $pen_lo1= number_format($penlo->nilai,"2",",",".");
        
		$sqllo2="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('81','82','83') and b.kd_skpd='$id'";
                    $querylo2= $this->db->query($sqllo2);
                    $penlo2 = $querylo2->row();
                    $pen_lo_lalu = $penlo2->nilai;
                    $pen_lo_lalu1= number_format($penlo2->nilai,"2",",",".");
		
		$sqllo3="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,2) in ('91','92') and b.kd_skpd='$id'";
                    $querylo3= $this->db->query($sqllo3);
                    $bello = $querylo3->row();
                    $bel_lo = $bello->nilai;
                    $bel_lo1= number_format($bello->nilai,"2",",",".");
        
		$sqllo4="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('91','92') and b.kd_skpd='$id'";
                    $querylo4= $this->db->query($sqllo4);
                    $bello2 = $querylo4->row();
                    $bel_lo_lalu = $bello2->nilai;
                    $bel_lo_lalu1= number_format($bello2->nilai,"2",",",".");		

					$surplus_lo = $pen_lo - $bel_lo;
                    if ($surplus_lo < 0){
                    	$lo1="("; $surplus_lox=$surplus_lo*-1; $lo2=")";}
                    else {
                    	$lo1=""; $surplus_lox=$surplus_lo; $lo2="";}		
                    $surplus_lo1 = number_format($surplus_lox,"2",",",".");
                    
					$surplus_lo_lalu = $pen_lo_lalu - $bel_lo_lalu;
                    if ($surplus_lo_lalu < 0){
                    	$lo3="("; $surplus_lo_lalux=$surplus_lo_lalu*-1; $lo4=")";}
                    else {
                    	$lo3=""; $surplus_lo_lalux=$surplus_lo_lalu; $lo4="";}						
                    $surplus_lo_lalu1 = number_format($surplus_lo_lalux,"2",",",".");

					$selisih_surplus_lo = $surplus_lo - $surplus_lo_lalu;
                    if ($selisih_surplus_lo < 0){
                    	$lo5="("; $selisih_surplus_lox=$selisih_surplus_lo*-1; $lo6=")";}
                    else {
                    	$lo5=""; $selisih_surplus_lox=$selisih_surplus_lo; $lo6="";}
                    $selisih_surplus_lo1 = number_format($selisih_surplus_lox,"2",",",".");
                    
					if( $surplus_lo_lalu=='' or $surplus_lo_lalu==0){
					$persen2 = '0,00';
					}else{
					$persen2 = ($surplus_lo/$surplus_lo_lalu)*100;
					$persen2 = number_format($persen2,"2",",",".");
					}
					
		$sqllo5="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,2) in ('81','82','83','84') and b.kd_skpd='$id'";
                    $querylo5= $this->db->query($sqllo5);
                    $penlo3 = $querylo5->row();
                    $pen_lo3 = $penlo3->nilai;
                    $pen_lo31= number_format($penlo3->nilai,"2",",",".");
        
		$sqllo6="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('81','82','83','84') and b.kd_skpd='$id'";
                    $querylo6= $this->db->query($sqllo6);
                    $penlo4 = $querylo6->row();
                    $pen_lo_lalu4 = $penlo4->nilai;
                    $pen_lo_lalu41= number_format($penlo4->nilai,"2",",",".");
		
		$sqllo7="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,2) in ('91','92','93') and b.kd_skpd='$id'";
                    $querylo7= $this->db->query($sqllo7);
                    $bello5 = $querylo7->row();
                    $bel_lo5 = $bello5->nilai;
                    $bel_lo51= number_format($bello5->nilai,"2",",",".");
		
		$sqllo8="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('91','92','93') and b.kd_skpd='$id'";
                    $querylo8= $this->db->query($sqllo8);
                    $bello6 = $querylo8->row();
                    $bel_lo_lalu6 = $bello6->nilai;
                    $bel_lo_lalu61= number_format($bello6->nilai,"2",",",".");		

					$surplus_lo2 = $pen_lo3 - $bel_lo5;
                    if ($surplus_lo2 < 0){
                    	$lo7="("; $surplus_lo2x=$surplus_lo2*-1; $lo8=")";}
                    else {
                    	$lo7=""; $surplus_lo2x=$surplus_lo2; $lo8="";}		
                    $surplus_lo21 = number_format($surplus_lo2x,"2",",",".");
                    
					$surplus_lo_lalu2 = $pen_lo_lalu4 - $bel_lo_lalu6;
                    if ($surplus_lo_lalu2 < 0){
                    	$lo9="("; $surplus_lo_lalu2x=$surplus_lo_lalu2*-1; $lo10=")";}
                    else {
                    	$lo9=""; $surplus_lo_lalu2x=$surplus_lo_lalu2; $lo10="";}						
                    $surplus_lo_lalu21 = number_format($surplus_lo_lalu2x,"2",",",".");

					$selisih_surplus_lo2 = $surplus_lo2 - $surplus_lo_lalu2;
                    if ($selisih_surplus_lo2 < 0){
                    	$lo11="("; $selisih_surplus_lo2x=$selisih_surplus_lo2*-1; $lo12=")";}
                    else {
                    	$lo11=""; $selisih_surplus_lo2x=$selisih_surplus_lo2; $lo12="";}
                    $selisih_surplus_lo21 = number_format($selisih_surplus_lo2x,"2",",",".");
                    
					if( $surplus_lo_lalu2=='' or $surplus_lo_lalu2==0){
					$persen3 = '0,00';
					}else{
					$persen3 = ($surplus_lo2/$surplus_lo_lalu2)*100;
					$persen3 = number_format($persen3,"2",",",".");
					}
		
		$sqllo9="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('8') and b.kd_skpd='$id'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$id'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('9') and b.kd_skpd='$id'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$id'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    if ($surplus_lo3 < 0){
                    	$lo13="("; $surplus_lo3x=$surplus_lo3*-1; $lo14=")";}
                    else {
                    	$lo13=""; $surplus_lo3x=$surplus_lo3; $lo14="";}		
                    $surplus_lo31 = number_format($surplus_lo3x,"2",",",".");
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    if ($surplus_lo_lalu3 < 0){
                    	$lo15="("; $surplus_lo_lalu3x=$surplus_lo_lalu3*-1; $lo16=")";}
                    else {
                    	$lo15=""; $surplus_lo_lalu3x=$surplus_lo_lalu3; $lo16="";}						
                    $surplus_lo_lalu31 = number_format($surplus_lo_lalu3x,"2",",",".");

					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
                    if ($selisih_surplus_lo3 < 0){
                    	$lo17="("; $selisih_surplus_lo3x=$selisih_surplus_lo3*-1; $lo18=")";}
                    else {
                    	$lo17=""; $selisih_surplus_lo3x=$selisih_surplus_lo3; $lo18="";}
                    $selisih_surplus_lo31 = number_format($selisih_surplus_lo3x,"2",",",".");
                    
					if( $surplus_lo_lalu3=='' or $surplus_lo_lalu3==0){
					$persen4 = '0,00';
					}else{
					$persen4 = ($surplus_lo3/$surplus_lo_lalu3)*100;
					$persen4 = number_format($persen4,"2",",",".");
					}

					
		$sqllo13="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,2) in ('84') and b.kd_skpd='$id'";
                    $querylo13= $this->db->query($sqllo13);
                    $penlo11 = $querylo13->row();
                    $pen_lo11 = $penlo11->nilai;
                    $pen_lo111= number_format($penlo11->nilai,"2",",",".");
        
		$sqllo14="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('84') and b.kd_skpd='$id'";
                    $querylo14= $this->db->query($sqllo14);
                    $penlo12 = $querylo14->row();
                    $pen_lo_lalu12 = $penlo12->nilai;
                    $pen_lo_lalu121= number_format($penlo12->nilai,"2",",",".");
		
		$sqllo15="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,2) in ('93') and b.kd_skpd='$id'";
                    $querylo15= $this->db->query($sqllo15);
                    $bello13 = $querylo15->row();
                    $bel_lo13 = $bello13->nilai;
                    $bel_lo131= number_format($bello13->nilai,"2",",",".");
		
		$sqllo16="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('93') and b.kd_skpd='$id'";
                    $querylo16= $this->db->query($sqllo16);
                    $bello14 = $querylo16->row();
                    $bel_lo_lalu14 = $bello14->nilai;
                    $bel_lo_lalu141= number_format($bello14->nilai,"2",",",".");		

					$surplus_lo4 = $pen_lo11 - $bel_lo13;
                    if ($surplus_lo4 < 0){
                    	$lo19="("; $surplus_lo4x=$surplus_lo4*-1; $lo20=")";}
                    else {
                    	$lo19=""; $surplus_lo4x=$surplus_lo4; $lo20="";}		
                    $surplus_lo41 = number_format($surplus_lo4x,"2",",",".");
                    
					$surplus_lo_lalu4 = $pen_lo_lalu12 - $bel_lo_lalu14;
                    if ($surplus_lo_lalu4 < 0){
                    	$lo21="("; $surplus_lo_lalu4x=$surplus_lo_lalu4*-1; $lo22=")";}
                    else {
                    	$lo21=""; $surplus_lo_lalu4x=$surplus_lo_lalu4; $lo22="";}						
                    $surplus_lo_lalu41 = number_format($surplus_lo_lalu4x,"2",",",".");

					$selisih_surplus_lo4 = $surplus_lo4 - $surplus_lo_lalu4;
                    if ($selisih_surplus_lo4 < 0){
                    	$lo23="("; $selisih_surplus_lo4x=$selisih_surplus_lo4*-1; $lo24=")";}
                    else {
                    	$lo23=""; $selisih_surplus_lo4x=$selisih_surplus_lo4; $lo24="";}
                    $selisih_surplus_lo41 = number_format($selisih_surplus_lo4x,"2",",",".");
                    
					if( $surplus_lo_lalu4=='' or $surplus_lo_lalu4==0){
					$persen5 = '0,00';
					}else{
					$persen5 = ($surplus_lo4/$surplus_lo_lalu4)*100;
					$persen5 = number_format($persen5,"2",",",".");
					}
					
					
		$sqllo17="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,2) in ('85') and b.kd_skpd='$id'";
                    $querylo17= $this->db->query($sqllo17);
                    $penlo15 = $querylo17->row();
                    $pen_lo15 = $penlo15->nilai;
                    $pen_lo151= number_format($penlo15->nilai,"2",",",".");
        
		$sqllo18="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('85') and b.kd_skpd='$id'";
                    $querylo18= $this->db->query($sqllo18);
                    $penlo16 = $querylo18->row();
                    $pen_lo_lalu16 = $penlo16->nilai;
                    $pen_lo_lalu161= number_format($penlo16->nilai,"2",",",".");
		
		$sqllo19="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,2) in ('94') and b.kd_skpd='$id'";
                    $querylo19= $this->db->query($sqllo19);
                    $bello17 = $querylo19->row();
                    $bel_lo17 = $bello17->nilai;
                    $bel_lo171= number_format($bello17->nilai,"2",",",".");
		
		$sqllo20="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('94') and b.kd_skpd='$id'";
                    $querylo20= $this->db->query($sqllo20);
                    $bello18 = $querylo20->row();
                    $bel_lo_lalu18 = $bello18->nilai;
                    $bel_lo_lalu181= number_format($bello18->nilai,"2",",",".");		

					$surplus_lo5 = $pen_lo15 - $bel_lo17;
                    if ($surplus_lo5 < 0){
                    	$lo25="("; $surplus_lo5x=$surplus_lo5*-1; $lo26=")";}
                    else {
                    	$lo25=""; $surplus_lo5x=$surplus_lo5; $lo26="";}		
                    $surplus_lo51 = number_format($surplus_lo5x,"2",",",".");
                    
					$surplus_lo_lalu5 = $pen_lo_lalu16 - $bel_lo_lalu18;
                    if ($surplus_lo_lalu5 < 0){
                    	$lo27="("; $surplus_lo_lalu5x=$surplus_lo_lalu5*-1; $lo28=")";}
                    else {
                    	$lo27=""; $surplus_lo_lalu5x=$surplus_lo_lalu5; $lo28="";}						
                    $surplus_lo_lalu51 = number_format($surplus_lo_lalu5x,"2",",",".");

					$selisih_surplus_lo5 = $surplus_lo5 - $surplus_lo_lalu5;
                    if ($selisih_surplus_lo5 < 0){
                    	$lo29="("; $selisih_surplus_lo5x=$selisih_surplus_lo5*-1; $lo30=")";}
                    else {
                    	$lo29=""; $selisih_surplus_lo5x=$selisih_surplus_lo5; $lo30="";}
                    $selisih_surplus_lo51 = number_format($selisih_surplus_lo5x,"2",",",".");
                    
					if( $surplus_lo_lalu5=='' or $surplus_lo_lalu5==0){
					$persen6 = '0,00';
					}else{
					$persen6 = ($surplus_lo5/$surplus_lo_lalu5)*100;
					$persen6 = number_format($persen6,"2",",",".");
					}			
					
        $cRet='';
		
        $modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong> $nm_skpd</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>LAPORAN OPERASIONAL </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$bulan] $thn_ang DAN $thn_ang_1</strong></td>
                    </tr>
					<tr>
                         <td align=\"center\"><strong>&nbsp</strong></td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  colspan =\"6\"bgcolor=\"#CCCCCC\" width=\"60%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>$thn_ang_1</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" ><b>Kenaikan</br>(Penurunan)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td colspan =\"6\"style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td colspan =\"6\"style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"60%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                        </tr>";

        $sqlmaplo="SELECT seq, nor, uraian, isnull(kode_1,'-') as kode_1, isnull(kode_2,'-') as kode_2, isnull(kode_3,'-') as kode_3, isnull(cetak,'debet-debet') as cetak FROM map_lo_ppkd_prov 
				   GROUP BY seq, nor, uraian, isnull(kode_1,'-'), isnull(kode_2,'-'), isnull(kode_3,'-'), isnull(cetak,'debet-debet') ORDER BY seq";
				   
                $querymaplo = $this->db->query($sqlmaplo);
                $no     = 0;                                  
               
                foreach ($querymaplo->result() as $loquery)
                {
                    
                    $nama      = $loquery->uraian;   
                    $n         = $loquery->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$n2         = $loquery->kode_2;
					$n2		   = ($n2=="-"?"'-'":$n2);
					$n3         = $loquery->kode_3;
					$n3		   = ($n3=="-"?"'-'":$n3);
					$normal    = $loquery->cetak;
					
		$quelo01   = "SELECT SUM($normal) as nilai FROM trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE (left(kd_rek5,3) in ($n) or left(kd_rek5,5) in ($n2) or left(kd_rek5,7) in ($n3)) and year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and b.kd_skpd='$id'";
                    $quelo02 = $this->db->query($quelo01);
                    $quelo03 = $quelo02->row();
                    $nil     = $quelo03->nilai;
                    $nilai    = number_format($quelo03->nilai,"2",",",".");
					
		$quelo04   = "SELECT SUM($normal) as nilai FROM trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE (left(kd_rek5,3) in ($n) or left(kd_rek5,5) in ($n2) or left(kd_rek5,7) in ($n3)) and year(tgl_voucher)=$thn_ang_1 and b.kd_skpd='$id'";
                    $quelo05 = $this->db->query($quelo04);
                    $quelo06 = $quelo05->row();
                    $nil_lalu     = $quelo06->nilai;
                    $nilai_lalu    = number_format($quelo06->nilai,"2",",",".");
					
                    $real_nilai = $nil - $nil_lalu;
                    if ($real_nilai < 0){
                    	$lo0="("; $real_nilaix=$real_nilai*-1; $lo00=")";}
                    else {
                    	$lo0=""; $real_nilaix=$real_nilai; $lo00="";}
                    $real_nilai1 = number_format($real_nilaix,"2",",",".");
                    
					if( $nil_lalu=='' or $nil_lalu==0){
					$persen1 = '0,00';
					}else{
					$persen1 = ($nil/$nil_lalu)*100;
					$persen1 = number_format($persen1,"2",",",".");
					}
                    $no       = $no + 1;
                    switch ($loquery->seq) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 30:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 35:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 40:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 45:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 70:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 75:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 80:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 95:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 100:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 105:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 125:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 130:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 135:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 140:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 145:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 170:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 175:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 180:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 210:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 215:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 220:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 225:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo1$surplus_lo1$lo2</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo3$surplus_lo_lalu1$lo4</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo5$selisih_surplus_lo1$lo6</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen2</td>
                                 </tr>";
                        break;
					case 230:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 235:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 240:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 260:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 265:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 270:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 290:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 295:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo19$surplus_lo41$lo20</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo21$surplus_lo_lalu41$lo22</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo23$selisih_surplus_lo41$lo24</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen5</td>
                                 </tr>";
                        break;
					case 300:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 305:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo7$surplus_lo21$lo8</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo9$surplus_lo_lalu21$lo10</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo11$selisih_surplus_lo21$lo12</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen3</td>
                                 </tr>";
                        break;
					case 310:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 315:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 320:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 330:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 335:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"60%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 340:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 350:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;
					case 355:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo25$surplus_lo51$lo26</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo27$surplus_lo_lalu51$lo28</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo29$selisih_surplus_lo51$lo30</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen6</td>
                                 </tr>";
                        break;
					case 360:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 365:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo13$surplus_lo31$lo14</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo15$surplus_lo_lalu31$lo16</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo17$selisih_surplus_lo31$lo18</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen4</td>
                                 </tr>";
                        break;	
					default:
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
               
				}
                              
                    
                }
				
       // $cRet         .= "</table>";
//        $data['prev']  = $cRet;
//        $data['sikap'] = 'preview';
//        
//        
//        
//        $this->template->set('title', 'LAPORAN OPERASIONAL'); 
//        $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
        //$this->template->load('template','anggaran/rka/perkadaII',$data); 
        
        $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = 'LO PPKD $bulan';
        $this->template->set('title', 'LO PPKD $bulan');        
        switch($pilih) {       
        case 1;
			 echo ("<title>LO PPKD $bulan</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        } 
        
                 
    }
    
	function rpt_neraca_obyek($cbulan="", $pilih=1){
	        $id   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;
			
			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$id' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
			$modtahun= $thn_ang%4;
	 
			if ($modtahun = 0){
				$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
					else {
				$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
			 
			$arraybulan=explode(".",$nilaibulan);
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER $arraybulan[$cbulan] $thn_ang DAN $thn_ang_1 </strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td colspan =\"7\" bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td colspan =\"7\" style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td colspan =\"7\" style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1, isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT isnull(SUM(a.debet),0) AS debet, isnull(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE kd_skpd<>'$id' AND a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1, isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1, isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
					
			$eku 		= $sal_akhir + $rk_ppkd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, seq, bold, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_skpd_obyek ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				$bold=$res['bold'];
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(a.kd_skpd,7)=left('$id',7) and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='D'){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and left(a.kd_skpd,7)=left('$id',7) and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal=='D'){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['bold']) {
                    case 1:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"7\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 2:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 3:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 4:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 6:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 7:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
					    break;
					case 11:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c$sal_akhir1$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>
                                 </tr>";
                        break;		
					case 12:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min003$eku1$min004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 13:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min007$eku_tang1$min008</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;
					}
				
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA SKPD $id / $cbulan");
        $this->template->set('title', ("NERACA SKPD $id / $cbulan"));  
         switch ($pilih)
        {
            case 1;
				echo ("<title>NERACA SKPD $cbulan</title>");
				echo $cRet;
				break;
            case 0;
               $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}
	
	function rpt_neraca_unit_obyek($cbulan="", $kd_skpd="", $pilih=1){
	        $id   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;
			
			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
			$modtahun= $thn_ang%4;
	 
			if ($modtahun = 0){
				$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
					else {
				$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
			 
			$arraybulan=explode(".",$nilaibulan);
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER $arraybulan[$cbulan] $thn_ang DAN $thn_ang_1 </strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td colspan =\"7\" bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td colspan =\"7\" style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td colspan =\"7\" style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT isnull(SUM(a.debet),0) AS debet, isnull(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
					
			$eku 		= $sal_akhir + $rk_ppkd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, bold, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_skpd_obyek ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				$bold=$res['bold'];
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd ='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='D'){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and a.kd_skpd ='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal=='D'){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['bold']) {
                    case 1:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"7\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 2:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 3:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 4:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 6:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 7:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
					    break;
					case 11:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c$sal_akhir1$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>
                                 </tr>";
                        break;		
					case 12:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min003$eku1$min004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 13:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min007$eku_tang1$min008</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;
					}
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA UNIT $kd_skpd / $cbulan");
        $this->template->set('title', ("NERACA UNIT $kd_skpd / $cbulan"));  
         switch ($pilih)
        {
            case 1;
				echo ("<title>NERACA UNIT $cbulan</title>");
				echo $cRet;
				break;
            case 0;
               $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}

	function rpt_neraca_awal_obyek($cbulan="", $pilih=1){
	        $id   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;
			
			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$id' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
			$modtahun= $thn_ang%4;
	 
			if ($modtahun = 0){
				$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
					else {
				$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
			 
			$arraybulan=explode(".",$nilaibulan);
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA AWAL</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER 1 JANUARI $thn_ang</strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td colspan =\"7\" bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>JUMLAH</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td colspan =\"7\" style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td colspan =\"7\" style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT isnull(SUM(a.debet),0) AS debet, isnull(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE kd_skpd<>'$id' AND a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1, isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1, isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
					
			$eku 		= $sal_akhir + $rk_ppkd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, seq, bold, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_skpd_obyek ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				$bold=$res['bold'];
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(a.kd_skpd,7)=left('$id',7) and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='D'){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and left(a.kd_skpd,7)=left('$id',7) and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal=='D'){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['bold']) {
                    case 1:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"7\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 2:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 3:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 4:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 6:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 7:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
					    break;
					case 11:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>
                                 </tr>";
                        break;		
					case 12:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 13:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;
					}
				
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA SKPD $id / $cbulan");
        $this->template->set('title', ("NERACA SKPD $id / $cbulan"));  
         switch ($pilih)
        {
            case 1;
				echo ("<title>NERACA SKPD $cbulan</title>");
				echo $cRet;
				break;
            case 0;
               $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}

	function rpt_neraca_awal_unit_obyek($cbulan="", $kd_skpd="", $pilih=1){
	        $id   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;
			
			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
			$modtahun= $thn_ang%4;
	 
			if ($modtahun = 0){
				$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
					else {
				$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
			 
			$arraybulan=explode(".",$nilaibulan);
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA AWAL</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER 1 JANUARI $thn_ang</strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td colspan =\"7\" bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>JUMLAH</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td colspan =\"7\" style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td colspan =\"7\" style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT isnull(SUM(a.debet),0) AS debet, isnull(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
					
			$eku 		= $sal_akhir + $rk_ppkd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, bold, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_skpd_obyek ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				$bold=$res['bold'];
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd ='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='D'){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and a.kd_skpd ='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal=='D'){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['bold']) {
                    case 1:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"7\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 2:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 3:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 4:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 6:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 7:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
					    break;
					case 11:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>
                                 </tr>";
                        break;		
					case 12:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 13:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;
					}
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA UNIT $kd_skpd / $cbulan");
        $this->template->set('title', ("NERACA UNIT $kd_skpd / $cbulan"));  
         switch ($pilih)
        {
            case 1;
				echo ("<title>NERACA UNIT $cbulan</title>");
				echo $cRet;
				break;
            case 0;
               $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}

	
	function rpt_neraca_awal($cbulan="", $pilih=1){
	        $id   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;
			
			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$id' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
			$modtahun= $thn_ang%4;
	 
			if ($modtahun = 0){
				$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
					else {
				$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
			 
			$arraybulan=explode(".",$nilaibulan);
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA AWAL</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER 1 JANUARI $thn_ang </strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>JUMLAH</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1, isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT isnull(SUM(a.debet),0) AS debet, isnull(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE kd_skpd<>'$id' AND a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1, isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1, isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
					
			$eku 		= $sal_akhir + $rk_ppkd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
			$queryneraca = "SELECT kode, uraian, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_skpd ORDER BY seq";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query("SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%')");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='D'){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and kd_skpd<>'$id' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal=='D'){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['seq']) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 65:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 70:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 170:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 300:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 320:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 340:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 370:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 375:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 378:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 380:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 385:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 410:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 415:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 420:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 460:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 465:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>
                                 </tr>";
                        break;
					case 470:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min009$rk_ppkd_lalu1$min010</td>
                                 </tr>";
						break;		 
					case 475:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 485:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;	
					default:	
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					}
				
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA AWAL SKPD Keseluruhan / $cbulan");
        $this->template->set('title', 'NERACA AWAL SKPD Keseluruhan / $cbulan');  
         switch ($pilih)
        {
            case 1;
				echo ("<title>NERACA AWAL SKPD $cbulan</title>");
				echo $cRet;
				break;
            case 0;
               $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}

	
	function rpt_neraca_awal_unit($cbulan="", $kd_skpd="", $pilih=1){
	        $id   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;
			
			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
			$modtahun= $thn_ang%4;
	 
			if ($modtahun = 0){
				$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
					else {
				$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
			 
			$arraybulan=explode(".",$nilaibulan);
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA AWAL</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER 1 JANUARI $thn_ang</strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>JUMLAH</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT isnull(SUM(a.debet),0) AS debet, isnull(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1, isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
					
			$eku 		= $sal_akhir + $rk_ppkd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_skpd ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd ='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='D'){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and a.kd_skpd ='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal=='D'){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['seq']) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 65:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 70:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 170:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 300:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 320:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 340:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 370:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 375:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 378:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 380:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 385:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 410:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 415:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 420:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 460:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 465:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>
                                 </tr>";
                        break;
					case 470:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min009$rk_ppkd_lalu1$min010</td>
                                 </tr>";
						break;		 
					case 475:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 485:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;	
					default:	
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					}
				
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA AWAL UNIT $kd_skpd / $cbulan");
        $this->template->set('title', 'NERACA AWAL UNIT $kd_skpd / $cbulan');  
         switch ($pilih)
        {
            case 1;
				echo ("<title>NERACA AWAL UNIT $cbulan</title>");
				echo $cRet;
				break;
            case 0;
               $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}

	
	
	function cetak_lra_unit($cbulan="", $kd_skpd="", $pilih=1){
	$id  = $this->session->userdata('kdskpd');
    $thn = $this->session->userdata('pcThang');
	
	if($cbulan== 12){
	$sumber_data= "_at";
	}else{
	$sumber_data= "";
	}
	
	$sqlanggaran1="select case when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_ubah) then 2 
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_sempurna) and $cbulan<month(tgl_dpa_ubah) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan>=month(tgl_dpa_sempurna) then 1 
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=0 and status_ubah=0 and $cbulan>=month(tgl_dpa) then 1
					   else 1 end as anggaran from trhrka where kd_skpd='$kd_skpd'";
    $sqlanggaran=$this->db->query($sqlanggaran1);
	foreach ($sqlanggaran->result() as $rowttd)
        {
            $anggaran=$rowttd->anggaran;
        }

	$ag_tox=$anggaran;
	 
	 

    //function cetak_lra(){
        $sql41="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,1)='4' and kd_skpd='$kd_skpd' ";
                    $query41 = $this->db->query($sql41);
                    $jmlp = $query41->row();
                    $jmlpendapatan = $jmlp->nilai;
                    $jmlangpendapatan = $jmlp->anggaran;
                    $jmlangpendapatan1= number_format($jmlp->anggaran,"2",",",".");
                    $jmlpendapatan1= number_format($jmlp->nilai,"2",",",".");
                    
					$real_pend = $jmlangpendapatan - $jmlpendapatan;
                    if ($real_pend < 0){
                    	$x001="("; $real_pendx=$real_pend*-1; $y001=")";}
                    else {
                    	$x001=""; $real_pendx=$real_pend; $y001="";}
                    $selisihpend = number_format($real_pendx,"2",",",".");
                    if ($jmlpendapatan==0){
                        $tmp001=1;
                    }else{
                        $tmp001=$jmlpendapatan;
                    }
					
                    $per001     = ($jmlangpendapatan!=0)?($jmlpendapatan / $jmlangpendapatan ) * 100:0; 
                    $persen001  = number_format($per001,"2",",",".");
					
        $sql51="SELECT SUM(anggaran) as angaran,SUM(real_spj)as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,1) in ('5','6') and kd_skpd='$kd_skpd' ";
                    $query51 = $this->db->query($sql51);
                    $jmlb = $query51->row();
                    $jmlangbelanja = $jmlb->angaran;
                    $jmlbelanja = $jmlb->nilai;
                    $jmlbelanja1= number_format($jmlb->nilai,"2",",",".");
                    $jmlangbelanja1= number_format($jmlb->angaran,"2",",",".");
					
					$real_belanja = $jmlangbelanja - $jmlbelanja;
                    if ($real_belanja < 0){
                    	$x002="("; $real_belanjax=$real_belanja*-1; $y002=")";}
                    else {
                    	$x002=""; $real_belanjax=$real_belanja; $y002="";}
                    $selisihbelanja = number_format($real_belanjax,"2",",",".");
                    if ($jmlbelanja==0){
                        $tmp002=1;
                    }else{
                        $tmp002=$jmlbelanja;
                    }
					
                    $per002     = ($jmlangbelanja!=0)?($jmlbelanja / $jmlangbelanja ) * 100:0; 
                    $persen002  = number_format($per002,"2",",",".");
					
        $sql523="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,3)='523' and kd_skpd='$kd_skpd' ";
                    $query523 = $this->db->query($sql523);
                    $jmlbm = $query523->row();
                    $jmlbmbelanja = $jmlbm->nilai;
                    $jmlangbmbelanja = $jmlbm->anggaran;
                    $jmlbmbelanja1= number_format($jmlbmbelanja,"2",",",".");
                    $jmlangbmbelanja1= number_format($jmlangbmbelanja,"2",",",".");
        $sql61="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='71' and kd_skpd='$kd_skpd' ";
                    $query61 = $this->db->query($sql61);
                    $jmlpm = $query61->row();
                    $jmlpmasuk = $jmlpm->nilai;
                    $jmlangpmasuk = $jmlpm->anggaran;
        $sql62="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='72' and kd_skpd='$kd_skpd' ";
                    $query62 = $this->db->query($sql62);
                    $jmlpk = $query62->row();
                    $jmlpkeluar = $jmlpk->nilai;
                    $jmlangpkeluar = $jmlpk->anggaran;
        $surplus =  $jmlpendapatan- $jmlbelanja;
        $angsurplus = $jmlangpendapatan- $jmlangbelanja;        
        if ($surplus < 0){
                    	$x="("; $surplusx=$surplus*-1; $y=")";
                        }else {
                    	$x=""; $surplusx=$surplus; $y="";
                        }
        if ($angsurplus < 0){
                    	$e="("; $angsurplusx=$angsurplus*-1; $f=")";
                        }else {
                    	$e=""; $angsurplusx=$angsurplus; $f="";
                        }
        $surplus1= number_format($surplusx,"2",",",".");
        $angsurplus1= number_format($angsurplusx,"2",",",".");
		
		$real_surplus = $angsurplus - $surplus;
                    if ($real_surplus < 0){
                    	$x003="("; $real_surplusx=$real_surplus*-1; $y003=")";}
                    else {
                    	$x003=""; $real_surplusx=$real_surplus; $y003="";}
        $selisihsurplus = number_format($real_surplusx,"2",",",".");
                    if ($surplus==0){
                        $tmp003=1;
                    }else{
                        $tmp003=$surplus;
                    }
					
                    $per003     = ($angsurplus!=0)?($surplus / $angsurplus ) * 100:0; 
                    $persen003  = number_format($per003,"2",",",".");
		
        $biaya_net =  $jmlpmasuk- $jmlpkeluar;
        $angbiaya_net =  $jmlangpmasuk- $jmlangpkeluar;        
        if ($biaya_net < 0){
                    	$a="("; $biaya_netx=$biaya_net*-1; $b=")";
                        }else {
                    	$a=""; $biaya_netx=$biaya_net; $b="";
                        }
        if ($angbiaya_net < 0){
                    	$g="("; $angbiaya_netx=$angbiaya_net*-1; $h=")";
                        }else {
                    	$g=""; $angbiaya_netx=$angbiaya_net; $h="";
                        }
        $biaya_net1 =   number_format($biaya_netx,"2",",",".");
        $angbiaya_net1 =   number_format($angbiaya_netx,"2",",",".");
        $silpa= ($jmlpendapatan+$jmlpmasuk)-($jmlbelanja+$jmlpkeluar);
        $angsilpa= ($jmlangpendapatan+$jmlangpmasuk)-($jmlangbelanja+$jmlangpkeluar);                
        if ($silpa < 0){
                    	$c="("; $silpax=$silpa*-1; $d=")";
                        }else {
                    	$c=""; $silpax=$silpa; $d="";
                        }
        if ($angsilpa < 0){
                    	$i="("; $angsilpax=$angsilpa*-1; $j=")";
                        }else {
                    	$i=""; $angsilpax=$angsilpa; $j="";
                        }
        $silpa1 =number_format($silpax,"2",",","."); 
        $angsilpa1 =number_format($angsilpax,"2",",",".");
       $sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
		$nm_skpd	= strtoupper ($nmskpd);
        $jk=$this->rka_model->combo_skpd();
       
        $cRet='';
        
	 $modtahun= $thn%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>					
                    <tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan] $thn</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>ANGGARAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>LEBIH</br>(KURANG)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                        </tr>";
               
                   $sql4="SELECT a.seq,a.nor,a.uraian,isnull(a.kode_1,'-') as kode_1,isnull(a.kode_2,'-') as kode_2,isnull(a.kode_3,'-') as kode_3,thn_m1 AS lalu FROM map_lra_skpd a 
				   GROUP BY a.seq,a.nor,a.uraian,isnull(a.kode_1,'-'),isnull(a.kode_2,'-'),isnull(a.kode_3,'-'),thn_m1 ORDER BY a.seq";
                // isnull(a.kode_1,\"'-'\")
                $query4 = $this->db->query($sql4);
                $no     = 0;                                  
               
                foreach ($query4->result() as $row4)
                {
                    
                    $nama      = $row4->uraian;   
                    $real_lalu = number_format($row4->lalu,"2",",",".");
                    $n         = $row4->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$n2         = $row4->kode_2;
					$n2		   = ($n2=="-"?"'-'":$n2);
					$n3         = $row4->kode_3;
					$n3		   = ($n3=="-"?"'-'":$n3);

//                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi( $bulan,$ag_tox) b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (".$n.") ";
                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) b WHERE kd_skpd='$kd_skpd' and (left(b.kd_rek5,3) in ($n) or left(b.kd_rek5,5) in ($n2) or left(b.kd_rek5,7) in ($n3))";
//					                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM realisasi b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (\"'.$n.'\") ";
                    $query5 = $this->db->query($sql5);
                    $trh    = $query5->row();
                    $nil    = $trh->nilai;
                    $angnil = $trh->anggaran;
                    
                    $real_s = $trh->anggaran - $trh->nilai;
                    if ($real_s < 0){
                    	$x1="("; $real_sx=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $real_sx=$real_s; $y1="";}
                    $selisih = number_format($real_sx,"2",",",".");
                    if ($trh->nilai==0){
                        $tmp=1;
                    }else{
                        $tmp=$trh->nilai;
                    }
                    $nilai    = number_format($trh->nilai,"2",",",".");
                    $angnilai = number_format($trh->anggaran,"2",",",".");
                    $per1     = ($angnil!=0)?($nil / $angnil ) * 100:0; 
                    $persen1  = number_format($per1,"2",",",".");
                    $no       = $no + 1;
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;					
					case 35:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 40:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlangpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x001$selisihpend$y001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen001</td>
                                 </tr>";
                        break;
					case 45:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 50:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td	 style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 55:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 70:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;						
					case 75:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 80:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;						
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 120:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlangbelanja1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlbelanja1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x002$selisihbelanja$y002</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen002</td>
                                 </tr>";
                        break;
					case 125:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 130:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$e$angsurplus1$f</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$x$surplus1$y</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x003$selisihsurplus$y003</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen003</td>
                                 </tr>";
                        break;
                   
                    default:
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                }
                }
        $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LRA UNIT $kd_skpd / $cbulan");
        $this->template->set('title', 'LRA UNIT $kd_skpd / $cbulan');        
        switch($pilih) {       
        case 1;
			echo ("<title>LRA UNIT $cbulan</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        } 
    }
    
	
    function cetak_lra($cbulan="", $pilih=1){
	$id  = $this->session->userdata('kdskpd');
    $thn = $this->session->userdata('pcThang');
	
	if($cbulan== 12){
	$sumber_data= "_at";
	}else{
	$sumber_data= "";
	}
	
	$sqlanggaran1="select case when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_ubah) then 2 
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_sempurna) and $cbulan<month(tgl_dpa_ubah) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan>=month(tgl_dpa_sempurna) then 1 
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=0 and status_ubah=0 and $cbulan>=month(tgl_dpa) then 1
					   else 1 end as anggaran from trhrka where kd_skpd='$id'";
    $sqlanggaran=$this->db->query($sqlanggaran1);
	foreach ($sqlanggaran->result() as $rowttd)
        {
            $anggaran=$rowttd->anggaran;
        }

	$ag_tox=$anggaran;
	 
	 

    //function cetak_lra(){
        $sql41="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,1)='4' and kd_skpd<>'$id' ";
                    $query41 = $this->db->query($sql41);
                    $jmlp = $query41->row();
                    $jmlpendapatan = $jmlp->nilai;
                    $jmlangpendapatan = $jmlp->anggaran;
                    $jmlangpendapatan1= number_format($jmlp->anggaran,"2",",",".");
                    $jmlpendapatan1= number_format($jmlp->nilai,"2",",",".");
                    
					$real_pend = $jmlangpendapatan - $jmlpendapatan;
                    if ($real_pend < 0){
                    	$x001="("; $real_pendx=$real_pend*-1; $y001=")";}
                    else {
                    	$x001=""; $real_pendx=$real_pend; $y001="";}
                    $selisihpend = number_format($real_pendx,"2",",",".");
                    if ($jmlpendapatan==0){
                        $tmp001=1;
                    }else{
                        $tmp001=$jmlpendapatan;
                    }
					
                    $per001     = ($jmlangpendapatan!=0)?($jmlpendapatan / $jmlangpendapatan ) * 100:0; 
                    $persen001  = number_format($per001,"2",",",".");
					
        $sql51="SELECT SUM(anggaran) as angaran,SUM(real_spj)as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,1) in ('5','6') and kd_skpd<>'$id' ";
                    $query51 = $this->db->query($sql51);
                    $jmlb = $query51->row();
                    $jmlangbelanja = $jmlb->angaran;
                    $jmlbelanja = $jmlb->nilai;
                    $jmlbelanja1= number_format($jmlb->nilai,"2",",",".");
                    $jmlangbelanja1= number_format($jmlb->angaran,"2",",",".");
					
					$real_belanja = $jmlangbelanja - $jmlbelanja;
                    if ($real_belanja < 0){
                    	$x002="("; $real_belanjax=$real_belanja*-1; $y002=")";}
                    else {
                    	$x002=""; $real_belanjax=$real_belanja; $y002="";}
                    $selisihbelanja = number_format($real_belanjax,"2",",",".");
                    if ($jmlbelanja==0){
                        $tmp002=1;
                    }else{
                        $tmp002=$jmlbelanja;
                    }
					
                    $per002     = ($jmlangbelanja!=0)?($jmlbelanja / $jmlangbelanja ) * 100:0; 
                    $persen002  = number_format($per002,"2",",",".");
					
        $sql523="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,3)='523' and kd_skpd<>'$id' ";
                    $query523 = $this->db->query($sql523);
                    $jmlbm = $query523->row();
                    $jmlbmbelanja = $jmlbm->nilai;
                    $jmlangbmbelanja = $jmlbm->anggaran;
                    $jmlbmbelanja1= number_format($jmlbmbelanja,"2",",",".");
                    $jmlangbmbelanja1= number_format($jmlangbmbelanja,"2",",",".");
        $sql61="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='71' and kd_skpd<>'$id' ";
                    $query61 = $this->db->query($sql61);
                    $jmlpm = $query61->row();
                    $jmlpmasuk = $jmlpm->nilai;
                    $jmlangpmasuk = $jmlpm->anggaran;
        $sql62="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='72' and kd_skpd<>'$id' ";
                    $query62 = $this->db->query($sql62);
                    $jmlpk = $query62->row();
                    $jmlpkeluar = $jmlpk->nilai;
                    $jmlangpkeluar = $jmlpk->anggaran;
        $surplus =  $jmlpendapatan- $jmlbelanja;
        $angsurplus = $jmlangpendapatan- $jmlangbelanja;        
        if ($surplus < 0){
                    	$x="("; $surplusx=$surplus*-1; $y=")";
                        }else {
                    	$x=""; $surplusx=$surplus; $y="";
                        }
        if ($angsurplus < 0){
                    	$e="("; $angsurplusx=$angsurplus*-1; $f=")";
                        }else {
                    	$e=""; $angsurplusx=$angsurplus; $f="";
                        }
        $surplus1= number_format($surplusx,"2",",",".");
        $angsurplus1= number_format($angsurplusx,"2",",",".");
		
		$real_surplus = $angsurplus - $surplus;
                    if ($real_surplus < 0){
                    	$x003="("; $real_surplusx=$real_surplus*-1; $y003=")";}
                    else {
                    	$x003=""; $real_surplusx=$real_surplus; $y003="";}
        $selisihsurplus = number_format($real_surplusx,"2",",",".");
                    if ($surplus==0){
                        $tmp003=1;
                    }else{
                        $tmp003=$surplus;
                    }
					
                    $per003     = ($angsurplus!=0)?($surplus / $angsurplus ) * 100:0; 
                    $persen003  = number_format($per003,"2",",",".");
		
        $biaya_net =  $jmlpmasuk- $jmlpkeluar;
        $angbiaya_net =  $jmlangpmasuk- $jmlangpkeluar;        
        if ($biaya_net < 0){
                    	$a="("; $biaya_netx=$biaya_net*-1; $b=")";
                        }else {
                    	$a=""; $biaya_netx=$biaya_net; $b="";
                        }
        if ($angbiaya_net < 0){
                    	$g="("; $angbiaya_netx=$angbiaya_net*-1; $h=")";
                        }else {
                    	$g=""; $angbiaya_netx=$angbiaya_net; $h="";
                        }
        $biaya_net1 =   number_format($biaya_netx,"2",",",".");
        $angbiaya_net1 =   number_format($angbiaya_netx,"2",",",".");
        $silpa= ($jmlpendapatan+$jmlpmasuk)-($jmlbelanja+$jmlpkeluar);
        $angsilpa= ($jmlangpendapatan+$jmlangpmasuk)-($jmlangbelanja+$jmlangpkeluar);                
        if ($silpa < 0){
                    	$c="("; $silpax=$silpa*-1; $d=")";
                        }else {
                    	$c=""; $silpax=$silpa; $d="";
                        }
        if ($angsilpa < 0){
                    	$i="("; $angsilpax=$angsilpa*-1; $j=")";
                        }else {
                    	$i=""; $angsilpax=$angsilpa; $j="";
                        }
        $silpa1 =number_format($silpax,"2",",","."); 
        $angsilpa1 =number_format($angsilpax,"2",",",".");
       $sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$id' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
		$nm_skpd	= strtoupper ($nmskpd);
        $jk=$this->rka_model->combo_skpd();
       
        $cRet='';
        
	 $modtahun= $thn%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>					
                    <tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan] $thn</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>ANGGARAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>LEBIH</br>(KURANG)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                        </tr>";
               
                   $sql4="SELECT a.seq,a.nor,a.uraian,isnull(a.kode_1,'-') as kode_1,isnull(a.kode_2,'-') as kode_2,isnull(a.kode_3,'-') as kode_3,thn_m1 AS lalu FROM map_lra_skpd a 
				   GROUP BY a.seq,a.nor,a.uraian,isnull(a.kode_1,'-'),isnull(a.kode_2,'-'),isnull(a.kode_3,'-'),thn_m1 ORDER BY a.seq";
                // isnull(a.kode_1,\"'-'\")
                $query4 = $this->db->query($sql4);
                $no     = 0;                                  
               
                foreach ($query4->result() as $row4)
                {
                    
                    $nama      = $row4->uraian;   
                    $real_lalu = number_format($row4->lalu,"2",",",".");
                    $n         = $row4->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$n2         = $row4->kode_2;
					$n2		   = ($n2=="-"?"'-'":$n2);
					$n3         = $row4->kode_3;
					$n3		   = ($n3=="-"?"'-'":$n3);

//                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi( $bulan,$ag_tox) b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (".$n.") ";
                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) b WHERE kd_skpd<>'$id' and (left(b.kd_rek5,3) in ($n) or left(b.kd_rek5,5) in ($n2) or left(b.kd_rek5,7) in ($n3))";
//					                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM realisasi b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (\"'.$n.'\") ";
                    $query5 = $this->db->query($sql5);
                    $trh    = $query5->row();
                    $nil    = $trh->nilai;
                    $angnil = $trh->anggaran;
                    
                    $real_s = $trh->anggaran - $trh->nilai;
                    if ($real_s < 0){
                    	$x1="("; $real_sx=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $real_sx=$real_s; $y1="";}
                    $selisih = number_format($real_sx,"2",",",".");
                    if ($trh->nilai==0){
                        $tmp=1;
                    }else{
                        $tmp=$trh->nilai;
                    }
                    $nilai    = number_format($trh->nilai,"2",",",".");
                    $angnilai = number_format($trh->anggaran,"2",",",".");
                    $per1     = ($angnil!=0)?($nil / $angnil ) * 100:0; 
                    $persen1  = number_format($per1,"2",",",".");
                    $no       = $no + 1;
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;					
					case 35:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 40:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlangpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x001$selisihpend$y001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen001</td>
                                 </tr>";
                        break;
					case 45:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 50:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td	 style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 55:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 70:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;						
					case 75:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 80:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                        break;						
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 120:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlangbelanja1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlbelanja1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x002$selisihbelanja$y002</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen002</td>
                                 </tr>";
                        break;
					case 125:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 130:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$e$angsurplus1$f</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$x$surplus1$y</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x003$selisihsurplus$y003</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen003</td>
                                 </tr>";
                        break;
                   
                    default:
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$persen1</td>
                                 </tr>";
                }
                }
        $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LRA SKPD Keseluruhan / $cbulan");
        $this->template->set('title', 'LRA SKPD Keseluruhan / $cbulan');        
        switch($pilih) {       
        case 1;
			echo ("<title>LRA SKPD $cbulan</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
		case 4;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
    }
    
	function cetak_lra_pemda_unit($cbulan="", $kd_skpd="", $cetak=1){ 
	$bulan=$cbulan;
	$id  = $this->session->userdata('kdskpd');
    $thn = $this->session->userdata('pcThang');
	
	if($cbulan== 12){
	$sumber_data= "_at";
	}else{
	$sumber_data= "";
	}
	
	$sumber_skpd= "_unit";
	
	$sqlanggaran1="select case when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_ubah) then 2 
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_sempurna) and $cbulan<month(tgl_dpa_ubah) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan>=month(tgl_dpa_sempurna) then 1 
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=0 and status_ubah=0 and $cbulan>=month(tgl_dpa) then 1
					   else 1 end as anggaran from trhrka where kd_skpd='$kd_skpd'";
    $sqlanggaran=$this->db->query($sqlanggaran1);
	foreach ($sqlanggaran->result() as $rowttd)
        {
            $anggaran=$rowttd->anggaran;
        }

	$ag_tox=$anggaran;
	

    //function cetak_lra(){
		
		$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
		
		$nm_skpd	= strtoupper ($nmskpd);
        $jk=$this->rka_model->combo_skpd();
       
        $cRet='';
        
	 $modtahun= $thn%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
	   
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA DAERAH</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>
                    </tr>
					<tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN</strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong> $arraybulan[$bulan] $thn</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>ANGGARAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>LEBIH</br>(KURANG)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                        </tr>";
               
                   $sql4="SELECT a.seq,a.cetak,a.bold,a.parent,a.nor,isnull(a.uraian,'') uraian,isnull(a.kode_1,'-') as kode_1,isnull(a.kode_2,'-') as kode_2,isnull(a.kode_3,'-') as kode_3,thn_m1 AS lalu FROM map_lra_prov a 
						  ORDER BY a.seq";
                // isnull(a.kode_1,\"'-'\")
                $query4 = $this->db->query($sql4);
                $no     = 0;                                  
               
                foreach ($query4->result() as $row4)
                {
                    $normal      = $row4->cetak;   	
                    $bold      = $row4->bold;   	
                    $parent      = $row4->parent;   	
                    $nama      = $row4->uraian;
                    $real_lalu = number_format($row4->lalu,"2",",",".");
                    $n         = $row4->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$n2         = $row4->kode_2;
					$n2		   = ($n2=="-"?"'-'":$n2);
					$n3         = $row4->kode_3;
					$n3		   = ($n3=="-"?"'-'":$n3);

//                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi( $bulan,$ag_tox) b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (".$n.") ";
                    $sql5   = "SELECT SUM(case when LEFT(kd_rek5,2) in ('51','52','53','61','62','72') and $parent=1 then b.anggaran*-1 else b.anggaran end) as anggaran, ISNULL(SUM($normal),0) as nilai FROM data_realisasi_n_pemda$sumber_data$sumber_skpd($bulan,$ag_tox,$thn,'$kd_skpd') b WHERE (left(b.kd_rek5,3) in ($n) or left(b.kd_rek5,5) in ($n2) or left(b.kd_rek5,7) in ($n3))";
//					                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM realisasi b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (\"'.$n.'\") ";
                    $query5 = $this->db->query($sql5);
                    $trh    = $query5->row();
                    $nil    = $trh->nilai;
                    $angnil = $trh->anggaran;
                    
                    $real_s = $trh->anggaran - $trh->nilai;
                    if ($real_s < 0){
                    	$x1="("; $real_sx=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $real_sx=$real_s; $y1="";}
                    $selisih = number_format($real_sx,"2",",",".");
                    if ($trh->nilai==0){
                        $tmp=1;
                    }else{
                        $tmp=$trh->nilai;
                    }
                    $nilai    = number_format($trh->nilai,"2",",",".");
                    $angnilai = number_format($trh->anggaran,"2",",",".");
                    $per1     = ($angnil!=0)?($nil / $angnil ) * 100:0; 
                    $persen1  = number_format($per1,"2",",",".");
                    $no       = $no + 1;
                    switch ($row4->bold) {	
                    case 0:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					default:
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                }
                }
        $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LRA KONSOL / $kd_skpd / $cbulan");
        $this->template->set('title', 'LRA KONSOL / $kd_skpd / $cbulan');        
        switch($cetak) {       
        case 1;
			echo ("<title>LRA KONSOL UNIT $cbulan</title>");
			echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        } 
    }
	
	
	function cetak_lra_pemda($cbulan="", $cetak=1){ 
	$bulan=$cbulan;
	$id  = $this->session->userdata('kdskpd');
    $thn = $this->session->userdata('pcThang');
	
	if($cbulan== 12){
	$sumber_data= "_at";
	}else{
	$sumber_data= "";
	}
	
	$sqlanggaran1="select case when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_ubah) then 2 
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_sempurna) and $cbulan<month(tgl_dpa_ubah) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan>=month(tgl_dpa_sempurna) then 1 
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=0 and status_ubah=0 and $cbulan>=month(tgl_dpa) then 1
					   end as anggaran from trhrka where kd_skpd='$id'";
    $sqlanggaran=$this->db->query($sqlanggaran1);
	foreach ($sqlanggaran->result() as $rowttd)
        {
            $anggaran=$rowttd->anggaran;
        }

	$ag_tox=$anggaran;
	

    //function cetak_lra(){
        
		$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$id' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
		
		$nm_skpd	= strtoupper ($nmskpd);
        $jk=$this->rka_model->combo_skpd();
       
        $cRet='';
        
	 $modtahun= $thn%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
	   
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA DAERAH</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN</strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong> $arraybulan[$bulan] $thn</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>ANGGARAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>LEBIH</br>(KURANG)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                        </tr>";
               
                   $sql4="SELECT a.seq,a.cetak,a.parent,a.bold,a.nor,isnull(a.uraian,'') uraian,isnull(a.kode_1,'-') as kode_1,isnull(a.kode_2,'-') as kode_2,isnull(a.kode_3,'-') as kode_3,thn_m1 AS lalu FROM map_lra_prov a 
						  ORDER BY a.seq";
                // isnull(a.kode_1,\"'-'\")
                $query4 = $this->db->query($sql4);
                $no     = 0;                                  
               
                foreach ($query4->result() as $row4)
                {
                    $normal      = $row4->cetak;   	
                    $bold      = $row4->bold;
					$parent      = $row4->parent;
                    $nama      = $row4->uraian;   
                    $real_lalu = number_format($row4->lalu,"2",",",".");
                    $n         = $row4->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$n2         = $row4->kode_2;
					$n2		   = ($n2=="-"?"'-'":$n2);
					$n3         = $row4->kode_3;
					$n3		   = ($n3=="-"?"'-'":$n3);

//                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi( $bulan,$ag_tox) b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (".$n.") ";
                    $sql5   = "SELECT SUM(case when LEFT(kd_rek5,2) in ('51','52','62') and $parent=1 then b.anggaran*-1 else b.anggaran end) as anggaran, SUM(b.real_spj) as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thn) b WHERE (left(b.kd_rek5,3) in ($n) or left(b.kd_rek5,5) in ($n2) or left(b.kd_rek5,7) in ($n3))";
//					                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM realisasi b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (\"'.$n.'\") ";
                    $query5 = $this->db->query($sql5);
                    $trh    = $query5->row();
                    $nil    = $trh->nilai;
                    $angnil = $trh->anggaran;
                    
                    $real_s = $trh->nilai-$trh->anggaran;
                    if ($real_s < 0){
                    	$x1="("; $real_sx=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $real_sx=$real_s; $y1="";}
                    $selisih = number_format($real_sx,"2",",",".");
                    if ($trh->nilai==0){
                        $tmp=1;
                    }else{
                        $tmp=$trh->nilai;
                    }
                    $nilai    = number_format($trh->nilai,"2",",",".");
                    $angnilai = number_format($trh->anggaran,"2",",",".");
                    $per1     = ($angnil!=0)?($nil / $angnil ) * 100:0; 
                    $persen1  = number_format($per1,"2",",",".");
                    $no       = $no + 1;
                    switch ($row4->bold) {	
                    case 0:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;				
                    default:
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
                }
                }
        $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LRA KONSOL $cbulan");
        $this->template->set('title', 'LRA KONSOL $cbulan');        
        switch($cetak) {       
        case 1;
			echo ("<title>LRA KONSOL $cbulan</title>");
			echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
		case 4;
		$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, 'L');
        break;
        } 
    }

    function ctk_lra_lo_pemda($cbulan="", $pilih=""){
        //$id = $skpd;
        $cetak='2';//$ctk; 
        $id     = $this->session->userdata('kdskpd');
        $thn_ang = $this->session->userdata('pcThang');
        $thn_ang_1= $thn_ang-1;  
        //$laporan=$lap; 
       
       // if ($cetak == '1') {
//           $skpd = '';
//           $skpd1 = '';           
//       } else {             
           $skpd = "AND kd_skpd='$id'";
           $skpd1 = "AND b.kd_skpd='$id'"; 
       //}  
		
	   if($cbulan== 12){
			$sumber_jurnal= "_calk";
			}else{
			$sumber_jurnal= "";
			}
	   
       $y123=")";
	   $x123="(";       
	    $sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$id'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $nmskpd     = $rowsc->nm_skpd;
                } 
		$nm_skpd = strtoupper($nmskpd);		
	   // INSERT DATA
	   
       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
     
// created by henri_tb
			
		$sqllo1="select sum(kredit-debet) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('81','82','83')";
                    $querylo1= $this->db->query($sqllo1);
                    $penlo = $querylo1->row();
                    $pen_lo = $penlo->nilai;
                    $pen_lo1= number_format($penlo->nilai,"2",",",".");
        
		$sqllo2="select sum(kredit-debet) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('81','82','83')";
                    $querylo2= $this->db->query($sqllo2);
                    $penlo2 = $querylo2->row();
                    $pen_lo_lalu = $penlo2->nilai;
                    $pen_lo_lalu1= number_format($penlo2->nilai,"2",",",".");
		
		$sqllo3="select sum(debet-kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('91','92')";
                    $querylo3= $this->db->query($sqllo3);
                    $bello = $querylo3->row();
                    $bel_lo = $bello->nilai;
                    $bel_lo1= number_format($bello->nilai,"2",",",".");
        
		$sqllo4="select sum(debet-kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('91','92')";
                    $querylo4= $this->db->query($sqllo4);
                    $bello2 = $querylo4->row();
                    $bel_lo_lalu = $bello2->nilai;
                    $bel_lo_lalu1= number_format($bello2->nilai,"2",",",".");		

					$surplus_lo = $pen_lo - $bel_lo;
                    if ($surplus_lo < 0){
                    	$lo1="("; $surplus_lox=$surplus_lo*-1; $lo2=")";}
                    else {
                    	$lo1=""; $surplus_lox=$surplus_lo; $lo2="";}		
                    $surplus_lo1 = number_format($surplus_lox,"2",",",".");
                    
					$surplus_lo_lalu = $pen_lo_lalu - $bel_lo_lalu;
                    if ($surplus_lo_lalu < 0){
                    	$lo3="("; $surplus_lo_lalux=$surplus_lo_lalu*-1; $lo4=")";}
                    else {
                    	$lo3=""; $surplus_lo_lalux=$surplus_lo_lalu; $lo4="";}						
                    $surplus_lo_lalu1 = number_format($surplus_lo_lalux,"2",",",".");

					$selisih_surplus_lo = $surplus_lo - $surplus_lo_lalu;
                    if ($selisih_surplus_lo < 0){
                    	$lo5="("; $selisih_surplus_lox=$selisih_surplus_lo*-1; $lo6=")";}
                    else {
                    	$lo5=""; $selisih_surplus_lox=$selisih_surplus_lo; $lo6="";}
                    $selisih_surplus_lo1 = number_format($selisih_surplus_lox,"2",",",".");
                    
					if( $surplus_lo_lalu=='' or $surplus_lo_lalu==0){
					$persen2 = '0,00';
					}else{
					$persen2 = ($surplus_lo/$surplus_lo_lalu)*100;
					$persen2 = number_format($persen2,"2",",",".");
					}
					
		$sqllo5="select sum(kredit-debet) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('81','82','83','84')";
                    $querylo5= $this->db->query($sqllo5);
                    $penlo3 = $querylo5->row();
                    $pen_lo3 = $penlo3->nilai;
                    $pen_lo31= number_format($penlo3->nilai,"2",",",".");
        
		$sqllo6="select sum(kredit-debet) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('81','82','83','84')";
                    $querylo6= $this->db->query($sqllo6);
                    $penlo4 = $querylo6->row();
                    $pen_lo_lalu4 = $penlo4->nilai;
                    $pen_lo_lalu41= number_format($penlo4->nilai,"2",",",".");
		
		$sqllo7="select sum(debet-kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('91','92','93')";
                    $querylo7= $this->db->query($sqllo7);
                    $bello5 = $querylo7->row();
                    $bel_lo5 = $bello5->nilai;
                    $bel_lo51= number_format($bello5->nilai,"2",",",".");
		
		$sqllo8="select sum(debet-kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('91','92','93')";
                    $querylo8= $this->db->query($sqllo8);
                    $bello6 = $querylo8->row();
                    $bel_lo_lalu6 = $bello6->nilai;
                    $bel_lo_lalu61= number_format($bello6->nilai,"2",",",".");		

					$surplus_lo2 = $pen_lo3 - $bel_lo5;
                    if ($surplus_lo2 < 0){
                    	$lo7="("; $surplus_lo2x=$surplus_lo2*-1; $lo8=")";}
                    else {
                    	$lo7=""; $surplus_lo2x=$surplus_lo2; $lo8="";}		
                    $surplus_lo21 = number_format($surplus_lo2x,"2",",",".");
                    
					$surplus_lo_lalu2 = $pen_lo_lalu4 - $bel_lo_lalu6;
                    if ($surplus_lo_lalu2 < 0){
                    	$lo9="("; $surplus_lo_lalu2x=$surplus_lo_lalu2*-1; $lo10=")";}
                    else {
                    	$lo9=""; $surplus_lo_lalu2x=$surplus_lo_lalu2; $lo10="";}						
                    $surplus_lo_lalu21 = number_format($surplus_lo_lalu2x,"2",",",".");

					$selisih_surplus_lo2 = $surplus_lo2 - $surplus_lo_lalu2;
                    if ($selisih_surplus_lo2 < 0){
                    	$lo11="("; $selisih_surplus_lo2x=$selisih_surplus_lo2*-1; $lo12=")";}
                    else {
                    	$lo11=""; $selisih_surplus_lo2x=$selisih_surplus_lo2; $lo12="";}
                    $selisih_surplus_lo21 = number_format($selisih_surplus_lo2x,"2",",",".");
                    
					if( $surplus_lo_lalu2=='' or $surplus_lo_lalu2==0){
					$persen3 = '0,00';
					}else{
					$persen3 = ($surplus_lo2/$surplus_lo_lalu2)*100;
					$persen3 = number_format($persen3,"2",",",".");
					}
		
		$sqllo9="select sum(kredit-debet) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,1) in ('8')";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8')";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,1) in ('9')";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9')";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    if ($surplus_lo3 < 0){
                    	$lo13="("; $surplus_lo3x=$surplus_lo3*-1; $lo14=")";}
                    else {
                    	$lo13=""; $surplus_lo3x=$surplus_lo3; $lo14="";}		
                    $surplus_lo31 = number_format($surplus_lo3x,"2",",",".");
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    if ($surplus_lo_lalu3 < 0){
                    	$lo15="("; $surplus_lo_lalu3x=$surplus_lo_lalu3*-1; $lo16=")";}
                    else {
                    	$lo15=""; $surplus_lo_lalu3x=$surplus_lo_lalu3; $lo16="";}						
                    $surplus_lo_lalu31 = number_format($surplus_lo_lalu3x,"2",",",".");

					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
                    if ($selisih_surplus_lo3 < 0){
                    	$lo17="("; $selisih_surplus_lo3x=$selisih_surplus_lo3*-1; $lo18=")";}
                    else {
                    	$lo17=""; $selisih_surplus_lo3x=$selisih_surplus_lo3; $lo18="";}
                    $selisih_surplus_lo31 = number_format($selisih_surplus_lo3x,"2",",",".");
                    
					if( $surplus_lo_lalu3=='' or $surplus_lo_lalu3==0){
					$persen4 = '0,00';
					}else{
					$persen4 = ($surplus_lo3/$surplus_lo_lalu3)*100;
					$persen4 = number_format($persen4,"2",",",".");
					}

					
		$sqllo13="select sum(kredit-debet) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('84')";
                    $querylo13= $this->db->query($sqllo13);
                    $penlo11 = $querylo13->row();
                    $pen_lo11 = $penlo11->nilai;
                    $pen_lo111= number_format($penlo11->nilai,"2",",",".");
        
		$sqllo14="select sum(kredit-debet) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('84')";
                    $querylo14= $this->db->query($sqllo14);
                    $penlo12 = $querylo14->row();
                    $pen_lo_lalu12 = $penlo12->nilai;
                    $pen_lo_lalu121= number_format($penlo12->nilai,"2",",",".");
		
		$sqllo15="select sum(debet-kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('93')";
                    $querylo15= $this->db->query($sqllo15);
                    $bello13 = $querylo15->row();
                    $bel_lo13 = $bello13->nilai;
                    $bel_lo131= number_format($bello13->nilai,"2",",",".");
		
		$sqllo16="select sum(debet-kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('93')";
                    $querylo16= $this->db->query($sqllo16);
                    $bello14 = $querylo16->row();
                    $bel_lo_lalu14 = $bello14->nilai;
                    $bel_lo_lalu141= number_format($bello14->nilai,"2",",",".");		

					$surplus_lo4 = $pen_lo11 - $bel_lo13;
                    if ($surplus_lo4 < 0){
                    	$lo19="("; $surplus_lo4x=$surplus_lo4*-1; $lo20=")";}
                    else {
                    	$lo19=""; $surplus_lo4x=$surplus_lo4; $lo20="";}		
                    $surplus_lo41 = number_format($surplus_lo4x,"2",",",".");
                    
					$surplus_lo_lalu4 = $pen_lo_lalu12 - $bel_lo_lalu14;
                    if ($surplus_lo_lalu4 < 0){
                    	$lo21="("; $surplus_lo_lalu4x=$surplus_lo_lalu4*-1; $lo22=")";}
                    else {
                    	$lo21=""; $surplus_lo_lalu4x=$surplus_lo_lalu4; $lo22="";}						
                    $surplus_lo_lalu41 = number_format($surplus_lo_lalu4x,"2",",",".");

					$selisih_surplus_lo4 = $surplus_lo4 - $surplus_lo_lalu4;
                    if ($selisih_surplus_lo4 < 0){
                    	$lo23="("; $selisih_surplus_lo4x=$selisih_surplus_lo4*-1; $lo24=")";}
                    else {
                    	$lo23=""; $selisih_surplus_lo4x=$selisih_surplus_lo4; $lo24="";}
                    $selisih_surplus_lo41 = number_format($selisih_surplus_lo4x,"2",",",".");
                    
					if( $surplus_lo_lalu4=='' or $surplus_lo_lalu4==0){
					$persen5 = '0,00';
					}else{
					$persen5 = ($surplus_lo4/$surplus_lo_lalu4)*100;
					$persen5 = number_format($persen5,"2",",",".");
					}
					
					
		$sqllo17="select sum(kredit-debet) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('85')";
                    $querylo17= $this->db->query($sqllo17);
                    $penlo15 = $querylo17->row();
                    $pen_lo15 = $penlo15->nilai;
                    $pen_lo151= number_format($penlo15->nilai,"2",",",".");
        
		$sqllo18="select sum(kredit-debet) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('85')";
                    $querylo18= $this->db->query($sqllo18);
                    $penlo16 = $querylo18->row();
                    $pen_lo_lalu16 = $penlo16->nilai;
                    $pen_lo_lalu161= number_format($penlo16->nilai,"2",",",".");
		
		$sqllo19="select sum(debet-kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('94')";
                    $querylo19= $this->db->query($sqllo19);
                    $bello17 = $querylo19->row();
                    $bel_lo17 = $bello17->nilai;
                    $bel_lo171= number_format($bello17->nilai,"2",",",".");
		
		$sqllo20="select sum(debet-kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('94')";
                    $querylo20= $this->db->query($sqllo20);
                    $bello18 = $querylo20->row();
                    $bel_lo_lalu18 = $bello18->nilai;
                    $bel_lo_lalu181= number_format($bello18->nilai,"2",",",".");		

					$surplus_lo5 = $pen_lo15 - $bel_lo17;
                    if ($surplus_lo5 < 0){
                    	$lo25="("; $surplus_lo5x=$surplus_lo5*-1; $lo26=")";}
                    else {
                    	$lo25=""; $surplus_lo5x=$surplus_lo5; $lo26="";}		
                    $surplus_lo51 = number_format($surplus_lo5x,"2",",",".");
                    
					$surplus_lo_lalu5 = $pen_lo_lalu16 - $bel_lo_lalu18;
                    if ($surplus_lo_lalu5 < 0){
                    	$lo27="("; $surplus_lo_lalu5x=$surplus_lo_lalu5*-1; $lo28=")";}
                    else {
                    	$lo27=""; $surplus_lo_lalu5x=$surplus_lo_lalu5; $lo28="";}						
                    $surplus_lo_lalu51 = number_format($surplus_lo_lalu5x,"2",",",".");

					$selisih_surplus_lo5 = $surplus_lo5 - $surplus_lo_lalu5;
                    if ($selisih_surplus_lo5 < 0){
                    	$lo29="("; $selisih_surplus_lo5x=$selisih_surplus_lo5*-1; $lo30=")";}
                    else {
                    	$lo29=""; $selisih_surplus_lo5x=$selisih_surplus_lo5; $lo30="";}
                    $selisih_surplus_lo51 = number_format($selisih_surplus_lo5x,"2",",",".");
                    
					if( $surplus_lo_lalu5=='' or $surplus_lo_lalu5==0){
					$persen6 = '0,00';
					}else{
					$persen6 = ($surplus_lo5/$surplus_lo_lalu5)*100;
					$persen6 = number_format($persen6,"2",",",".");
					}			
					
		
        $modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);

        $cRet='';
        
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>LAPORAN OPERASIONAL </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan] $thn_ang</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>Kenaikan</br>(Penurunan)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                        </tr>";

        $sqlmaplo="SELECT seq, nor, uraian, isnull(kode_1,'-') as kode_1, isnull(kode_2,'-') as kode_2, isnull(kode_3,'-') as kode_3, isnull(cetak,'debet-debet') as cetak FROM map_lo_prov 
				   GROUP BY seq, nor, uraian, isnull(kode_1,'-'), isnull(kode_2,'-'), isnull(kode_3,'-'), isnull(cetak,'debet-debet') ORDER BY seq";
				   
                $querymaplo = $this->db->query($sqlmaplo);
                $no     = 0;                                  
               
                foreach ($querymaplo->result() as $loquery)
                {
                    
                    $nama      = $loquery->uraian;   
                    $n         = $loquery->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$n2        = $loquery->kode_2;
					$n2		   = ($n2=="-"?"'-'":$n2);
					$n3        = $loquery->kode_3;
					$n3		   = ($n3=="-"?"'-'":$n3);
					$normal    = $loquery->cetak;
					
		$quelo01   = "SELECT SUM($normal) as nilai FROM trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE (left(kd_rek5,3) in ($n) or left(kd_rek5,5) in ($n2) or left(kd_rek5,7) in ($n3)) and year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan";
                    $quelo02 = $this->db->query($quelo01);
                    $quelo03 = $quelo02->row();
                    $nil     = $quelo03->nilai;
                    $nilai    = number_format($quelo03->nilai,"2",",",".");
					
		$quelo04   = "SELECT SUM($normal) as nilai FROM trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE (left(kd_rek5,3) in ($n) or left(kd_rek5,5) in ($n2) or left(kd_rek5,7) in ($n3)) and year(tgl_voucher)=$thn_ang_1";
                    $quelo05 = $this->db->query($quelo04);
                    $quelo06 = $quelo05->row();
                    $nil_lalu     = $quelo06->nilai;
                    $nilai_lalu    = number_format($quelo06->nilai,"2",",",".");
					
                    $real_nilai = $nil - $nil_lalu;
                    if ($real_nilai < 0){
                    	$lo0="("; $real_nilaix=$real_nilai*-1; $lo00=")";}
                    else {
                    	$lo0=""; $real_nilaix=$real_nilai; $lo00="";}
                    $real_nilai1 = number_format($real_nilaix,"2",",",".");
                    
					if( $nil_lalu=='' or $nil_lalu==0){
					$persen1 = '0,00';
					}else{
					$persen1 = ($nil/$nil_lalu)*100;
					$persen1 = number_format($persen1,"2",",",".");
					}
                    $no       = $no + 1;
                    switch ($loquery->seq) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 40:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 45:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 50:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 80:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 85:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 140:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 145:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 150:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 200:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 205:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 245:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 250:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo1$surplus_lo1$lo2</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo3$surplus_lo_lalu1$lo4</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo5$selisih_surplus_lo1$lo6</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen2</td>
                                 </tr>";
                        break;
					case 255:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 260:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 265:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 290:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 295:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 320:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo19$surplus_lo41$lo20</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo21$surplus_lo_lalu41$lo22</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo23$selisih_surplus_lo41$lo24</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen5</td>
                                 </tr>";
                        break;	
					case 325:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 330:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo7$surplus_lo21$lo8</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo9$surplus_lo_lalu21$lo10</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo11$selisih_surplus_lo21$lo12</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen3</td>
                                 </tr>";
                        break;
					case 335:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 340:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 345:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 360:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 365:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 385:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 390:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo13$surplus_lo31$lo14</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo15$surplus_lo_lalu31$lo16</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo17$selisih_surplus_lo31$lo18</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen4</td>
                                 </tr>";
                        break;
					default:
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";

                }
                              
                    
                }
               
              
       // $cRet         .= "</table>";
//        $data['prev']  = $cRet;
//        $data['sikap'] = 'preview';
//        
//        
//        
//        $this->template->set('title', 'LAPORAN OPERASIONAL'); 
//        $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
        //$this->template->load('template','anggaran/rka/perkadaII',$data); 
        
        $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LO KONSOL $cbulan");
        $this->template->set('title', 'LO KONSOL $cbulan');        
        switch($pilih) {       
        case 1;
            // $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
			echo "<title>LO KONSOL $cbulan</title>";
			echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename=$judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename=$judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
		case 0;
            $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
			/* echo "<title>LO KONSOL $cbulan</title>";
			echo $cRet; */
        break;
        } 
        
                 
    }
    
	function ctk_lra_lo_pemda_unit($cbulan="", $kd_skpd="", $pilih=1){
        //$id = $skpd;
        $cetak='2';//$ctk; 
        $id     = $this->session->userdata('kdskpd');
        $thn_ang = $this->session->userdata('pcThang');
        $thn_ang_1= $thn_ang-1;  
        //$laporan=$lap; 
       
       // if ($cetak == '1') {
//           $skpd = '';
//           $skpd1 = '';           
//       } else {             
           $skpd = "AND kd_skpd='$kd_skpd'";
           $skpd1 = "AND b.kd_skpd='$kd_skpd'"; 
       //}  

       $y123=")";
	   $x123="(";       
	    $sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $nmskpd     = $rowsc->nm_skpd;
                } 
		$nm_skpd = strtoupper($nmskpd);		
	   // INSERT DATA
	   
       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$kd_skpd'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
     
// created by henri_tb
			
		$sqllo1="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('81','82','83') and kd_skpd='$kd_skpd'";
                    $querylo1= $this->db->query($sqllo1);
                    $penlo = $querylo1->row();
                    $pen_lo = $penlo->nilai;
                    $pen_lo1= number_format($penlo->nilai,"2",",",".");
        
		$sqllo2="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('81','82','83') and kd_skpd='$kd_skpd'";
                    $querylo2= $this->db->query($sqllo2);
                    $penlo2 = $querylo2->row();
                    $pen_lo_lalu = $penlo2->nilai;
                    $pen_lo_lalu1= number_format($penlo2->nilai,"2",",",".");
		
		$sqllo3="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('91','92') and kd_skpd='$kd_skpd'";
                    $querylo3= $this->db->query($sqllo3);
                    $bello = $querylo3->row();
                    $bel_lo = $bello->nilai;
                    $bel_lo1= number_format($bello->nilai,"2",",",".");
        
		$sqllo4="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('91','92') and kd_skpd='$kd_skpd'";
                    $querylo4= $this->db->query($sqllo4);
                    $bello2 = $querylo4->row();
                    $bel_lo_lalu = $bello2->nilai;
                    $bel_lo_lalu1= number_format($bello2->nilai,"2",",",".");		

					$surplus_lo = $pen_lo - $bel_lo;
                    if ($surplus_lo < 0){
                    	$lo1="("; $surplus_lox=$surplus_lo*-1; $lo2=")";}
                    else {
                    	$lo1=""; $surplus_lox=$surplus_lo; $lo2="";}		
                    $surplus_lo1 = number_format($surplus_lox,"2",",",".");
                    
					$surplus_lo_lalu = $pen_lo_lalu - $bel_lo_lalu;
                    if ($surplus_lo_lalu < 0){
                    	$lo3="("; $surplus_lo_lalux=$surplus_lo_lalu*-1; $lo4=")";}
                    else {
                    	$lo3=""; $surplus_lo_lalux=$surplus_lo_lalu; $lo4="";}						
                    $surplus_lo_lalu1 = number_format($surplus_lo_lalux,"2",",",".");

					$selisih_surplus_lo = $surplus_lo - $surplus_lo_lalu;
                    if ($selisih_surplus_lo < 0){
                    	$lo5="("; $selisih_surplus_lox=$selisih_surplus_lo*-1; $lo6=")";}
                    else {
                    	$lo5=""; $selisih_surplus_lox=$selisih_surplus_lo; $lo6="";}
                    $selisih_surplus_lo1 = number_format($selisih_surplus_lox,"2",",",".");
                    
					if( $surplus_lo_lalu=='' or $surplus_lo_lalu==0){
					$persen2 = '0,00';
					}else{
					$persen2 = ($surplus_lo/$surplus_lo_lalu)*100;
					$persen2 = number_format($persen2,"2",",",".");
					}
					
		$sqllo5="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('81','82','83','84') and kd_skpd='$kd_skpd'";
                    $querylo5= $this->db->query($sqllo5);
                    $penlo3 = $querylo5->row();
                    $pen_lo3 = $penlo3->nilai;
                    $pen_lo31= number_format($penlo3->nilai,"2",",",".");
        
		$sqllo6="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('81','82','83','84') and kd_skpd='$kd_skpd'";
                    $querylo6= $this->db->query($sqllo6);
                    $penlo4 = $querylo6->row();
                    $pen_lo_lalu4 = $penlo4->nilai;
                    $pen_lo_lalu41= number_format($penlo4->nilai,"2",",",".");
		
		$sqllo7="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('91','92','93') and kd_skpd='$kd_skpd'";
                    $querylo7= $this->db->query($sqllo7);
                    $bello5 = $querylo7->row();
                    $bel_lo5 = $bello5->nilai;
                    $bel_lo51= number_format($bello5->nilai,"2",",",".");
		
		$sqllo8="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('91','92','93') and kd_skpd='$kd_skpd'";
                    $querylo8= $this->db->query($sqllo8);
                    $bello6 = $querylo8->row();
                    $bel_lo_lalu6 = $bello6->nilai;
                    $bel_lo_lalu61= number_format($bello6->nilai,"2",",",".");		

					$surplus_lo2 = $pen_lo3 - $bel_lo5;
                    if ($surplus_lo2 < 0){
                    	$lo7="("; $surplus_lo2x=$surplus_lo2*-1; $lo8=")";}
                    else {
                    	$lo7=""; $surplus_lo2x=$surplus_lo2; $lo8="";}		
                    $surplus_lo21 = number_format($surplus_lo2x,"2",",",".");
                    
					$surplus_lo_lalu2 = $pen_lo_lalu4 - $bel_lo_lalu6;
                    if ($surplus_lo_lalu2 < 0){
                    	$lo9="("; $surplus_lo_lalu2x=$surplus_lo_lalu2*-1; $lo10=")";}
                    else {
                    	$lo9=""; $surplus_lo_lalu2x=$surplus_lo_lalu2; $lo10="";}						
                    $surplus_lo_lalu21 = number_format($surplus_lo_lalu2x,"2",",",".");

					$selisih_surplus_lo2 = $surplus_lo2 - $surplus_lo_lalu2;
                    if ($selisih_surplus_lo2 < 0){
                    	$lo11="("; $selisih_surplus_lo2x=$selisih_surplus_lo2*-1; $lo12=")";}
                    else {
                    	$lo11=""; $selisih_surplus_lo2x=$selisih_surplus_lo2; $lo12="";}
                    $selisih_surplus_lo21 = number_format($selisih_surplus_lo2x,"2",",",".");
                    
					if( $surplus_lo_lalu2=='' or $surplus_lo_lalu2==0){
					$persen3 = '0,00';
					}else{
					$persen3 = ($surplus_lo2/$surplus_lo_lalu2)*100;
					$persen3 = number_format($persen3,"2",",",".");
					}
		
		$sqllo9="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    if ($surplus_lo3 < 0){
                    	$lo13="("; $surplus_lo3x=$surplus_lo3*-1; $lo14=")";}
                    else {
                    	$lo13=""; $surplus_lo3x=$surplus_lo3; $lo14="";}		
                    $surplus_lo31 = number_format($surplus_lo3x,"2",",",".");
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    if ($surplus_lo_lalu3 < 0){
                    	$lo15="("; $surplus_lo_lalu3x=$surplus_lo_lalu3*-1; $lo16=")";}
                    else {
                    	$lo15=""; $surplus_lo_lalu3x=$surplus_lo_lalu3; $lo16="";}						
                    $surplus_lo_lalu31 = number_format($surplus_lo_lalu3x,"2",",",".");

					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
                    if ($selisih_surplus_lo3 < 0){
                    	$lo17="("; $selisih_surplus_lo3x=$selisih_surplus_lo3*-1; $lo18=")";}
                    else {
                    	$lo17=""; $selisih_surplus_lo3x=$selisih_surplus_lo3; $lo18="";}
                    $selisih_surplus_lo31 = number_format($selisih_surplus_lo3x,"2",",",".");
                    
					if( $surplus_lo_lalu3=='' or $surplus_lo_lalu3==0){
					$persen4 = '0,00';
					}else{
					$persen4 = ($surplus_lo3/$surplus_lo_lalu3)*100;
					$persen4 = number_format($persen4,"2",",",".");
					}

					
		$sqllo13="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('84') and kd_skpd='$kd_skpd'";
                    $querylo13= $this->db->query($sqllo13);
                    $penlo11 = $querylo13->row();
                    $pen_lo11 = $penlo11->nilai;
                    $pen_lo111= number_format($penlo11->nilai,"2",",",".");
        
		$sqllo14="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('84') and kd_skpd='$kd_skpd'";
                    $querylo14= $this->db->query($sqllo14);
                    $penlo12 = $querylo14->row();
                    $pen_lo_lalu12 = $penlo12->nilai;
                    $pen_lo_lalu121= number_format($penlo12->nilai,"2",",",".");
		
		$sqllo15="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('93') and kd_skpd='$kd_skpd'";
                    $querylo15= $this->db->query($sqllo15);
                    $bello13 = $querylo15->row();
                    $bel_lo13 = $bello13->nilai;
                    $bel_lo131= number_format($bello13->nilai,"2",",",".");
		
		$sqllo16="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('93') and kd_skpd='$kd_skpd'";
                    $querylo16= $this->db->query($sqllo16);
                    $bello14 = $querylo16->row();
                    $bel_lo_lalu14 = $bello14->nilai;
                    $bel_lo_lalu141= number_format($bello14->nilai,"2",",",".");		

					$surplus_lo4 = $pen_lo11 - $bel_lo13;
                    if ($surplus_lo4 < 0){
                    	$lo19="("; $surplus_lo4x=$surplus_lo4*-1; $lo20=")";}
                    else {
                    	$lo19=""; $surplus_lo4x=$surplus_lo4; $lo20="";}		
                    $surplus_lo41 = number_format($surplus_lo4x,"2",",",".");
                    
					$surplus_lo_lalu4 = $pen_lo_lalu12 - $bel_lo_lalu14;
                    if ($surplus_lo_lalu4 < 0){
                    	$lo21="("; $surplus_lo_lalu4x=$surplus_lo_lalu4*-1; $lo22=")";}
                    else {
                    	$lo21=""; $surplus_lo_lalu4x=$surplus_lo_lalu4; $lo22="";}						
                    $surplus_lo_lalu41 = number_format($surplus_lo_lalu4x,"2",",",".");

					$selisih_surplus_lo4 = $surplus_lo4 - $surplus_lo_lalu4;
                    if ($selisih_surplus_lo4 < 0){
                    	$lo23="("; $selisih_surplus_lo4x=$selisih_surplus_lo4*-1; $lo24=")";}
                    else {
                    	$lo23=""; $selisih_surplus_lo4x=$selisih_surplus_lo4; $lo24="";}
                    $selisih_surplus_lo41 = number_format($selisih_surplus_lo4x,"2",",",".");
                    
					if( $surplus_lo_lalu4=='' or $surplus_lo_lalu4==0){
					$persen5 = '0,00';
					}else{
					$persen5 = ($surplus_lo4/$surplus_lo_lalu4)*100;
					$persen5 = number_format($persen5,"2",",",".");
					}
					
					
		$sqllo17="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('85') and kd_skpd='$kd_skpd'";
                    $querylo17= $this->db->query($sqllo17);
                    $penlo15 = $querylo17->row();
                    $pen_lo15 = $penlo15->nilai;
                    $pen_lo151= number_format($penlo15->nilai,"2",",",".");
        
		$sqllo18="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('85') and kd_skpd='$kd_skpd'";
                    $querylo18= $this->db->query($sqllo18);
                    $penlo16 = $querylo18->row();
                    $pen_lo_lalu16 = $penlo16->nilai;
                    $pen_lo_lalu161= number_format($penlo16->nilai,"2",",",".");
		
		$sqllo19="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('94') and kd_skpd='$kd_skpd'";
                    $querylo19= $this->db->query($sqllo19);
                    $bello17 = $querylo19->row();
                    $bel_lo17 = $bello17->nilai;
                    $bel_lo171= number_format($bello17->nilai,"2",",",".");
		
		$sqllo20="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('94') and kd_skpd='$kd_skpd'";
                    $querylo20= $this->db->query($sqllo20);
                    $bello18 = $querylo20->row();
                    $bel_lo_lalu18 = $bello18->nilai;
                    $bel_lo_lalu181= number_format($bello18->nilai,"2",",",".");		

					$surplus_lo5 = $pen_lo15 - $bel_lo17;
                    if ($surplus_lo5 < 0){
                    	$lo25="("; $surplus_lo5x=$surplus_lo5*-1; $lo26=")";}
                    else {
                    	$lo25=""; $surplus_lo5x=$surplus_lo5; $lo26="";}		
                    $surplus_lo51 = number_format($surplus_lo5x,"2",",",".");
                    
					$surplus_lo_lalu5 = $pen_lo_lalu16 - $bel_lo_lalu18;
                    if ($surplus_lo_lalu5 < 0){
                    	$lo27="("; $surplus_lo_lalu5x=$surplus_lo_lalu5*-1; $lo28=")";}
                    else {
                    	$lo27=""; $surplus_lo_lalu5x=$surplus_lo_lalu5; $lo28="";}						
                    $surplus_lo_lalu51 = number_format($surplus_lo_lalu5x,"2",",",".");

					$selisih_surplus_lo5 = $surplus_lo5 - $surplus_lo_lalu5;
                    if ($selisih_surplus_lo5 < 0){
                    	$lo29="("; $selisih_surplus_lo5x=$selisih_surplus_lo5*-1; $lo30=")";}
                    else {
                    	$lo29=""; $selisih_surplus_lo5x=$selisih_surplus_lo5; $lo30="";}
                    $selisih_surplus_lo51 = number_format($selisih_surplus_lo5x,"2",",",".");
                    
					if( $surplus_lo_lalu5=='' or $surplus_lo_lalu5==0){
					$persen6 = '0,00';
					}else{
					$persen6 = ($surplus_lo5/$surplus_lo_lalu5)*100;
					$persen6 = number_format($persen6,"2",",",".");
					}			
					
		
        $modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);

        $cRet='';
        
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
						<td align=\"center\"><strong>$nm_skpd</strong></td>
					</tr>	
                    <tr>
                         <td align=\"center\"><strong>LAPORAN OPERASIONAL </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan] $thn_ang</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>Kenaikan</br>(Penurunan)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                        </tr>";

        $sqlmaplo="SELECT seq, nor, uraian, isnull(kode_1,'-') as kode_1, isnull(kode_2,'-') as kode_2, isnull(kode_3,'-') as kode_3, isnull(cetak,'debet-debet') as cetak FROM map_lo_prov 
				   GROUP BY seq, nor, uraian, isnull(kode_1,'-'), isnull(kode_2,'-'), isnull(kode_3,'-'), isnull(cetak,'debet-debet') ORDER BY seq";
				   
                $querymaplo = $this->db->query($sqlmaplo);
                $no     = 0;                                  
               
                foreach ($querymaplo->result() as $loquery)
                {
                    
                    $nama      = $loquery->uraian;   
                    $n         = $loquery->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$n2        = $loquery->kode_2;
					$n2		   = ($n2=="-"?"'-'":$n2);
					$n3        = $loquery->kode_3;
					$n3		   = ($n3=="-"?"'-'":$n3);
					$normal    = $loquery->cetak;
					
		$quelo01   = "SELECT SUM($normal) as nilai FROM trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE (left(kd_rek5,3) in ($n) or left(kd_rek5,5) in ($n2) or left(kd_rek5,7) in ($n3)) and year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and kd_skpd='$kd_skpd'";
                    $quelo02 = $this->db->query($quelo01);
                    $quelo03 = $quelo02->row();
                    $nil     = $quelo03->nilai;
                    $nilai    = number_format($quelo03->nilai,"2",",",".");
					
		$quelo04   = "SELECT SUM($normal) as nilai FROM trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE (left(kd_rek5,3) in ($n) or left(kd_rek5,5) in ($n2) or left(kd_rek5,7) in ($n3)) and year(tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";
                    $quelo05 = $this->db->query($quelo04);
                    $quelo06 = $quelo05->row();
                    $nil_lalu     = $quelo06->nilai;
                    $nilai_lalu    = number_format($quelo06->nilai,"2",",",".");
					
                    $real_nilai = $nil - $nil_lalu;
                    if ($real_nilai < 0){
                    	$lo0="("; $real_nilaix=$real_nilai*-1; $lo00=")";}
                    else {
                    	$lo0=""; $real_nilaix=$real_nilai; $lo00="";}
                    $real_nilai1 = number_format($real_nilaix,"2",",",".");
                    
					if( $nil_lalu=='' or $nil_lalu==0){
					$persen1 = '0,00';
					}else{
					$persen1 = ($nil/$nil_lalu)*100;
					$persen1 = number_format($persen1,"2",",",".");
					}
                    $no       = $no + 1;
                    switch ($loquery->seq) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 40:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 45:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 50:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 80:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 85:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 140:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 145:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 150:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 200:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 205:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 245:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 250:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo1$surplus_lo1$lo2</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo3$surplus_lo_lalu1$lo4</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo5$selisih_surplus_lo1$lo6</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen2</td>
                                 </tr>";
                        break;
					case 255:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 260:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 265:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 290:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 295:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 320:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo19$surplus_lo41$lo20</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo21$surplus_lo_lalu41$lo22</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo23$selisih_surplus_lo41$lo24</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen5</td>
                                 </tr>";
                        break;	
					case 325:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 330:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo7$surplus_lo21$lo8</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo9$surplus_lo_lalu21$lo10</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo11$selisih_surplus_lo21$lo12</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen3</td>
                                 </tr>";
                        break;
					case 335:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 340:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 345:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 360:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 365:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 385:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 390:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo13$surplus_lo31$lo14</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$lo15$surplus_lo_lalu31$lo16</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo17$selisih_surplus_lo31$lo18</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen4</td>
                                 </tr>";
                        break;
					default:
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";

                }
                              
                    
                }
               
              
       // $cRet         .= "</table>";
//        $data['prev']  = $cRet;
//        $data['sikap'] = 'preview';
//        
//        
//        
//        $this->template->set('title', 'LAPORAN OPERASIONAL'); 
//        $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
        //$this->template->load('template','anggaran/rka/perkadaII',$data); 
        
        $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LO KONSOL UNIT $cbulan");
        $this->template->set('title', 'LO KONSOL UNIT $cbulan');        
        switch($pilih) {       
        case 1;
            // $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
			echo "<title>LO KONSOL UNIT $cbulan</title>";
			echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        } 
        
                 
    }
    
	
    function lampiran_II()
    {
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/perda_real_ii', $data);
    }

    function cetak_perdaII_real($cetak = 0)
    {
        //$cetak =   $this->uri->segment(3);
        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc)
        {
            $tgl = $rowsc->tgl_rka;
            $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
            $kab = $rowsc->kab_kota;
            $daerah = $rowsc->daerah;
            $thn = $rowsc->thn_ang;
        }

        $cRet = '';
        if ($cetak <> 0)
        {
            $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"10%\"><strong><h5>LAMPIRAN II  :</h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
                    </tr>
                                         
                   
                  </table>";
        }
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\" width=\"100%\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td align=\"center\" width=\"100%\"><strong>REALISASI APBD </strong></td>
                    </tr>
                    
                    <tr>
                         <td align=\"center\" width=\"100%\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table>";

        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>KODE</b></td>                            
                            <td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>URUSAN PEMERINTAH DAERAH</b></td>
                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" bgcolor=\"#CCCCCC\" width=\"26%\" align=\"center\" colspan=\"4\"><b>PENDAPATAN</b></td>
                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" bgcolor=\"#CCCCCC\" width=\"54%\" align=\"center\" colspan=\"8\"><b>BELANJA</b></td>
                        </tr>
                        <tr>
 		                    <td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">SETELAH<br>PERUBAHAN</td>
                            <td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">REALISASI</td>
                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" colspan=\"2\" width=\"12%\" bgcolor=\"#CCCCCC\" align=\"center\">LEBIH(KURANG)</td>
                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\"colspan=\"3\" width=\"21%\" bgcolor=\"#CCCCCC\" align=\"center\">SETELAH PERUBAHAN</td>
                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\"colspan=\"3\" width=\"21%\" bgcolor=\"#CCCCCC\" align=\"center\">REALISASI</td>
                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\"colspan=\"2\" width=\"12%\" bgcolor=\"#CCCCCC\" align=\"center\">LEBIH</br>(KURANG)</td>
                        </tr>
                        <tr>
                             <td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >(RP.)</td>
                             <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" >%</td>
                             <td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Tidak Langsung</td>
                             <td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Langsung</td>
                             <td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Jumlah</td>
                             <td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Tidak Langsung</td>
                             <td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Langsung</td>
                             <td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Jumlah</td>
                             <td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >(RP.)</td>
                             <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" >%</td>
                        </tr>    
                     </thead>
                    
                     
                        <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" >&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                        </tr>
                        ";
        $sql1 = "SELECT * FROM (SELECT a.kd_urusan1 AS kode, a.nm_urusan1 AS nama,a.kd_urusan1 AS urut,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,1)='4' AND LEFT(kd_skpd,1)=a.kd_urusan1) AS nilai_4,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd WHERE LEFT(kd_rek5,1)='4' AND LEFT(kd_skpd,1)=a.kd_urusan1) AS cp_4,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,1)='4' AND LEFT(d.kd_skpd,1)=a.kd_urusan1) AS debet_4,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,1)='4' AND LEFT(d.kd_skpd,1)=a.kd_urusan1) AS kredit_4,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,2)='51' AND LEFT(kd_skpd,1)=a.kd_urusan1) AS btl,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,2)='52' AND LEFT(kd_skpd,1)=a.kd_urusan1) AS bl,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND LEFT(kd_skpd,1)=a.kd_urusan1) AS jumlah,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,2)='51' AND LEFT(d.kd_skpd,1)=a.kd_urusan1) AS debet_btl,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,2)='51' AND LEFT(d.kd_skpd,1)=a.kd_urusan1) AS kredit_btl,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd WHERE LEFT(kd_rek5,2)='51' AND LEFT(kd_skpd,1)=a.kd_urusan1) AS cp_btl,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,2)='52' AND LEFT(d.kd_skpd,1)=a.kd_urusan1) AS debet_bl,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,2)='52' AND LEFT(d.kd_skpd,1)=a.kd_urusan1) AS kredit_bl,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd WHERE LEFT(kd_rek5,2)='52' AND LEFT(kd_skpd,1)=a.kd_urusan1) AS cp_bl FROM trdrka b
                        RIGHT JOIN ms_urusan1 a ON LEFT(b.kd_skpd,1)=a.kd_urusan1 GROUP BY  a.kd_urusan1 ,a.nm_urusan1
                        UNION
                        SELECT a.kd_urusan AS kode, a.nm_urusan AS nama,a.kd_urusan AS urut,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,1)='4' AND LEFT(kd_skpd,4)=a.kd_urusan) AS nilai_4,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd WHERE LEFT(kd_rek5,1)='4' AND LEFT(kd_skpd,4)=a.kd_urusan) AS cp_4,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,1)='4' AND LEFT(d.kd_skpd,4)=a.kd_urusan) AS debet_4,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,1)='4' AND LEFT(d.kd_skpd,4)=a.kd_urusan) AS kredit_4,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,2)='51' AND LEFT(kd_skpd,4)=a.kd_urusan) AS btl,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,2)='52' AND LEFT(kd_skpd,4)=a.kd_urusan) AS bl,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND LEFT(kd_skpd,4)=a.kd_urusan) AS jumlah,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,2)='51' AND LEFT(d.kd_skpd,4)=a.kd_urusan) AS debet_btl,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,2)='51' AND LEFT(d.kd_skpd,4)=a.kd_urusan) AS kredit_btl,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd WHERE LEFT(kd_rek5,2)='51' AND LEFT(kd_skpd,4)=a.kd_urusan) AS cp_btl,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,2)='52' AND LEFT(d.kd_skpd,4)=a.kd_urusan) AS debet_bl,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,2)='52' AND LEFT(d.kd_skpd,4)=a.kd_urusan) AS kredit_bl,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd WHERE LEFT(kd_rek5,2)='52' AND LEFT(kd_skpd,4)=a.kd_urusan) AS cp_bl FROM trdrka b
                        RIGHT JOIN ms_urusan a ON LEFT(b.kd_skpd,4)=a.kd_urusan WHERE LENGTH(kd_urusan) <> '1' GROUP BY  a.kd_urusan ,a.nm_urusan
                        UNION
                        SELECT a.kd_skpd AS kode, a.nm_skpd AS nama,a.kd_skpd AS urut,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,1)='4' AND kd_skpd=a.kd_skpd) AS nilai_4,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd WHERE LEFT(kd_rek5,1)='4' AND kd_skpd=a.kd_skpd) AS cp_4,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,1)='4' AND d.kd_skpd=a.kd_skpd) AS debet_4,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,1)='4' AND d.kd_skpd=a.kd_skpd) AS kredit_4,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,2)='51' AND kd_skpd=a.kd_skpd) AS btl,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,2)='52' AND kd_skpd=a.kd_skpd) AS bl,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND  kd_skpd=a.kd_skpd) AS jumlah,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,2)='51' AND d.kd_skpd=a.kd_skpd) AS debet_btl,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,2)='51' AND d.kd_skpd=a.kd_skpd) AS kredit_btl,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd WHERE LEFT(kd_rek5,2)='51' AND kd_skpd=a.kd_skpd) AS cp_btl,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,2)='52' AND d.kd_skpd=a.kd_skpd) AS debet_bl,
                        (SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE LEFT(c.kd_rek5,2)='52' AND d.kd_skpd=a.kd_skpd) AS kredit_bl,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd WHERE LEFT(kd_rek5,2)='52' AND kd_skpd=a.kd_skpd) AS cp_bl FROM trdrka b
                        RIGHT JOIN ms_skpd a ON a.kd_skpd=b.kd_skpd GROUP BY a.kd_skpd,a.nm_skpd
                        UNION
                        SELECT '' AS kode, 'JUMLAH' AS nama,'JUMLAH' AS urut,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,1)='4') AS nilai_4,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd WHERE LEFT(kd_rek5,1)='4') AS cp_4,
                        (SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5,1)='4' ) AS debet_4,
                        (SELECT SUM(kredit) FROM trdju_pkd WHERE LEFT(kd_rek5,1)='4' ) AS kredit_4,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,2)='51' ) AS btl,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,2)='52' ) AS bl,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_rek5,1)='5' ) AS jumlah,
                        (SELECT SUM(debet) FROM trdju_pkd WHERE LEFT(kd_rek5,2)='51' ) AS debet_btl,
                        (SELECT SUM(kredit) FROM trdju_pkd WHERE LEFT(kd_rek5,2)='51') AS kredit_btl,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd WHERE LEFT(kd_rek5,2)='51' ) AS cp_btl,
                        (SELECT SUM(debet) FROM trdju_pkd WHERE LEFT(kd_rek5,2)='52' ) AS debet_bl,
                        (SELECT SUM(kredit) FROM trdju_pkd WHERE LEFT(kd_rek5,2)='52' ) AS kredit_bl,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd WHERE LEFT(kd_rek5,2)='52' ) AS cp_bl FROM trdrka b
                        RIGHT JOIN ms_urusan1 a ON LEFT(b.kd_skpd,1)=a.kd_urusan1 GROUP BY  a.kd_urusan1 ,a.nm_urusan1) a ORDER BY a.urut
";

        $query = $this->db->query($sql1);
        foreach ($query->result() as $row)
        {
            $kode = $row->kode;
            $nama = $row->nama;
            $ang_4 = $row->nilai_4;
            $in = $row->cp_4;
            $indebet = $row->debet_4;
            $inkredit = $row->kredit_4;
            $real_4 = ($in + $inkredit) - $indebet;
            $pend = number_format($ang_4, "2", ",", ".");
            $pend_real = number_format($real_4, "2", ",", ".");
            $selisih_4 = $real_4 - $ang_4;
            if ($selisih_4 < 0)
            {
                $x = "(";
                $selisih_4 = $selisih_4 * -1;
                $y = ")";
            } else
            {
                $x = "";
                $y = "";
            }
            $sel_4 = number_format($selisih_4, "2", ",", ".");
            $per_4 = ($selisih_4 != 0) ? ($selisih_4 / $ang_4) * 100 : 0;
            $persen_4 = number_format($per_4);

            $ang_51 = $row->btl;
            $btlcp = $row->cp_btl;
            $debet_btl = $row->debet_btl;
            $kredit_btl = $row->kredit_btl;
            $real_btl = $debet_btl - ($btlcp + $kredit_btl);
            $ang_52 = $row->bl;
            $blcp = $row->cp_bl;
            $debet_bl = $row->debet_bl;
            $kredit_bl = $row->kredit_bl;
            $real_bl = $debet_bl - ($blcp + $kredit_bl);
            $jum_5 = $ang_51 + $ang_52;
            $jum_5_real = $real_btl + $real_bl;
            $btl = number_format($ang_51, "2", ",", ".");
            $bl = number_format($ang_52, "2", ",", ".");
            $jum = number_format($jum_5, "2", ",", ".");
            $btl_real = number_format($real_btl, "2", ",", ".");
            $bl_real = number_format($real_bl, "2", ",", ".");
            $jum_real = number_format($jum_5_real, "2", ",", ".");
            $selisih_5 = $jum_5_real - $jum_5;
            if ($selisih_5 < 0)
            {
                $x1 = "(";
                $selisih_5 = $selisih_5 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $sel_5 = number_format($selisih_5, "2", ",", ".");
            $per_5 = ($selisih_5 != 0) ? ($selisih_5 / $jum_5) * 100 : 0;
            $persen_5 = number_format($per_5);

            $cRet .= "<tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\" width=\"5%\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\" width=\"15%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$pend</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$pend_real</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$x$sel_4$y</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"5%\">$persen_4</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$btl</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$bl</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$jum</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$btl_real</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$bl_real</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$jum_real</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$x1$sel_5$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"5%\">$persen_5</td>
                                </tr>
                                     ";


        }

        $cRet .= " </table>";
        $judul = 'Laporan Realisasi APBD  Lamp II';
        $data['prev'] = $cRet;
        $this->template->set('title', 'CETAK PERDA REALISASI LAMPIRAN II');
        switch ($cetak)
        {
            case 1;
                $this->tukd_model->_mpdf('', $cRet, 10, 10, 10, 'L');
                break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
    }

    function lampiran_III()
    {
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/perda_real_iii', $data);
    }

    function cetak_perdaIII_real($skpd = '', $cetak = '')
    {
        $cetak = $cetak;
        $id = $skpd;
        $sqldns = "SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
        $sqlskpd = $this->db->query($sqldns);
        foreach ($sqlskpd->result() as $rowdns)
        {

            $kd_urusan = $rowdns->kd_u;
            $nm_urusan = $rowdns->nm_u;
            $kd_skpd = $rowdns->kd_sk;
            $nm_skpd = $rowdns->nm_sk;
        }

        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc)
        {

            $tgl = $rowsc->tgl_rka;
            $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
            $kab = $rowsc->kab_kota;
            $daerah = $rowsc->daerah;
            $thn = $rowsc->thn_ang;
        }


        $cRet = '';
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>RINGKASAN REALISASI APBD </strong></td>
                    </tr>
                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table>";
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                    <tr>
                        <td width=\"20%\">Urusan Organisasi </td>
                        <td width=\"80%\">:$kd_urusan - $nm_urusan</td>
                    </tr>
                    <tr>
                        <td>Organisasi</td>
                        <td>:$kd_skpd - $nm_skpd</td>
                    </tr>";

        $cRet .= "</table>";

        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Kode Rekening</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"26%\" align=\"center\"><b>Uraian</b></td>                            
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\"><b>Jumlah (Rp.)</b></td>
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>Bertambah/ (berkurang)</b></td>
                            <td  rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"13%\" align=\"center\"><b>Dasar Hukum</b></td>                            
                            </tr>
                        <tr>
 		                     <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Anggaran </td>
                             <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Realisasi</td>
                             <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Jumlah</td>
                             <td width=\"3%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
                             
                        </tr>    
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>  
                            <td style=\"border-top: none;\"></td>
                                                                                   
                         </tr>
                     </tfoot>
                    
                     
                        <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"26%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"14%\">&nbsp;</td>
                            </tr>
                        ";


        $sql_p = "SELECT * FROM (SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND h.kd_kegiatan = a.kd_kegiatan ) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS kredit,'2' AS nu FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
                        LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,5) ='00.01' GROUP BY a.kd_kegiatan,c.nm_kegiatan
                        UNION ALL 
                        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE  h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                        ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,24)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,25)) a ORDER BY kd_rek,nu ";

        $pend = $this->db->query($sql_p);
        //$query = $this->skpd_model->getAllc();

        foreach ($pend->result() as $row)
        {
            $kode = $row->kd_rek;
            $nama = $row->nm_rek;
            $ang = number_format($row->nilai_u, "2", ".", ",");
            $angaran = $row->nilai_u;
            $pen = $row->cp;
            $debet = $row->debet;
            $kredit = $row->kredit;
            $real = ($pen + $kredit) - $debet;
            $nreal = number_format($real, "2", ".", ",");
            $real_s = $real - $angaran;
            if ($real_s < 0)
            {
                $x1 = "(";
                $real_s = $real_s * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisih = number_format($real_s, "2", ".", ",");
            $per1 = ($real_s != 0) ? ($real_s / $row->nilai_u) * 100 : 0;
            $persen1 = number_format($per1);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>
                                     ";


        }

        $sqltp = "SELECT SUM(a.nilai) AS totp,SUM(a.nilai_ubah) AS totp_u, 
                        (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='4' AND a.kd_skpd='$id') AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,1)='4' AND d.kd_skpd='$id') AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,1)='4' AND f.kd_skpd='$id') AS kredit FROM trdrka a
                         WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'";


        $sqlp = $this->db->query($sqltp);
        foreach ($sqlp->result() as $rowp)
        {
            $angp = number_format($rowp->totp_u, "2", ".", ",");
            $angaranp = $rowp->totp_u;
            $penp = $rowp->cp;
            $debetp = $rowp->debet;
            $kreditp = $rowp->kredit;
            $realp = ($penp + $kreditp) - $debetp;
            $nrealp = number_format($realp, "2", ".", ",");
            $real_sp = $realp - $angaranp;
            if ($real_sp < 0)
            {
                $x1 = "(";
                $real_sp = $real_sp * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisihp = number_format($real_sp, "2", ".", ",");
            $per1p = ($real_sp != 0) ? ($real_sp / $rowp->totp_u) * 100 : 0;
            $persen1p = number_format($per1p);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Jumlah Pendapatan Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        }


        $sqltb = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
            (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='5' AND a.kd_skpd='$id' ) AS cp,
            (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,1)='5' AND d.kd_skpd='$id' ) AS debet,
            (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,1)='5' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
            WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";

        $sqlb = $this->db->query($sqltb);
        foreach ($sqlb->result() as $rowb_5)
        {
            $ang_5 = number_format($rowb_5->totb_u, "2", ".", ",");
            $angaran_5 = $rowb_5->totb_u;
            $in_5 = $rowb_5->cp;
            $debet_5 = $rowb_5->debet;
            $kredit_5 = $rowb_5->kredit;
            $real_5 = $debet_5 - ($in_5 + $kredit_5);
            $nreal_5 = number_format($real_5, "2", ".", ",");
            $real_s_5 = $real_5 - $angaran_5;
            if ($real_s_5 < 0)
            {
                $x1 = "(";
                $real_s_5 = $real_s_5 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_5 = number_format($real_s_5, "2", ".", ",");
            $per_5 = ($real_s_5 != 0) ? ($real_s_5 / $rowb_5->totb_u) * 100 : 0;
            $persen_5 = number_format($per_5);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_5$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_5</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";


        }

        $sqltbtl = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
                            (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='51' AND a.kd_skpd='$id' ) AS cp,
                            (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='51' AND d.kd_skpd='$id' ) AS debet,
                            (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='51' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
                            WHERE LEFT(kd_rek5,2)='51' AND kd_skpd='$id'";


        $sqlbtl = $this->db->query($sqltbtl);
        foreach ($sqlbtl->result() as $rowbtl)
        {
            $ang_51 = number_format($rowbtl->totb_u, "2", ".", ",");
            $angaran_51 = $rowbtl->totb_u;
            $in_51 = $rowbtl->cp;
            $debet_51 = $rowbtl->debet;
            $kredit_51 = $rowbtl->kredit;
            $real_51 = $debet_51 - ($in_51 + $kredit_51);
            $nreal_51 = number_format($real_51, "2", ".", ",");
            $real_s_51 = $real_51 - $angaran_51;
            if ($real_s_51 < 0)
            {
                $x1 = "(";
                $real_s_51 = $real_s_51 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_51 = number_format($real_s_51, "2", ".", ",");
            $per_51 = ($real_s_51 != 0) ? ($real_s_51 / $rowbtl->totb_u) * 100 : 0;
            $persen_51 = number_format($per_51);


        }


        $sql_btl = "SELECT * FROM (SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND h.kd_kegiatan = a.kd_kegiatan ) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS kredit,'2' AS nu FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
                        LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,5) ='00.02' GROUP BY a.kd_kegiatan,c.nm_kegiatan
                        UNION ALL 
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,25)) a ORDER BY kd_rek,nu";

        $btl = $this->db->query($sql_btl);

        foreach ($btl->result() as $row_btl)
        {
            $kode = $row_btl->kd_rek;
            $nama = $row_btl->nm_rek;
            $ang_511 = number_format($row_btl->nilai_u, "2", ".", ",");
            $angaran_511 = $row_btl->nilai_u;
            $in_511 = $row_btl->cp;
            $debet_511 = $row_btl->debet;
            $kredit_511 = $row_btl->kredit;
            $real_511 = $debet_511 - ($in_511 + $kredit_511);
            $nreal_511 = number_format($real_511, "2", ".", ",");
            $real_s_511 = $real_511 - $angaran_511;
            if ($real_s_511 < 0)
            {
                $x1 = "(";
                $real_s_511 = $real_s_511 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_511 = number_format($real_s_511, "2", ".", ",");
            $per_511 = ($real_s_511 != 0) ? ($real_s_511 / $row_btl->nilai_u) * 100 : 0;
            $persen_511 = number_format($per_511);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_511</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_511</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_511$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_511</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>
                                     ";


        }
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";


        $sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                        (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='52' AND a.kd_skpd='$id') AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='52' AND d.kd_skpd='$id') AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='52' AND f.kd_skpd='$id') AS kredit FROM trdrka a
                        WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='$id'";

        $sqlbl = $this->db->query($sqltbl);
        foreach ($sqlbl->result() as $rowbl)
        {
            $ang_52 = number_format($rowbl->totbl_u, "2", ".", ",");
            $angaran_52 = $rowbl->totbl_u;
            $in_52 = $rowbl->cp;
            $debet_52 = $rowbl->debet;
            $kredit_52 = $rowbl->kredit;
            $real_52 = $debet_52 - ($in_52 + $kredit_52);
            $nreal_52 = number_format($real_52, "2", ".", ",");
            $real_s_52 = $real_52 - $angaran_52;
            if ($real_s_52 < 0)
            {
                $x1 = "(";
                $real_s_52 = $real_s_52 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_52 = number_format($real_s_51, "2", ".", ",");
            $per_52 = ($real_s_5 != 0) ? ($real_s_51 / $rowbl->totbl_u) * 100 : 0;
            $persen_52 = number_format($per_52);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Langsung</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_52</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_52</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_52$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_52</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        }
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";


        $sql_bl = "SELECT * FROM (SELECT a.kd_program AS kd_rek, c.nm_program AS nm_rek,(SELECT SUM(nilai) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai_u,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND LEFT(h.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program ) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND LEFT(i.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program ) AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND LEFT(k.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program ) AS kredit,'1' AS nu FROM trskpd a INNER JOIN m_prog c ON a.kd_program1=c.kd_program
                        LEFT JOIN trdrka b ON a.kd_program=LEFT(b.kd_kegiatan,(LENGTH(a.kd_program))) WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_program,c.nm_program 
                        UNION ALL
                        SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND h.kd_kegiatan = a.kd_kegiatan ) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS kredit,'2' AS nu FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
                        LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_kegiatan,c.nm_kegiatan
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                        ON LEFT(a.kd_rek5,2)=b.kd_rek2   
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,24)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3                   
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,25)) a ORDER BY kd_rek,nu";


        $bl = $this->db->query($sql_bl);
        foreach ($bl->result() as $row_bl)
        {
            $kode = $row_bl->kd_rek;
            $nama = $row_bl->nm_rek;
            $ang_522 = number_format($row_bl->nilai_u, "2", ".", ",");
            $angaran_522 = $row_bl->nilai_u;
            $in_522 = $row_bl->cp;
            $debet_522 = $row_bl->debet;
            $kredit_522 = $row_bl->kredit;
            $real_522 = $debet_522 - ($in_522 + $kredit_522);
            $nreal_522 = number_format($real_522, "2", ".", ",");
            $real_s_522 = $real_522 - $angaran_522;
            if ($real_s_522 < 0)
            {
                $x1 = "(";
                $real_s_522 = $real_s_522 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_522 = number_format($real_s_522, "2", ".", ",");
            $per_522 = ($real_s_522 != 0) ? ($real_s_522 / $row_bl->nilai_u) * 100 : 0;
            $persen_522 = number_format($per_522);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_522</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_522</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_522$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_522</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>
                                     ";


        }
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";


        $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_5$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_5</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";


        $sqltpm = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                        (SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='61' AND a.kd_skpd='$id' ) AS cp,
                        (SELECT SUM(IFNULL(debet,0)) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='61' AND d.kd_skpd='$id' ) AS debet,
                        (SELECT SUM(IFNULL(kredit,0)) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='61' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
                        WHERE LEFT(kd_rek5,2)='61' AND kd_skpd='$id'";

        $sqlpm = $this->db->query($sqltpm);
        foreach ($sqlpm->result() as $rowpm)
        {
            $ang_61 = number_format($rowpm->totbl_u, "2", ".", ",");
            $angaran_61 = $rowpm->totbl_u;
            $in_61 = $rowpm->cp;
            $debet_61 = $rowpm->debet;
            $kredit_61 = $rowpm->kredit;
            $real_61 = $debet_61 - ($in_61 + $kredit_61);
            $nreal_61 = number_format($real_61, "2", ".", ",");
            $real_s_61 = $real_61 - $angaran_61;
            if ($real_s_61 < 0)
            {
                $x1 = "(";
                $real_s_61 = $real_s_61 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_61 = number_format($real_s_61, "2", ".", ",");
            $per_61 = ($real_s_61 != 0) ? ($real_s_61 / $rowpm->totbl_u) * 100 : 0;
            $persen_61 = number_format($per_61);
            //
            //                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
            //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Masuk</td>
            //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_61</td>
            //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_61</td>
            //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_61$y1</td>
            //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_61</td>
            //                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
            //                                     </tr>";
        }


        $sqlpm = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                        ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,24)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,25) ) a ORDER BY kd_rek,nu";


        $sql611 = $this->db->query($sqlpm);
        foreach ($sql611->result() as $row_61)
        {
            $kd = $row_61->kd_rek;
            $nm = $row_61->nm_rek;
            $ang_611 = number_format($row_61->nilai_u, "2", ".", ",");
            $angaran_611 = $row_61->nilai_u;
            $in_611 = $row_61->cp;
            $debet_611 = $row_61->debet;
            $kredit_611 = $row_61->kredit;
            $real_611 = $debet_611 - ($in_611 + $kredit_611);
            $nreal_611 = number_format($real_611, "2", ".", ",");
            $real_s_611 = $real_611 - $angaran_611;
            if ($real_s_611 < 0)
            {
                $x1 = "(";
                $real_s_611 = $real_s_611 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_611 = number_format($real_s_611, "2", ".", ",");
            $per_611 = ($real_s_611 != 0) ? ($real_s_611 / $row_61->nilai_u) * 100 : 0;
            $persen_611 = number_format($per_611);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\">$kd</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\">$nm</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$ang_611</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$nreal_611</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$x1$selisih_611$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\">$persen_611</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        }
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

        $sqltpk = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                        (SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='62' AND a.kd_skpd='$id' ) AS cp,
                        (SELECT SUM(IFNULL(debet,0)) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='62' AND d.kd_skpd='$id' ) AS debet,
                        (SELECT SUM(IFNULL(kredit,0)) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='62' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
                        WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id' ";

        $sqlpk = $this->db->query($sqltpk);
        foreach ($sqlpk->result() as $rowpk)
        {
            $ang_62 = number_format($rowpk->totbl_u, "2", ".", ",");
            $angaran_62 = $rowpk->totbl_u;
            //echo($angaran_62);
            $in_62 = $rowpk->cp;
            $debet_62 = $rowpk->debet;
            $kredit_62 = $rowpk->kredit;
            $real_62 = $debet_62 - ($in_62 + $kredit_62);
            $nreal_62 = number_format($real_62, "2", ".", ",");
            $real_s_62 = $real_62 - $angaran_62;
            if ($real_s_62 < 0)
            {
                $x1 = "(";
                $real_s_62 = $real_s_62 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_62 = number_format($real_s_62, "2", ".", ",");
            $per_62 = ($real_s_62 != 0) ? ($real_s_62 / $rowpk->totbl_u) * 100 : 0;
            $persen_62 = number_format($per_62);

            //                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
            //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Keluar</td>
            //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_62</td>
            //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_62</td>
            //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_62$y1</td>
            //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_62</td>
            //                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
            //                                     </tr>";
        }

        $sqlpk = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                        ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,24)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,25) ) a ORDER BY kd_rek,nu";

        $sql62 = $this->db->query($sqlpk);
        foreach ($sql62->result() as $row_62)
        {
            $kd = $row_62->kd_rek;
            $nm = $row_62->nm_rek;
            $ang_622 = number_format($row_62->nilai_u, "2", ".", ",");
            $angaran_622 = $row_62->nilai_u;
            $in_622 = $row_62->cp;
            $debet_622 = $row_62->debet;
            $kredit_622 = $row_62->kredit;
            $real_622 = $debet_622 - ($in_622 + $kredit_622);
            $nreal_622 = number_format($real_622, "2", ".", ",");
            $real_s_622 = $real_622 - $angaran_622;
            if ($real_s_622 < 0)
            {
                $x1 = "(";
                $real_s_622 = $real_s_622 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_622 = number_format($real_s_622, "2", ".", ",");
            $per_622 = ($real_s_611 != 0) ? ($real_s_622 / $row_62->nilai_u) * 100 : 0;
            $persen_622 = number_format($per_622);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\">$kd</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\">$nm</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$ang_622</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$nreal_622</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$x1$selisih_622$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\">$persen_622</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        }
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

        $netto = $angaran_61 - $angaran_62;
        $net = number_format($netto, "2", ",", ".");
        $netto_r = $real_61 - $real_62;
        $net_r = number_format($netto_r, "2", ",", ".");
        $netto_s = $netto_r - $netto;
        if ($netto_s < 0)
        {
            $x1 = "(";
            $netto_s = $netto_s * -1;
            $y1 = ")";
        } else
        {
            $x1 = "";
            $y1 = "";
        }
        $netto_selisih = number_format($netto_s, "2", ",", ".");
        $perpnet = ($netto_s != 0) ? ($netto_s / $netto) * 100 : 0;
        $persennet = number_format($perpnet);


        $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
                                    <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Netto</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$net</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$net_r</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$netto_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persennet</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

        $silpa = ($angaranp + $angaran_61) - ($angaran_5 + $angaran_62);
        if ($silpa < 0)
        {
            $a = "(";
            $silpa = $silpa * -1;
            $b = ")";
        } else
        {
            $a = "";
            $b = "";
        }
        $silp = number_format($silpa, "2", ",", ".");
        $silpa_real = ($realp + $real_61) - ($real_5 + $real_62);
        if ($silpa_real < 0)
        {
            $c = "(";
            $silpa_real = $silpa_real * -1;
            $d = ")";
        } else
        {
            $c = "";
            $d = "";
        }
        $silp_real = number_format($silpa_real, "2", ",", ".");
        $silpa_s = $silpa_real - $silpa;
        if ($silpa_s < 0)
        {
            $x = "(";
            $silpa_s = $silpa_s * -1;
            $y = ")";
        } else
        {
            $x = "";
            $y = "";
        }
        $silpa_selisih = number_format($silpa_s, "2", ",", ".");
        $persil = ($silpa_s != 0) ? ($silpa_s / $silpa) * 100 : 0;
        $persensilpa = number_format($persil);

        //$cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
        //                                    <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">SILPA</td>
        //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$a$silp$b</td>
        //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$c$silp_real$d</td>
        //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x$silpa_selisih$y</td>
        //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persensilpa</td>
        //                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
        //                                     </tr>";
        $cRet .= " </table>";
        $data['prev'] = $cRet;
        $this->template->set('title', 'CETAK REALISASI LAMPIRAN III');


        switch ($cetak)
        {
            case 1;
                $this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
                break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }

    }

    function lampiran_IV()
    {
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/perda_real_iv', $data);
    }
    
	function cetak_lra2()
    {
        $data['page_title']= 'LRA SKPD';
        $this->template->set('title', 'LRA SKPD');   
        $this->template->load('template','akuntansi/cetak_lra',$data) ; 
    }

	function cetak_lra_pemda2()
    {
        $data['page_title']= 'LRA KONSOLIDASI';
        $this->template->set('title', 'LRA KONSOLIDASI');   
        $this->template->load('template','akuntansi/cetak_lra_pemda',$data) ; 
    }
	
    function ctk_lra_ppkd()
    {
        $data['page_title'] = 'REALISASI PPKD';
        $this->template->set('title', 'REALISASI PPKD');
        $this->template->load('template', 'akuntansi/cetak_lra_ppkd', $data);
    }

    function cetak_lra_lo_v()
    {
        $data['page_title']= 'LO SKPD';
        $this->template->set('title', 'LO SKPD');   
        $this->template->load('template','akuntansi/cetak_lra_lo',$data) ; 
    }

    function ctk_lra_lo_ppkd()
    {
        $data['page_title'] = 'LO PPKD';
        $this->template->set('title', 'LO PPKD');
        $this->template->load('template', 'akuntansi/cetak_lra_lo_ppkd', $data);
    }
    
    function cetak_lra_lo_pemda()
    {
        $data['page_title'] = 'LO KONSOLIDASI';
        $this->template->set('title', 'LO KONSOLIDASI');
        $this->template->load('template', 'akuntansi/cetak_lra_lo_pemda', $data);
    }
    
    function cetak_lpe()
    {
        $data['page_title'] = 'LPE SKPD';
        $this->template->set('title', 'LPE SKPD');
        $this->template->load('template', 'akuntansi/cetak_lpe', $data);
    }
    
	function ctk_lpe_ppkd()
    {
        $data['page_title'] = 'LPE';
        $this->template->set('title', 'LPE');
        $this->template->load('template', 'akuntansi/cetak_lpe_ppkd', $data);
    }
	
	function cetak_lpe_pemda()
    {
        $data['page_title'] = 'LPE KONSOLIDASI';
        $this->template->set('title', 'LPE KONSOLIDASI');
        $this->template->load('template', 'akuntansi/cetak_lpe_pemda', $data);
    }
	
    function cetak_lpsal()
    {
        $data['page_title'] = 'LPSAL';
        $this->template->set('title', 'LPSAL');
        $this->template->load('template', 'akuntansi/cetak_lpsal', $data);
    }
	
	function ctk_kapitalisasi(){
        $data['page_title']= 'CETAK KAPITALISASI';
        $this->template->set('title', 'CETAK KAPITALISASI');   
        $this->template->load('template','akuntansi/ctk_kapit',$data) ;	
	}
	
	function ctk_lap_aset(){
        $data['page_title']= 'CETAK LAP. ASET';
        $this->template->set('title', 'CETAK LAP. ASET');   
        $this->template->load('template','akuntansi/cetak_lap_aset',$data) ;	
	}
	
	function ctk_lap_kewajiban(){
        $data['page_title']= 'CETAK LAP. KEWAJIBAN';
        $this->template->set('title', 'CETAK LAP. KEWAJIBAN');   
        $this->template->load('template','akuntansi/cetak_lap_kewajiban',$data) ;	
	}
	
	function ctk_lap_aset_penyu(){
	$data['page_title']= 'CETAK LAP. PENYUSUTAN';
	$this->template->set('title', 'CETAK LAP. PENYUSUTAN');   
	$this->template->load('template','akuntansi/cetak_lap_aset_penyu',$data) ;	
	}
	
	function ctk_lap_amortisasi(){
	$data['page_title']= 'CETAK LAP. AMORTISASI';
	$this->template->set('title', 'CETAK LAP. AMORTISASI');   
	$this->template->load('template','akuntansi/cetak_lap_amortisasi',$data) ;	
	}
	
	function ctk_lap_peng_aset(){
	$data['page_title']= 'CETAK LAP. PENGADAAN ASET';
	$this->template->set('title', 'CETAK LAP. PENGADAAN ASET');   
	$this->template->load('template','akuntansi/cetak_lap_peng',$data) ;	
	}
	
	function ctk_lap_pen_lra(){
	$data['page_title']= 'CETAK LAP. PENJELASAN LRA - LO';
	$this->template->set('title', 'CETAK LAP. PENJELASAN LRA - LO');   
	$this->template->load('template','akuntansi/cetak_lap_pen_lra',$data) ;	
	}
	
	function ctk_lap_kom(){
	$data['page_title']= 'CETAK LAP. DAMPAK KOMULATIF';
	$this->template->set('title', 'CETAK LAP. DAMPAK KOMULATIF');   
	$this->template->load('template','akuntansi/cetak_lap_kom',$data) ;	
	}
	
	function ctk_lap_beb_susut(){
	$data['page_title']= 'CETAK LAP. BEBAN PENYUSUTAN';
	$this->template->set('title', 'CETAK LAP. BEBAN PENYUSUTAN');   
	$this->template->load('template','akuntansi/cetak_lap_beb_susut',$data) ;	
	}
	
	function ctk_lap_lainlain(){
		$data['page_title']= 'CETAK LAP. BEBAN LAIN LAIN';
		$this->template->set('title', 'CETAK LAP. BEBAN LAIN LAIN');   
		$this->template->load('template','akuntansi/cetak_lap_lainlain',$data) ;	
	}
	
	function ctk_lap_lo(){
	$data['page_title']= 'CETAK LAP. OPERASIONAL ';
	$this->template->set('title', 'CETAK LAP. OPERASIONAL');   
	$this->template->load('template','akuntansi/cetak_lap_lo',$data) ;	
	}
	
	function hitung_kapitalisasi(){
		$skpd     = $this->session->userdata('kdskpd');
		$this->db->query("exec kapitalisasi_anguz '$skpd'");		
		echo '1';	
	}
	
	
	function hitung_rincian_kapitalisasi(){
		$skpd     = $this->session->userdata('kdskpd');
		$this->db->query("exec rincian_kapitalisasi_anguz '$skpd'");		
		echo '1';	
	}
	
	function proses_transfer_lamp(){
		$skpd     = $this->session->userdata('kdskpd');
		$this->db->query("exec kapitalisasi_transfer '$skpd'");		
		echo '1';	
	}
	
	function thapus_rincian_kapit(){
        $skpd = $this->input->post('skpd');
        $giat  = $this->input->post('giat');
        $rek  = $this->input->post('rek');
        $nolamp  = $this->input->post('nolamp');
		
        $query = $this->db->query("delete from lamp_aset where kd_skpd='$skpd' and no_lamp='$nolamp'");
        $query = $this->db->query("delete from trdkapitalisasi where kd_skpd='$skpd' and kd_kegiatan='$giat' and kd_rek5_trans='$rek' and no_lamp='$nolamp'");
        if ( $query > 0 ){
            echo '1' ;
        } else {
            echo '0' ;
        }
    }
	function kapit_rinci($skpd='',$kegiatan='',$rekening='') {
        
        $norinci  = $skpd.'.'.$kegiatan.'.'.$rekening;
        $sql    = "select *,tahun_n+nilai as tot_kap from trdkapitalisasi where no_rinci='$norinci' order by no_lamp";                   
        
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii     = 0;

        foreach($query1->result_array() as $resulte)
        { 
           
            $result[] = array(
                        'id'      => $ii,   
                        'no_lamp'  => $resulte['no_lamp'],  
                        'kd_rek3'    => $resulte['kd_rek3'],  
                        'nm_rek3'   => $resulte['nm_rek3'],  
                        'kd_rek5'  => $resulte['kd_rek5'],  
                        'nm_rek5' => $resulte['nm_rek5'],  
                        'kd_rek6' => $resulte['kd_rek6'],  
                        'nm_rek6' => $resulte['nm_rek6'],  
                        'tahun' => $resulte['tahun'],
                        'merk' => $resulte['merk'],
                        'no_polisi' => $resulte['no_polisi'],
                        'fungsi' => $resulte['fungsi'],
                        'hukum' => $resulte['hukum'],
                        'lokasi' => $resulte['lokasi'],
                        'alamat' =>$resulte['alamat'],
                        'sert'=>$resulte['sert'],
                        'luas'=>$resulte['luas'],
                        'jumlah'=>$resulte['jumlah'],
                        'satuan'=>$resulte['satuan'],
                        'harga_satuan'=>number_format($resulte['harga_satuan'],"2",".",","),
                        'piutang_awal'=>number_format($resulte['piutang_awal'],"2",".",","),
                        'piutang_koreksi'=>number_format($resulte['piutang_koreksi'],"2",".",","),
                        'piutang_sudah'=>number_format($resulte['piutang_sudah'],"2",".",","),
                        'investasi_awal'=>number_format($resulte['investasi_awal'],"2",".",","),
                        'sal_awal'=>number_format($resulte['sal_awal'],"2",".",","),
                        'kurang'=>number_format($resulte['kurang'],"2",".",","),
                        'tambah'=>number_format($resulte['tambah'],"2",".",","),
                        'tahun_n'=>number_format($resulte['tahun_n'],"2",".",","),
                        'kondisi_b'=>$resulte['kondisi_b'],     
                        'kondisi_rr'=>$resulte['kondisi_rr'],     
                        'kondisi_rb'=>$resulte['kondisi_rb'],     
                        'rincian_beban'=>$resulte['rincian_beban'],     
                        'no_polis'=>$resulte['no_polis'],     
                        'bulan'=>$resulte['bulan'],     
                        'kepemilikan'=>$resulte['kepemilikan'],     
                        'keterangan'=>$resulte['keterangan'],
                        'nilai'=>number_format($resulte['nilai'],"2",".",","),
                        'tot_kap'=>number_format($resulte['tot_kap'],"2",".",",")
                        );
                        $ii++;
        }
           
           echo json_encode($result);
    }
	function update_rincian_kapitalisasi(){
		$skpd     = $this->session->userdata('kdskpd');
        $kdgiat   = $this->input->post('kdgiat');
        $kdrek5 = $this->input->post('kdrek5');
        $no_lamp = $this->input->post('no_lamp');
        $xnil     = $this->input->post('xnil');
        
        
            $sql = "UPDATE trdkapitalisasi SET nilai=$xnil WHERE kd_skpd='$skpd' AND kd_kegiatan='$kdgiat' AND kd_rek5_trans='$kdrek5' AND no_lamp='$no_lamp'";
            $asg = $this->db->query($sql);
            if($asg){
                echo '2';
            }else{
                echo '0';
            }
        
        
    }
	function load_sum_kapit_rinci(){

		$kdskpd = $this->input->post('skpd');
		$kegiatan = $this->input->post('keg');
		$rek = $this->input->post('rek');
		$norinci=$kdskpd.'.'.$kegiatan.'.'.$rek;

        $query1 = $this->db->query(" select sum(tahun_n) as rektotal_rinci,sum(nilai) as rektotal_rinci_kapit from trdkapitalisasi where no_rinci='$norinci' ");  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
           
            $result[] = array(
                        'id' => $ii,        
                        'rektotal_rinci' => number_format($resulte['rektotal_rinci'],"2",".",","),  
                        'rektotal_rinci_kapit' => number_format($resulte['rektotal_rinci_kapit'],"2",".",",")  
                        );
                        $ii++;
        }
           
           //return $result;
		   echo json_encode($result);	
	}
	 
    function cek_rek_aset(){
        $kdrek5     = $this->input->post('kdrek5');
        $result   = array();
        $query    = $this->db->query("select LEFT(a.kd_rek5,3) as kdrek3,LEFT(a.map_lo,3) as kdrek3_u, c.nm_rek3, a.kd_rek5,a.nm_rek5,a.map_lo,b.nm_rek5 FROM ms_rek5 a
					inner join ms_rek5 b ON a.map_lo=b.kd_rek5 
					INNER JOIN ms_rek3_64 c ON LEFT(a.map_lo,3)=c.kd_rek3 where a.kd_rek5='$kdrek5'");
        $ii       = 0;
        foreach ( $query->result_array() as $row ){
            $result[] = array(
                'id'    =>  '$ii',
                'kdrek3' =>  $row['kdrek3'],
                'kdrek3_u' =>  $row['kdrek3_u'],
                'nm_rek3' =>  $row['nm_rek3'],
                'kdrek5' =>  $row['kd_rek5'],
                'nm_rek5' =>  $row['nm_rek5'],
                'map_lo' =>  $row['map_lo']
            );
            $ii++;
        }
        echo json_encode($result);
    }
	
	function cetak_kapitalisasi($kdskpd='',$ctk=''){
        $thn_ang = $this->session->userdata('pcThang');
        $lcskpd = $kdskpd;
        $skpd =  $this->tukd_model->get_nama($kdskpd,'nm_skpd','ms_skpd','kd_skpd');
        $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="17" align="center" ><b>'.$prov.' </TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="17" align="center" ><b>KAPITALISASI </TD>
					</TR>
					</TABLE><br/>';
			$cRet .='<TABLE width="100%">
					 <TR>
						<TD align="left" width="20%" >SKPD</TD>
						<TD colspan= "15" align="left" width="100%" >: '.$lcskpd.' '.$skpd.'</TD>
					 </TR>
					 </TABLE>';

			$cRet .='<TABLE style="border-collapse:collapse" width="100%" border="1" cellspacing="0" cellpadding="1" align=center>
					 <thead>
					 <TR>
						<TD rowspan="2" width="80" bgcolor="#CCCCCC" align="center" >Kode</TD>
						<TD rowspan="2" width="80" bgcolor="#CCCCCC" align="center" >Uraian</TD>
						<TD rowspan="2" width="80" bgcolor="#CCCCCC" align="center" >Nama Barang</TD>
						<TD rowspan="2" width="80" bgcolor="#CCCCCC" align="center" >Klasifikasi Aset</TD>
                        <TD colspan="2" width="90"  bgcolor="#CCCCCC" align="center" >Pegawai</TD>
						<TD colspan="2" width="150"  bgcolor="#CCCCCC" align="center" >Barang dan Jasa</TD>
						<TD colspan="2" width="150" bgcolor="#CCCCCC" align="center" >Belanja Modal</TD>
						<TD colspan="2" width="150" bgcolor="#CCCCCC" align="center" >Belanja Modal dan Administrasi Pengadaan</TD>
						<TD colspan="3" width="150" bgcolor="#CCCCCC" align="center" >Kapitalisasi</TD>
						<TD rowspan="2" width="150" bgcolor="#CCCCCC" align="center" >Qty</TD>
						<TD rowspan="2" width="150" bgcolor="#CCCCCC" align="center" >Sat.</TD>
					 </TR>
					 <TR>
                        <TD width="90"  bgcolor="#CCCCCC" align="center" >Anggaran</TD>
						<TD width="150"  bgcolor="#CCCCCC" align="center" >Realisasi</TD>						
						<TD width="150"  bgcolor="#CCCCCC" align="center" >Anggaran</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >Realisasi</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >Anggaran</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >Realisasi</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >Anggaran</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >Realisasi</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >Anggaran</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >Penghitungan Kapitalisasi</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >Realisasi</TD>
					 </TR>
					 <TR>
                        <TD width="90"  bgcolor="#CCCCCC" align="center" >1</TD>
						<TD width="150"  bgcolor="#CCCCCC" align="center" >2</TD>						
						<TD width="150"  bgcolor="#CCCCCC" align="center" >3</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >4</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >5</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >6</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >7</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >8</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >9</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >10</TD>
						<TD width="90"  bgcolor="#CCCCCC" align="center" >11</TD>
						<TD width="150"  bgcolor="#CCCCCC" align="center" >12</TD>						
						<TD width="150"  bgcolor="#CCCCCC" align="center" >13</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >14</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >15</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >16</TD>
						<TD width="150" bgcolor="#CCCCCC" align="center" >17</TD>
					 </TR>
					 </thead>
					 ';
				$total_kap = 0;
				$total_ang_peg = 0;
				$total_real_peg = 0;
				$total_ang_brg = 0;
				$total_real_brg = 0;
				$total_ang_mod = 0;
				$total_real_mod = 0;
				$total_ang_peng = 0;
				$total_real_peng = 0;
				$total_ang_kap = 0;
				$total_nil_kap = 0;
				$total_tot_kap = 0;
				$query = $this->db->query(" exec cetak_kapitalisasi '$lcskpd'");
				foreach ($query->result() as $row) {
                    $kode = $row->kode; 
                    $uraian = $row->uraian;                   
                    $nama_barang = $row->nama_barang;                   
                    $klasifikasi = $row->klasifikasi;
                    $ang_peg =$row->ang_peg;
                    $real_peg=$row->real_peg;
                    $ang_brg = $row->ang_brg;
                    $real_brg = $row->real_brg;
                    $ang_mod = $row->ang_mod;
                    $real_mod = $row->real_mod;
					$ang_x  = $row->ang_x;
                    $real_x  = $row->real_x;
                    $ang_peng  = $row->ang_peng;
                    $real_peng  = $row->real_peng;
					$ang_pengx  = $ang_x+$ang_peng;
                    $real_pengx  = $real_x+$real_peng;
                    $ang_kap  = $ang_peg+$ang_brg+$ang_mod+$ang_peng;
                    $nil_kap  = $row->nil_kap;
                    $tot_kap  = $real_mod+$nil_kap;
                    $qty  = $row->qty;
                    $sat  = $row->sat;
                    $jen  = $row->jen;
					
					$panjang = strlen($kode);
					$ang_peg1  = empty($ang_peg) || $ang_peg == 0 ? '' :number_format($ang_peg,"2",",",".");
					$real_peg1 = empty($real_peg) || $real_peg == 0 ? '' :number_format($real_peg,"2",",",".");
					$ang_brg1  = empty($ang_brg) || $ang_brg == 0 ? '' :number_format($ang_brg,"2",",",".");
					$real_brg1 = empty($real_brg) || $real_brg == 0 ? '' :number_format($real_brg,"2",",",".");
					$ang_mod1  = empty($ang_mod) || $ang_mod == 0 ? '' :number_format($ang_mod,"2",",",".");
					$real_mod1 = empty($real_mod) || $real_mod == 0 ? '' :number_format($real_mod,"2",",",".");
					$ang_kap1  =  $ang_kap == 0 ? '' :number_format($ang_kap,"2",",",".");
					$nil_kap1 = empty($nil_kap) || $nil_kap == 0 ? '' :number_format($nil_kap,"2",",",".");
					$tot_kap1  = $tot_kap == 0 ? '' :number_format($tot_kap,"2",",",".");
					$ang_peng1  = empty($ang_pengx) || $ang_pengx == 0 ? '' :number_format($ang_pengx,"2",",",".");
					$real_peng1  = empty($real_pengx) || $real_pengx == 0 ? '' :number_format($real_pengx,"2",",",".");
					$qty1  = empty($qty) || $qty == 0 ? '' :number_format($qty,"0",",",".");
					
					if($panjang==18){
					$total_ang_peg=$total_ang_peg+$ang_peg;
					$total_real_peg=$total_real_peg+$real_peg;
					$total_ang_brg=$total_ang_brg+$ang_brg;
					$total_real_brg=$total_real_brg+$real_brg;
					$total_ang_mod=$total_ang_mod+$ang_mod;
					$total_real_mod=$total_real_mod+$real_mod;
					$total_ang_peng=$total_ang_peng+$ang_pengx;
					$total_real_peng=$total_real_peng+$real_pengx;
					$total_ang_kap=$total_ang_kap+$ang_kap;
					$total_nil_kap=$total_nil_kap+$nil_kap;
					$total_tot_kap=$total_tot_kap+$tot_kap;
					}
					if ($jen=='Y'){
					$cRet.='<TR>
                        <TD width="90"  >'.$kode.'</TD>
						<TD width="150" >'.$uraian.'</TD>						
						<TD width="150" >'.$nama_barang.'</TD>
						<TD width="150" >'.$klasifikasi.'</TD>
						<TD width="150" align="right" >'.$ang_peg1.'</TD>
						<TD width="150" align="right" >'.$real_peg1.'</TD>
						<TD width="150" align="right" >'.$ang_brg1.'</TD>
						<TD width="150" align="right" >'.$real_brg1.'</TD>
						<TD width="150" align="right" >'.$ang_mod1.'</TD>
						<TD width="150" align="right" >'.$real_mod1.'</TD>
						<TD width="90"  align="right" >'.$ang_peng1.'</TD>
						<TD width="150" align="right" >'.$real_peng1.'</TD>						
						<TD width="150" align="right" >'.$ang_kap1.'</TD>
						<TD width="150" align="right" >'.$nil_kap1.'</TD>
						<TD width="150" align="right" >'.$tot_kap1.'</TD>
						<TD width="150" align="center">'.$qty1.'</TD>
						<TD width="150" >'.$sat.'</TD>
						</TR>';
					} else{
					$cRet.='<TR>
                        <TD width="90"  >'.$kode.'</TD>
						<TD width="150" >'.$uraian.'</TD>						
						<TD width="150" >'.$nama_barang.'</TD>
						<TD width="150" >'.$klasifikasi.'</TD>
						<TD width="150" align="right" >'.$ang_peg1.'</TD>
						<TD width="150" align="right" >'.$real_peg1.'</TD>
						<TD width="150" align="right" >'.$ang_brg1.'</TD>
						<TD width="150" align="right" >'.$real_brg1.'</TD>
						<TD width="150" align="right" >'.$ang_mod1.'</TD>
						<TD width="150" align="right" >'.$real_mod1.'</TD>
						<TD width="90"  align="right" >'.$ang_peng1.'</TD>
						<TD width="150" align="right" >'.$real_peng1.'</TD>						
						<TD width="150" align="right" ></TD>
						<TD width="150" align="right" ></TD>
						<TD width="150" align="right" ></TD>
						<TD width="150" align="center"></TD>
						<TD width="150" ></TD>
						</TR>';	
					}
					
				}
				$cRet.='<TR>
                        <TD width="90" colspan="4" align="center" >TOTAL</TD>
						<TD width="150" align="right" >'.number_format($total_ang_peg,"2",",",".").'</TD>
						<TD width="150" align="right" >'.number_format($total_real_peg,"2",",",".").'</TD>
						<TD width="150" align="right" >'.number_format($total_ang_brg,"2",",",".").'</TD>
						<TD width="150" align="right" >'.number_format($total_real_brg,"2",",",".").'</TD>
						<TD width="150" align="right" >'.number_format($total_ang_mod,"2",",",".").'</TD>
						<TD width="150" align="right" >'.number_format($total_real_mod,"2",",",".").'</TD>
						<TD width="90"  align="right" >'.number_format($total_ang_peng,"2",",",".").'</TD>
						<TD width="150" align="right" >'.number_format($total_real_peng,"2",",",".").'</TD>						
						<TD width="150" align="right" >'.number_format($total_ang_kap,"2",",",".").'</TD>
						<TD width="150" align="right" >'.number_format($total_nil_kap,"2",",",".").'</TD>
						<TD width="150" align="right" >'.number_format($total_tot_kap,"2",",",".").'</TD>
						<TD width="150" align="center"></TD>
						<TD width="150" ></TD>
						</TR>';
						
			$cRet .='</TABLE>';
			//$ctk=0;
			$judul="Kapit_$lcskpd";
			$data['prev']= $cRet;
             switch ($ctk){
				case 0;
				echo ("<title>Kapitalisasi</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			}
		}
	
	
	
	function cetak_lap_aset($kdskpd='',$rek3='',$ctk=''){
        $thn_ang = $this->session->userdata('pcThang');
        $thn_sbl = $thn_ang-1;
        $lcskpd = $kdskpd;
        if($rek3==15){
			$nama_rek='Aset Lainnya';
		}else{
			$nama_rek=$this->tukd_model->get_nama($rek3,'nm_rek3','ms_rek3_64','kd_rek3');
		}
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="7" align="center" ><b>'.$prov.' </TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="7" align="center" >'.$nama_rek.' </TD>
					</TR>
					</TABLE><br/>';
			
$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td width=\"5%\" align=\"center\" style=\"font-size:12px\">Kode</td>
					<td width=\"40%\" align=\"center\" style=\"font-size:12px\">Nama Unit Kerja</td>
					<td width=\"10%\" align=\"center\" style=\"font-size:12px\">$thn_sbl</td>
					<td width=\"10%\" align=\"center\" style=\"font-size:12px\">Tambah</td>
					<td width=\"10%\" align=\"center\" style=\"font-size:12px\">Kurang</td>
					<td width=\"10%\" align=\"center\" style=\"font-size:12px\">Pengadaan $thn_ang</td>
					<td width=\"10%\" align=\"center\" style=\"font-size:12px\">$thn_ang</td>
					
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">7</td> 
				</tr>
				</thead>";
			$tot_awal=0;
			$tot_tambah=0;
			$tot_kurang=0;
			$tot_tahun_n=0;
			$tot_total=0;
			$sql = "SELECT a.kd_skpd, a.nm_skpd, ISNULL(sal_awal,0) sal_awal, ISNULL(tambah,0) tambah, ISNULL(kurang,0) kurang,
					ISNULL(tahun_n,0) tahun_n FROM ms_skpd a
					LEFT JOIN (
					SELECT a.kd_skpd, SUM(a.sal_awal) sal_awal, SUM(a.tambah) as tambah, SUM(a.kurang) as kurang, SUM(a.tahun_n) as tahun_n FROM lamp_aset a 
					WHERE kd_rek3='$rek3'
					GROUP BY a.kd_skpd) b ON a.kd_skpd=b.kd_skpd
					ORDER BY a.kd_skpd";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_skpd;
                       $nama = $row->nm_skpd;
                       $sal_awal = $row->sal_awal;
                       $tambah = $row->tambah;
                       $kurang = $row->kurang;
                       $tahun_n = $row->tahun_n;
                       $tot = $sal_awal+$tambah-$kurang+$tahun_n;
						$tot_awal=$tot_awal+$sal_awal;
						$tot_tambah=$tot_tambah+$tambah;
						$tot_kurang=$tot_kurang+$kurang;
						$tot_tahun_n=$tot_tahun_n+$tahun_n;
						$tot_total=$tot_total+$tot;
					 $cRet .='<tr>
							   <td align="left" valign="top" style="font-size:12px">'.$kode.'</td> 
							   <td align="left" style="font-size:12px">'.$nama.'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($sal_awal, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($tambah, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($kurang, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($tahun_n, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($tot, "2", ",", ".").'</td> 
							</tr>'; 
					}
			 $cRet .='<tr>
						   <td colspan="2" align="center" valign="top" style="font-size:12px">TOTAL</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_awal, "2", ",", ".").'</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_tambah, "2", ",", ".").'</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_kurang, "2", ",", ".").'</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_tahun_n, "2", ",", ".").'</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_total, "2", ",", ".").'</td> 
						</tr>';
			$cRet .="</table>";
			$data['prev']= $cRet;    
             switch ($ctk){
				case 0;
				echo ("<title>Lap. Aset</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'P');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $nama_rek.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
    function cetak_lap_aset_rinci($kdskpd='',$rek3='',$ctk=''){
        $thn_ang = $this->session->userdata('pcThang');
        $thn_sbl = $thn_ang-1;
        $lcskpd = $kdskpd;
        if($rek3==15){
			$nama_rek='Aset Lainnya';
		}else{
			$nama_rek=$this->tukd_model->get_nama($rek3,'nm_rek3','ms_rek3_64','kd_rek3');
		}
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="7" align="center" ><b>'.$prov.' </TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="7" align="center" >'.$nama_rek.' </TD>
					</TR>
					</TABLE><br/>';
			
$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Kode</td>
					<td width=\"25%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Nama Unit Kerja</td>
					<td width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Kode Akun</td>
					<td width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Uraian Akun</td>
					<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">$thn_sbl</td>
					<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Tambah</td>
					<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Kurang</td>
					<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Pengadaan $thn_ang</td>
					<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">$thn_ang</td>
					
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">7</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">8</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">9</td> 
				</tr>
				</thead>";
			$tot_awal=0;
			$tot_tambah=0;
			$tot_kurang=0;
			$tot_tahun_n=0;
			$tot_total=0;
			$sql = "SELECT kd_skpd, nm_skpd, kd_rek3, nm_rek3, sal_awal, tambah, kurang, tahun_n  FROM (
					select a.kd_skpd,(select nm_skpd from ms_skpd where kd_skpd=a.kd_skpd group by nm_skpd) nm_skpd, a.kd_rek3, (SELECT nm_rek3 FROM ms_rek3_64 WHERE kd_rek3=a.kd_rek3) nm_rek3, SUM(a.sal_awal) sal_awal, SUM(a.tambah) as tambah, SUM(a.kurang) as kurang, SUM(a.tahun_n) as tahun_n 
					from lamp_aset a where kd_rek3='$rek3'
					group by a.kd_skpd, a.kd_rek3, a.nm_rek3
					UNION ALL 
					select a.kd_skpd,(select nm_skpd from ms_skpd where kd_skpd=a.kd_skpd group by nm_skpd) nm_skpd, LEFT(a.kd_rek5,5) kd_rek4,(select nm_rek4_64 from ms_rek4_64 where kd_rek4_64=LEFT(a.kd_rek5,5)) nm_rek3, 
									  SUM(a.sal_awal) sal_awal, SUM(a.tambah) as tambah, 
									  SUM(a.kurang) as kurang, SUM(a.tahun_n) as tahun_n 
					from lamp_aset a where kd_rek3='$rek3'
					group by a.kd_skpd, LEFT(a.kd_rek5,5) ) x
					where kd_skpd<>''
					order by kd_skpd, kd_rek3";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_skpd;
                       $nama = $row->nm_skpd;
                       $kd_rek = $row->kd_rek3;
                       $nm_rek = $row->nm_rek3;
                       $sal_awal = $row->sal_awal;
                       $tambah = $row->tambah;
                       $kurang = $row->kurang;
                       $tahun_n = $row->tahun_n;
                       $tot = $sal_awal+$tambah-$kurang+$tahun_n;
						
						
					$len = 	strlen($kd_rek);
					
						if($len=='3'){
							 $cRet .='<tr>
									   <td align="center" valign="top" style="font-size:12px"><b>'.$kode.'</b></td> 
									   <td align="left" style="font-size:12px"><b>'.$nama.'</b></td> 
									   <td align="left" style="font-size:12px"><b>'.$kd_rek.'</b></td> 
									   <td align="left" style="font-size:12px"><b>'.$nm_rek.'</b></td>
									   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($sal_awal, "2", ",", ".").'</b></td> 
									   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tambah, "2", ",", ".").'</b></td> 
									   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($kurang, "2", ",", ".").'</b></td> 
									   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tahun_n, "2", ",", ".").'</b></td> 
									   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot, "2", ",", ".").'</b></td> 
									</tr>'; 
						}else{
							 $cRet .='<tr>
								   <td align="center" valign="top" style="font-size:12px">'.$kode.'</td> 
								   <td align="left" style="font-size:12px">'.$nama.'</td> 
								   <td align="left" style="font-size:12px">'.$kd_rek.'</td> 
								   <td align="left" style="font-size:12px">'.$nm_rek.'</td>
								   <td align="right" valign="top" style="font-size:12px">'.number_format($sal_awal, "2", ",", ".").'</td> 
								   <td align="right" valign="top" style="font-size:12px">'.number_format($tambah, "2", ",", ".").'</td> 
								   <td align="right" valign="top" style="font-size:12px">'.number_format($kurang, "2", ",", ".").'</td> 
								   <td align="right" valign="top" style="font-size:12px">'.number_format($tahun_n, "2", ",", ".").'</td> 
								   <td align="right" valign="top" style="font-size:12px">'.number_format($tot, "2", ",", ".").'</td> 
								</tr>'; 
						}
					}
					
			$sql_tot = "SELECT SUM(a.sal_awal) sal_awal, SUM(a.tambah) as tambah, SUM(a.kurang) as kurang, 
								   SUM(a.tahun_n) as tahun_n 
							FROM lamp_aset a 
							WHERE kd_rek3='$rek3' AND kd_skpd<>''";
			 $hasil_tot = $this->db->query($sql_tot);
                    foreach ($hasil_tot->result() as $row)
                    {
						$sal_awal = $row->sal_awal;
					    $tambah = $row->tambah;
					    $kurang = $row->kurang;
					    $tahun_n = $row->tahun_n;
						
						$tot_awal=$tot_awal+$sal_awal;
						$tot_tambah=$tot_tambah+$tambah;
						$tot_kurang=$tot_kurang+$kurang;
						$tot_tahun_n=$tot_tahun_n+$tahun_n;
						$tot=$sal_awal+$tambah-$kurang+$tahun_n;
						$tot_total=$tot_total+$tot;
					
			
					 $cRet .='<tr>
								   <td colspan="4" align="center" valign="top" style="font-size:12px">TOTAL</td> 
								   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_awal, "2", ",", ".").'</b></td> 
								   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_tambah, "2", ",", ".").'</b></td> 
								   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_kurang, "2", ",", ".").'</b></td> 
								   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_tahun_n, "2", ",", ".").'</b></td> 
								   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_total, "2", ",", ".").'</b></td> 
								</tr>';
						
					}
			$cRet .="</table>";
			$data['prev']= $cRet;    
             switch ($ctk){
				case 0;
				echo ("<title>Lap. Aset Rinci</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'P');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $nama_rek.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
	function cetak_lap_aset_neraca($kdskpd='',$rek3='',$ctk=''){
        $thn_ang = $this->session->userdata('pcThang');
        $thn_sbl = $thn_ang-1;
        $lcskpd = $kdskpd;
		
		if($rek3==15){
			$nama_rek='Aset Lainnya';
			$where="LEFT(b.kd_rek5,2)";
			$rek3_ =$rek3;
		}else if($rek3==153){
			$nama_rek=$this->tukd_model->get_nama($rek3,'nm_rek3','ms_rek3_64','kd_rek3');
			$where="LEFT(b.kd_rek5,5)";
			$rek3_ =15305; 
		}else if($rek3==15306){
			$nama_rek=$this->tukd_model->get_nama(153,'nm_rek3','ms_rek3_64','kd_rek3');
			$where="LEFT(b.kd_rek5,5)";
			$rek3_ =15306; 
		}else{
			$nama_rek=$this->tukd_model->get_nama($rek3,'nm_rek3','ms_rek3_64','kd_rek3');
			$where="LEFT(b.kd_rek5,3)";
			$rek3_ =$rek3;
		}
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="7" align="center" ><b>'.$prov.' </TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="7" align="center" >'.$nama_rek.' </TD>
					</TR>
					</TABLE><br/>';
			
			$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Kode</td>
					<td width=\"45%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Nama Unit Kerja</td>
					<td width=\"25%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">$thn_ang</td>
					<td width=\"25%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">$thn_sbl</td>
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
				</tr>
				</thead>";
			$tot_nilai=0;
			$tot_nilai_lalu=0;
			/* $sql = "SELECT * FROM (SELECT b.kd_unit, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=b.kd_unit) nm_skpd,
						   SUM(CASE WHEN YEAR(a.tgl_voucher)<=$thn_ang THEN debet-kredit ELSE 0 END) nilai,
						   SUM(CASE WHEN YEAR(a.tgl_voucher)<=$thn_sbl THEN debet-kredit ELSE 0 END) nilai_lalu 
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
					WHERE $where IN ('$rek3') GROUP BY b.kd_unit) z WHERE nilai<>0 OR nilai_lalu<>0 ORDER BY kd_unit"; */
					
				$sql = "SELECT x.kd_skpd kd_unit, x.nm_skpd, ISNULL(nilai,0) nilai, ISNULL(nilai_lalu,0) nilai_lalu 
						FROM (
						SELECT kd_skpd, nm_skpd FROM ms_skpd
						) x
						LEFT JOIN
						(
						SELECT * FROM (SELECT b.kd_unit, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=b.kd_unit) nm_skpd,
												   SUM(CASE WHEN YEAR(a.tgl_voucher)<=$thn_ang THEN debet-kredit ELSE 0 END) nilai,
												   SUM(CASE WHEN YEAR(a.tgl_voucher)<=$thn_sbl THEN debet-kredit ELSE 0 END) nilai_lalu 
											FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
											WHERE $where IN ('$rek3_') GROUP BY b.kd_unit) z WHERE nilai<>0 OR nilai_lalu<>0 
						) y ON x.kd_skpd=y.kd_unit					
						ORDER BY kd_unit";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_unit;
                       $nama = $row->nm_skpd;
                       $nilai = $row->nilai;
                       $nilai_lalu = $row->nilai_lalu;
					   
					   $tot_nilai = $tot_nilai+$nilai;
					   $tot_nilai_lalu = $tot_nilai_lalu+$nilai_lalu;
                       
						$cRet .='<tr>
							   <td align="center" valign="top" style="font-size:12px">'.$kode.'</td> 
							   <td align="left" style="font-size:12px">'.$nama.'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($nilai, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($nilai_lalu, "2", ",", ".").'</td> 
							</tr>'; 
					}
					
					
					
						$cRet .='<tr>
							   <td colspan="2" align="center" valign="top" style="font-size:12px"><b>TOTAL</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_nilai, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_nilai_lalu, "2", ",", ".").'</b></td> 
							</tr>'; 
							
			$cRet .="</table>";
			$data['prev']= $cRet;    
             switch ($ctk){
				case 0;
				echo ("<title>Lap. Aset Neraca</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'P');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $nama_rek.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
	function cetak_lap_aset_neraca_rinci($kdskpd='',$rek3='',$ctk=''){
        $thn_ang = $this->session->userdata('pcThang');
        $thn_sbl = $thn_ang-1;
        $lcskpd = $kdskpd;
        
		if($rek3==15){
			$nama_rek='Aset Lainnya';
			$where="LEFT(b.kd_rek5,2)";
			$where2="LEFT(b.kd_rek5,2)";
			$rek3_ =$rek3;
		}else if($rek3==153){
			$nama_rek=$this->tukd_model->get_nama($rek3,'nm_rek3','ms_rek3_64','kd_rek3');
			$where="LEFT(b.kd_rek5,5)";
			$where2="LEFT(b.kd_rek5,3)";
			$rek3_ =15305; 
		}else if($rek3==15306){
			$nama_rek=$this->tukd_model->get_nama(153,'nm_rek3','ms_rek3_64','kd_rek3');
			$where="LEFT(b.kd_rek5,5)";
			$where2="LEFT(b.kd_rek5,3)";
			$rek3_ =15306; 
		}else{
			$nama_rek=$this->tukd_model->get_nama($rek3,'nm_rek3','ms_rek3_64','kd_rek3');
			$where="LEFT(b.kd_rek5,3)";
			$where2="LEFT(b.kd_rek5,3)";
			$rek3_ =$rek3;
		}
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="7" align="center" ><b>'.$prov.' </TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="7" align="center" >'.$nama_rek.' </TD>
					</TR>
					</TABLE><br/>';
			
			$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Kode</td>
					<td width=\"45%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Nama Unit Kerja</td>
					<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Kode Akun</td>
					<td width=\"20%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Uraian Akun</td>
					<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">$thn_ang</td>
					<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">$thn_sbl</td>
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
				</tr>
				</thead>";
			$tot_nilai=0;
			$tot_nilai_lalu=0;
			$sql = "SELECT * FROM (SELECT 1 jns, b.kd_unit, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=b.kd_unit) nm_unit, $where2 kd_akun,
						   (SELECT nm_rek3 FROM ms_rek3_64 WHERE kd_rek3=$where2) nm_akun,
						   SUM(CASE WHEN YEAR(a.tgl_voucher)<=$thn_ang THEN debet-kredit ELSE 0 END) nilai,
						   SUM(CASE WHEN YEAR(a.tgl_voucher)<=$thn_sbl THEN debet-kredit ELSE 0 END) nilai_lalu 
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
					WHERE $where IN ('$rek3_') GROUP BY b.kd_unit, $where2 
					UNION ALL
					SELECT 2 jns, b.kd_unit, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=b.kd_unit) nm_unit, LEFT(b.kd_rek5,5) kd_akun,
						   (SELECT nm_rek4_64 FROM ms_rek4_64 WHERE kd_rek4_64=LEFT(b.kd_rek5,5)) nm_akun,
						   SUM(CASE WHEN YEAR(a.tgl_voucher)<=$thn_ang THEN debet-kredit ELSE 0 END) nilai,
						   SUM(CASE WHEN YEAR(a.tgl_voucher)<=$thn_sbl THEN debet-kredit ELSE 0 END) nilai_lalu 
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
					WHERE $where IN ('$rek3_') GROUP BY b.kd_unit, LEFT(b.kd_rek5,5)) z
					WHERE nilai<>0 OR nilai_lalu<>0
					ORDER BY kd_unit, kd_akun";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $jns = $row->jns;
                       $kode = $row->kd_unit;
                       $nm_skpd = $row->nm_unit;
                       $kd_akun = $row->kd_akun;
                       $nm_akun = $row->nm_akun;
                       $nilai = $row->nilai;
                       $nilai_lalu = $row->nilai_lalu;
					   
					   $tot_nilai = $tot_nilai+$nilai;
					   $tot_nilai_lalu = $tot_nilai_lalu+$nilai_lalu;
                       
					   if($jns==1){
						$cRet .='<tr>
							   <td align="center" valign="top" style="font-size:12px"><b>'.$kode.'</b></td> 
							   <td align="left" style="font-size:12px"><b>'.$nm_skpd.'</b></td> 
							   <td align="left" style="font-size:12px"><b>'.$kd_akun.'</b></td> 
							   <td align="left" style="font-size:12px"><b>'.$nm_akun.'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($nilai, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($nilai_lalu, "2", ",", ".").'</b></td> 
							</tr>'; 
					   }else{
						   $cRet .='<tr>
							   <td align="center" valign="top" style="font-size:12px">'.$kode.'</td> 
							   <td align="left" style="font-size:12px">'.$nm_skpd.'</td> 
							   <td align="left" style="font-size:12px">'.$kd_akun.'</td> 
							   <td align="left" style="font-size:12px">'.$nm_akun.'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($nilai, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($nilai_lalu, "2", ",", ".").'</td> 
							</tr>'; 
					   }
					}
				
				$sql = "SELECT 
						   SUM(CASE WHEN YEAR(a.tgl_voucher)<=$thn_ang THEN debet-kredit ELSE 0 END) tot,
						   SUM(CASE WHEN YEAR(a.tgl_voucher)<=$thn_sbl THEN debet-kredit ELSE 0 END) tot_lalu 
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
					WHERE $where IN ('$rek3_')";
				$hasil = $this->db->query($sql);
				foreach ($hasil->result() as $row)
				{
				   $tot = $row->tot;
				   $tot_lalu = $row->tot_lalu;
				   
				   $cRet .='<tr>
						   <td colspan="4" align="center" valign="top" style="font-size:12px"><b>TOTAL</b></td> 
						   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot, "2", ",", ".").'</b></td> 
						   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lalu, "2", ",", ".").'</b></td> 
						</tr>'; 
				}
						
							
			$cRet .="</table>";
			$data['prev']= $cRet;    
             switch ($ctk){
				case 0;
				echo ("<title>Lap. Aset Neraca</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'P');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $nama_rek.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
	
	
	function cetak_lap_kewjiban_rinci($kdskpd='',$rek3='',$ctk=''){
        $thn_ang = $this->session->userdata('pcThang');
        $thn_sbl = $thn_ang-1;
        $lcskpd = $kdskpd;

		$nama_rek=$this->tukd_model->get_nama($rek3,'nm_rek3','ms_rek3_64','kd_rek3');
		
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="7" align="center" ><b>'.$prov.' </TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="7" align="center" >'.$nama_rek.' </TD>
					</TR>
					</TABLE><br/>';
			
$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Kode</td>
					<td width=\"25%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Nama Unit Kerja</td>
					<td width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Kode Akun</td>
					<td width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Uraian Akun</td>
					<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Nilai $thn_ang</td>					
					<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Nilai $thn_sbl</td>					
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
				</tr>
				</thead>";
			$tot_thn=0;
			$tot_thnsbl=0;
			
			$sql = "SELECT x.kd_unit, (select nm_skpd from trdrka where kd_skpd=x.kd_unit group by nm_skpd) nm_skpd, kd_rek, nm_rek, SUM(nil_2017) nil_2017, SUM(nil_2016) nil_2016  FROM (
					select b.kd_unit, LEFT(b.kd_rek5,3) kd_rek, (SELECT nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) nm_rek, SUM(kredit-debet) nil_2017, 0 nil_2016
					from trhju a inner join trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$thn_ang and LEFT(b.kd_rek5,1) IN ('2') AND LEFT(b.kd_rek5,3)='$rek3'
					group by b.kd_unit, LEFT(b.kd_rek5,3)

					UNION ALL
					select b.kd_unit, LEFT(b.kd_rek5,3) kd_rek, (SELECT nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) nm_rek, 0 nil_2017, SUM(kredit-debet) nil_2016 
					from trhju a inner join trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$thn_sbl and LEFT(b.kd_rek5,1) IN ('2') AND LEFT(b.kd_rek5,3)='$rek3'
					group by b.kd_unit, LEFT(b.kd_rek5,3)

					UNION ALL
					select b.kd_unit, LEFT(b.kd_rek5,5) kd_rek, (SELECT nm_rek4_64 from ms_rek4_64 where kd_rek4_64=LEFT(b.kd_rek5,5)) nm_rek, SUM(kredit-debet) nil_2017, 0 nil_2016 
					from trhju a inner join trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$thn_ang and LEFT(b.kd_rek5,1) IN ('2') AND LEFT(b.kd_rek5,3)='$rek3'
					group by b.kd_unit, LEFT(b.kd_rek5,5)  

					UNION ALL
					select b.kd_unit, LEFT(b.kd_rek5,5) kd_rek, (SELECT nm_rek4_64 from ms_rek4_64 where kd_rek4_64=LEFT(b.kd_rek5,5)) nm_rek, 0 nil_2017, SUM(kredit-debet) nil_2016 
					from trhju a inner join trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$thn_sbl and LEFT(b.kd_rek5,1) IN ('2') AND LEFT(b.kd_rek5,3)='$rek3'
					group by b.kd_unit, LEFT(b.kd_rek5,5) ) x
					where nil_2017<>0 or nil_2016<>0
					group by kd_unit, kd_rek, nm_rek
					order by kd_unit, kd_rek";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_unit;
                       $nama = $row->nm_skpd;
                       $kd_rek = $row->kd_rek;
                       $nm_rek = $row->nm_rek;
                       $nil_thn = $row->nil_2017;
                       $nil_thnsbl = $row->nil_2016;

					$len = 	strlen($kd_rek);
					
						if($len=='3'){
							 $cRet .='<tr>
									   <td align="center" valign="top" style="font-size:12px"><b>'.$kode.'</b></td> 
									   <td align="left" style="font-size:12px"><b>'.$nama.'</b></td> 
									   <td align="left" style="font-size:12px"><b>'.$kd_rek.'</b></td> 
									   <td align="left" style="font-size:12px"><b>'.$nm_rek.'</b></td>
									   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($nil_thn, "2", ",", ".").'</b></td> 
									   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($nil_thnsbl, "2", ",", ".").'</b></td> 
									</tr>'; 
						}else{
							 $cRet .='<tr>
								   <td align="center" valign="top" style="font-size:12px">'.$kode.'</td> 
								   <td align="left" style="font-size:12px">'.$nama.'</td> 
								   <td align="left" style="font-size:12px">'.$kd_rek.'</td> 
								   <td align="left" style="font-size:12px">'.$nm_rek.'</td>
								   <td align="right" valign="top" style="font-size:12px">'.number_format($nil_thn, "2", ",", ".").'</td> 
								   <td align="right" valign="top" style="font-size:12px">'.number_format($nil_thnsbl, "2", ",", ".").'</td> 
								</tr>'; 
						}
					}
					
			$sql_tot = "SELECT SUM(nil_2017) nil_2017, SUM(nil_2016) nil_2016  FROM (
						select b.kd_unit, LEFT(b.kd_rek5,3) kd_rek, (SELECT nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) nm_rek, SUM(kredit-debet) nil_2017, 0 nil_2016
						from trhju a inner join trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where YEAR(a.tgl_voucher)<=$thn_ang and LEFT(b.kd_rek5,1) IN ('2') AND LEFT(b.kd_rek5,3)='$rek3'
						group by b.kd_unit, LEFT(b.kd_rek5,3)
						UNION ALL
						select b.kd_unit, LEFT(b.kd_rek5,3) kd_rek, (SELECT nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) nm_rek, 0 nil_2017, SUM(kredit-debet) nil_2016 
						from trhju a inner join trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where YEAR(a.tgl_voucher)<=$thn_sbl and LEFT(b.kd_rek5,1) IN ('2') AND LEFT(b.kd_rek5,3)='$rek3'
						group by b.kd_unit, LEFT(b.kd_rek5,3)) x
						where nil_2017<>0 or nil_2016<>0";
			 $hasil_tot = $this->db->query($sql_tot);
                    foreach ($hasil_tot->result() as $row)
                    {
						$nil_thn = $row->nil_2017;
                        $nil_thnsbl = $row->nil_2016;
						
					 $cRet .='<tr>
								   <td colspan="4" align="center" valign="top" style="font-size:12px"><b>TOTAL</b></td> 
								   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($nil_thn, "2", ",", ".").'</b></td> 
								   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($nil_thnsbl, "2", ",", ".").'</b></td> 
								</tr>';
						
					}
			$cRet .="</table>";
			$data['prev']= $cRet;    
             switch ($ctk){
				case 0;
				echo ("<title>Lap. Kewajiban</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'P');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $nama_rek.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
	
	function cetak_lap_aset_penyu($kdskpd='',$rek3='',$ctk=''){
        $lntahunang = $this->session->userdata('pcThang');       
        $cthnsbl = $lntahunang-1;       
        $lcskpd = $kdskpd;
        if($rek3==15){
			$nama_rek='Aset Lainnya';
		}else{
			$nama_rek=$this->tukd_model->get_nama($rek3,'nm_rek3','ms_rek3_64','kd_rek3');
		}
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="7" align="center" ><b>'.$prov.' </TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="7" align="center" >'.$nama_rek.' </TD>
					</TR>
					</TABLE><br/>';
			
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td rowspan=\"2\" width=\"5%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Kode</td>
					<td rowspan=\"2\" width=\"50%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Nama Unit Kerja</td>
					<td rowspan=\"2\" width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Nilai Perolehan</td>
					<td colspan=\"2\" width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\"  style=\"font-size:12px\">Akumulasi Penyusutan<br>Tahun $cthnsbl</td>
					<td rowspan=\"2\" width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Penyusutan <br>Tahun $lntahunang</td>
					<td rowspan=\"2\" width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Nilai Buku Per<br>31 Desember $lntahunang</td>
                </tr>
				<tr>
					<td  width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Awal</td>
                    <td width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Koreksi</td>
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">7</td> 
				</tr>
				</thead>";
			$tot_awal=0;
			$tot_tambah=0;
			$tot_kurang=0;
			$tot_tahun_n=0;
			$tot_total=0;
			$tot_awal=0;
			$tot_koreksi=0;
			$tot_peny_tahun=0;
			$tot_nilai_buku=0;
			/* $sql = "SELECT a.kd_skpd, a.nm_skpd, ISNULL(sal_awal,0) sal_awal, ISNULL(tambah,0) tambah, ISNULL(kurang,0) kurang,
					ISNULL(tahun_n,0) tahun_n, ISNULL(akum_penyu,0) akum_penyu, ISNULL(akum_penyu_n,0) akum_penyu_n, 
					ISNULL(nilai_buku,0) nilai_buku FROM ms_skpd a
					LEFT JOIN
					(SELECT kd_skpd, SUM(sal_awal) sal_awal, SUM(tambah) tambah,SUM(kurang) kurang, SUM(tahun_n) tahun_n, 
					SUM(akum_penyu) akum_penyu, SUM(akum_penyu_n) akum_penyu_n, SUM(nilai_buku) nilai_buku
					FROM (
					SELECT
						kd_skpd,sal_awal,tambah,kurang,tahun_n,a.akum_penyu,a.akum_penyu_n, (
							a.sal_awal - a.kurang + a.tambah + tahun_n
						) - a.akum_penyu - a.akum_penyu_n AS nilai_buku
					FROM
					(SELECT	a.*, CASE WHEN len(tahun) <> 4 THEN
						CAST (	a.sal_awal - a.kurang + a.tambah + tahun_n AS DECIMAL (20,0))
						WHEN a.usia >= a.masa THEN	CAST (	a.sal_awal - a.kurang + a.tambah + tahun_n AS DECIMAL (20, 0))
						ELSE CAST (	(a.sal_awal - a.kurang + a.tambah + tahun_n	) / a.masa * a.usia AS DECIMAL (20, 0))
						END AS akum_penyu,	CASE WHEN len(tahun) <> 4 THEN	0 WHEN a.usia >= a.masa THEN 0
						WHEN a.masa - a.usia = 1 THEN (	a.sal_awal - a.kurang + a.tambah + tahun_n) - (	CAST ((	a.sal_awal - a.kurang + a.tambah + tahun_n) / a.masa * a.usia AS DECIMAL (20, 0)
							))
					ELSE CAST (	(a.sal_awal - a.kurang + a.tambah + tahun_n	) / a.masa AS DECIMAL (20, 0))
					END AS akum_penyu_n
					FROM (SELECT no_lamp, CASE WHEN (kd_rek6 = '') THEN	kd_rek5	ELSE kd_rek6 END AS kode1,
							CASE WHEN (kd_rek6 = '') THEN	kd_rek5
						ELSE kd_rek6 END AS kode,
						CASE WHEN (nm_rek6 = '') THEN nm_rek5 ELSE	nm_rek6 	END AS nama,
					tahun,	sal_awal,	kurang,	tambah,	tahun_n,kd_skpd,(SELECT	masa FROM ms_penyu WHERE kd_rek4 = LEFT (kd_rek5, 5)
					) masa,	CASE WHEN len(tahun) <> 4 THEN 0
					ELSE $lntahunang - tahun
					END AS usia FROM lamp_aset WHERE
					kd_rek3 = '$rek3' ) a
					) a
					) b GROUP BY kd_skpd ) c ON a.kd_skpd=c.kd_skpd ORDER BY kd_skpd"; */
			if ($rek3==133){	
			$sql="SELECT x.kd_skpd, x.nm_skpd, x.sal_awal, x.tambah, x.kurang, x.tahun_n,  ISNULL(z.awal,0) awal, ISNULL(z.koreksi,0) koreksi, ISNULL(z.peny_tahun,0) peny_tahun, ISNULL(z.nilai_buku,0) nilai_buku FROM (
					SELECT a.kd_skpd, a.nm_skpd, ISNULL(sal_awal,0) sal_awal, ISNULL(tambah,0) tambah, ISNULL(kurang,0) kurang,
										ISNULL(tahun_n,0) tahun_n FROM ms_skpd a
										LEFT JOIN
										(SELECT kd_skpd, SUM(sal_awal) sal_awal, SUM(tambah) tambah,SUM(kurang) kurang, SUM(tahun_n) tahun_n
										FROM (
										SELECT
											kd_skpd,sal_awal,tambah,kurang,tahun_n
										FROM
										(SELECT	a.*
										FROM (SELECT no_lamp, CASE WHEN (kd_rek6 = '') THEN	kd_rek5	ELSE kd_rek6 END AS kode1,
												CASE WHEN (kd_rek6 = '') THEN	kd_rek5
											ELSE kd_rek6 END AS kode,
											CASE WHEN (nm_rek6 = '') THEN nm_rek5 ELSE	nm_rek6 	END AS nama,
										tahun,	sal_awal,	kurang,	tambah,	tahun_n,kd_skpd,(SELECT	masa FROM ms_penyu WHERE kd_rek4 = LEFT (kd_rek5, 5)
										) masa,	CASE WHEN len(tahun) <> 4 THEN 0
										ELSE $lntahunang - tahun
										END AS usia FROM lamp_aset WHERE
										kd_rek3 = '$rek3' ) a
										) a
										) b GROUP BY kd_skpd ) c ON a.kd_skpd=c.kd_skpd ) x
					left join(
					SELECT kd_skpd,
									  SUM(akum_penyuk) as awal, 
									  SUM(akum_penyu) as koreksi , 
									  SUM(akum_penyu_n) as peny_tahun, 
									  SUM(nilai_buku) nilai_buku  
					FROM (select a.*, (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)-a.akum_penyu-a.akum_penyu_n as nilai_buku from (select a.*, case when len(tahun)<>4 then 0 when sisa_umur+tmasa<=0 and tahun_n+koreksi<>0 then a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu when sisa_umur+tmasa<=0 and tahun_n+koreksi=0 then 0 when (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu)<=0 then 0 else cast(((a.sal_awal+a.tambah-a.kurang+tahun_n+koreksi)-akum_penyu)/(sisa_umur+tmasa) as decimal(20,0)) end as akum_penyu_n
						from (SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  lokasi, alamat,  fungsi, luas,  satuan, sal_awal,  kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, 
						case when tmasa<>0 and kd_rek3='$rek3' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end masa,
						case when jam='1' then bulan when (case when tmasa<>0 and kd_rek3='$rek3' then (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek3=tmasa) 
						else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end)
						+sisa_umur>=(case when tmasa<>0 and kd_rek3='$rek3' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) then (case when tmasa<>0 and kd_rek3='$rek3' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end)-sisa_umur else (case when tmasa<>0 and kd_rek3='$rek3' then (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek3=tmasa) 
						else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end) end tmasa,
						case when len(tahun)<>4 then 0 else $lntahunang-tahun end as usia, isnull(sisa_umur,masa) sisa_umur, isnull(akum_penyu,0) akum_penyuk, 
						case when len(tahun)<>4 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when status in ('9','10') then isnull(akum_penyub,0) when sisa_umur<=0 and tahun_n+korplus-kormin=0 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when sal_awal=sal_awal-kurang+tambah+tahun_n-kormin+korplus then akum_penyu when sal_awal-kurang+tambah+tahun_n-kormin+korplus=0 then 0 when $lntahunang-tahun>=(case when tmasa<>0 and kd_rek3='$rek3' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) and sal_awal=0 then sal_awal-kurang+tambah+tahun_n-kormin+korplus when (sal_awal-kurang+tambah+tahun_n-kormin+korplus)<sal_awal then cast((isnull(akum_penyu,0))*((sal_awal-kurang+tambah+tahun_n-kormin+korplus)/sal_awal) as decimal(20,0)) when sal_awal>0 and tambah>0 then akum_penyu+(case when ($lntahunang-tahun)>(case when tmasa<>0 and kd_rek3='$rek3' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) then tambah else tambah/(case when tmasa<>0 and kd_rek3='$rek3' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end)*($lntahunang-tahun) end) when sal_awal=0 and tahun_n=0 then cast(($lntahunang-tahun)*(sal_awal-kurang+tambah+tahun_n-kormin+korplus)/(case when tmasa<>0 and kd_rek3='$rek3' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) as decimal(20,0)) else isnull(akum_penyu,0) end as akum_penyu, kd_skpd FROM lamp_aset where kd_rek3 = '$rek3') a) a) a
					group by kd_skpd) z
					on x.kd_skpd=z.kd_skpd
					order by kd_skpd";
			}else if ($rek3==134){	
			$sql="SELECT x.kd_skpd, x.nm_skpd, x.sal_awal, x.tambah, x.kurang, x.tahun_n,  ISNULL(z.awal,0) awal, ISNULL(z.koreksi,0) koreksi, ISNULL(z.peny_tahun,0) peny_tahun, ISNULL(z.nilai_buku,0) nilai_buku FROM (
					SELECT a.kd_skpd, a.nm_skpd, ISNULL(sal_awal,0) sal_awal, ISNULL(tambah,0) tambah, ISNULL(kurang,0) kurang,
										ISNULL(tahun_n,0) tahun_n FROM ms_skpd a
										LEFT JOIN
										(SELECT kd_skpd, SUM(sal_awal) sal_awal, SUM(tambah) tambah,SUM(kurang) kurang, SUM(tahun_n) tahun_n
										FROM (
										SELECT
											kd_skpd,sal_awal,tambah,kurang,tahun_n
										FROM
										(SELECT	a.*
										FROM (SELECT no_lamp, CASE WHEN (kd_rek6 = '') THEN	kd_rek5	ELSE kd_rek6 END AS kode1,
												CASE WHEN (kd_rek6 = '') THEN	kd_rek5
											ELSE kd_rek6 END AS kode,
											CASE WHEN (nm_rek6 = '') THEN nm_rek5 ELSE	nm_rek6 	END AS nama,
										tahun,	sal_awal,	kurang,	tambah,	tahun_n,kd_skpd,(SELECT	masa FROM ms_penyu WHERE kd_rek4 = LEFT (kd_rek5, 5)
										) masa,	CASE WHEN len(tahun) <> 4 THEN 0
										ELSE $lntahunang - tahun
										END AS usia FROM lamp_aset WHERE
										kd_rek3 = '$rek3' ) a
										) a
										) b GROUP BY kd_skpd ) c ON a.kd_skpd=c.kd_skpd ) x
					left join(
					SELECT kd_skpd,
									  SUM(akum_penyuk) as awal, 
									  SUM(akum_penyu) as koreksi , 
									  SUM(akum_penyu_n) as peny_tahun, 
									  SUM(nilai_buku) nilai_buku  
					FROM (select a.*, (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)-a.akum_penyu-a.akum_penyu_n as nilai_buku from (select a.*, case when len(tahun)<>4 then 0 when sisa_umur+tmasa<=0 and tahun_n+koreksi<>0 then a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu when sisa_umur+tmasa<=0 and tahun_n+koreksi=0 then 0 when (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu)<=0 then 0 else cast(((a.sal_awal+a.tambah-a.kurang+tahun_n+koreksi)-akum_penyu)/(sisa_umur+tmasa) as decimal(20,0)) end as akum_penyu_n
						from (SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  lokasi, alamat,  fungsi, luas,  satuan, sal_awal,  kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, 
						(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) masa,
						case when jam='1' then bulan when (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5))
						+sisa_umur>=(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) then (select masa from ms_penyu where kd_rek4=left(kd_rek5,5))-sisa_umur else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end tmasa,
						case when len(tahun)<>4 then 0 else $lntahunang-tahun end as usia, isnull(sisa_umur,masa) sisa_umur, isnull(akum_penyu,0) akum_penyuk, 
						case when len(tahun)<>4 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when status in ('9','10') then isnull(akum_penyub,0) when sisa_umur<=0 and tahun_n+korplus-kormin=0 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when sal_awal=sal_awal-kurang+tambah+tahun_n-kormin+korplus then akum_penyu when sal_awal-kurang+tambah+tahun_n-kormin+korplus=0 then 0 when $lntahunang-tahun>=(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) and sal_awal=0 then sal_awal-kurang+tambah+tahun_n-kormin+korplus when (sal_awal-kurang+tambah+tahun_n-kormin+korplus)<sal_awal then cast((isnull(akum_penyu,0))*((sal_awal-kurang+tambah+tahun_n-kormin+korplus)/sal_awal) as decimal(20,0)) when sal_awal>0 and tambah>0 then akum_penyu+(case when ($lntahunang-tahun)>(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) then tambah else tambah/(select masa from ms_penyu where kd_rek4=left(kd_rek5,5))*($lntahunang-tahun) end) when sal_awal=0 and tahun_n=0 then cast(($lntahunang-tahun)*(sal_awal-kurang+tambah+tahun_n-kormin+korplus)/(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) as decimal(20,0)) else isnull(akum_penyu,0) end as akum_penyu, kd_skpd FROM lamp_aset where kd_rek3 = '$rek3') a) a) a
					group by kd_skpd) z
					on x.kd_skpd=z.kd_skpd
					order by kd_skpd";
			}else{
				$sql="SELECT x.kd_skpd, x.nm_skpd, x.sal_awal, x.tambah, x.kurang, x.tahun_n,  ISNULL(z.awal,0) awal, ISNULL(z.koreksi,0) koreksi, ISNULL(z.peny_tahun,0) peny_tahun, ISNULL(z.nilai_buku,0) nilai_buku FROM (
						SELECT a.kd_skpd, a.nm_skpd, ISNULL(sal_awal,0) sal_awal, ISNULL(tambah,0) tambah, ISNULL(kurang,0) kurang,
											ISNULL(tahun_n,0) tahun_n FROM ms_skpd a
											LEFT JOIN
											(SELECT kd_skpd, SUM(sal_awal) sal_awal, SUM(tambah) tambah,SUM(kurang) kurang, SUM(tahun_n) tahun_n
											FROM (
											SELECT
												kd_skpd,sal_awal,tambah,kurang,tahun_n
											FROM
											(SELECT	a.*
											FROM (SELECT no_lamp, CASE WHEN (kd_rek6 = '') THEN	kd_rek5	ELSE kd_rek6 END AS kode1,
													CASE WHEN (kd_rek6 = '') THEN	kd_rek5
												ELSE kd_rek6 END AS kode,
												CASE WHEN (nm_rek6 = '') THEN nm_rek5 ELSE	nm_rek6 	END AS nama,
											tahun,	sal_awal,	kurang,	tambah,	tahun_n,kd_skpd,(SELECT	masa FROM ms_penyu WHERE kd_rek4 = LEFT (kd_rek5, 5)
											) masa,	CASE WHEN len(tahun) <> 4 THEN 0
											ELSE $lntahunang - tahun
											END AS usia FROM lamp_aset WHERE
											kd_rek3 = '$rek3' ) a
											) a
											) b GROUP BY kd_skpd ) c ON a.kd_skpd=c.kd_skpd ) x
						left join(
						SELECT kd_skpd, SUM(sal_awal) sal_awal, 
										   SUM(kurang) kurang, 
										   SUM(tambah) tambah, 
										   SUM(tahun_n) tahun_n,  
										   SUM(akum_penyuk) awal,  
										   SUM(akum_penyu) koreksi, 
										   SUM(akum_penyu_n) peny_tahun, 
										   SUM(nilai_buku) nilai_buku 
						FROM (
						select a.*, (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)-a.akum_penyu-a.akum_penyu_n as nilai_buku from (select a.*, case when len(tahun)<>4 then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when a.usia>=a.masa then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when status in ('9','10') then akum_penyub when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi then akum_penyuk when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*(a.usia-1) as decimal(20,0))+cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu, case when len(tahun)<>4 then 0 when a.usia>=a.masa then 0 when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when a.masa-a.usia=1 then (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)-(case when len(tahun)<>4 then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when a.usia>=a.masa then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when status in ('9','10') then akum_penyub when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi then akum_penyuk when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*(a.usia-1) as decimal(20,0))+cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end) else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu_n
						from(SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  merk, no_polisi, jumlah,  satuan, harga_satuan, sal_awal, kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, (select masa from ms_penyu where kd_rek4=LEFT(kd_rek5,5)) masa, 
						case when len(tahun)<>4 then 0 else $lntahunang-tahun end as usia, isnull(akum_penyu,0) akum_penyuk, isnull(akum_penyub,0) akum_penyub, status, kd_skpd FROM lamp_aset where kd_rek3 = '$rek3') a) a) a
						group by kd_skpd) z
						on x.kd_skpd=z.kd_skpd
						order by kd_skpd";
			}
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_skpd;
                       $nama = $row->nm_skpd;
                       $sal_awal = $row->sal_awal;
                       $tambah = $row->tambah;
                       $kurang = $row->kurang;
                       $tahun_n = $row->tahun_n;
                       $awal = $row->awal;
                       $koreksi = $row->koreksi;
                       $peny_tahun = $row->peny_tahun;
                       $nilai_buku = $row->nilai_buku;
                       $tot = $sal_awal+$tambah-$kurang+$tahun_n;
						$tot_awal=$tot_awal+$awal;
						$tot_koreksi=$tot_koreksi+$koreksi;
						$tot_peny_tahun=$tot_peny_tahun+$peny_tahun;
						$tot_nilai_buku=$tot_nilai_buku+$nilai_buku;
						$tot_total=$tot_total+$tot;
					 $cRet .='<tr>
							   <td align="left" valign="top" style="font-size:12px">'.$kode.'</td> 
							   <td align="left" style="font-size:12px">'.$nama.'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($tot, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($awal, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($koreksi, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($peny_tahun, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($nilai_buku, "2", ",", ".").'</td> 
							</tr>'; 
					}
			 $cRet .='<tr>
						   <td colspan="2" align="center" valign="top" style="font-size:12px">TOTAL</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_total, "2", ",", ".").'</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_awal, "2", ",", ".").'</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_koreksi, "2", ",", ".").'</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_peny_tahun, "2", ",", ".").'</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_nilai_buku, "2", ",", ".").'</td> 
						</tr>';
			$cRet .="</table>";
			$data['prev']= $cRet;    
            $judul='Lap_Penyusutan_Aset_'.$nama_rek.'';
			switch ($ctk){
				case 0;
				echo ("<title>$judul</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'P');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
	function cetak_lap_beb_susut($ctk=''){
        $lntahunang = $this->session->userdata('pcThang');       
        
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="7" align="center" ><b>LAPORAN BEBAN PENYUSUTAN '.$lntahunang.'</b></TD>
					</TR>
					</TABLE><br/>';
			
$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td width=\"5%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Kode SKPD</td>
					<td width=\"50%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Nama SKPD</td>
					<td width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Peralatan dan mesin</td>
					<td width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\"  style=\"font-size:12px\">Gedung dan Bangunan</td>
					<td width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Jalan, Irigasi dan Jaringan</td>
					<td width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Amortisasi</td>
					
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
				</tr>
				</thead>";
			
			$sql = "SELECT v.kd_skpd, (select nm_skpd from trdrka where kd_skpd=v.kd_skpd group by nm_skpd) nm_skpd, ISNULL(peralatan_mesin,0) as peralatan_mesin, ISNULL(gdg_bangunan,0) as gdg_bangunan, ISNULL(jln_irigas,0) as jln_irigas, ISNULL(amortisasi,0) as amortisasi FROM (
					select kd_skpd from trdrka 
					group by kd_skpd ) v
					LEFT JOIN
					(
					select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) peralatan_mesin 
					from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where LEFT(b.kd_rek5,5) IN ('91701') AND YEAR(tgl_voucher)=$lntahunang
					group by b.kd_unit ) w
					on v.kd_skpd=w.kd_skpd
					LEFT JOIN
					(
					select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) gdg_bangunan 
					from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where LEFT(b.kd_rek5,5) IN ('91702') AND YEAR(tgl_voucher)=$lntahunang
					group by b.kd_unit ) x
					on v.kd_skpd=x.kd_skpd
					LEFT JOIN
					(
					select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) jln_irigas 
					from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where LEFT(b.kd_rek5,5) IN ('91703') AND YEAR(tgl_voucher)=$lntahunang
					group by b.kd_unit ) y
					on v.kd_skpd=y.kd_skpd
					LEFT JOIN
					(
					select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) amortisasi 
					from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where LEFT(b.kd_rek5,5) IN ('91704') AND YEAR(tgl_voucher)=$lntahunang
					group by b.kd_unit ) z
					on v.kd_skpd=z.kd_skpd
					order by kd_skpd
					";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_skpd;
                       $nama = $row->nm_skpd;
                       $peralatan_mesin = $row->peralatan_mesin;
                       $gdg_bangunan = $row->gdg_bangunan;
                       $jln_irigas = $row->jln_irigas;
                       $amortisasi = $row->amortisasi;
                       
					 $cRet .='<tr>
							   <td align="left" valign="top" style="font-size:12px">'.$kode.'</td> 
							   <td align="left" style="font-size:12px">'.$nama.'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($peralatan_mesin, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($gdg_bangunan, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jln_irigas, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($amortisasi, "2", ",", ".").'</td> 
							</tr>'; 
					}
			
			$cRet .="</table>";
			$data['prev']= $cRet;    
            $judul='Lap_Beban_Penyusutan';
			switch ($ctk){
				case 0;
				echo ("<title>$judul</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'P');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
	
	function cetak_lap_lainlain($ctk=''){
        $lntahunang = $this->session->userdata('pcThang');       
        $thnsbl = $lntahunang-1;      
        
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="7" align="center" ><b>LAPORAN BEBAN LAIN LAIN '.$lntahunang.'</b></TD>
					</TR>
					</TABLE><br/>';
			
$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td width=\"5%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Kode SKPD</td>
					<td width=\"50%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Nama SKPD</td>
					<td width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Persediaan Lain Lain</td>
					<td width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\"  style=\"font-size:12px\">Penyisihan Piutang</td>
					
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
				</tr>
				</thead>";
			
			$sql = "SELECT v.kd_skpd, (select nm_skpd from trdrka where kd_skpd=v.kd_skpd group by nm_skpd) nm_skpd,  ISNULL(persediaan_lain,0) as persediaan_lain, ISNULL(penyisihan_piutang_2017,0) as penyisihan_piutang_2017 FROM (
						select kd_skpd from trdrka 
						group by kd_skpd ) v
						LEFT JOIN
						(
						SELECT b.kd_unit as kd_skpd, sum(b.debet-b.kredit) persediaan_lain 
						from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher 
						where LEFT(b.kd_rek5,3) IN ('919') AND YEAR(tgl_voucher)='$lntahunang'
						group by b.kd_unit ) y
						on v.kd_skpd=y.kd_skpd
						LEFT JOIN
						(
						select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) penyisihan_piutang_2017 
						from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where LEFT(b.kd_rek5,3) IN ('918') AND YEAR(tgl_voucher)='$lntahunang'
						group by b.kd_unit ) w
						on v.kd_skpd=w.kd_skpd
						order by kd_skpd
					";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_skpd;
                       $nama = $row->nm_skpd;
                       $persediaan_lain = $row->persediaan_lain;
                       $penyisihan_piutang_2017 = $row->penyisihan_piutang_2017;
                       
					   
					   if($persediaan_lain<0){
						   $a = "(";
						   $b = ")";
						   $persediaan_lain1 = $persediaan_lain*-1;
					   }else{
						   $a = "";
						   $b = "";
						   $persediaan_lain1 = $persediaan_lain;
					   }
					   
					   if($penyisihan_piutang_2017<0){
						   $c = "(";
						   $d = ")";
						   $penyisihan_piutang_20171 = $penyisihan_piutang_2017*-1;
					   }else{
						   $c = "";
						   $d = "";
						   $penyisihan_piutang_20171 = $penyisihan_piutang_2017;
					   }
					   
					 $cRet .='<tr>
							   <td align="left" valign="top" style="font-size:12px">'.$kode.'</td> 
							   <td align="left" style="font-size:12px">'.$nama.'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.$a.''.number_format($persediaan_lain, "2", ",", ".").''.$b.'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.$c.''.number_format($penyisihan_piutang_20171, "2", ",", ".").''.$d.'</td> 
							</tr>'; 
					}
			
			$cRet .="</table>";
			$data['prev']= $cRet;    
            $judul='Lap_Beban_lain_lain';
			switch ($ctk){
				case 0;
				echo ("<title>$judul</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'P');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
	
	function cetak_lap_amortisasi($kdskpd='',$rek3='',$ctk=''){
        $lntahunang = $this->session->userdata('pcThang');       
        $lcskpd = $kdskpd;
		$rek3='153';
        if($rek3==15){
			$nama_rek='Aset Lainnya';
		}else{
			$nama_rek=$this->tukd_model->get_nama($rek3,'nm_rek3','ms_rek3_64','kd_rek3');
		}
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="7" align="center" ><b>'.$prov.' </TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="7" align="center" >'.$nama_rek.' </TD>
					</TR>
					</TABLE><br/>';
			
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td width=\"5%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Kode</td>
					<td width=\"50%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Nama Unit Kerja</td>
					<td width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Nilai Perolehan</td>
					<td width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Akumulasi Amortisasi</td>
					<td width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Amortisasi $lntahunang</td>
					<td width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Nilai Buku</td>
					
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
				</tr>
				</thead>";
			$tot_awal=0;
			$tot_tambah=0;
			$tot_kurang=0;
			$tot_tahun_n=0;
			$tot_total=0;
			$tot_akum_penyu=0;
			$tot_akum_penyu_n=0;
			$tot_nilai_buku=0;
			$sql = "SELECT a.kd_skpd, a.nm_skpd, ISNULL(sal_awal,0) sal_awal, ISNULL(tambah,0) tambah, ISNULL(kurang,0) kurang,
					ISNULL(tahun_n,0) tahun_n, ISNULL(akum_penyu,0) akum_penyu, ISNULL(akum_penyu_n,0) akum_penyu_n, 
					ISNULL(nilai_buku,0) nilai_buku FROM ms_skpd a
					LEFT JOIN
					(SELECT kd_skpd, SUM(sal_awal) sal_awal, SUM(tambah) tambah,SUM(kurang) kurang, SUM(tahun_n) tahun_n, 
					SUM(akum_penyu) akum_penyu, SUM(akum_penyu_n) akum_penyu_n, SUM(nilai_buku) nilai_buku
					FROM (select kd_skpd,a.sal_awal,a.tambah,a.kurang,a.tahun_n, a.akum_penyu,a.akum_penyu_n,
					(a.sal_awal-a.kurang+a.tambah+tahun_n)-a.akum_penyu-a.akum_penyu_n as nilai_buku from (select a.*, case when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when status in ('9','10') then akum_penyub when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi then akum_penyuk when len(tahun)<>4 then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when a.usia>=a.masa then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*(a.usia-1) as decimal(20,0))+cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu, case when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when len(tahun)<>4 then 0 when a.usia>=a.masa then 0 when a.masa-a.usia=1 then (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)-(case when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi and status not in ('9','10') then akum_penyuk when tambah=sal_awal+tambah-kurang+tahun_n+koreksi and status not in ('9','10') then akum_penyuk when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi and status in ('9','10') then akum_penyub when tambah=sal_awal+tambah-kurang+tahun_n+koreksi and status in ('9','10') then akum_penyub else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*a.usia as decimal(20,0)) end) else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu_n
						from(SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  merk, no_polisi, fungsi, lokasi, alamat, jumlah, satuan, harga_satuan, sal_awal, kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, (select masa from ms_amortisasi where kd_rek4=LEFT(kd_rek5,5)) masa, 
						case when len(tahun)<>4 then 0 else $lntahunang-tahun end as usia, isnull(akum_penyu,0) akum_penyuk, isnull(akum_penyub,0) akum_penyub, status, kd_skpd FROM lamp_aset where kd_rek3 = '$rek3') a) a) a GROUP BY kd_skpd) b
					ON a.kd_skpd=b.kd_skpd ORDER BY a.kd_skpd";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_skpd;
                       $nama = $row->nm_skpd;
                       $sal_awal = $row->sal_awal;
                       $tambah = $row->tambah;
                       $kurang = $row->kurang;
                       $tahun_n = $row->tahun_n;
                       $akum_penyu = $row->akum_penyu;
                       $akum_penyu_n = $row->akum_penyu_n;
                       $nilai_buku = $row->nilai_buku;
                       $tot = $sal_awal+$tambah-$kurang+$tahun_n;
						$tot_akum_penyu=$tot_akum_penyu+$akum_penyu;
						$tot_akum_penyu_n=$tot_akum_penyu_n+$akum_penyu_n;
						$tot_nilai_buku=$tot_nilai_buku+$nilai_buku;
						$tot_total=$tot_total+$tot;
					 $cRet .='<tr>
							   <td align="left" valign="top" style="font-size:12px">'.$kode.'</td> 
							   <td align="left" style="font-size:12px">'.$nama.'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($tot, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($akum_penyu, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($akum_penyu_n, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($nilai_buku, "2", ",", ".").'</td> 
							</tr>'; 
					}
			 $cRet .='<tr>
						   <td colspan="2" align="center" valign="top" style="font-size:12px">TOTAL</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_total, "2", ",", ".").'</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_akum_penyu, "2", ",", ".").'</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_akum_penyu_n, "2", ",", ".").'</td> 
						   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_nilai_buku, "2", ",", ".").'</td> 
						</tr>';
			$cRet .="</table>";
			$data['prev']= $cRet;    
            $judul='Lap_amortisasi_'.$nama_rek.'';
			switch ($ctk){
				case 0;
				echo ("<title>$judul</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'P');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
	function cetak_lap_peng($kdskpd='',$rek3='',$ctk=''){
        $lntahunang = $this->session->userdata('pcThang');       
        $lcskpd = $kdskpd;
		$rek3='153';
        if($rek3==15){
			$nama_rek='Aset Lainnya';
		}else{
			$nama_rek=$this->tukd_model->get_nama($rek3,'nm_rek3','ms_rek3_64','kd_rek3');
		}
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="21" align="center" ><b>'.$prov.' </TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="21" align="center" >PENGADAAN ASET TAHUN ANGGARAN '.$lntahunang.'</TD>
					</TR>
					</TABLE><br/>';
			
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" style=\"font-size:12px\">No</td>
                    <td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" style=\"font-size:12px\">Unit Kerja</td>
					<td colspan=\"6\" bgcolor=\"#CCCCCC\" width=\"50%\" align=\"center\" style=\"font-size:12px\">LRA</td>
					<td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" style=\"font-size:12px\">Jumlah LRA</td>
					<td colspan=\"9\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" style=\"font-size:12px\">Neraca</td>
					<td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" style=\"font-size:12px\">Jumlah Neraca</td>
					<td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" style=\"font-size:12px\">Selisih antara<br>LRA dan Neraca</td>
					<td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" style=\"font-size:12px\">Keterangan</td>
                </tr>
				<tr>
                   <td colspan=\"6\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Belanja Modal</td> 
				   <td colspan=\"1\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Aset Lancar</td> 
				   <td colspan=\"6\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Aset Tetap $lntahunang</td> 
				   <td colspan=\"2\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Aset Lainnya</td> 
				</tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Tanah</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Peralatan dan Mesin</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Gedung dan Bangunan</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Jalan Irigasi dan Jaringan</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Aset Tetap Lainnya</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Aset Lainnya</td> 
				   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Persediaan</td> 
				   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Tanah</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Peralatan dan Mesin</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Gedung dan Bangunan</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Jalan Irigasi dan Jaringan</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Aset Tetap Lainnya</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Konstruksi dalam Pengerjaan</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Aset Tak Berwujud</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Aset Lainnya</td> 
				</tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">7</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">8</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">9</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">10</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">11</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">12</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">13</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">14</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">15</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">16</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">17</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">18</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">19</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">20</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">21</td> 
				</tr>
				</thead>";
				
				$jum_mod_tanah=0;
				$jum_mod_mesin=0;
				$jum_mod_gedung=0;
				$jum_mod_jalan=0;
			   $jum_mod_tetap=0;
			   $jum_mod_lainnya=0;
			   $jum_aset_persediaan=0;
			   $jum_aset_tanah=0;
			   $jum_aset_gedung=0;
			   $jum_aset_mesin=0;
			   $jum_aset_jalan=0;
			   $jum_aset_tetap=0;
			   $jum_aset_kontruksi=0;
			   $jum_aset_takwujud=0;
			   $jum_aset_lainnya=0;
			   $tot_mod=0;
			   $tot_aset=0;
			   $tot_selisih=0;
			$no=0;
			$sql = "SELECT a.kd_skpd, a.nm_skpd
					,ISNULL(mod_tanah,0) as mod_tanah 
					,ISNULL(mod_mesin,0) as mod_mesin 
					,ISNULL(mod_gedung,0) as mod_gedung 
					,ISNULL(mod_jalan,0) as mod_jalan
					,ISNULL(mod_tetap,0) as mod_tetap
					,ISNULL(mod_lainnya,0) as mod_lainnya
					,ISNULL(aset_persediaan,0) as aset_persediaan
					,ISNULL(aset_tanah,0) as aset_tanah
					,ISNULL(aset_mesin,0) as aset_mesin
					,ISNULL(aset_gedung,0) as aset_gedung
					,ISNULL(aset_jalan,0) as aset_jalan
					,ISNULL(aset_tetap,0) as aset_tetap
					,ISNULL(aset_kontruksi,0) as aset_kontruksi
					,ISNULL(aset_takwujud,0) as aset_takwujud
					,ISNULL(aset_lainnya,0) as aset_lainnya
					FROM ms_skpd a 
					LEFT JOIN 
					(SELECT kd_skpd
					,SUM(CASE WHEN kd_rek ='521' THEN real_spj ELSE 0 END) AS mod_tanah
					,SUM(CASE WHEN kd_rek ='522' THEN real_spj ELSE 0 END) AS mod_mesin
					,SUM(CASE WHEN kd_rek ='523' THEN real_spj ELSE 0 END) AS mod_gedung
					,SUM(CASE WHEN kd_rek ='524' THEN real_spj ELSE 0 END) AS mod_jalan
					,SUM(CASE WHEN kd_rek ='525' THEN real_spj ELSE 0 END) AS mod_tetap
					,SUM(CASE WHEN kd_rek ='526' THEN real_spj ELSE 0 END) AS mod_lainnya
					,SUM(CASE WHEN kd_rek ='1170302' THEN real_spj ELSE 0 END) AS aset_persediaan
					,SUM(CASE WHEN kd_rek ='131' THEN real_spj ELSE 0 END) AS aset_tanah
					,SUM(CASE WHEN kd_rek ='132' THEN real_spj ELSE 0 END) AS aset_mesin
					,SUM(CASE WHEN kd_rek ='133' THEN real_spj ELSE 0 END) AS aset_gedung
					,SUM(CASE WHEN kd_rek ='134' THEN real_spj ELSE 0 END) AS aset_jalan
					,SUM(CASE WHEN kd_rek ='135' THEN real_spj ELSE 0 END) AS aset_tetap
					,SUM(CASE WHEN kd_rek ='136' THEN real_spj ELSE 0 END) AS aset_kontruksi
					,SUM(CASE WHEN kd_rek ='153' THEN real_spj ELSE 0 END) AS aset_takwujud
					,SUM(CASE WHEN kd_rek ='154' THEN real_spj ELSE 0 END) AS aset_lainnya
					 FROM 
					(select b.kd_skpd, left(a.kd_rek5,3) kd_rek, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where YEAR(b.tgl_voucher)='$lntahunang' AND left(a.kd_rek5,3) in ('521','522','523','524','525','526')
					group by kd_skpd, left(a.kd_rek5,3)
					UNION ALL
					SELECT kd_skpd, kd_rek3 as kd_rek, SUM(tahun_n) as real_spj 
					FROM lamp_aset WHERE kd_rek3 IN('117','131','132','133','134','135','136','153','154')
					GROUP BY kd_skpd,kd_rek3
					UNION ALL
					SELECT kd_skpd, kd_rek5 as kd_rek, SUM(tahun_n) as real_spj 
					FROM lamp_aset WHERE kd_rek5 IN('1170302')
					GROUP BY kd_skpd,kd_rek5
					)a
					GROUP BY kd_skpd) b
					ON a.kd_skpd=b.kd_skpd
					order by a.kd_skpd
					";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_skpd;
                       $nama = $row->nm_skpd;
                       $mod_tanah = $row->mod_tanah;
                       $mod_mesin = $row->mod_mesin;
                       $mod_gedung = $row->mod_gedung;
                       $mod_jalan = $row->mod_jalan;
                       $mod_tetap = $row->mod_tetap;
                       $mod_lainnya = $row->mod_lainnya;
                       $aset_persediaan = $row->aset_persediaan;
                       $aset_tanah = $row->aset_tanah;
                       $aset_gedung = $row->aset_gedung;
                       $aset_mesin = $row->aset_mesin;
                       $aset_jalan = $row->aset_jalan;
                       $aset_tetap = $row->aset_tetap;
                       $aset_kontruksi = $row->aset_kontruksi;
                       $aset_takwujud = $row->aset_takwujud;
                       $aset_lainnya = $row->aset_lainnya;
					   $jum_mod= $mod_tanah+$mod_mesin+$mod_gedung+$mod_jalan+$mod_tetap+$mod_lainnya;
					   $jum_aset = $aset_persediaan+$aset_tanah+$aset_gedung+$aset_mesin+$aset_jalan+$aset_tetap+$aset_kontruksi+$aset_takwujud+$aset_lainnya;
                       $selisih=$jum_aset-$jum_mod;
					   $jum_mod_tanah=$jum_mod_tanah+$mod_tanah;
					   $jum_mod_mesin=$jum_mod_mesin+$mod_mesin;
					   $jum_mod_gedung=$jum_mod_gedung+$mod_gedung;
					   $jum_mod_jalan=$jum_mod_jalan+$mod_jalan;
					   $jum_mod_tetap=$jum_mod_tetap+$mod_tetap;
					   $jum_mod_lainnya=$jum_mod_lainnya+$mod_lainnya;
					   $jum_aset_persediaan=$jum_aset_persediaan+$aset_persediaan;
					   $jum_aset_tanah=$jum_aset_tanah+$aset_tanah;
					   $jum_aset_gedung=$jum_aset_gedung+$aset_gedung;
					   $jum_aset_mesin=$jum_aset_mesin+$aset_mesin;
					   $jum_aset_jalan=$jum_aset_jalan+$aset_jalan;
					   $jum_aset_tetap=$jum_aset_tetap+$aset_tetap;
					   $jum_aset_kontruksi=$jum_aset_kontruksi+$aset_kontruksi;
					   $jum_aset_takwujud=$jum_aset_takwujud+$aset_takwujud;
					   $jum_aset_lainnya=$jum_aset_lainnya+$aset_lainnya;
					   $tot_mod=$tot_mod+$jum_mod;
					   $tot_aset=$tot_aset+$jum_aset;
					   $tot_selisih=$tot_selisih+$selisih;
					   $no=$no+1;
					 $cRet .='<tr>
							   <td align="center" valign="top" style="font-size:12px">'.$no.'</td> 
							   <td align="left" style="font-size:12px">'.$nama.'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($mod_tanah, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($mod_mesin, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($mod_gedung, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($mod_jalan, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($mod_tetap, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($mod_lainnya, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_mod, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($aset_persediaan, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($aset_tanah, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($aset_mesin, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($aset_gedung, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($aset_jalan, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($aset_tetap, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($aset_kontruksi, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($aset_takwujud, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($aset_lainnya, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_aset, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($selisih, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">&nbsp;</td> 
							</tr>'; 
					}
			
			
			
			$cRet .='<tr>
							   <td colspan="2" align="center" valign="top" style="font-size:12px">T O T A L</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_mod_tanah, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_mod_mesin, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_mod_gedung, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_mod_jalan, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_mod_tetap, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_mod_lainnya, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_mod, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_aset_persediaan, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_aset_tanah, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_aset_mesin, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_aset_gedung, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_aset_jalan, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_aset_tetap, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_aset_kontruksi, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_aset_takwujud, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_aset_lainnya, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_aset, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($tot_selisih, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">&nbsp;</td> 
							</tr>'; 
			$cRet .="</table>";
			$data['prev']= $cRet;    
            $judul='Lap_pengadaan_aset';
			switch ($ctk){
				case 0;
				echo ("<title>$judul</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
	function cetak_lap_pen_lra($kdskpd='',$rek3='',$ctk=''){
        $lntahunang = $this->session->userdata('pcThang');       
        $lcskpd = $kdskpd;
		$rek3='153';
        if($rek3==15){
			$nama_rek='Aset Lainnya';
		}else{
			$nama_rek=$this->tukd_model->get_nama($rek3,'nm_rek3','ms_rek3_64','kd_rek3');
		}
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="21" align="center" ><b>'.$prov.' </TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="21" align="center" >PENGADAAN ASET TAHUN ANGGARAN '.$lntahunang.'</TD>
					</TR>
					</TABLE><br/>';
			
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td rowspan=\"2\" width=\"5%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">No</td>
                    <td rowspan=\"2\" width=\"5%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Unit Kerja</td>
					<td colspan=\"3\" width=\"25%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Laporan Realisasi Anggaran</td>
					<td rowspan=\"2\" width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Jumlah LRA</td>
					<td colspan=\"3\" width=\"25%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Laporan Operasional</td>
					<td rowspan=\"2\" width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Jumlah LO</td>
					<td rowspan=\"2\" width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Selisih antara<br>LRA dan LO</td>
					<td rowspan=\"2\" width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Keterangan</td>
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Pendapatan</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Belanja Pegawai</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Barang dan Jasa</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Pendapatan</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Beban Pegawai</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Barang dan Jasa</td> 
				</tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">7</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">8</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">9</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">10</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">11</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">12</td> 
				</tr>
				</thead>";
		
			$jum_pend=0;
		    $jum_bel_peg=0;
		    $jum_bel_br=0;
		    $jum_pend_lo=0;
		    $jum_bbn_peg=0;
		    $jum_bbn_br=0;
		    $tot_lra=0;
		    $tot_lo=0;
		    $tot_sel=0;
			$no=0;
			$sql = "SELECT a.kd_skpd, a.nm_skpd
					,ISNULL(pend,0) as pend 
					,ISNULL(bel_peg,0) as bel_peg 
					,ISNULL(bel_br,0) as bel_br 
					,ISNULL(pend_lo,0) as pend_lo
					,ISNULL(bbn_peg,0) as bbn_peg
					,ISNULL(bbn_br,0) as bbn_br
					FROM ms_skpd a 
					LEFT JOIN 
					(SELECT kd_skpd
					,SUM(CASE WHEN kd_rek ='4' THEN real_spj ELSE 0 END) AS pend
					,SUM(CASE WHEN kd_rek ='511' THEN real_spj ELSE 0 END) AS bel_peg
					,SUM(CASE WHEN kd_rek ='512' THEN real_spj ELSE 0 END) AS bel_br
					,SUM(CASE WHEN kd_rek ='8' THEN real_spj ELSE 0 END) AS pend_lo
					,SUM(CASE WHEN kd_rek ='911' THEN real_spj ELSE 0 END) AS bbn_peg
					,SUM(CASE WHEN kd_rek ='912' THEN real_spj ELSE 0 END) AS bbn_br
					FROM
					(select b.kd_skpd, left(a.kd_rek5,3) kd_rek, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,3) in ('511','512','911','912') AND YEAR(b.tgl_voucher)=$lntahunang
					group by kd_skpd, left(a.kd_rek5,3)
					UNION ALL
					select b.kd_skpd, left(a.kd_rek5,1) kd_rek, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1) in ('4','8') AND YEAR(b.tgl_voucher)=$lntahunang
					GROUP BY kd_skpd, left(a.kd_rek5,1))a
					GROUP BY kd_skpd) b ON 
					a.kd_skpd=b.kd_skpd
					order by a.kd_skpd";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_skpd;
                       $nama = $row->nm_skpd;
                       $pend = $row->pend;
                       $bel_peg = $row->bel_peg;
                       $bel_br = $row->bel_br;
                       $pend_lo = $row->pend_lo;
                       $bbn_peg = $row->bbn_peg;
                       $bbn_br = $row->bbn_br;
					   $jum_lra= $pend+$bel_peg+$bel_br;
					   $jum_lo = $pend_lo+$bbn_peg+$bbn_br;
                       $selisih=$jum_lra-$jum_lo;
					   $jum_pend=$jum_pend+$pend;
					   $jum_bel_peg=$jum_bel_peg+$bel_peg;
					   $jum_bel_br=$jum_bel_br+$bel_br;
					   $jum_pend_lo=$jum_pend_lo+$pend_lo;
					   $jum_bbn_peg=$jum_bbn_peg+$bbn_peg;
					   $jum_bbn_br=$jum_bbn_br+$bbn_br;
					   $tot_lra=$tot_lra+$jum_lra;
					   $tot_lo=$tot_lo+$jum_lo;
					   $tot_sel=$tot_sel+$selisih;
					   $no=$no+1;
					 $cRet .='<tr>
							   <td align="center" valign="top" style="font-size:12px">'.$no.'</td> 
							   <td align="left" style="font-size:12px">'.$nama.'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($pend, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($bel_peg, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($bel_br, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_lra, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($pend_lo, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($bbn_peg, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($bbn_br, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_lo, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($selisih, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">&nbsp;</td> 
							</tr>'; 
					}
					
			$sql_tot = "SELECT ISNULL(SUM(pend),0) as pend 
						  ,ISNULL(SUM(bel_peg),0) as bel_peg 
						  ,ISNULL(SUM(bel_br),0) as bel_br 
						  ,ISNULL(SUM(pend_lo),0) as pend_lo
						  ,ISNULL(SUM(bbn_peg),0) as bbn_peg
						  ,ISNULL(SUM(bbn_br),0) as bbn_br
						FROM ms_skpd a 
						LEFT JOIN 
						(SELECT kd_skpd
						,SUM(CASE WHEN kd_rek ='4' THEN real_spj ELSE 0 END) AS pend
						,SUM(CASE WHEN kd_rek ='511' THEN real_spj ELSE 0 END) AS bel_peg
						,SUM(CASE WHEN kd_rek ='512' THEN real_spj ELSE 0 END) AS bel_br
						,SUM(CASE WHEN kd_rek ='8' THEN real_spj ELSE 0 END) AS pend_lo
						,SUM(CASE WHEN kd_rek ='911' THEN real_spj ELSE 0 END) AS bbn_peg
						,SUM(CASE WHEN kd_rek ='912' THEN real_spj ELSE 0 END) AS bbn_br
						FROM
						(select b.kd_skpd, left(a.kd_rek5,3) kd_rek, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
						from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,3) in ('511','512','911','912') AND YEAR(b.tgl_voucher)=$lntahunang
						group by kd_skpd, left(a.kd_rek5,3)
						UNION ALL
						select b.kd_skpd, left(a.kd_rek5,1) kd_rek, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
						from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1) in ('4','8') AND YEAR(b.tgl_voucher)=$lntahunang
						GROUP BY kd_skpd, left(a.kd_rek5,1))a
						GROUP BY kd_skpd) b ON a.kd_skpd=b.kd_skpd";
                    $hasil_tot = $this->db->query($sql_tot);
                    foreach ($hasil_tot->result() as $row)
                    {
                       $pend = $row->pend;
                       $bel_peg = $row->bel_peg;
                       $bel_br = $row->bel_br;
                       $pend_lo = $row->pend_lo;
                       $bbn_peg = $row->bbn_peg;
                       $bbn_br = $row->bbn_br;
					   $jum_lra= $pend+$bel_peg+$bel_br;
					   $jum_lo = $pend_lo+$bbn_peg+$bbn_br;
                       $selisih=$jum_lra-$jum_lo;
					   $no=$no+1;
					 $cRet .='<tr>
							   <td colspan="2" align="center" valign="top" style="font-size:12px"></td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($pend, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($bel_peg, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($bel_br, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_lra, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($pend_lo, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($bbn_peg, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($bbn_br, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_lo, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($selisih, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">&nbsp;</td> 
							</tr>';
					}
			 
			$cRet .="</table>";
			$data['prev']= $cRet;    
            $judul='Lap_penjelasan_lo_lra';
			switch ($ctk){
				case 0;
				echo ("<title>$judul</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
	function cetak_lap_pen_lra_rinci($kdskpd='',$rek3='',$ctk='',$js=''){
        $lntahunang = $this->session->userdata('pcThang');       
        
		$trhju = "trhju_calk";
		$trdju = "trdju_calk";
		
		//--pindah
		$sql51 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=5";
        $hasil51 = $this->db->query($sql51);
		foreach ($hasil51->result() as $row)
        {
			$kd_rek51 = $row->kd_rek;			
		}
		
		$sql91 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=9";
        $hasil91 = $this->db->query($sql91);
		foreach ($hasil91->result() as $row)
        {
			$kd_rek91 = $row->kd_rek;			
		}
		
		$sql21 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=2";
        $hasil21 = $this->db->query($sql21);
		foreach ($hasil21->result() as $row)
        {
			$kd_rek21 = $row->kd_rek;			
		}
		
		$sql52 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=5";
        $hasil52 = $this->db->query($sql52);
		foreach ($hasil52->result() as $row)
        {
			$kd_rek52 = $row->kd_rek;			
		}
		
		$sql92 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=9";
        $hasil92 = $this->db->query($sql92);
		foreach ($hasil92->result() as $row)
        {
			$kd_rek92 = $row->kd_rek;			
		}
		
		$sql22 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=2";
        $hasil22 = $this->db->query($sql22);
		foreach ($hasil22->result() as $row)
        {
			$kd_rek22 = $row->kd_rek;			
		}
		
		$sql53 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=5";
        $hasil53 = $this->db->query($sql53);
		foreach ($hasil53->result() as $row)
        {
			$kd_rek53 = $row->kd_rek;			
		}
		
		$sql93 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=9";
        $hasil93 = $this->db->query($sql93);
		foreach ($hasil93->result() as $row)
        {
			$kd_rek93 = $row->kd_rek;			
		}
		
		$sql23 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=2";
        $hasil23 = $this->db->query($sql23);
		foreach ($hasil23->result() as $row)
        {
			$kd_rek23 = $row->kd_rek;			
		}
		
		$sql54 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=5";
        $hasil54 = $this->db->query($sql54);
		foreach ($hasil54->result() as $row)
        {
			$kd_rek54 = $row->kd_rek;			
		}
		
		$sql94 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=9";
        $hasil94 = $this->db->query($sql94);
		foreach ($hasil94->result() as $row)
        {
			$kd_rek94 = $row->kd_rek;			
		}
		
		$sql24 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=2";
        $hasil24 = $this->db->query($sql24);
		foreach ($hasil24->result() as $row)
        {
			$kd_rek24 = $row->kd_rek;			
		}
		//--akhir
		
		if($js=='2'){
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="21" align="center" ><b>PEMERINTAH PROVINSI KALIMANTAN BARAT</TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="21" align="center" >PENGADAAN ASET TAHUN ANGGARAN '.$lntahunang.'</TD>
					</TR>
					</TABLE><br/>';
			
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td rowspan=\"2\" width=\"2%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">No</td>
                    <td rowspan=\"2\" width=\"5%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Kode SKPD</td>
					<td rowspan=\"2\" width=\"33%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Nama SKPD</td>
					<td colspan=\"2\" width=\"15%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Barang Jasa</td>
					<td colspan=\"2\" width=\"15%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Persediaan</td>
					<td colspan=\"2\" width=\"15%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Pemeliharaan</td>
					<td colspan=\"2\" width=\"15%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Perjalanan Dinas</td>
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
				</tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">7</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">8</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">9</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">10</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">11</td> 
				</tr>
				</thead>";
		
			$no=0;
			$tot_lra_brg_jasa =0;
			$tot_lo_brg_jasa =0;
			$tot_lra_persediaan =0;
			$tot_lo_persediaan =0;
			$tot_lra_pemeliharaan =0;
			$tot_lo_pemeliharaan =0;
			$tot_lra_prj_dinas =0;
			$tot_lo_prj_dinas =0;
            $sql = "SELECT o.kd_skpd,(select nm_skpd from trdrka where kd_skpd=o.kd_skpd group by nm_skpd) nm_skpd, ISNULL(k.lra_brg_jasa,0) lra_brg_jasa, ISNULL(p.lo_brg_jasa,0) lo_brg_jasa, ISNULL(l.lra_persediaan,0) lra_persediaan, ISNULL(q.lo_persediaan,0) lo_persediaan, ISNULL(m.lra_pemeliharaan,0) lra_pemeliharaan, ISNULL(r.lo_pemeliharaan,0) lo_pemeliharaan, ISNULL(n.lra_prj_dinas,0) lra_prj_dinas, ISNULL(s.lo_prj_dinas,0) lo_prj_dinas FROM (
				select kd_skpd from trdrka 
				group by kd_skpd ) o
				LEFT JOIN 
				(select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) lra_brg_jasa 
				from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
				where b.kd_rek5 IN ($kd_rek51) 
				AND YEAR(tgl_voucher)=$lntahunang
				group by b.kd_unit) k
				on o.kd_skpd=k.kd_skpd
				LEFT JOIN
				(
				select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) lo_brg_jasa 
				from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
				where b.kd_rek5 IN ($kd_rek91) 
				AND YEAR(tgl_voucher)=$lntahunang
				group by b.kd_unit) p
				on o.kd_skpd=p.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) lra_persediaan 
				from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
				where b.kd_rek5 IN ($kd_rek52) 
				AND YEAR(tgl_voucher)=$lntahunang
				group by b.kd_unit)l
				on o.kd_skpd=l.kd_skpd
				LEFT JOIN
				(
				select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) lo_persediaan 
				from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
				where b.kd_rek5 IN ($kd_rek92) 
				AND YEAR(tgl_voucher)=$lntahunang
				group by b.kd_unit) q 
				on o.kd_skpd=q.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) lra_pemeliharaan 
				from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
				where b.kd_rek5 IN ($kd_rek53) 
				AND YEAR(tgl_voucher)=$lntahunang
				group by b.kd_unit)m
				on o.kd_skpd=m.kd_skpd
				LEFT JOIN
				(
				select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) lo_pemeliharaan 
				from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
				where b.kd_rek5 IN ($kd_rek93) 
				AND YEAR(tgl_voucher)=$lntahunang
				group by b.kd_unit) r
				on o.kd_skpd=r.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) lra_prj_dinas 
				from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
				where b.kd_rek5 IN ($kd_rek54) 
				AND YEAR(tgl_voucher)=$lntahunang
				group by b.kd_unit)n
				on o.kd_skpd=n.kd_skpd
				LEFT JOIN
				(
				select b.kd_unit as kd_skpd, sum(b.debet-b.kredit) lo_prj_dinas 
				from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
				where b.kd_rek5 IN ($kd_rek94) 
				AND YEAR(tgl_voucher)=$lntahunang
				group by b.kd_unit) s
				on o.kd_skpd=s.kd_skpd
				where lra_brg_jasa<>0 OR lo_brg_jasa<>0 OR lra_persediaan<>0 OR lo_persediaan<>0 OR lra_pemeliharaan<>0 OR lo_pemeliharaan<>0 OR lra_prj_dinas<>0 OR lo_prj_dinas<>0
				order by kd_skpd";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_skpd;
                       $nama = $row->nm_skpd;
                       $lra_brg_jasa = $row->lra_brg_jasa;
                       $lo_brg_jasa = $row->lo_brg_jasa;
                       $lra_persediaan = $row->lra_persediaan;
                       $lo_persediaan = $row->lo_persediaan;
                       $lra_pemeliharaan = $row->lra_pemeliharaan;
                       $lo_pemeliharaan = $row->lo_pemeliharaan;
                       $lra_prj_dinas = $row->lra_prj_dinas;
                       $lo_prj_dinas = $row->lo_prj_dinas;
					   $no=$no+1;
					 $cRet .='<tr>
							   <td align="center" valign="top" style="font-size:12px">'.$no.'</td> 
							   <td align="center" style="font-size:12px">'.$kode.'</td> 
							   <td align="left" style="font-size:12px">'.$nama.'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_brg_jasa, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_brg_jasa, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_persediaan, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_persediaan, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_pemeliharaan, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_pemeliharaan, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_prj_dinas, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_prj_dinas, "2", ",", ".").'</td> 
							</tr>'; 
							
						$tot_lra_brg_jasa = $tot_lra_brg_jasa+$lra_brg_jasa;
						$tot_lo_brg_jasa = $tot_lo_brg_jasa+$lo_brg_jasa;
						$tot_lra_persediaan = $tot_lra_persediaan+$lra_persediaan;
						$tot_lo_persediaan = $tot_lo_persediaan+$lo_persediaan;
						$tot_lra_pemeliharaan = $tot_lra_pemeliharaan+$lra_pemeliharaan;
						$tot_lo_pemeliharaan = $tot_lo_pemeliharaan+$lo_pemeliharaan;
						$tot_lra_prj_dinas = $tot_lra_prj_dinas+$lra_prj_dinas;
						$tot_lo_prj_dinas = $tot_lo_prj_dinas+$lo_prj_dinas;
					}
					
					
					
					 $cRet .='<tr>
							   <td colspan="3" align="center" valign="top" style="font-size:12px"><b>Jumlah</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_brg_jasa, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_brg_jasa, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_persediaan, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_persediaan, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_pemeliharaan, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_pemeliharaan, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_prj_dinas, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_prj_dinas, "2", ",", ".").'</b></td> 
							</tr>';
		}else{
		$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="21" align="center" ><b>PEMERINTAH PROVINSI KALIMANTAN BARAT</TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="21" align="center" >PENDAPATAN TAHUN ANGGARAN '.$lntahunang.'</TD>
					</TR>
					</TABLE><br/>';
			
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td rowspan=\"2\" width=\"4%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Kode SKPD</td>
					<td rowspan=\"2\" width=\"12%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Nama SKPD</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Pendapatan Pajak Daerah</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Pendapatan Retribusi Daerah</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Pendapatan Hasil Pengelolaan Kekayaan Daerah yang Dipisahkan</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Lain-lain PAD yang sah</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Dana Bagi Hasil Pajak</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Dana Bagi Hasil Sumber Daya Alam</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Dana Alokasi Umum</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Dana Alokasi Khusus</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Dana Otonomi Khusus</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Dana Penyesuaian</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Bantuan Keuangan dari Provinsi atau Pemerintah Daerah Lainnya</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Pendapatan Hibah</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Pendapatan Dana Darurat</td>
					<td colspan=\"2\" width=\"6%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Pendapatan Lainnya</td>
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
				   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
				   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
				   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
				   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
				   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
				   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
				   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
				   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
				   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
				   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LRA</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">LO</td> 
				</tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">7</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">8</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">9</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">10</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">11</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">12</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">13</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">14</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">15</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">16</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">17</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">18</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">19</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">20</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">21</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">22</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">23</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">24</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">25</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">26</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">27</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">28</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">29</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">30</td> 
				</tr>
				</thead>";
		
			$no=0;
			$tot_lra_pjk =0;
			$tot_lo_pjk =0;
			$tot_lra_retri =0;
			$tot_lo_retri =0;
			$tot_lra_hasil =0;
			$tot_lo_hasil =0;
			$tot_lra_lain =0;
			$tot_lo_lain =0;
			$tot_lra_bagi_pjk =0;
		    $tot_lo_bagi_pjk=0;
		    $tot_lra_bagi_sda =0;
		    $tot_lo_bagi_sda =0;
		    $tot_lra_dau =0;
		    $tot_lo_dau =0;
		    $tot_lra_dak =0; 
		    $tot_lo_dak =0; 
		    $tot_lra_dok =0; 
		    $tot_lo_dok =0;
		    $tot_lra_sesuai =0;
		    $tot_lo_sesuai =0;
		    $tot_lra_hibah =0;
		    $tot_lo_hibah =0;
		    $tot_lra_bantu_keu =0;
		    $tot_lo_bantu_keu =0;
		    $tot_lra_darurat =0;
		    $tot_lo_darurat =0;
		    $tot_lra_lainnya =0;
		    $tot_lo_lainnya =0;
            $sql = "SELECT o.kd_skpd,(select nm_skpd from trdrka where kd_skpd=o.kd_skpd group by nm_skpd) nm_skpd, 
       ISNULL(k.lra_pjk,0) lra_pjk, 
       ISNULL(p.lo_pjk,0) lo_pjk, 
       ISNULL(l.lra_retri,0) lra_retri, 
       ISNULL(q.lo_retri,0) lo_retri, 
       ISNULL(m.lra_hasil,0) lra_hasil, 
       ISNULL(r.lo_hasil,0) lo_hasil, 
       ISNULL(n.lra_lain,0) lra_lain, 
       ISNULL(s.lo_lain,0) lo_lain, 
       ISNULL(t.lra_bagi_pjk,0) lra_bagi_pjk,
       ISNULL(u.lo_bagi_pjk,0) lo_bagi_pjk,
       ISNULL(v.lra_bagi_sda,0) lra_bagi_sda,
       ISNULL(w.lo_bagi_sda,0) lo_bagi_sda,
       ISNULL(x.lra_dau,0) lra_dau,
       ISNULL(y.lo_dau,0) lo_dau,
       ISNULL(z.lra_dak,0) lra_dak, 
       ISNULL(za.lo_dak,0) lo_dak, 
       ISNULL(zb.lra_dok,0) lra_dok, 
       ISNULL(zc.lo_dok,0) lo_dok,
       ISNULL(zd.lra_sesuai,0) lra_sesuai,
       ISNULL(ze.lo_sesuai,0) lo_sesuai,
	   ISNULL(zl.lra_bantu_keu,0) lra_bantu_keu,
       ISNULL(zm.lo_bantu_keu,0) lo_bantu_keu,
	   ISNULL(zf.lra_hibah,0) lra_hibah,
       ISNULL(zg.lo_hibah,0) lo_hibah,
       ISNULL(zh.lra_darurat,0) lra_darurat,
       ISNULL(zi.lo_darurat,0) lo_darurat,
       ISNULL(zj.lra_lainnya,0) lra_lainnya,
       ISNULL(zk.lo_lainnya,0) lo_lainnya
       FROM (
				select kd_skpd from trdrka group by kd_skpd) o
				LEFT JOIN 
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_pjk from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('411') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) k on o.kd_skpd=k.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lo_pjk from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('811') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) p on o.kd_skpd=p.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_retri from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('412') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) l on o.kd_skpd=l.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lo_retri from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('812') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) q on o.kd_skpd=q.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_hasil from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('413') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) m on o.kd_skpd=m.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lo_hasil from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('813') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) r on o.kd_skpd=r.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_lain from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('414') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) n on o.kd_skpd=n.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lo_lain from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('814') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) s on o.kd_skpd=s.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_bagi_pjk from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,5) IN ('42101') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) t on o.kd_skpd=t.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lo_bagi_pjk from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,5) IN ('82101') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) u on o.kd_skpd=u.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_bagi_sda from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,5) IN ('42102') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) v on o.kd_skpd=v.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lo_bagi_sda from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,5) IN ('82102') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) w on o.kd_skpd=w.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_dau from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,5) IN ('42103') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) x on o.kd_skpd=x.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lo_dau from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,5) IN ('82103') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) y on o.kd_skpd=y.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_dak from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,5) IN ('42104') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) z on o.kd_skpd=z.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lo_dak from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,5) IN ('82104') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) za 
				on o.kd_skpd=za.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_dok from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,5) IN ('42201') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) zb on o.kd_skpd=zb.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lo_dok from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,5) IN ('82201') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) zc
				on o.kd_skpd=zc.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_sesuai from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,5) IN ('42202','42203') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) zd 
				on o.kd_skpd=zd.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lo_sesuai from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,5) IN ('82203') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) ze
				on o.kd_skpd=ze.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_hibah from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('431') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) zf
				on o.kd_skpd=zf.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lo_hibah from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('831') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) zg
				on o.kd_skpd=zg.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_bantu_keu from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('424') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) zl
				on o.kd_skpd=zl.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lo_bantu_keu from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('823','824') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) zm
				on o.kd_skpd=zm.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_darurat from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('432') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) zh
				on o.kd_skpd=zh.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, 0 lo_darurat from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
				where LEFT(b.kd_rek5,3) IN ('832') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) zi on o.kd_skpd=zi.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lra_lainnya from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('433') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) zj
				on o.kd_skpd=zj.kd_skpd
				LEFT JOIN
				(select b.kd_unit as kd_skpd, sum(b.kredit-b.debet) lo_lainnya from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and  a.no_voucher=b.no_voucher where LEFT(b.kd_rek5,3) IN ('832','833') AND YEAR(tgl_voucher)=$lntahunang group by b.kd_unit) zk
				on o.kd_skpd=zk.kd_skpd
				order by kd_skpd";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_skpd;
                       $nama = $row->nm_skpd;
                       $lra_pjk = $row->lra_pjk;
                       $lo_pjk = $row->lo_pjk;
                       $lra_retri = $row->lra_retri;
                       $lo_retri = $row->lo_retri;
                       $lra_hasil = $row->lra_hasil;
                       $lo_hasil = $row->lo_hasil;
                       $lra_lain = $row->lra_lain;
                       $lo_lain = $row->lo_lain;
					   $lra_bagi_pjk = $row->lra_bagi_pjk;
					   $lo_bagi_pjk = $row->lo_bagi_pjk;
					   $lra_bagi_sda = $row->lra_bagi_sda;
					   $lo_bagi_sda = $row->lo_bagi_sda;
					   $lra_dau = $row->lra_dau;
					   $lo_dau = $row->lo_dau;
					   $lra_dak = $row-> lra_dak; 
					   $lo_dak = $row-> lo_dak;
					   $lra_dok = $row-> lra_dok; 
					   $lo_dok = $row->lo_dok;
					   $lra_sesuai = $row->lra_sesuai;
					   $lo_sesuai = $row->lo_sesuai;
					   $lra_bantu_keu = $row->lra_bantu_keu;
					   $lo_bantu_keu = $row->lo_bantu_keu;
					   $lra_hibah = $row->lra_hibah;
					   $lo_hibah = $row->lo_hibah;
					   $lra_darurat = $row->lra_darurat;
					   $lo_darurat = $row->lo_darurat;
					   $lra_lainnya = $row->lra_lainnya;
					   $lo_lainnya = $row->lo_lainnya;
					 $cRet .='<tr>
							   <td align="center" style="font-size:12px">'.$kode.'</td> 
							   <td align="left" style="font-size:12px">'.$nama.'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_pjk, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_pjk, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_retri, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_retri, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_hasil, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_hasil, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_lain, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_lain, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_bagi_pjk, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_bagi_pjk, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_bagi_sda, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_bagi_sda, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_dau, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_dau, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_dak, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_dak, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_dok, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_dok, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_sesuai, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_sesuai, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_bantu_keu, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_bantu_keu, "2", ",", ".").'</td>
							    <td align="right" valign="top" style="font-size:12px">'.number_format($lra_hibah, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_hibah, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_darurat, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_darurat, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lra_lainnya, "2", ",", ".").'</td>
							   <td align="right" valign="top" style="font-size:12px">'.number_format($lo_lainnya, "2", ",", ".").'</td></tr>'; 
						$tot_lra_pjk = $tot_lra_pjk+$lra_pjk;
						$tot_lo_pjk = $tot_lo_pjk+$lo_pjk;
						$tot_lra_retri = $tot_lra_retri+$lra_retri;
						$tot_lo_retri = $tot_lo_retri+$lo_retri;
						$tot_lra_hasil = $tot_lra_hasil+$lra_hasil;
						$tot_lo_hasil = $tot_lo_hasil+$lo_hasil;
						$tot_lra_lain = $tot_lra_lain+$lra_lain;
						$tot_lo_lain = $tot_lo_lain+$lo_lain;
					   $tot_lra_bagi_pjk = $tot_lra_bagi_pjk+$lra_bagi_pjk;
					   $tot_lo_bagi_pjk = $tot_lo_bagi_pjk+$lo_bagi_pjk;
					   $tot_lra_bagi_sda = $tot_lra_bagi_sda+$lra_bagi_sda;
					   $tot_lo_bagi_sda = $tot_lo_bagi_sda+$lo_bagi_sda;
					   $tot_lra_dau = $tot_lra_dau+$lra_dau;
					   $tot_lo_dau = $tot_lo_dau+$lo_dau;
					   $tot_lra_dak = $tot_lra_dak+$lra_dak; 
					   $tot_lo_dak = $tot_lo_dak+$lo_dak;
					   $tot_lra_dok = $tot_lra_dok+$lra_dok; 
					   $tot_lo_dok = $tot_lo_dok+$lo_dok;
					   $tot_lra_sesuai = $tot_lra_sesuai+$lra_sesuai;
					   $tot_lo_sesuai = $tot_lo_sesuai+$lo_sesuai;
					   $tot_lra_hibah = $tot_lra_hibah+$lra_hibah;
					   $tot_lo_hibah = $tot_lo_hibah+$lo_hibah;
					   $tot_lra_bantu_keu = $tot_lra_bantu_keu+$lra_bantu_keu;
					   $tot_lo_bantu_keu = $tot_lo_bantu_keu+$lo_bantu_keu;
					   $tot_lra_darurat = $tot_lra_darurat+$lra_darurat;
					   $tot_lo_darurat = $tot_lo_darurat+$lo_darurat;
					   $tot_lra_lainnya = $tot_lra_lainnya+$lra_lainnya;
					   $tot_lo_lainnya = $tot_lo_lainnya+$lo_lainnya;
					}
					
					
					
					 $cRet .='<tr>
							   <td colspan="2" align="center" valign="top" style="font-size:12px"><b>Jumlah</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_pjk, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_pjk, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_retri, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_retri, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_hasil, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_hasil, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_lain, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_lain, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_bagi_pjk, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_bagi_pjk, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_bagi_sda, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_bagi_sda, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_dau, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_dau, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_dak, "2", ",", ".").'</b></td> 
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_dak, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_dok, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_dok, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_sesuai, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_sesuai, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_bantu_keu, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_bantu_keu, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_hibah, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_hibah, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_darurat, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_darurat, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lra_lainnya, "2", ",", ".").'</b></td>
							   <td align="right" valign="top" style="font-size:12px"><b>'.number_format($tot_lo_lainnya, "2", ",", ".").'</b></td>
							   </tr>';
		}
			$cRet .="</table>";
			$data['prev']= $cRet;    
            $judul='Lap_penjelasan_lo_lra_rinci';
			switch ($ctk){
				case 0;
				echo ("<title>$judul</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
	
	function cetak_lap_kom($kdskpd='',$rek3='',$ctk=''){
        $lntahunang = $this->session->userdata('pcThang');       
        $lcskpd = $kdskpd;
		$rek3='153';
        if($rek3==15){
			$nama_rek='Aset Lainnya';
		}else{
			$nama_rek=$this->tukd_model->get_nama($rek3,'nm_rek3','ms_rek3_64','kd_rek3');
		}
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="21" align="center" ><b>'.$prov.' </TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="21" align="center" >PENJELASAN DAMPAK KOMULATIF KEBIJAKAN/KESALAHAN MENDASAR PADA LAPORAN PERUBAHAN EKUITAS TAHUN ANGGARAN '.$lntahunang.'</TD>
					</TR>
					</TABLE><br/>';
			
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td rowspan=\"2\" width=\"5%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">No</td>
                    <td rowspan=\"2\" width=\"25%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Unit Kerja</td>
					<td colspan=\"2\" width=\"20%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Koreksi Nilai Persediaan</td>
					<td colspan=\"2\" width=\"20%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Selisih Revaluasi Aset Tetap</td>
					<td colspan=\"2\" width=\"20%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Lain - Lain</td>
					<td rowspan=\"2\" width=\"10%\" align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Jumlah</td>
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Uraian</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Realisasi</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Uraian</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Realisasi</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Uraian</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Realisasi</td> 
				</tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">7</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">8</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">9</td> 
				</tr>
				</thead>";
			$jum_real_sedia=0;
			$jum_real_tetap=0;
			$jum_real_lain=0;
			$total=0;
			$no=0;
			$sql = "SELECT a.kd_skpd, a.nm_skpd
					,ISNULL(real_sedia,0) as real_sedia 
					,ISNULL(real_tetap,0) as real_tetap 
					,ISNULL(real_lain,0) as real_lain 
					FROM ms_skpd a 
					LEFT JOIN (
					SELECT kd_skpd
					,SUM(CASE WHEN reev ='2' THEN real_spj ELSE 0 END) AS real_sedia
					,SUM(CASE WHEN reev ='1' THEN real_spj ELSE 0 END) AS real_tetap
					,SUM(CASE WHEN reev ='3' THEN real_spj ELSE 0 END) AS real_lain
					 FROM (
					select b.kd_skpd, kd_rek5,b.reev ,sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where b.reev = '2' 
					AND kd_rek5 = '3110101' and year(b.tgl_voucher)=$lntahunang 
and month(b.tgl_voucher)<=12
					GROUP BY b.kd_skpd,kd_rek5,b.reev
					UNION ALL
					select b.kd_skpd, kd_rek5,b.reev, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where b.reev = '1' 
					AND kd_rek5 = '3110101' and year(b.tgl_voucher)=$lntahunang 
and month(b.tgl_voucher)<=12
					GROUP BY b.kd_skpd,kd_rek5,b.reev
					UNION ALL
					select b.kd_skpd, kd_rek5,b.reev, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where b.reev = '3' 
					AND kd_rek5 = '3110101' and year(b.tgl_voucher)=$lntahunang 
and month(b.tgl_voucher)<=12
					GROUP BY b.kd_skpd,kd_rek5,b.reev) a
					GROUP BY kd_skpd)b
					ON a.kd_skpd=b.kd_skpd
					order by a.kd_skpd
					";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_skpd;
                       $nama = $row->nm_skpd;
                       $real_sedia = $row->real_sedia;
                       $real_tetap = $row->real_tetap;
                       $real_lain = $row->real_lain;
					   $tot= $real_sedia+$real_tetap+$real_lain;
                       $jum_real_sedia=$jum_real_sedia+$real_sedia;
                       $jum_real_tetap=$jum_real_tetap+$real_tetap;
                       $jum_real_lain=$jum_real_lain+$real_lain;
					   $total=$total+$tot;
					   $no=$no+1;
					 $cRet .='<tr>
							   <td align="center" valign="top" style="font-size:12px">'.$no.'</td> 
							   <td align="left" style="font-size:12px">'.$nama.'</td> 
							   <td align="right" valign="top" style="font-size:12px">&nbsp;</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($real_sedia, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px"></td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($real_tetap, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px"></td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($real_lain, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($tot, "2", ",", ".").'</td> 
							</tr>'; 
					}
			$cRet .='<tr>
							   <td colspan="2" align="center" valign="top" style="font-size:12px">J U M L A H</td> 
							   <td align="right" valign="top" style="font-size:12px">&nbsp;</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_real_sedia, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px"></td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_real_tetap, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px"></td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_real_lain, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($total, "2", ",", ".").'</td> 
							</tr>'; 
			$cRet .="</table>";
			$data['prev']= $cRet;    
            $judul='Lap_penjelasan_dampak_komulatif';
			switch ($ctk){
				case 0;
				echo ("<title>$judul</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
	
	function cetak_lap_lo($kdskpd='',$rek3='',$ctk=''){
        $lntahunang = $this->session->userdata('pcThang');       
        $lcskpd = $kdskpd;
		$rek3='153';
        if($rek3==15){
			$nama_rek='Aset Lainnya';
		}else{
			$nama_rek=$this->tukd_model->get_nama($rek3,'nm_rek3','ms_rek3_64','kd_rek3');
		}
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
					<TR>
						<TD colspan="21" align="center" ><b>'.$prov.' </TD>
					</TR>
					<tr></tr>
                    <TR>
						<TD colspan="21" align="center" >PENJELASAN LAPORAN OPERASIONAL TAHUN ANGGARAN'.$lntahunang.'</TD>
					</TR>
					</TABLE><br/>';
			
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <thead>
				<tr>
                    <td rowspan=\"2\" width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">No</td>
                    <td rowspan=\"2\" width=\"35%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Unit Kerja</td>
					<td colspan=\"2\" width=\"25%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Beban Penyusutan</td>
					<td colspan=\"2\" width=\"25%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Beban Lain-lain</td>
					<td rowspan=\"2\" width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">Jumlah</td>
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Uraian</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Realisasi</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Uraian</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">Realisasi</td> 
				</tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">7</td> 
				</tr>
				</thead>";
			$jum_bbn_susut=0;
			$jum_bbn_lain=0;
			$total=0;
			$no=0;
			$sql = "SELECT a.kd_skpd, a.nm_skpd
					,ISNULL(bbn_susut,0) as bbn_susut 
					,ISNULL(bbn_lain,0) as bbn_lain 
					FROM ms_skpd a 
					LEFT JOIN 
					(SELECT kd_skpd
					,SUM(CASE WHEN kd_rek ='917' THEN real_spj ELSE 0 END) AS bbn_susut
					,SUM(CASE WHEN kd_rek IN ('918','919') THEN real_spj ELSE 0 END) AS bbn_lain
					 FROM 
					(select b.kd_skpd, left(a.kd_rek5,3) kd_rek, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,3) in ('917','918','919')
					group by kd_skpd, left(a.kd_rek5,3))a
					GROUP BY kd_skpd) b
					ON a.kd_skpd=b.kd_skpd
					order by a.kd_skpd
					";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode = $row->kd_skpd;
                       $nama = $row->nm_skpd;
                       $bbn_susut = $row->bbn_susut;
                       $bbn_lain = $row->bbn_lain;
					   $tot= $bbn_susut+$bbn_lain;
                       $jum_bbn_susut=$jum_bbn_susut+$bbn_susut;
                       $jum_bbn_lain=$jum_bbn_lain+$bbn_lain;
					   $total=$total+$tot;
					   $no=$no+1;
					 $cRet .='<tr>
							   <td align="center" valign="top" style="font-size:12px">'.$no.'</td> 
							   <td align="left" style="font-size:12px">'.$nama.'</td> 
							   <td align="right" valign="top" style="font-size:12px">&nbsp;</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($bbn_susut, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px"></td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($bbn_lain, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($tot, "2", ",", ".").'</td> 
							</tr>'; 
					}
			$cRet .='<tr>
							   <td colspan="2" align="center" valign="top" style="font-size:12px">J U M L A H</td> 
							   <td align="right" valign="top" style="font-size:12px">&nbsp;</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_bbn_susut, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px"></td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($jum_bbn_lain, "2", ",", ".").'</td> 
							   <td align="right" valign="top" style="font-size:12px">'.number_format($total, "2", ",", ".").'</td> 
							</tr>'; 
			$cRet .="</table>";
			$data['prev']= $cRet;    
            $judul='Lap_penjelasan_lo';
			switch ($ctk){
				case 0;
				echo ("<title>$judul</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
				case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
		}
	
	
	
	function cetak_perdaIV_real($cetak = 1)
    {

        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc)
        {

            $tgl = $rowsc->tgl_rka;
            $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
            $kab = $rowsc->kab_kota;
            $daerah = $rowsc->daerah;
            $thn = $rowsc->thn_ang;
        }


        $cRet = '';
        if ($cetak <> 0)
        {
            $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"10%\"><strong><h5>LAMPIRAN IV  :</h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
                    </tr>
                                         
                   
                  </table>";
        }
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI BELANJA MENURUT URUSAN PEMERINTAHAN DAERAH, ORGANISASI, PROGRAM DAN KEGIATAN</strong></td>
                    </tr>
                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table>";

        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>KODE</b></td>                            
                            <td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"22%\" align=\"center\"><b>URAIAN URUSAN, ORGANISASI, PROGRAM DAN KEGIATAN PEMERINTAH DAERAH</b></td>                            
                            <td style=\"border-bottom: solid 1px black;\" colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"49%\" align=\"center\"><b>SETELAH PERUBAHAN</b></td>
                            <td style=\"border-bottom: solid 1px black;\" colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"49%\" align=\"center\"><b>REALISASI</b></td>
                            <td style=\"border-bottom: solid 1px black;\" colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>LEBIH/(KURANG)</b></td>
                        </tr>
                        <tr>
                            <td style=\"border-bottom: solid 1px black;\" colspan=\"3\" width=\"21%\" bgcolor=\"#CCCCCC\" align=\"center\">JENIS BELANJA</td>
                            <td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">JUMLAH</td>
                            <td style=\"border-bottom: solid 1px black;\" colspan=\"3\" width=\"21%\" bgcolor=\"#CCCCCC\" align=\"center\">JENIS BELANJA</td>
                            <td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">JUMLAH</td>
                            <td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">(Rp)</td>
                            <td rowspan=\"2\" width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
                        </tr>
                        <tr>
 		                    <td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">PEGAWAI</td>
                            <td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">BARANG DAN JASA</td>
                            <td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">MODAL</td>
                            <td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">PEGAWAI</td>
                            <td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">BARANG DAN JASA</td>
                            <td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">MODAL</td>
                        </tr>    
                     </thead>
                    
                     
                        <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"22%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                        </tr>
                        ";
        $sql1 = "SELECT * FROM (SELECT a.kd_urusan1 AS kode,a.kd_urusan1 AS kode1, a.nm_urusan1 AS nama,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='521' AND LEFT(kd_skpd,1)=a.kd_urusan1) AS ang_521,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='522' AND LEFT(kd_skpd,1)=a.kd_urusan1)AS ang_522,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='523' AND LEFT(kd_skpd,1)=a.kd_urusan1) AS ang_523,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,2)='52' AND LEFT(kd_skpd,1)=a.kd_urusan1) AS ang_jumlah,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='521' AND LEFT(kd_skpd,1)=a.kd_urusan1) AS real_521,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='522' AND LEFT(kd_skpd,1)=a.kd_urusan1)AS real_522,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='523' AND LEFT(kd_skpd,1)=a.kd_urusan1) AS real_523,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,2)='52' AND LEFT(kd_skpd,1)=a.kd_urusan1) AS real_jumlah,'1' AS urut FROM trdrka b 
                        RIGHT JOIN ms_urusan1 a ON LEFT(b.kd_skpd,1)=a.kd_urusan1 GROUP BY  a.kd_urusan1 ,a.nm_urusan1   
                        UNION
                        SELECT a.kd_urusan AS kode,a.kd_urusan AS kode1, a.nm_urusan AS nama,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='521' AND LEFT(kd_skpd,4)=a.kd_urusan) AS ang_521,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='522' AND LEFT(kd_skpd,4)=a.kd_urusan)AS ang_522,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT (kd_rek5,3)='523' AND LEFT(kd_skpd,4)=a.kd_urusan) AS ang_523,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,2)='52' AND LEFT(kd_skpd,4)=a.kd_urusan)AS ang_jumlah,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='521' AND LEFT(kd_skpd,4)=a.kd_urusan) AS real_521,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='522' AND LEFT(kd_skpd,4)=a.kd_urusan)AS real_522,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT (kd_rek5,3)='523' AND LEFT(kd_skpd,4)=a.kd_urusan) AS real_523,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,2)='52' AND LEFT(kd_skpd,4)=a.kd_urusan)AS real_jumlah,'2' AS urut FROM trdrka b 
                        RIGHT JOIN ms_urusan a ON LEFT(b.kd_skpd,4)=a.kd_urusan GROUP BY  a.kd_urusan ,a.nm_urusan  
                        UNION
                        SELECT b.kd_skpd AS kode,b.kd_skpd AS kode1, b.nm_skpd AS nama,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='521' AND kd_skpd=a.kd_skpd) AS ang_521,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='522' AND kd_skpd=a.kd_skpd) AS ang_522, 
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='523' AND kd_skpd=a.kd_skpd) AS ang_523,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,2)='52' AND kd_skpd=a.kd_skpd)AS ang_jumlah,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='521' AND kd_skpd=a.kd_skpd) AS real_521,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='522' AND kd_skpd=a.kd_skpd) AS real_522, 
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='523' AND kd_skpd=a.kd_skpd) AS real_523,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,2)='52' AND kd_skpd=a.kd_skpd)AS real_jumlah,'3' AS urut FROM trdrka a 
                        RIGHT JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd GROUP BY a.kd_skpd,b.nm_skpd 
                        UNION
                        SELECT b.kd_program AS kode,b.kd_program AS kode1,c.nm_program AS nama,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='521' AND kd_skpd=a.kd_skpd AND LEFT(kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program ) AS ang_521,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='522' AND kd_skpd=a.kd_skpd AND LEFT(kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program ) AS ang_522,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='523' AND kd_skpd=a.kd_skpd AND LEFT(kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program ) AS ang_523,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,2)='52' AND kd_skpd=a.kd_skpd AND LEFT(kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program ) AS ang_jumlah,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='521' AND kd_skpd=a.kd_skpd AND LEFT(kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program ) AS real_521,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='522' AND kd_skpd=a.kd_skpd AND LEFT(kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program ) AS real_522,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='523' AND kd_skpd=a.kd_skpd AND LEFT(kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program ) AS real_523,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,2)='52' AND kd_skpd=a.kd_skpd AND LEFT(kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program ) AS real_jumlah,
                        '4' AS urut
                        FROM trdrka a INNER JOIN trskpd b ON a.kd_kegiatan=b.kd_kegiatan
                        INNER JOIN m_prog c ON b.kd_program1 = c.kd_program WHERE RIGHT(b.kd_program,2) <>'00'GROUP BY  b.kd_program,c.nm_program 
                        UNION
                        SELECT b.kd_kegiatan AS kode,b.kd_kegiatan AS kode1,c.nm_kegiatan AS nama,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='521' AND kd_skpd=a.kd_skpd AND kd_kegiatan=b.kd_kegiatan ) AS ang_521,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='522' AND kd_skpd=a.kd_skpd AND kd_kegiatan=b.kd_kegiatan ) AS ang_522,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='523' AND kd_skpd=a.kd_skpd AND kd_kegiatan=b.kd_kegiatan ) AS ang_523,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,2)='52' AND kd_skpd=a.kd_skpd AND kd_kegiatan=b.kd_kegiatan ) AS ang_jumlah,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='521' AND kd_skpd=a.kd_skpd AND kd_kegiatan=b.kd_kegiatan ) AS real_521,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='522' AND kd_skpd=a.kd_skpd AND kd_kegiatan=b.kd_kegiatan ) AS real_522,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='523' AND kd_skpd=a.kd_skpd AND kd_kegiatan=b.kd_kegiatan ) AS real_523,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,2)='52' AND kd_skpd=a.kd_skpd AND kd_kegiatan=b.kd_kegiatan ) AS real_jumlah,
                        '5' AS urut
                        FROM trdrka a INNER JOIN trskpd b ON a.kd_kegiatan=b.kd_kegiatan
                        INNER JOIN m_giat c ON b.kd_kegiatan1 = c.kd_kegiatan WHERE RIGHT(b.kd_program,2) <>'00'GROUP BY  b.kd_kegiatan,c.nm_kegiatan 
                        UNION	
                        SELECT DISTINCT '' AS kode,'99' AS kode, 'JUMLAH' AS nama,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='521') AS ang_521,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='522' )AS ang_522,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,3)='523' ) AS ang_523,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,2)='52' ) AS ang_jumlah,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='521' ) AS real_521,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='522' )AS real_522,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,3)='523' ) AS real_523,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,2)='52' ) AS real_jumlah,'6' AS urut FROM trdrka) a ORDER BY kode1,urut";

        $query = $this->db->query($sql1);
        //$query = $this->skpd_model->getAllc();

        foreach ($query->result() as $row)
        {
            $kode = $row->kode;
            $nama = $row->nama;
            $ang521 = number_format($row->ang_521, "2", ".", ",");
            $ang522 = number_format($row->ang_522, "2", ".", ",");
            $ang523 = number_format($row->ang_523, "2", ".", ",");
            $jum_ang = number_format($row->ang_jumlah, "2", ".", ",");
            $real521 = number_format($row->real_521, "2", ".", ",");
            $real522 = number_format($row->real_522, "2", ".", ",");
            $real523 = number_format($row->real_523, "2", ".", ",");
            $jum_real = number_format($row->real_jumlah, "2", ".", ",");
            $rumus1 = $row->real_jumlah - $row->ang_jumlah;
            if ($rumus1 < 0)
            {
                $x1 = "(";
                $rumus1 = $rumus1 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $total1 = number_format($rumus1, "2", ".", ",");
            $per1 = ($rumus1 != 0) ? ($rumus1 / $row->ang_jumlah) * 100 : 0;
            $persen1 = number_format($per1, "2", ".", ",");

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"22%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$ang521</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$ang522</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$ang523</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$jum_ang</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$real521</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$real522</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$real523</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$jum_real</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$x1$total1$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"right\">$persen1</td>
                                </tr> ";


        }

        $cRet .= " </table>";
        $data['prev'] = $cRet;
        $judul = 'Laporan Realisasi APBD  Lamp IV ';
        $this->template->set('title', 'CETAK PERDA REALISASI LAMPIRAN IV');
        switch ($cetak)
        {
            case 1;
                $this->tukd_model->_mpdf('', $cRet, 10, 10, 10, 'L');
                break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
    }
	
	function ctk_penyi_piutang($skpd='', $ctk=''){
    
		$lntahunang = $this->session->userdata('pcThang');       
		$bulan = 12+1;
		$sql =  " select nm_skpd from ms_skpd where kd_skpd='$skpd'";
			$hasil = $this->db->query($sql);
            foreach ($hasil->result() as $row)
				{
					$nama_skpd = $row->nm_skpd;
				}
					
		$cRet = '';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">
                 <tr>
                    <td colspan=\"5\" style=\"border-top:none;border-right:none;border-left:none;font-size:14px\" align=\"center\">
                    <b>PEMERINTAH PROVINSI KALIMANTAN BARAT</b> <br>
					<b>".strtoupper($nama_skpd)."</b> <br>
                    <b>ANALISIS UMUR PIUTANG</b><BR>
                    <b>PER 31 DESEMBER $lntahunang </b>
                    <BR>&nbsp;                                        
                    </td>           
                </tr>
				</table>
				";
		 $cRet .="<table style=\"border-collapse:collapse;font-size:12px\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">
                 <tr>
                    <td width=\"5%\"  align=\"left\">
                    SKPD </td> 
					<td> :</td>
					<td> $skpd - $nama_skpd <br></td>
                </tr>
				<tr>
                    <td width=\"5%\"  align=\"left\">
                    &nbsp;</td> 
                </tr>
				</table>
				";
		
					$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">
                <tr>
                    <td width=\"10%\" align=\"center\" style=\"font-size:12px\">Kode Rekening </td>
					<td width=\"10%\" align=\"center\" style=\"font-size:12px\">Uraian</td>
					<td width=\"10%\" align=\"center\" style=\"font-size:12px\">Tahun<br>Penetapan</td>
					<td width=\"10%\" align=\"center\" style=\"font-size:12px\">Bulan<br>Penetapan</td>
					<td width=\"10%\" align=\"center\" style=\"font-size:12px\">Keterangan</td>
					<td width=\"10%\" align=\"center\" style=\"font-size:12px\">Saldo<br>Piutang</td>
					<td width=\"10%\" align=\"center\" style=\"font-size:12px\">Umur<br>Piutang</td>
					<td width=\"5%\" align=\"center\" style=\"font-size:12px\">Kualitas<br>Piutang</td>
					<td width=\"5%\" align=\"center\" style=\"font-size:12px\">Taksiran<br>Piutang Tak<br>Tertagih</td>
					<td width=\"10%\" align=\"center\" style=\"font-size:12px\">Penyisihan<br>Piutang</td>
					<td width=\"10%\" align=\"center\" style=\"font-size:12px\">Nilai Buku<br>Piutang Tahun<br>$lntahunang</td>
                </tr>
				<tr>
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">1</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">2</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">3</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">4</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">5</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">6</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">7</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">8</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">9</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">10</td> 
                   <td align=\"center\" bgcolor=\"#CCCCCC\" style=\"font-size:12px\">11</td> 
                </tr>";
				
				$sql = "select kd_rek3 kode1, kd_rek3 kode, UPPER(nm_rek3) nama, '' lokasi, 0 tahun, 0 bulan, 0 jumlah, 0 sal_awal, 
						0 kurang, 0 tambah, 0 tahun_n, '' keterangan, 0 umur_t, 0 umur_b, '' kualitas, 0 penyi_piu from lamp_aset 
						where kd_skpd='$skpd' and kd_rek3 in (113,114)
						union
						select LEFT(kd_rek5,5) kode1, LEFT(kd_rek5,5) kode, (SELECT UPPER(nm_rek4_64) from ms_rek4_64 where kd_rek4_64 = LEFT(kd_rek5,5)) nama, 
						'' lokasi, 0 tahun, 0 bulan, 0 jumlah, 0 sal_awal, 0 kurang, 0 tambah, 0 tahun_n, '' keterangan, 0 umur_t, 
						0 umur_b, '' kualitas, 0 penyi_piu from lamp_aset 
						where kd_skpd='$skpd' and kd_rek3 in (113,114)
						union all
						select kode1, kode, nama, lokasi, tahun, bulan, jumlah,  sal_awal,  kurang,  
						tambah, tahun_n, keterangan, umur_t, isnull(umur_b,1) umur_b, case when left(kode1,5)=11301 and umur_t<=1 then 'Lancar'
						when left(kode1,5)=11301 and umur_t>1 and umur_t<=2 then 'Kurang Lancar'
						when left(kode1,5)=11301 and umur_t>2 and umur_t<=5 then 'Diragukan'
						when left(kode1,5)=11301 and umur_t>5 then 'Macet'
						when left(kode1,5)=11302 and umur_t<1 and isnull(umur_b,1)<=1 then 'Lancar'
						when left(kode1,5)=11302 and umur_t<1 and isnull(umur_b,1)>1 and isnull(umur_b,1)<=3 then 'Kurang Lancar'
						when left(kode1,5)=11302 and umur_t<1 and isnull(umur_b,1)>3 and isnull(umur_b,1)<=12 then 'Diragukan'
						when left(kode1,5)=11302 and umur_t>=1 then 'Macet'
						when left(kode1,5) not in (11301,11302) and umur_t<1 and isnull(umur_b,1)<1 then 'Lancar'
						when left(kode1,5) not in (11301,11302) and umur_t<1 and isnull(umur_b,1)>1 and isnull(umur_b,1)<=1 then 'Kurang Lancar'
						when left(kode1,5) not in (11301,11302) and umur_t<1 and isnull(umur_b,1)>2 and isnull(umur_b,1)<=2 then 'Diragukan'
						when left(kode1,5) not in (11301,11302) and umur_t>=0 and isnull(umur_b,1)>3 and isnull(umur_b,1)<=3 then 'Macet'
						else 'Tidak Diketahui' end as kualitas,
						case when left(kode1,5)=11301 and umur_t<=1 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 0.005 as decimal(20,2))
						when left(kode1,5)=11301 and umur_t>1 and umur_t<=2 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 0.1 as decimal(20,2))
						when left(kode1,5)=11301 and umur_t>2 and umur_t<=5 then
						cast((sal_awal-kurang+tambah+tahun_n)* 0.5 as decimal(20,2))
						when left(kode1,5)=11301 and umur_t>5 then
						cast((sal_awal-kurang+tambah+tahun_n) * 1 as decimal(20,2))
						when left(kode1,5)=11302 and umur_t<1 and isnull(umur_b,0)<=1 then
						cast((sal_awal-kurang+tambah+tahun_n) * 0.005 as decimal(20,2))
						when left(kode1,5)=11302 and umur_t<1 and isnull(umur_b,0)>1 and isnull(umur_b,0)<=3 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 0.1 as decimal(20,2))
						when left(kode1,5)=11302 and umur_t<1 and isnull(umur_b,0)>3 and isnull(umur_b,0)<=12 then 
						cast((sal_awal-kurang+tambah+tahun_n)* 0.5 as decimal(20,2))
						when left(kode1,5)=11302 and umur_t>=1 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 1 as decimal(20,2))
						when left(kode1,5) not in (11301,11302) and umur_t<1 and isnull(umur_b,0)<1 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 0.005 as decimal(20,2))
						when left(kode1,5) not in (11301,11302) and umur_t<1 and isnull(umur_b,0)>1 and isnull(umur_b,0)<=1 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 0.1 as decimal(20,2))
						when left(kode1,5) not in (11301,11302) and umur_t<1 and isnull(umur_b,0)>2 and isnull(umur_b,0)<=2 then 
						cast((sal_awal-kurang+tambah+tahun_n)* 0.5 as decimal(20,2))
						when left(kode1,5) not in (11301,11302) and umur_t>=0 and isnull(umur_b,0)>3 and isnull(umur_b,0)<=3 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 1 as decimal(20,2))
						else 'Tidak Diketahui' end as penyi_piu 
						from
						(SELECT kd_rek5 as kode1, kd_rek5 as kode, nm_rek5 as nama, lokasi, tahun, isnull(bulan,1) bulan, jumlah,   
						sal_awal,  kurang,  tambah, tahun_n, keterangan, case when $bulan-isnull(bulan,1)=12 then $lntahunang-tahun+1 else $lntahunang-tahun end 
						as umur_t, case when $bulan-isnull(bulan,1)=12 then 0 else $bulan-isnull(bulan,1) end as umur_b FROM lamp_aset where kd_rek3 
						in (113,114) and kd_skpd ='$skpd') a
						union all
						select LEFT(kode1,5)+'988' kode1, '' kode, (SELECT 'TOTAL '+UPPER(nm_rek4_64) from ms_rek4_64 where kd_rek4_64 = LEFT(kode1,5)) nama, 
						'' lokasi, 0 tahun, 0 bulan, 0 jumlah, sum(sal_awal) sal_awal, sum(kurang) kurang, 
						sum(tambah) tambah, sum(tahun_n) tahun_n, '' keterangan, 0 umur_t, 
						0 umur_b, '' kualitas, sum(penyi_piu) penyi_piu
						from (select kode1, kode, nama, lokasi, tahun, bulan, jumlah,  sal_awal,  kurang,  
						tambah, tahun_n, keterangan, umur_t, isnull(umur_b,1) umur_b, case when left(kode1,5)=11301 and umur_t<=1 then 'Lancar'
						when left(kode1,5)=11301 and umur_t>1 and umur_t<=2 then 'Kurang Lancar'
						when left(kode1,5)=11301 and umur_t>2 and umur_t<=5 then 'Diragukan'
						when left(kode1,5)=11301 and umur_t>5 then 'Macet'
						when left(kode1,5)=11302 and umur_t<1 and isnull(umur_b,1)<=1 then 'Lancar'
						when left(kode1,5)=11302 and umur_t<1 and isnull(umur_b,1)>1 and isnull(umur_b,1)<=3 then 'Kurang Lancar'
						when left(kode1,5)=11302 and umur_t<1 and isnull(umur_b,1)>3 and isnull(umur_b,1)<=12 then 'Diragukan'
						when left(kode1,5)=11302 and umur_t>=1 then 'Macet'
						when left(kode1,5) not in (11301,11302) and umur_t<1 and isnull(umur_b,1)<1 then 'Lancar'
						when left(kode1,5) not in (11301,11302) and umur_t<1 and isnull(umur_b,1)>1 and isnull(umur_b,1)<=1 then 'Kurang Lancar'
						when left(kode1,5) not in (11301,11302) and umur_t<1 and isnull(umur_b,1)>2 and isnull(umur_b,1)<=2 then 'Diragukan'
						when left(kode1,5) not in (11301,11302) and umur_t>=0 and isnull(umur_b,1)>3 and isnull(umur_b,1)<=3 then 'Macet'
						else 'Tidak Diketahui' end as kualitas,
						case when left(kode1,5)=11301 and umur_t<=1 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 0.005 as decimal(20,2))
						when left(kode1,5)=11301 and umur_t>1 and umur_t<=2 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 0.1 as decimal(20,2))
						when left(kode1,5)=11301 and umur_t>2 and umur_t<=5 then
						cast((sal_awal-kurang+tambah+tahun_n)* 0.5 as decimal(20,2))
						when left(kode1,5)=11301 and umur_t>5 then
						cast((sal_awal-kurang+tambah+tahun_n) * 1 as decimal(20,2))
						when left(kode1,5)=11302 and umur_t<1 and isnull(umur_b,0)<=1 then
						cast((sal_awal-kurang+tambah+tahun_n) * 0.005 as decimal(20,2))
						when left(kode1,5)=11302 and umur_t<1 and isnull(umur_b,0)>1 and isnull(umur_b,0)<=3 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 0.1 as decimal(20,2))
						when left(kode1,5)=11302 and umur_t<1 and isnull(umur_b,0)>3 and isnull(umur_b,0)<=12 then 
						cast((sal_awal-kurang+tambah+tahun_n)* 0.5 as decimal(20,2))
						when left(kode1,5)=11302 and umur_t>=1 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 1 as decimal(20,2))
						when left(kode1,5) not in (11301,11302) and umur_t<1 and isnull(umur_b,0)<1 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 0.005 as decimal(20,2))
						when left(kode1,5) not in (11301,11302) and umur_t<1 and isnull(umur_b,0)>1 and isnull(umur_b,0)<=1 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 0.1 as decimal(20,2))
						when left(kode1,5) not in (11301,11302) and umur_t<1 and isnull(umur_b,0)>2 and isnull(umur_b,0)<=2 then 
						cast((sal_awal-kurang+tambah+tahun_n)* 0.5 as decimal(20,2))
						when left(kode1,5) not in (11301,11302) and umur_t>=0 and isnull(umur_b,0)>3 and isnull(umur_b,0)<=3 then 
						cast((sal_awal-kurang+tambah+tahun_n) * 1 as decimal(20,2))
						else 'Tidak Diketahui' end as penyi_piu 
						from
						(SELECT kd_rek5 as kode1, kd_rek5 as kode, nm_rek5 as nama, lokasi, tahun, isnull(bulan,1) bulan, jumlah,   
						sal_awal,  kurang,  tambah, tahun_n, keterangan, case when $bulan-isnull(bulan,1)=12 then $lntahunang-tahun+1 else $lntahunang-tahun end 
						as umur_t, case when $bulan-isnull(bulan,1)=12 then 0 else $bulan-isnull(bulan,1) end as umur_b FROM lamp_aset where kd_rek3 
						in (113,114) and kd_skpd ='$skpd') a) a group by left(kode1,5)
						union
						select LEFT(kd_rek5,5)+'9999' kode1, '' kode, '' nama, '' lokasi, 0 tahun, 0 bulan, 0 jumlah, 0 sal_awal, 
						0 kurang, 0 tambah, 0 tahun_n, '' keterangan, 0 umur_t, 0 umur_b, '' kualitas, 0 penyi_piu from lamp_aset 
						where kd_skpd='$skpd' and kd_rek3 in (113,114) 
						order by kode1, tahun, bulan  
";
                    $hasil = $this->db->query($sql);
                    foreach ($hasil->result() as $row)
                    {
                       $kode1 = $row->kode1;
                       $kode = $row->kode;
					   $nama = $row->nama;
					   $bln = $row->bulan;
                       $tahun = $row->tahun;
                       $lokasi = $row->lokasi;
                       $jumlah = $row->jumlah;
                       $sal_awal = $row->sal_awal;
                       $kurang = $row->kurang;
                       $tambah = $row->tambah;
                       $tahun_n = $row->tahun_n;
                       $akhir = $sal_awal-$kurang+$tambah;
                       $keterangan = $row->keterangan;
					   $umur_t = $row->umur_t;
					   $umur_b = $row->umur_b;
					   $kualitas = $row->kualitas;
					   $penyi_piu = $row->penyi_piu;
					   $nilai_piu = $akhir-$penyi_piu;
					   $jumlah==0 ? $jumlah = '' : $jumlah=number_format($jumlah,"0",",",".");
					   $bln==0 ? $bln = '' : $bln=number_format($bln,"0",",",".");
					   $sal_awal==0 ? $sal_awal = '' : $sal_awal=number_format($sal_awal,"2",",",".");
					   $kurang==0 ? $kurang = '' : $kurang=number_format($kurang,"2",",",".");
					   $tambah==0 ? $tambah = '' : $tambah=number_format($tambah,"2",",",".");
					   $tahun_n==0 ? $tahun_n = '' : $tahun_n=number_format($tahun_n,"2",",",".");
					   $umur_t==0 ? $umur_t = '' : $umur_t=number_format($umur_t,"0",",",".");
					   $umur_b==0 ? $umur_b = '' : $umur_b=number_format($umur_b,"0",",",".");
					   
					   if ($umur_b==0 && strlen($kode1)==7){$umur_piu=$umur_t." Tahun";}
					   elseif (strlen($kode1)!=7){$umur_piu = '';}
					   else {$umur_piu=$umur_t." Tahun " .$umur_b. "Bulan";}
					   
					   if($kualitas=='Lancar'){
					   $taksiran="0,5%";}
					   elseif($kualitas=='Kurang Lancar'){
					   $taksiran="10%";}
					   elseif($kualitas=='Diragukan'){
					   $taksiran="50%";}
					   else{
					   $taksiran="100%";}
						
					   if (strlen($kode1)==7){$tahun=$tahun;}
					   else {$tahun = '';}
					   
					   if (strlen($kode1)==7 || strlen($kode1)==8){$akhir=number_format($akhir,"2",",",".");}
					   else {$akhir = '';}
					   
					   if (strlen($kode1)==7){$taksiran=$taksiran;}
					   else {$taksiran = '';}
					   
					   if (strlen($kode1)==7 || strlen($kode1)==8){$penyi_piu=number_format($penyi_piu,"2",",",".");}
					   else {$penyi_piu = '';}
					   
					   if (strlen($kode1)==7 || strlen($kode1)==8){$nilai_piu=number_format($nilai_piu,"2",",",".");}
					   else {$nilai_piu = '';}
					   $cRet .="<tr>
							   <td align=\"left\" style=\"font-size:12px\">$kode</td> 
							   <td align=\"left\" style=\"font-size:12px\">$nama</td> 
							   <td align=\"center\" style=\"font-size:12px\">$tahun</td> 
							   <td align=\"center\" style=\"font-size:12px\">$bln</td> 
							   <td align=\"center\" style=\"font-size:12px\">$keterangan</td> 
							   <td align=\"center\" style=\"font-size:12px\">$akhir</td> 
							   <td align=\"center\" style=\"font-size:12px\">$umur_piu</td> 
							   <td align=\"center\" style=\"font-size:12px\">$kualitas</td> 
							   <td align=\"center\" style=\"font-size:12px\">$taksiran</td> 
							   <td align=\"center\" style=\"font-size:12px\">$penyi_piu</td>
							   <td align=\"center\" style=\"font-size:12px\">$nilai_piu</td> 
							</tr>";    
                    }
				
				/* if($ctk==0){
 
         $data['prev']= $cRet;    
		 echo ("<title>Rincian Neraca $nama_rek</title>");
		 echo $cRet;}
		 else{

	    $this->_mpdf('',$cRet,10,10,10,0,1,'');
} */

		$data['prev']= $cRet;
		$judul  = "Laporan_Lampiran_Aset_Penyusutan_$skpd";
        $this->template->set('title', 'Rincian Neraca $nama_rek');        
        switch($ctk) {
		case 0;
              $data['prev']= $cRet;    
		 echo ("<title>UMUR PIUTANG</title>");
		 echo $cRet;
        break;
        case 1;
             $this->_mpdf('',$cRet,10,10,10,0,1,'');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
           $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        } 
		
		
	}
    
	
	
    function lampiran_V()
    {
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/perda_real_v', $data);
    }

    function cetak_perdaV_real($cetak = 1)
    {

        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc)
        {

            $tgl = $rowsc->tgl_rka;
            $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
            $kab = $rowsc->kab_kota;
            $daerah = $rowsc->daerah;
            $thn = $rowsc->thn_ang;
        }


        $cRet = '';
        if ($cetak <> 0)
        {
            $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN V  </h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5></strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"15%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"15%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
                    </tr>
                                         
                   
                  </table>";
        }
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>REALISASI BELANJA DAERAH UNTUK KESELARASAN DAN KETERPADUAN URUSAN PEMERINTAHAN DAERAH DAN FUNGSI DALAM KERANGKA PENGELOLAAN KEUANGAN NEGARA </strong></td>
                    </tr>
                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table>";

        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>KODE</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"39%\" align=\"center\"><b>URAIAN</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>JUMLAH SETELAH PERUBAHAN</b></td>
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>REALISASI</b></td>
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"19%\" align=\"center\"><b>LEBIH/(KURANG)</b></td>
                            </tr>
                        <tr>
 		                     <td width=\"16%\" bgcolor=\"#CCCCCC\" align=\"center\">JUMLAH</td>
                             <td width=\"3%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
                        </tr>    
                     </thead>
                    <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                     
                        <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"16%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"16%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"16%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\">&nbsp;</td>
                        </tr>
                        ";
        $sql1 = "SELECT * FROM (SELECT b.kd_fungsi AS kode, c.nm_fungsi AS nama,b.kd_fungsi AS kode1,'1' AS kode2,' 'AS skpd,
                        (SELECT SUM(a.anggaran) FROM realisasi a LEFT JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd WHERE LEFT(a.kd_rek5,1)='5' AND b.kd_fungsi=c.kd_fungsi)AS anggaran,
                        (SELECT SUM(a.real_spj) FROM realisasi a LEFT JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd WHERE LEFT(a.kd_rek5,1)='5' AND b.kd_fungsi=c.kd_fungsi)AS realisasi 
                        FROM trdrka a  INNER JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd LEFT JOIN ms_fungsi c ON b.kd_fungsi=c.kd_fungsi GROUP BY b.kd_fungsi,c.nm_fungsi,b.kd_fungsi
                        UNION
                        SELECT a.kd_skpd AS kode, b.nm_skpd AS nama,b.kd_fungsi AS kode1,'2' AS kode2,a.kd_skpd AS skpd,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,1)='5' AND kd_skpd=a.kd_skpd)AS anggaran,
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,1)='5' AND kd_skpd=a.kd_skpd)AS realisasi FROM trdrka a 
                        INNER JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd GROUP BY a.kd_skpd,b.nm_skpd,b.kd_fungsi
                        UNION	
                        SELECT DISTINCT '' AS kode, 'JUMLAH' AS nama,'99' AS kode1,'3' AS kode2,'' AS skpd,
                        (SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,1)='5') AS anggaran,                                          
                        (SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,1)='5' ) AS realisasi FROM trdrka) a ORDER BY kode1,a.kode2,skpd";

        $query = $this->db->query($sql1);
        //$query = $this->skpd_model->getAllc();

        foreach ($query->result() as $row)
        {
            $kode = $row->kode;
            $nama = $row->nama;
            $ang = number_format($row->anggaran, "2", ".", ",");
            $real = number_format($row->realisasi, "2", ".", ",");
            $rumus1 = $row->realisasi - $row->anggaran;
            if ($rumus1 < 0)
            {
                $x1 = "(";
                $rumus1 = $rumus1 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $total1 = number_format($rumus1, "2", ".", ",");
            $per1 = ($rumus1 != 0) ? ($rumus1 / $row->anggaran) * 100 : 0;
            $persen1 = number_format($per1, "2", ".", ",");

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"8%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\">$ang</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\">$real</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\">$x1$total1$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\">$persen1</td>
                                    </tr>
                                     ";


        }

        $cRet .= " </table>";
        $data['prev'] = $cRet;
        $judul = 'Laporan Realisasi APBD  Lamp V ';
        $this->template->set('title', 'CETAK PERDA REALISASI LAMPIRAN V');
        switch ($cetak)
        {
            case 1;
                $this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
                break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }

    }

    function jur_umum()
    {
        $data['page_title'] = 'JURNAL UMUM';
        $this->template->set('title', 'JURNAL UMUM');
        $this->template->load('template', 'akuntansi/jur_umum', $data);
    }
    function jur_umum_ppkd()
    {
        $data['page_title'] = 'JURNAL UMUM';
        $this->template->set('title', 'JURNAL UMUM');
        $this->template->load('template', 'akuntansi/jur_umum_ppkd', $data);
    }

    function ctk_jurum($dcetak = '', $dcetak2 = '', $skpd = '')
    {
        $csql11 = " select nm_skpd from ms_skpd where kd_skpd = '$skpd'";
        $rs1 = $this->db->query($csql11);
        $trh1 = $rs1->row();
        $lcskpd = strtoupper($trh1->nm_skpd);
        $tgl_cetak = $this->tukd_model->rev_date($dcetak);
        $tgl_cetak2 = $this->tukd_model->rev_date($dcetak2);


        $cRet = "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
            <tr>
                <td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;\">$lcskpd
                </td>
            </tr>
             <tr>
                <td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;\">JURNAL UMUM
                </td>
            </tr>
            <tr>
                <td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;border-bottom:solid 1px black;\">PERIODE $tgl_cetak S.D $tgl_cetak2
                </td>
            </tr>
            <tr>
                <td align=\"center\" rowspan=\"2\">Tanggal</td>
                <td align=\"center\" rowspan=\"2\">Nomor<br>Bukti</td>
                <td colspan=\"5\" align=\"center\" rowspan=\"2\">Kode<br>Rekening</td>
                <td align=\"center\" rowspan=\"2\">Uraian</td>
                <td align=\"center\" rowspan=\"2\">ref</td>
                <td align=\"center\" colspan=\"2\">Jumlah Rp</td>
            </tr>
            <tr>
                <td align=\"center\">Debit</td>
                <td align=\"center\">Kredit</td>
            </tr>
            <tr>
                <td align=\"center\" width=\"10%\">1</td>
                <td align=\"center\" width=\"10%\">2</td>
                <td colspan=\"5\" align=\"center\" width=\"15%\">3</td>
                <td align=\"center\" width=\"42%\">4</td>
                <td align=\"center\" width=\"3%\"></td>
                <td align=\"center\" width=\"10%\">5</td>
                <td align=\"center\" width=\"10%\">6</td>
            </tr>
           ";

        $csql1 = "select count(*) as tot FROM 
                 trdju_ppkd a LEFT JOIN trhju_pkd b ON a.no_voucher= b.no_voucher  AND b.kd_skpd=a.kd_unit
                 where b.tgl_voucher >= '$dcetak' and b.tgl_voucher <= '$dcetak2' and b.kd_skpd = '$skpd'";
        $rs = $this->db->query($csql1);
        $trh = $rs->row();


        $csql = "SELECT b.tgl_voucher,a.no_voucher,a.kd_rek5,a.nm_rek5 AS nm_rek5,a.debet,a.kredit FROM 
                  trdju_pkd a LEFT JOIN trhju_pkd b ON a.no_voucher= b.no_voucher AND b.kd_skpd=a.kd_unit
                  where b.tgl_voucher >= '$dcetak' and b.tgl_voucher <= '$dcetak2' and b.kd_skpd = '$skpd' 
                  ORDER BY b.tgl_voucher,a.no_voucher,a.urut,a.rk,a.kd_rek5";
        $query = $this->db->query($csql);
        $cnovoc = '';
        $lcno = 0;
        foreach ($query->result_array() as $res)
        {
            $lcno = $lcno + 1;
            if ($lcno == $trh->tot)
            {
                $cRet .= "<tr>
                                <td style=\"border-bottom:none;border-top:none;\"></td>
                                <td style=\"border-bottom:none;border-top:none;\"></td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    0, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    1, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    2, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    3, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    5, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . $res['nm_rek5'] .
                    "</td>
                                <td style=\"border-bottom:none;\"></td>";
                if ($res['debet'] == 0)
                {
                    $cRet .= " <td style=\"border-bottom:none;\"></td>
                                            <td style=\"border-bottom:none;\" align=\"right\">" .
                        number_format($res['kredit']) . "</td>";
                } else
                {
                    $cRet .= "<td style=\"border-bottom:none;\" align=\"right\">" . number_format($res['debet']) .
                        "</td>
                                               <td style=\"border-bottom:none;\"></td>";
                }

                $cRet .= "</tr>";
            } else
            {
                if ($cnovoc == $res['no_voucher'])
                {
                    $cRet .= "<tr>
                                <td style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                                <td style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        0, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        1, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        2, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        3, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        5, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . $res['nm_rek5'] .
                        "</td>
                                <td style=\"border-bottom:none;\"></td>";
                    if ($res['debet'] == 0)
                    {
                        $cRet .= " <td style=\"border-bottom:none;\"></td>
                                            <td style=\"border-bottom:none;\" align=\"right\">" .
                            number_format($res['kredit']) . "</td>";
                    } else
                    {
                        $cRet .= "<td style=\"border-bottom:none;\" align=\"right\">" . number_format($res['debet']) .
                            "</td>
                                               <td style=\"border-bottom:none;\"></td>";
                    }

                    $cRet .= "</tr>";
                } else
                {
                    $cRet .= "<tr>
                                <td style=\"border-bottom:none\">" . $this->
                        tukd_model->rev_date($res['tgl_voucher']) . "</td>
                                <td style=\"border-bottom:none\">" . $res['no_voucher'] .
                        "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        0, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        1, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        2, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        3, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        5, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . $res['nm_rek5'] .
                        "</td>
                                <td style=\"border-bottom:none;\"></td>";
                    if ($res['debet'] == 0)
                    {
                        $cRet .= " <td style=\"border-bottom:none;\"></td>
                                            <td style=\"border-bottom:none;\" align=\"right\">" .
                            number_format($res['kredit']) . "</td>";
                    } else
                    {
                        $cRet .= "<td style=\"border-bottom:none;\" align=\"right\">" . number_format($res['debet']) .
                            "</td>
                                               <td style=\"border-bottom:none;\"></td>";
                    }

                    $cRet .= "</tr>";
                }
                $cnovoc = $res['no_voucher'];
            }

        }

        $cRet .= " <tr>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                    </tr>  
         </table>
         ";

        $data['prev'] = 'JURNAL UMUM PPKD';
        echo $cRet;
		//$this->tukd_model->_mpdf('', $cRet, 5, 5, 10, '0');

    }


    function ctk_jurum_ppkd($dcetak = '', $dcetak2 = '', $skpd = '')
    {
        $csql11 = " select nm_skpd from ms_skpd where kd_skpd = '$skpd'";
        $rs1 = $this->db->query($csql11);
        $trh1 = $rs1->row();
        $lcskpd = strtoupper($trh1->nm_skpd);
        $tgl_cetak = $this->tukd_model->rev_date($dcetak);
        $tgl_cetak2 = $this->tukd_model->rev_date($dcetak2);


        $cRet = "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
            <tr>
                <td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;\">$lcskpd
                </td>
            </tr>
             <tr>
                <td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;\">JURNAL UMUM
                </td>
            </tr>
            <tr>
                <td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;border-bottom:solid 1px black;\">PERIODE $tgl_cetak S.D $tgl_cetak2
                </td>
            </tr>
            <tr>
                <td align=\"center\" rowspan=\"2\">Tanggal</td>
                <td align=\"center\" rowspan=\"2\">Nomor<br>Bukti</td>
                <td colspan=\"5\" align=\"center\" rowspan=\"2\">Kode<br>Rekening</td>
                <td align=\"center\" rowspan=\"2\">Uraian</td>
                <td align=\"center\" rowspan=\"2\">ref</td>
                <td align=\"center\" colspan=\"2\">Jumlah Rp</td>
            </tr>
            <tr>
                <td align=\"center\">Debit</td>
                <td align=\"center\">Kredit</td>
            </tr>
            <tr>
                <td align=\"center\" width=\"10%\">1</td>
                <td align=\"center\" width=\"10%\">2</td>
                <td colspan=\"5\" align=\"center\" width=\"15%\">3</td>
                <td align=\"center\" width=\"42%\">4</td>
                <td align=\"center\" width=\"3%\"></td>
                <td align=\"center\" width=\"10%\">5</td>
                <td align=\"center\" width=\"10%\">6</td>
            </tr>
           ";

        $csql1 = "select count(*) as tot FROM 
                 trdju_ppkd a LEFT JOIN trhju_pkd b ON a.no_voucher= b.no_voucher  AND b.kd_skpd=a.kd_unit
                 where b.tgl_voucher >= '$dcetak' and b.tgl_voucher <= '$dcetak2' and b.kd_skpd = '$skpd'";
        $rs = $this->db->query($csql1);
        $trh = $rs->row();


        $csql = "SELECT b.tgl_voucher,a.no_voucher,a.kd_rek5,a.nm_rek5 AS nm_rek5,a.debet,a.kredit FROM 
                  trdju_pkd a LEFT JOIN trhju_pkd b ON a.no_voucher= b.no_voucher AND b.kd_skpd=a.kd_unit
                  where b.tgl_voucher >= '$dcetak' and b.tgl_voucher <= '$dcetak2' and b.kd_skpd = '$skpd' 
                  ORDER BY b.tgl_voucher,a.no_voucher,a.urut,a.rk,a.kd_rek5";
        $query = $this->db->query($csql);
        $cnovoc = '';
        $lcno = 0;
        foreach ($query->result_array() as $res)
        {
            $lcno = $lcno + 1;
            if ($lcno == $trh->tot)
            {
                $cRet .= "<tr>
                                <td style=\"border-bottom:none;border-top:none;\"></td>
                                <td style=\"border-bottom:none;border-top:none;\"></td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    0, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    1, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    2, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    3, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    5, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . $res['nm_rek5'] .
                    "</td>
                                <td style=\"border-bottom:none;\"></td>";
                if ($res['debet'] == 0)
                {
                    $cRet .= " <td style=\"border-bottom:none;\"></td>
                                            <td style=\"border-bottom:none;\" align=\"right\">" .
                        number_format($res['kredit']) . "</td>";
                } else
                {
                    $cRet .= "<td style=\"border-bottom:none;\" align=\"right\">" . number_format($res['debet']) .
                        "</td>
                                               <td style=\"border-bottom:none;\"></td>";
                }

                $cRet .= "</tr>";
            } else
            {
                if ($cnovoc == $res['no_voucher'])
                {
                    $cRet .= "<tr>
                                <td style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                                <td style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        0, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        1, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        2, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        3, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        5, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . $res['nm_rek5'] .
                        "</td>
                                <td style=\"border-bottom:none;\"></td>";
                    if ($res['debet'] == 0)
                    {
                        $cRet .= " <td style=\"border-bottom:none;\"></td>
                                            <td style=\"border-bottom:none;\" align=\"right\">" .
                            number_format($res['kredit']) . "</td>";
                    } else
                    {
                        $cRet .= "<td style=\"border-bottom:none;\" align=\"right\">" . number_format($res['debet']) .
                            "</td>
                                               <td style=\"border-bottom:none;\"></td>";
                    }

                    $cRet .= "</tr>";
                } else
                {
                    $cRet .= "<tr>
                                <td style=\"border-bottom:none\">" . $this->
                        tukd_model->rev_date($res['tgl_voucher']) . "</td>
                                <td style=\"border-bottom:none\">" . $res['no_voucher'] .
                        "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        0, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        1, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        2, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        3, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        5, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . $res['nm_rek5'] .
                        "</td>
                                <td style=\"border-bottom:none;\"></td>";
                    if ($res['debet'] == 0)
                    {
                        $cRet .= " <td style=\"border-bottom:none;\"></td>
                                            <td style=\"border-bottom:none;\" align=\"right\">" .
                            number_format($res['kredit']) . "</td>";
                    } else
                    {
                        $cRet .= "<td style=\"border-bottom:none;\" align=\"right\">" . number_format($res['debet']) .
                            "</td>
                                               <td style=\"border-bottom:none;\"></td>";
                    }

                    $cRet .= "</tr>";
                }
                $cnovoc = $res['no_voucher'];
            }

        }

        $cRet .= " <tr>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                    </tr>  
         </table>
         ";

        $data['prev'] = 'JURNAL UMUM PPKD';
        echo $cRet;
		//$this->tukd_model->_mpdf('', $cRet, 5, 5, 10, '0');

    }


    //wahyu========================================================================
    function cetak_lak()
    {
        $data['page_title'] = 'LAPORAN ARUS KAS';
        $this->template->set('title', 'LAPORAN ARUS KAS');
        $this->template->load('template', 'akuntansi/cetak_lak', $data);
    }

    function rpt_lak($cbulan="", $cetak=1){
			$thi=$this->session->userdata('pcThang');
			$thl=$thi-1;
			$id=$this->session->userdata('kdskpd');
			
			if($cbulan== 12){
			$sumber_data= "_at";
			}else{
			$sumber_data= "";
			}
			
			if($cbulan== 12){
			$sumber_jurnal= "_calk";
			}else{
			$sumber_jurnal= "";
			}
			
			$sqlanggaran1="select case when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_ubah) then 2 
							   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_sempurna) and $cbulan<month(tgl_dpa_ubah) then 1
							   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan<month(tgl_dpa_sempurna) then 1
							   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan>=month(tgl_dpa_sempurna) then 1 
							   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan<month(tgl_dpa_sempurna) then 1
							   when statu=1 and status_sempurna=0 and status_ubah=0 and $cbulan>=month(tgl_dpa) then 1
							   else 1 end as anggaran from trhrka where kd_skpd='$id'";
			$sqlanggaran=$this->db->query($sqlanggaran1);
			foreach ($sqlanggaran->result() as $rowttd)
				{
					$anggaran=$rowttd->anggaran;
				}

			$ag_tox=$anggaran;
			$bulan=$cbulan;
			$idx=0;
			
			
			$modtahun= $thi%4;
	 
			 if ($modtahun = 0){
				$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
					else {
				$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
			 
			 $arraybulan=explode(".",$nilaibulan);
			
			$cRet='';
			$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>LAPORAN ARUS KAS</strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan] $thi</strong></td>
                    </tr>
					<tr>
                         <td align=\"center\"><strong>METODE LANGSUNG</strong></td>
                    </tr>
					<tr>
                         <td align=\"center\"><strong>&nbsp;</strong></td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thi</b></td>  
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thl</b></td>  
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                          
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                        </tr>";

			
			//level 1
			
			$sql31="SELECT isnull(kode_1,'999') kode_1, isnull(kode_2,'999') kode_2 , isnull(kode_3,'999') kode_3, isnull(kode_5,'999') kode_5 from map_lak_prov where seq='85'";
					
                    $query31 = $this->db->query($sql31);
                    $jmlp = $query31->row();
                    $kode_1_85 = $jmlp->kode_1;	
                    $kode_2_85 = $jmlp->kode_2;	
                    $kode_3_85 = $jmlp->kode_3;
					$kode_5_85 = $jmlp->kode_5;	
			
			$sql41="SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thi) b 
					WHERE (left(b.kd_rek5,3) in ($kode_1_85) 
					or left(b.kd_rek5,5) in ($kode_2_85) 
					or left(b.kd_rek5,7) in ($kode_3_85))";
					
                    $query41 = $this->db->query($sql41);
                    $jmlp = $query41->row();
                    $operasi_masuk = $jmlp->nilai;					
			
			$sql32="SELECT isnull(kode_1,'999') kode_1, isnull(kode_2,'999') kode_2 , isnull(kode_3,'999') kode_3, isnull(kode_5,'999') kode_5 from map_lak_prov where seq='150'";
					
                    $query32 = $this->db->query($sql32);
                    $jmlp = $query32->row();
                    $kode_1_150 = $jmlp->kode_1;	
                    $kode_2_150 = $jmlp->kode_2;	
                    $kode_3_150 = $jmlp->kode_3;
					$kode_5_150 = $jmlp->kode_5;
					
			$sql42="SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thi) b 
					WHERE (left(b.kd_rek5,3) in ($kode_1_150) 
					or left(b.kd_rek5,5) in ($kode_2_150) 
					or left(b.kd_rek5,7) in ($kode_3_150))";
					
                    $query42 = $this->db->query($sql42);
                    $jmlp2 = $query42->row();
                    $operasi_keluar = $jmlp2->nilai;					
					
					$operasi_bersih = $operasi_masuk - $operasi_keluar;
			
			$sql33="SELECT isnull(kode_1,'999') kode_1, isnull(kode_2,'999') kode_2 , isnull(kode_3,'999') kode_3, isnull(kode_5,'999') kode_5 from map_lak_prov where seq='215'";
					
                    $query33 = $this->db->query($sql33);
                    $jmlp = $query33->row();
                    $kode_1_215 = $jmlp->kode_1;	
                    $kode_2_215 = $jmlp->kode_2;	
                    $kode_3_215 = $jmlp->kode_3;
					$kode_5_215 = $jmlp->kode_5;
					
			$sql43="SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thi) b 
					WHERE (left(b.kd_rek5,3) in ($kode_1_215) 
					or left(b.kd_rek5,5) in ($kode_2_215) 
					or left(b.kd_rek5,7) in ($kode_3_215))";
					
                    $query43 = $this->db->query($sql43);
                    $jmlp3 = $query43->row();
                    $investasi_masuk = $jmlp3->nilai;										

					
			$sql34="SELECT isnull(kode_1,'999') kode_1, isnull(kode_2,'999') kode_2 , isnull(kode_3,'999') kode_3, isnull(kode_5,'999') kode_5 from map_lak_prov where seq='270'";
					
                    $query34 = $this->db->query($sql34);
                    $jmlp = $query34->row();
                    $kode_1_270 = $jmlp->kode_1;	
                    $kode_2_270 = $jmlp->kode_2;	
                    $kode_3_270 = $jmlp->kode_3;		
					$kode_5_270 = $jmlp->kode_5;
					
			$sql44="SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thi) b 
					WHERE (left(b.kd_rek5,3) in ($kode_1_270) 
					or left(b.kd_rek5,5) in ($kode_2_270) 
					or left(b.kd_rek5,7) in ($kode_3_270))";
					
                    $query44 = $this->db->query($sql44);
                    $jmlp4 = $query44->row();			
                    $investasi_keluar = $jmlp4->nilai;
					
					$investasi_bersih = $investasi_masuk - $investasi_keluar;

					
			$sql35="SELECT isnull(kode_1,'999') kode_1, isnull(kode_2,'999') kode_2 , isnull(kode_3,'999') kode_3, isnull(kode_5,'999') kode_5 from map_lak_prov where seq='335'";
					
                    $query35 = $this->db->query($sql35);
                    $jmlp = $query35->row();
                    $kode_1_335 = $jmlp->kode_1;	
                    $kode_2_335 = $jmlp->kode_2;	
                    $kode_3_335 = $jmlp->kode_3;		
					$kode_5_335 = $jmlp->kode_5;
					
			$sql45="SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thi) b 
					WHERE (left(b.kd_rek5,3) in ($kode_1_335) 
					or left(b.kd_rek5,5) in ($kode_2_335) 
					or left(b.kd_rek5,7) in ($kode_3_335))";
					
                    $query45 = $this->db->query($sql45);
                    $jmlp5 = $query45->row();			
                    $pendanaan_masuk = $jmlp5->nilai;
			

			$sql36="SELECT isnull(kode_1,'999') kode_1, isnull(kode_2,'999') kode_2 , isnull(kode_3,'999') kode_3, isnull(kode_5,'999') kode_5 from map_lak_prov where seq='390'";
					
                    $query36 = $this->db->query($sql36);
                    $jmlp = $query36->row();
                    $kode_1_390 = $jmlp->kode_1;	
                    $kode_2_390 = $jmlp->kode_2;	
                    $kode_3_390 = $jmlp->kode_3;
					$kode_5_390 = $jmlp->kode_5;
					
			$sql46="SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thi) b 
					WHERE (left(b.kd_rek5,3) in ($kode_1_390) 
					or left(b.kd_rek5,5) in ($kode_2_390) 
					or left(b.kd_rek5,7) in ($kode_3_390))";
					
                    $query46 = $this->db->query($sql46);
                    $jmlp6 = $query46->row();				
                    $pendanaan_keluar = $jmlp6->nilai;
					
					$pendanaan_bersih = $pendanaan_masuk - $pendanaan_keluar;
	
			$sql47="select sum(nilai) nilai from (
					select sum(a.nilai) nilai from trdtrmpot a inner join trhtrmpot b on a.no_bukti=b.no_bukti and 
					a.kd_skpd=b.kd_skpd where a.kd_skpd<>'' and b.jns_spp in ('1','2','3','4','5','6') and left(a.kd_rek5,3) in ('211','213') and year(b.tgl_bukti)=$thi and month(b.tgl_bukti)<=$bulan
					UNION ALL
					select sum(kredit) nilai from trdju$sumber_jurnal  a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_skpd<>'' and a.kd_rek5 IN ('2110307','2110402') and year(tgl_voucher)='$thi' and month(tgl_voucher)<='$bulan'
					) a";
					
			/*$sql47="select sum(a.nilai) nilai from trdtrmpot a inner join trhtrmpot b on a.no_bukti=b.no_bukti and 
					a.kd_skpd=b.kd_skpd where a.kd_skpd<>'' and b.jns_spp in ('1','2','3','4','5','6') and left(a.kd_rek5,3) in ('211','213') and year(b.tgl_bukti)=$thi and month(b.tgl_bukti)<=$bulan
					";*/
					
                    $query47 = $this->db->query($sql47);
                    $jmlp7 = $query47->row();
                    $pfk_masuk = $jmlp7->nilai;
			
			$sql48="select sum(nilai) nilai from (
					select sum(a.nilai) nilai from trdstrpot a inner join trhstrpot b on a.no_bukti=b.no_bukti and 
					a.kd_skpd=b.kd_skpd where a.kd_skpd<>'' and b.jns_spp in ('1','2','3','4','5','6') and left(a.kd_rek5,3) in ('211','213') and year(b.tgl_bukti)=$thi and month(b.tgl_bukti)<=$bulan
					UNION ALL
					select sum(debet) nilai from trdju$sumber_jurnal  a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_skpd<>'' and a.kd_rek5 IN ('2110307','2110402') and year(tgl_voucher)='$thi' and month(tgl_voucher)<='$bulan'
					UNION ALL
					select sum(kredit-debet) nilai from trdju$sumber_jurnal  a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_skpd<>'' and left(a.kd_rek5,3) IN ('211','213') and year(tgl_voucher)<'$thi'
					) a";
			
			/*$sql48="select sum(a.nilai) nilai from trdstrpot a inner join trhstrpot b on a.no_bukti=b.no_bukti and 
					a.kd_skpd=b.kd_skpd where a.kd_skpd<>'' and b.jns_spp in ('1','2','3','4','5','6') and left(a.kd_rek5,3) in ('211','213') and year(b.tgl_bukti)=$thi and month(b.tgl_bukti)<=$bulan
					";*/
				
                    $query48 = $this->db->query($sql48);
                    $jmlp8 = $query48->row();
                    $pfk_keluar = $jmlp8->nilai;			
					
					$pfk_bersih = $pfk_masuk - $pfk_keluar;
					
					$naik_turun_kas = $operasi_bersih + $investasi_bersih + $pendanaan_bersih + $pfk_bersih;
					// Tahun 2018 dan selanjutnya jangan ditambah 6697526
			$sql49="SELECT sum(a.kredit-a.debet)+6697526 as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where LEFT(a.kd_rek5,5) in (71101) and year(b.tgl_voucher)=$thi and month(b.tgl_voucher)<=$bulan";
					
                    $query49 = $this->db->query($sql49);
                    $jmlp9 = $query49->row();
                    $kas_awal = $jmlp9->nilai;			
					
			$sql50="SELECT sum(a.debet-a.kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where a.kd_rek5=1110201 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thi$bulan'";
					
                    $query50 = $this->db->query($sql50);
                    $jmlp10 = $query50->row();
                    $kas_penerimaan = $jmlp10->nilai;			
			
			$sql51="SELECT SUM(ISNULL(nilai,0)) nilai FROM (
					SELECT sum(a.debet-a.kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where a.kd_rek5 in (1110301,1110101) and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thi$bulan'
					UNION ALL
					SELECT sum(nilai*-1) as nilai from penerimaan_non_sp2d where left(CONVERT(char(15),tanggal, 112),6)<='$thi$bulan'
					UNION ALL
					SELECT sum(nilai) as nilai from pengeluaran_non_sp2d where left(CONVERT(char(15),tanggal, 112),6)<='$thi$bulan'
					) a ";
					
                    $query51 = $this->db->query($sql51);
                    $jmlp11 = $query51->row();
                    $kas_akhir	 = $jmlp11->nilai;
			
			$sql52="SELECT sum(a.debet-a.kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where a.kd_rek5 in (1110401) and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thi$bulan'";
					
                    $query52 = $this->db->query($sql52);
                    $jmlp12 = $query52->row();
                    $kas_blud	 = $jmlp12->nilai;
			
			$sql53="SELECT sum(a.debet-a.kredit) as nilai from trdju$sumber_jurnal a inner join trhju$sumber_jurnal b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where a.kd_rek5 in (1110501) and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thi$bulan'";
					
                    $query53 = $this->db->query($sql53);
                    $jmlp13 = $query53->row();
                    $kas_lain	 = $jmlp13->nilai;
					//$kas_akhir = $kas_awal + $naik_turun_kas;
					
					//$total_kas = $kas_akhir + $kas_penerimaan;
					$total_kas = $kas_akhir + $kas_penerimaan + $kas_blud + $kas_lain;
					
					
			$parent='0';
			$no=0;
			$query = $this->db->query(" SELECT a.seq,a.nor,a.uraian,isnull(a.kode_1,'888') as kode_1,isnull(a.kode_2,'888') as kode_2,
										isnull(a.kode_3,'8888') as kode_3, thn_m1 FROM map_lak_prov a ORDER BY a.seq ");  
			foreach($query->result_array() as $res){

				$idx++;				
				$nor=$res['nor'];
				$uraian=$res['uraian'];
				$seq=$res['seq'];

				$rek1=trim($res['kode_1']);
				$rek2=trim($res['kode_2']);
				$rek3=trim($res['kode_3']);
				$saldo=$res['thn_m1'];
				
				if($rek1==''){
					$rek1="'XXX'";
				}
				if($rek2==''){
					$rek2="'XXXXX'";
				}
				if($rek3==''){
					$rek3="'XXXXXXX'";
				}
				
				$q = $this->db->query(" SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n_pemda$sumber_data($bulan,$ag_tox,$thi) b 
										WHERE (left(b.kd_rek5,3) in ($rek1) or left(b.kd_rek5,5) in ($rek2) or left(b.kd_rek5,7) in ($rek3))");  

				 foreach($q->result_array() as $r){
					$nilai=$r['nilai'];
				 }

				$nilai1=number_format($nilai,"2",",",".");

                    if ($operasi_bersih < 0){
                    	$x001="("; $operasi_bersih0=$operasi_bersih*-1; $y001=")";}
                    else {
                    	$x001=""; $operasi_bersih0=$operasi_bersih; $y001="";}
				$operasi_bersih1=number_format($operasi_bersih0,"2",",",".");
				
                    if ($investasi_bersih < 0){
                    	$x002="("; $investasi_bersih0=$investasi_bersih*-1; $y002=")";}
                    else {
                    	$x002=""; $investasi_bersih0=$investasi_bersih; $y002="";}
						
				$investasi_bersih1=number_format($investasi_bersih0,"2",",",".");
					
					if ($pendanaan_bersih < 0){
                    	$x003="("; $pendanaan_bersih0=$pendanaan_bersih*-1; $y003=")";}
                    else {
                    	$x003=""; $pendanaan_bersih0=$pendanaan_bersih; $y003="";}
				$pendanaan_bersih1=number_format($pendanaan_bersih0,"2",",",".");

					if ($pfk_keluar < 0){
                    	$x004="("; $pfk_keluar0=$pfk_keluar*-1; $y004=")";}
                    else {
                    	$x004=""; $pfk_keluar0=$pfk_keluar; $y004="";}
				$pfk_keluar1=number_format($pfk_keluar0,"2",",",".");

					if ($pfk_masuk < 0){
                    	$x005="("; $pfk_masuk0=$pfk_masuk*-1; $y005=")";}
                    else {
                    	$x005=""; $pfk_masuk0=$pfk_masuk; $y005="";}
				$pfk_masuk1=number_format($pfk_masuk0,"2",",",".");
				
					if ($pfk_bersih < 0){
                    	$x006="("; $pfk_bersih0=$pfk_bersih*-1; $y006=")";}
                    else {
                    	$x006=""; $pfk_bersih0=$pfk_bersih; $y006="";}
				$pfk_bersih1=number_format($pfk_bersih0,"2",",",".");

					if ($naik_turun_kas < 0){
                    	$x007="("; $naik_turun_kas0=$naik_turun_kas*-1; $y007=")";}
                    else {
                    	$x007=""; $naik_turun_kas0=$naik_turun_kas; $y007="";}
				$naik_turun_kas1=number_format($naik_turun_kas0,"2",",",".");	

					if ($kas_awal < 0){
                    	$x008="("; $kas_awal0=$kas_awal*-1; $y008=")";}
                    else {
                    	$x008=""; $kas_awal0=$kas_awal; $y008="";}
				$kas_awal1=number_format($kas_awal0,"2",",",".");	
				
					if ($kas_akhir < 0){
                    	$x009="("; $kas_akhir0=$kas_akhir*-1; $y009=")";}
                    else {
                    	$x009=""; $kas_akhir0=$kas_akhir; $y009="";}
				$kas_akhir1=number_format($kas_akhir0,"2",",",".");

					if ($kas_penerimaan < 0){
                    	$x010="("; $kas_penerimaan0=$kas_penerimaan*-1; $y010=")";}
                    else {
                    	$x010=""; $kas_penerimaan0=$kas_penerimaan; $y010="";}
				$kas_penerimaan1=number_format($kas_penerimaan0,"2",",",".");
								
				
					if ($total_kas < 0){
                    	$x011="("; $total_kas0=$total_kas*-1; $y011=")";}
                    else {
                    	$x011=""; $total_kas0=$total_kas; $y011="";}
				$total_kas1=number_format($total_kas0,"2",",",".");
				
					if ($saldo < 0){
                    	$xx="("; $saldo=$saldo*-1; $yy=")";}
                    else {
                    	$xx=""; $saldo=$saldo; $yy="";}
				$saldo1=number_format($saldo,"2",",",".");
				
				if ($kas_blud < 0){
                    	$x012="("; $kas_blud0=$kas_blud*-1; $y012=")";}
                    else {
                    	$x012=""; $kas_blud0=$kas_blud; $y012="";}
				$kas_blud1=number_format($kas_blud0,"2",",",".");
				
					if ($kas_lain < 0){
                    	$x013="("; $kas_lain0=$kas_lain*-1; $y013=")";}
                    else {
                    	$x013=""; $kas_lain0=$kas_lain; $y013="";}
				$kas_lain1=number_format($kas_lain0,"2",",",".");
				
				
				$no=$no+1;
				 
				switch ($res['seq']) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 85:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 90:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 150:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 155:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x001$operasi_bersih1$y001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 160:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 165:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 215:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 220:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 270:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 275:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x002$investasi_bersih1$y002</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 280:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 285:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 335:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 340:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 390:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 395:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x003$pendanaan_bersih1$y003</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 400:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 405:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 410:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x005$pfk_masuk1$y005</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 415:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x005$pfk_masuk1$y005</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 420:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 425:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x004$pfk_keluar1$y004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
					case 430:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x004$pfk_keluar1$y004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 435:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x006$pfk_bersih1$y006</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 440:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x007$naik_turun_kas1$y007</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
                    case 445:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x008$kas_awal1$y008</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;						
                    case 450:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x009$kas_akhir1$y009</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
					case 451:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x013$kas_lain1$y013</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;			
                    case 455:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x010$kas_penerimaan1$y010</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
					case 456:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x012$kas_blud1$y012</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;			
                    case 460: 	
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x011$total_kas1$y011</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;												
					default:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\"align=\"center\">$no</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"65%\">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nilai1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$xx$saldo1$yy</td>
                                 </tr>";
                        break;
				}
			}

			
			$cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAK $cbulan");
        $this->template->set('title', 'LAK $cbulan');        
        switch($cetak) {       
        case 1;
			echo ("<title>LAK $cbulan</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }
	}

	
	
	
	
	
    function cetak_neraca(){
        $data['page_title']= 'LAPORAN NERACA SKPD';
        $this->template->set('title', 'LAPORAN NERACA SKPD');   
        $this->template->load('template','akuntansi/cetak_neraca',$data) ; 
    }
    
	function cetak_neraca_pemda()
    {
        $data['page_title'] = 'LAPORAN NERACA KONSOLIDASI';
        $this->template->set('title', 'LAPORAN NERACA KONSOLIDASI');
        $this->template->load('template', 'akuntansi/cetak_neraca_pemda', $data);
    }

    function cetak_neraca_ppkd()
    {
        $data['page_title'] = 'LAPORAN NERACA PPKD';
        $this->template->set('title', 'LAPORAN NERACA PPKD');
        $this->template->load('template', 'akuntansi/cetak_neraca_ppkd', $data);
    }

	
	function rpt_neraca_pemda_unit($cbulan="", $kd_skpd="", $cetak=1){
		//$bulan	 = $_REQUEST['tgl1'];
			$id   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			$bulan	 = $cbulan;
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;

			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
	$modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
			
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>$nm_skpd</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>NERACA</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER $arraybulan[$bulan] $thn_ang DAN $thn_ang_1 </strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0 and kd_skpd='$kd_skpd'");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1, isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$sqlskpd_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd_lalu  =$row->thn_m1;
					}
			
			$sqllcr_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx_lalu  =$row->thn_m1;
					}
					
			$sqlast_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx_lalu  =$row->thn_m1;
					}
			
			$lcr_lalu		= $lcrx_lalu-$rk_skpd_lalu;
			$ast_lalu		= $astx_lalu-$rk_skpd_lalu;			
			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu-$rk_skpd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu-$rk_skpd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
			
			$sqlskpd = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd  =$row->thn_m1;
					}

			$sqllcr = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx =$row->thn_m1;
					}
					
			$sqlast = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx  =$row->thn_m1;
					}		
			
			$lcr		= $lcrx-$rk_skpd;
			$ast		= $astx-$rk_skpd;
			$eku 		= $sal_akhir + $rk_ppkd-$rk_skpd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd-$rk_skpd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
		if ($lcr < 0){
                    	$min015="("; $lcr=$lcr*-1; $min016=")";
                        }else {
                    	$min015=""; $lcr; $min016="";
                        }			

		$lcr1=number_format($lcr,"2",",",".");
		
		if ($lcr_lalu < 0){
                    	$min017="("; $lcr_lalu=$lcr_lalu*-1; $min018=")";
                        }else {
                    	$min017=""; $lcr_lalu; $min018="";
                        }			
		
		$lcr_lalu1=number_format($lcr_lalu,"2",",",".");
		
		if ($ast < 0){
                    	$min019="("; $ast=$ast*-1; $min020=")";
                        }else {
                    	$min019=""; $ast; $min020="";
                        }			

		$ast1=number_format($ast,"2",",",".");
		
		if ($ast_lalu < 0){
                    	$min021="("; $ast_lalu=$ast_lalu*-1; $min022=")";
                        }else {
                    	$min021=""; $ast_lalu; $min022="";
                        }			
		
		$ast_lalu1=number_format($ast_lalu,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal==1){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal==1){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['seq']) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 15:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 20:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;						
					case 100:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$min015$lcr1$min016</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$min017$lcr_lalu1$min018</td>
                                 </tr>";
                        break;
					case 105:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 145:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 170:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 175:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 220:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 225:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 240:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 245:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 280:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 285:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$min019$ast1$min020</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$min021$ast_lalu1$min022</td>
                                 </tr>";
                        break;		
					case 290:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 295:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 300:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 305:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 345:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 350:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 385:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 390:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 395:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min003$eku1$min004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;		
					case 400:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min007$eku_tang1$min008</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;
						default:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					}
 
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA KONSOL UNIT $cbulan");
        $this->template->set('title', 'NERACA KONSOL UNIT $cbulan');  
         switch ($cetak)
        {
            case 0;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
				break;
            case 1;
				echo "<title>NERACA KONSOL UNIT $cbulan</title>";
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}
	
	function rpt_neraca_awal_pemda_unit_obyek($cbulan="", $kd_skpd="", $cetak=1){
		//$bulan	 = $_REQUEST['tgl1'];
			$id   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			$bulan	 = $cbulan;
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;

			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
	$modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
			
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>$nm_skpd</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>NERACA AWAL</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER 1 JANUARI $thn_ang</strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td colspan =\"7\"bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>JUMLAH</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td colspan =\"7\"style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td colspan =\"7\"style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0 and kd_skpd='$kd_skpd'");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$sqlskpd_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd_lalu  =$row->thn_m1;
					}
			
			$sqllcr_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx_lalu  =$row->thn_m1;
					}
					
			$sqlast_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx_lalu  =$row->thn_m1;
					}
			
			$lcr_lalu		= $lcrx_lalu-$rk_skpd_lalu;
			$ast_lalu		= $astx_lalu-$rk_skpd_lalu;			
			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
			
			$sqlskpd = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd  =$row->thn_m1;
					}

			$sqllcr = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx =$row->thn_m1;
					}
					
			$sqlast = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx  =$row->thn_m1;
					}		
			
			$lcr		= $lcrx-$rk_skpd;
			$ast		= $astx-$rk_skpd;
			$eku 		= $sal_akhir + $rk_ppkd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
		if ($lcr < 0){
                    	$min015="("; $lcr=$lcr*-1; $min016=")";
                        }else {
                    	$min015=""; $lcr; $min016="";
                        }			

		$lcr1=number_format($lcr,"2",",",".");
		
		if ($lcr_lalu < 0){
                    	$min017="("; $lcr_lalu=$lcr_lalu*-1; $min018=")";
                        }else {
                    	$min017=""; $lcr_lalu; $min018="";
                        }			
		
		$lcr_lalu1=number_format($lcr_lalu,"2",",",".");
		
		if ($ast < 0){
                    	$min019="("; $ast=$ast*-1; $min020=")";
                        }else {
                    	$min019=""; $ast; $min020="";
                        }			

		$ast1=number_format($ast,"2",",",".");
		
		if ($ast_lalu < 0){
                    	$min021="("; $ast_lalu=$ast_lalu*-1; $min022=")";
                        }else {
                    	$min021=""; $ast_lalu; $min022="";
                        }			
		
		$ast_lalu1=number_format($ast_lalu,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, bold, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_obyek ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				$bold=$res['bold'];
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal==1){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal==1){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['bold']) {
                    case 1:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"7\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 2:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 3:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 4:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 14:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 34:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 15:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 6:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 16:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 7:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 17:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
					    break;
					case 11:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>
                                 </tr>";
                        break;		
					case 12:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 13:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;
					}
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA AWAL KONSOL OBYEK UNIT $cbulan");
        $this->template->set('title', 'NERACA AWAL KONSOL OBYEK UNIT $cbulan');  
         switch ($cetak)
        {
            case 0;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
				break;
            case 1;
				echo "<title>NERACA AWAL KONSOL OBYEK UNIT $cbulan</title>";
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}	
	
	
	
	function rpt_neraca_pemda_unit_obyek($cbulan="", $kd_skpd="", $cetak=1){
		//$bulan	 = $_REQUEST['tgl1'];
			$id   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			$bulan	 = $cbulan;
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;

			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
	$modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
			
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>$nm_skpd</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>NERACA</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER $arraybulan[$bulan] $thn_ang DAN $thn_ang_1 </strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td colspan =\"7\"bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td colspan =\"7\"style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td colspan =\"7\"style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju a INNER JOIN trhju b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0 and kd_skpd='$kd_skpd'");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$sqlskpd_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd_lalu  =$row->thn_m1;
					}
			
			$sqllcr_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx_lalu  =$row->thn_m1;
					}
					
			$sqlast_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx_lalu  =$row->thn_m1;
					}
			
			$lcr_lalu		= $lcrx_lalu-$rk_skpd_lalu;
			$ast_lalu		= $astx_lalu-$rk_skpd_lalu;			
			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
			
			$sqlskpd = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd  =$row->thn_m1;
					}

			$sqllcr = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx =$row->thn_m1;
					}
					
			$sqlast = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx  =$row->thn_m1;
					}		
			
			$lcr		= $lcrx-$rk_skpd;
			$ast		= $astx-$rk_skpd;
			$eku 		= $sal_akhir + $rk_ppkd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;					

					if ($sal_akhir >= 0)
					{
						$c = ""; $sal_akhir; $d = "";
					} else
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal >= 0)
					{
						$c1 = ""; $sal_awal; $d1 = "";
					} else
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu >= 0){
						$min001=""; $eku_lalu; $min002="";
						}else {
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku >= 0){
                    	$min003=""; $eku; $min004="";
						}else {
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu >= 0){
                    	$min005=""; $eku_tang_lalu; $min006="";
						}else {
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";

                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang >= 0){
                    	$min007=""; $eku_tang; $min008="";
						}else {
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu >= 0){
                    	$min009=""; $rk_ppkd_lalu; $min010="";
						}else {
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd >= 0){
                    	$min013=""; $rk_ppkd; $min014="";
						}else {
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
		if ($lcr >= 0){
                    	$min015=""; $lcr; $min016="";
						}else {
                    	$min015="("; $lcr=$lcr*-1; $min016=")";
                        }			

		$lcr1=number_format($lcr,"2",",",".");
		
		if ($lcr_lalu >= 0){
                    	$min017=""; $lcr_lalu; $min018="";
						}else {
                    	$min017="("; $lcr_lalu=$lcr_lalu*-1; $min018=")";
                        }			
		
		$lcr_lalu1=number_format($lcr_lalu,"2",",",".");
		
		if ($ast >= 0){
                    	$min019=""; $ast; $min020="";
						}else {
                    	$min019="("; $ast=$ast*-1; $min020=")";
                        }			

		$ast1=number_format($ast,"2",",",".");
		
		if ($ast_lalu >= 0){
                    	$min021=""; $ast_lalu; $min022="";
						}else {
                    	$min021="("; $ast_lalu=$ast_lalu*-1; $min022=")";
                        }			
		
		$ast_lalu1=number_format($ast_lalu,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, bold, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_obyek ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				$bold=$res['bold'];
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal==1){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal==1){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['bold']) {
                    case 1:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"7\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 2:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 3:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 4:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 14:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 34:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 15:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 6:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 16:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 7:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 17:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
					    break;
					case 11:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c$sal_akhir1$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>
                                 </tr>";
                        break;		
					case 12:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min003$eku1$min004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 13:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min007$eku_tang1$min008</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;
					}
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA KONSOL OBYEK UNIT $cbulan");
        $this->template->set('title', 'NERACA KONSOL OBYEK UNIT $cbulan');  
         switch ($cetak)
        {
            case 0;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
				break;
            case 1;
				echo "<title>NERACA KONSOL OBYEK UNIT $cbulan</title>";
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}	
	
	function rpt_neraca_awal_pemda_unit($cbulan="", $kd_skpd="", $cetak=1){
		//$bulan	 = $_REQUEST['tgl1'];
			$id   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			$bulan	 = $cbulan;
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;

			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
	$modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
			
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>$nm_skpd</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>NERACA AWAL</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER 1 JANUARI $thn_ang</strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>JUMLAH</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0 and kd_skpd='$kd_skpd'");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$sqlskpd_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd_lalu  =$row->thn_m1;
					}
			
			$sqllcr_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx_lalu  =$row->thn_m1;
					}
					
			$sqlast_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx_lalu  =$row->thn_m1;
					}
			
			$lcr_lalu		= $lcrx_lalu-$rk_skpd_lalu;
			$ast_lalu		= $astx_lalu-$rk_skpd_lalu;			
			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu-$rk_skpd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu-$rk_skpd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
			
			$sqlskpd = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd  =$row->thn_m1;
					}

			$sqllcr = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx =$row->thn_m1;
					}
					
			$sqlast = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx  =$row->thn_m1;
					}		
			
			$lcr		= $lcrx-$rk_skpd;
			$ast		= $astx-$rk_skpd;
			$eku 		= $sal_akhir + $rk_ppkd-$rk_skpd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd-$rk_skpd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
		if ($lcr < 0){
                    	$min015="("; $lcr=$lcr*-1; $min016=")";
                        }else {
                    	$min015=""; $lcr; $min016="";
                        }			

		$lcr1=number_format($lcr,"2",",",".");
		
		if ($lcr_lalu < 0){
                    	$min017="("; $lcr_lalu=$lcr_lalu*-1; $min018=")";
                        }else {
                    	$min017=""; $lcr_lalu; $min018="";
                        }			
		
		$lcr_lalu1=number_format($lcr_lalu,"2",",",".");
		
		if ($ast < 0){
                    	$min019="("; $ast=$ast*-1; $min020=")";
                        }else {
                    	$min019=""; $ast; $min020="";
                        }			

		$ast1=number_format($ast,"2",",",".");
		
		if ($ast_lalu < 0){
                    	$min021="("; $ast_lalu=$ast_lalu*-1; $min022=")";
                        }else {
                    	$min021=""; $ast_lalu; $min022="";
                        }			
		
		$ast_lalu1=number_format($ast_lalu,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal==1){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and kd_skpd='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal==1){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['seq']) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 15:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 20:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;						
					case 100:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$min017$lcr_lalu1$min018</td>
                                 </tr>";
                        break;
					case 105:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 145:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 170:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 175:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 220:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 225:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 240:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 245:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 280:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 285:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$min021$ast_lalu1$min022</td>
                                 </tr>";
                        break;		
					case 290:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 295:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 300:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 305:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 345:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 350:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 385:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 390:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 395:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;		
					case 400:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;
						default:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					}
 
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA AWAL KONSOL UNIT");
        $this->template->set('title', 'NERACA AWAL KONSOL UNIT');  
         switch ($cetak)
        {
            case 0;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
				break;
            case 1;
				echo "<title>NERACA KONSOL UNIT</title>";
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}

	function rpt_neraca_awal_pemda_obyek($cbulan="", $cetak=1){
		//$bulan	 = $_REQUEST['tgl1'];
			$kd_skpd   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			$bulan	 = $cbulan;
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;

			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
	$modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
			
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA AWAL</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER 1 JANUARI $thn_ang</strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td colspan =\"7\"bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>JUMLAH</b></td>
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td colspan =\"7\"style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td colspan =\"7\"style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8')";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9')";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju a INNER JOIN trhju b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8')";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8')";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9')";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9')";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$sqlskpd_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd_lalu  =$row->thn_m1;
					}
			
			$sqllcr_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx_lalu  =$row->thn_m1;
					}
					
			$sqlast_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx_lalu  =$row->thn_m1;
					}
			
			$lcr_lalu		= $lcrx_lalu-$rk_skpd_lalu;
			$ast_lalu		= $astx_lalu-$rk_skpd_lalu;			
			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu-$rk_skpd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu-$rk_skpd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
			
			$sqlskpd = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd  =$row->thn_m1;
					}

			$sqllcr = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx =$row->thn_m1;
					}
					
			$sqlast = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx  =$row->thn_m1;
					}		
			
			$lcr			= $lcrx-$rk_skpd;
			$ast			= $astx-$rk_skpd;
			$eku 			= $sal_akhir - $rk_ppkd + $rk_skpd;					
			$eku_tang 		= $sal_akhir + $nilaiutang - $rk_ppkd +$rk_skpd;					
			$rk_skpd		= $rk_skpd-$rk_ppkd;
			$rk_skpd_lalu	= $rk_skpd_lalu-$rk_ppkd_lalu;
			$rk_ppkd		= $rk_skpd;
			$rk_ppkd_lalu	= $rk_skpd_lalu;
			
					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
		if ($lcr < 0){
                    	$min015="("; $lcr=$lcr*-1; $min016=")";
                        }else {
                    	$min015=""; $lcr; $min016="";
                        }			

		$lcr1=number_format($lcr,"2",",",".");
		
		if ($lcr_lalu < 0){
                    	$min017="("; $lcr_lalu=$lcr_lalu*-1; $min018=")";
                        }else {
                    	$min017=""; $lcr_lalu; $min018="";
                        }			
		
		$lcr_lalu1=number_format($lcr_lalu,"2",",",".");
		
		if ($ast < 0){
                    	$min019="("; $ast=$ast*-1; $min020=")";
                        }else {
                    	$min019=""; $ast; $min020="";
                        }			

		$ast1=number_format($ast,"2",",",".");
		
		if ($ast_lalu < 0){
                    	$min021="("; $ast_lalu=$ast_lalu*-1; $min022=")";
                        }else {
                    	$min021=""; $ast_lalu; $min022="";
                        }			
		
		$ast_lalu1=number_format($ast_lalu,"2",",",".");
		
		if ($rk_skpd_lalu < 0){
                    	$min031="("; $rk_skpd_lalu=$rk_skpd_lalu*-1; $min032=")";
                        }else {
                    	$min031=""; $rk_skpd_lalu; $min032="";
                        }			
		
		$rk_skpd_lalu1=number_format($rk_skpd_lalu,"2",",",".");
		
		if ($rk_skpd < 0){
                    	$min033="("; $rk_skpd=$rk_skpd*-1; $min034=")";
                        }else {
                    	$min033=""; $rk_skpd; $min034="";
                        }
		
		$rk_skpd1=number_format($rk_skpd,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, bold, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_obyek ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				$bold=$res['bold'];
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal==1){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal==1){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['bold']) {
                    case 1:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"7\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 2:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 3:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 4:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 34:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min009$rk_ppkd_lalu1$min010</td>
                                 </tr>";
                        break;
					case 14:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min031$rk_skpd_lalu1$min032</td>
                                 </tr>";
                        break;
					case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 15:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min031$rk_skpd_lalu1$min032</td>
                                 </tr>";
                        break;	
					case 6:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 16:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min017$lcr_lalu1$min018</td>
                                 </tr>";
                        break;	
					case 7:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 17:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min021$ast_lalu1$min022</td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
					    break;
					case 11:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>
                                 </tr>";
                        break;		
					case 12:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 13:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;
					}
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA AWAL KONSOL OBYEK $cbulan");
        $this->template->set('title', 'NERACA AWAL KONSOL OBYEK $cbulan');  
         switch ($cetak)
        {
            case 0;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
				break;
            case 1;
				echo "<title>NERACA AWAL KONSOL OBYEK $cbulan</title>";
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}

	function rpt_neraca_pemda_obyek_audit($cbulan="", $cetak=1){
		//$bulan	 = $_REQUEST['tgl1'];
			$kd_skpd   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			$bulan	 = $cbulan;
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;

			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
	$modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
			
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER $arraybulan[$bulan] $thn_ang DAN $thn_ang_1 </strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td colspan =\"7\"bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1 AUDITED</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td colspan =\"7\"style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td colspan =\"7\"style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8')";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9')";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju a INNER JOIN trhju b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8')";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8')";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9')";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9')";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$sqlskpd_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd_lalu  =$row->thn_m1;
					}
			
			$sqllcr_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx_lalu  =$row->thn_m1;
					}
					
			$sqlast_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx_lalu  =$row->thn_m1;
					}
			
			$lcr_lalu		= $lcrx_lalu-$rk_skpd_lalu;
			$ast_lalu		= $astx_lalu-$rk_skpd_lalu;			
			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu-$rk_skpd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu-$rk_skpd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
			
			$sqlskpd = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd  =$row->thn_m1;
					}

			$sqllcr = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx =$row->thn_m1;
					}
					
			$sqlast = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx  =$row->thn_m1;
					}		
			
			$lcr			= $lcrx-$rk_skpd;
			$ast			= $astx-$rk_skpd;
			$eku 			= $sal_akhir - $rk_ppkd + $rk_skpd;					
			$eku_tang 		= $sal_akhir + $nilaiutang - $rk_ppkd +$rk_skpd;					
			$rk_skpd		= $rk_skpd-$rk_ppkd;
			$rk_skpd_lalu	= $rk_skpd_lalu-$rk_ppkd_lalu;
			$rk_ppkd		= $rk_skpd;
			$rk_ppkd_lalu	= $rk_skpd_lalu;
			
					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
		if ($lcr < 0){
                    	$min015="("; $lcr=$lcr*-1; $min016=")";
                        }else {
                    	$min015=""; $lcr; $min016="";
                        }			

		$lcr1=number_format($lcr,"2",",",".");
		
		if ($lcr_lalu < 0){
                    	$min017="("; $lcr_lalu=$lcr_lalu*-1; $min018=")";
                        }else {
                    	$min017=""; $lcr_lalu; $min018="";
                        }			
		
		$lcr_lalu1=number_format($lcr_lalu,"2",",",".");
		
		if ($ast < 0){
                    	$min019="("; $ast=$ast*-1; $min020=")";
                        }else {
                    	$min019=""; $ast; $min020="";
                        }			

		$ast1=number_format($ast,"2",",",".");
		
		if ($ast_lalu < 0){
                    	$min021="("; $ast_lalu=$ast_lalu*-1; $min022=")";
                        }else {
                    	$min021=""; $ast_lalu; $min022="";
                        }			
		
		$ast_lalu1=number_format($ast_lalu,"2",",",".");
		
		if ($rk_skpd_lalu < 0){
                    	$min031="("; $rk_skpd_lalu=$rk_skpd_lalu*-1; $min032=")";
                        }else {
                    	$min031=""; $rk_skpd_lalu; $min032="";
                        }			
		
		$rk_skpd_lalu1=number_format($rk_skpd_lalu,"2",",",".");
		
		if ($rk_skpd < 0){
                    	$min033="("; $rk_skpd=$rk_skpd*-1; $min034=")";
                        }else {
                    	$min033=""; $rk_skpd; $min034="";
                        }
		
		$rk_skpd1=number_format($rk_skpd,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, bold, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15, isnull(nilai_lalu,0) nilai_lalu 
										FROM map_neraca_obyek ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				$bold=$res['bold'];
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
				$nilai_lalu=$res['nilai_lalu'];							
				
			$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal==1){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal==1){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
				if ($nilai_lalu < 0){
                    	$xxx="("; $nilai_lalu=$nilai_lalu*-1; $yyy=")";
                        }else {
                    	$xxx=""; $yyy="";
                        }
						
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
		$nilai_lalu1= number_format($nilai_lalu,"2",",",".");
		
				$no       = $no + 1;

				switch ($res['bold']) {
                    case 1:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"7\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 2:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 3:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 4:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$xxx$nilai_lalu1$yyy</td>
                                 </tr>";
                        break;
					case 34:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min013$rk_ppkd1$min014</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$xxx$nilai_lalu1$yyy</td>
                                 </tr>";
                        break;
					case 14:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min033$rk_skpd1$min034</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$xxx$nilai_lalu1$yyy</td>
                                 </tr>";
                        break;
					case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$xxx$nilai_lalu1$yyy</td>
                                 </tr>";
                        break;
					case 15:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min033$rk_skpd1$min034</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$xxx$nilai_lalu1$yyy</td>
                                 </tr>";
                        break;	
					case 6:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$xxx$nilai_lalu1$yyy</td>
                                 </tr>";
                        break;
					case 16:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min015$lcr1$min016</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$xxx$nilai_lalu1$yyy</td>
                                 </tr>";
                        break;	
					case 7:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$xxx$nilai_lalu1$yyy</td>
                                 </tr>";
                        break;	
					case 17:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min019$ast1$min020</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$xxx$nilai_lalu1$yyy</td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
					    break;
					case 11:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c$sal_akhir1$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$xxx$nilai_lalu1$yyy</td>
                                 </tr>";
                        break;		
					case 12:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min003$eku1$min004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$xxx$nilai_lalu1$yyy</td>
                                 </tr>";
                        break;
					case 13:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min007$eku_tang1$min008</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$xxx$nilai_lalu1$yyy</td>
                                 </tr>";
                        break;
					}
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA KONSOL OBYEK AUDIT $cbulan");
        $this->template->set('title', 'NERACA KONSOL OBYEK AUDIT $cbulan');  
         switch ($cetak)
        {
            case 0;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
				break;
            case 1;
				echo "<title>NERACA KONSOL OBYEK $cbulan</title>";
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}

	
	function rpt_neraca_pemda_obyek($cbulan="", $cetak=1){
		//$bulan	 = $_REQUEST['tgl1'];
			$kd_skpd   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			$bulan	 = $cbulan;
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;

			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
	$modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
			
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER $arraybulan[$bulan] $thn_ang DAN $thn_ang_1 </strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td colspan =\"7\"bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td colspan =\"7\"style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td colspan =\"7\"style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8')";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9')";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju a INNER JOIN trhju b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8')";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8')";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9')";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9')";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$sqlskpd_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd_lalu  =$row->thn_m1;
					}
			
			$sqllcr_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx_lalu  =$row->thn_m1;
					}
					
			$sqlast_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx_lalu  =$row->thn_m1;
					}
			
			$lcr_lalu		= $lcrx_lalu-$rk_skpd_lalu;
			$ast_lalu		= $astx_lalu-$rk_skpd_lalu;			
			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu-$rk_skpd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu-$rk_skpd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
			
			$sqlskpd = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd  =$row->thn_m1;
					}

			$sqllcr = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx =$row->thn_m1;
					}
					
			$sqlast = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx  =$row->thn_m1;
					}		
			
			$lcr			= $lcrx-$rk_skpd;
			$ast			= $astx-$rk_skpd;
			$eku 			= $sal_akhir - $rk_ppkd + $rk_skpd;					
			$eku_tang 		= $sal_akhir + $nilaiutang - $rk_ppkd +$rk_skpd;					
			$rk_skpd		= $rk_skpd-$rk_ppkd;
			$rk_skpd_lalu	= $rk_skpd_lalu-$rk_ppkd_lalu;
			$rk_ppkd		= $rk_skpd;
			$rk_ppkd_lalu	= $rk_skpd_lalu;
			
					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
		if ($lcr < 0){
                    	$min015="("; $lcr=$lcr*-1; $min016=")";
                        }else {
                    	$min015=""; $lcr; $min016="";
                        }			

		$lcr1=number_format($lcr,"2",",",".");
		
		if ($lcr_lalu < 0){
                    	$min017="("; $lcr_lalu=$lcr_lalu*-1; $min018=")";
                        }else {
                    	$min017=""; $lcr_lalu; $min018="";
                        }			
		
		$lcr_lalu1=number_format($lcr_lalu,"2",",",".");
		
		if ($ast < 0){
                    	$min019="("; $ast=$ast*-1; $min020=")";
                        }else {
                    	$min019=""; $ast; $min020="";
                        }			

		$ast1=number_format($ast,"2",",",".");
		
		if ($ast_lalu < 0){
                    	$min021="("; $ast_lalu=$ast_lalu*-1; $min022=")";
                        }else {
                    	$min021=""; $ast_lalu; $min022="";
                        }			
		
		$ast_lalu1=number_format($ast_lalu,"2",",",".");
		
		if ($rk_skpd_lalu < 0){
                    	$min031="("; $rk_skpd_lalu=$rk_skpd_lalu*-1; $min032=")";
                        }else {
                    	$min031=""; $rk_skpd_lalu; $min032="";
                        }			
		
		$rk_skpd_lalu1=number_format($rk_skpd_lalu,"2",",",".");
		
		if ($rk_skpd < 0){
                    	$min033="("; $rk_skpd=$rk_skpd*-1; $min034=")";
                        }else {
                    	$min033=""; $rk_skpd; $min034="";
                        }
		
		$rk_skpd1=number_format($rk_skpd,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, bold, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_obyek ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				$bold=$res['bold'];
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal==1){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal==1){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['bold']) {
                    case 1:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"7\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 2:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 3:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 4:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 34:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min013$rk_ppkd1$min014</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min009$rk_ppkd_lalu1$min010</td>
                                 </tr>";
                        break;
					case 14:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min033$rk_skpd1$min034</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min031$rk_skpd_lalu1$min032</td>
                                 </tr>";
                        break;
					case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 15:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min033$rk_skpd1$min034</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min031$rk_skpd_lalu1$min032</td>
                                 </tr>";
                        break;	
					case 6:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 16:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min015$lcr1$min016</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min017$lcr_lalu1$min018</td>
                                 </tr>";
                        break;	
					case 7:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 17:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min019$ast1$min020</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min021$ast_lalu1$min022</td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
					    break;
					case 11:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c$sal_akhir1$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>
                                 </tr>";
                        break;		
					case 12:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min003$eku1$min004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 13:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min007$eku_tang1$min008</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;
					}
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA KONSOL OBYEK $cbulan");
        $this->template->set('title', 'NERACA KONSOL OBYEK $cbulan');  
         switch ($cetak)
        {
            case 0;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
				break;
            case 1;
				echo "<title>NERACA KONSOL OBYEK $cbulan</title>";
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}

	
	function rpt_neraca_pemda($cbulan="", $cetak=1){
		//$bulan	 = $_REQUEST['tgl1'];
			$kd_skpd   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			$bulan	 = $cbulan;
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;

			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
	$modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
			
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER $arraybulan[$bulan] $thn_ang DAN $thn_ang_1 </strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8')";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9')";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju a INNER JOIN trhju b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8')";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8')";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9')";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9')";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$sqlskpd_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd_lalu  =$row->thn_m1;
					}
			
			$sqllcr_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx_lalu  =$row->thn_m1;
					}
					
			$sqlast_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx_lalu  =$row->thn_m1;
					}
			
			$lcr_lalu		= $lcrx_lalu-$rk_skpd_lalu;
			$ast_lalu		= $astx_lalu-$rk_skpd_lalu;			
			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu-$rk_skpd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu-$rk_skpd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
			
			$sqlskpd = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd  =$row->thn_m1;
					}

			$sqllcr = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx =$row->thn_m1;
					}
					
			$sqlast = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx  =$row->thn_m1;
					}		
			
			$lcr			= $lcrx-$rk_skpd;
			$ast			= $astx-$rk_skpd;
			$eku 			= $sal_akhir - $rk_ppkd + $rk_skpd;					
			$eku_tang 		= $sal_akhir + $nilaiutang - $rk_ppkd +$rk_skpd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
		if ($lcr < 0){
                    	$min015="("; $lcr=$lcr*-1; $min016=")";
                        }else {
                    	$min015=""; $lcr; $min016="";
                        }			

		$lcr1=number_format($lcr,"2",",",".");
		
		if ($lcr_lalu < 0){
                    	$min017="("; $lcr_lalu=$lcr_lalu*-1; $min018=")";
                        }else {
                    	$min017=""; $lcr_lalu; $min018="";
                        }			
		
		$lcr_lalu1=number_format($lcr_lalu,"2",",",".");
		
		if ($ast < 0){
                    	$min019="("; $ast=$ast*-1; $min020=")";
                        }else {
                    	$min019=""; $ast; $min020="";
                        }			

		$ast1=number_format($ast,"2",",",".");
		
		if ($ast_lalu < 0){
                    	$min021="("; $ast_lalu=$ast_lalu*-1; $min022=")";
                        }else {
                    	$min021=""; $ast_lalu; $min022="";
                        }			
		
		$ast_lalu1=number_format($ast_lalu,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal==1){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal==1){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['seq']) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 15:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 20:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;						
					case 100:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$min015$lcr1$min016</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$min017$lcr_lalu1$min018</td>
                                 </tr>";
                        break;
					case 105:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 145:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 170:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 175:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 220:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 225:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 240:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 245:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 280:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 285:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$min019$ast1$min020</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$min021$ast_lalu1$min022</td>
                                 </tr>";
                        break;		
					case 290:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 295:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 300:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 305:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 345:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 350:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 385:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 390:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 395:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min003$eku1$min004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;		
					case 400:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min007$eku_tang1$min008</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;
						default:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					}
 
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA KONSOL $cbulan");
        $this->template->set('title', 'NERACA KONSOL $cbulan');  
         switch ($cetak)
        {
            case 0;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
				break;
            case 1;
				echo "<title>NERACA KONSOL $cbulan</title>";
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}

	function rpt_neraca_awal_pemda($cbulan="", $cetak=1){
		//$bulan	 = $_REQUEST['tgl1'];
			$kd_skpd   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			$bulan	 = $cbulan;
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;

			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
	$modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
			
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA AWAL</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER 1 JANUARI $thn_ang</strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>JUMLAH</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8')";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9')";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju a INNER JOIN trhju b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8')";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8')";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9')";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9')";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$sqlskpd_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd_lalu  =$row->thn_m1;
					}
			
			$sqllcr_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx_lalu  =$row->thn_m1;
					}
					
			$sqlast_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and year(a.tgl_voucher)<=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx_lalu  =$row->thn_m1;
					}
			
			$lcr_lalu		= $lcrx_lalu-$rk_skpd_lalu;
			$ast_lalu		= $astx_lalu-$rk_skpd_lalu;			
			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu-$rk_skpd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu-$rk_skpd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
			
			$sqlskpd = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd  =$row->thn_m1;
					}

			$sqllcr = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx =$row->thn_m1;
					}
					
			$sqlast = "select isnull(sum(debet-kredit),0) thn_m1 from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx  =$row->thn_m1;
					}		
			
			$lcr			= $lcrx-$rk_skpd;
			$ast			= $astx-$rk_skpd;
			$eku 			= $sal_akhir - $rk_ppkd + $rk_skpd;					
			$eku_tang 		= $sal_akhir + $nilaiutang - $rk_ppkd +$rk_skpd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
		if ($lcr < 0){
                    	$min015="("; $lcr=$lcr*-1; $min016=")";
                        }else {
                    	$min015=""; $lcr; $min016="";
                        }			

		$lcr1=number_format($lcr,"2",",",".");
		
		if ($lcr_lalu < 0){
                    	$min017="("; $lcr_lalu=$lcr_lalu*-1; $min018=")";
                        }else {
                    	$min017=""; $lcr_lalu; $min018="";
                        }			
		
		$lcr_lalu1=number_format($lcr_lalu,"2",",",".");
		
		if ($ast < 0){
                    	$min019="("; $ast=$ast*-1; $min020=")";
                        }else {
                    	$min019=""; $ast; $min020="";
                        }			

		$ast1=number_format($ast,"2",",",".");
		
		if ($ast_lalu < 0){
                    	$min021="("; $ast_lalu=$ast_lalu*-1; $min022=")";
                        }else {
                    	$min021=""; $ast_lalu; $min022="";
                        }			
		
		$ast_lalu1=number_format($ast_lalu,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal==1){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju a inner join trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal==1){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['seq']) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 15:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 20:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;						
					case 100:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$min017$lcr_lalu1$min018</td>
                                 </tr>";
                        break;
					case 105:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 145:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 170:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 175:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 220:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 225:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 240:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 245:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 280:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 285:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$min021$ast_lalu1$min022</td>
                                 </tr>";
                        break;		
					case 290:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 295:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 300:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 305:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 345:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 350:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 385:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 390:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 395:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;		
					case 400:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;
						default:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"60%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					}
 
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA KONSOL $cbulan");
        $this->template->set('title', 'NERACA KONSOL $cbulan');  
         switch ($cetak)
        {
            case 0;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
				break;
            case 1;
				echo "<title>NERACA KONSOL $cbulan</title>";
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}

	
     function rpt_neraca_ppkd($cetak=1){
	        $bulan	 = $_REQUEST['tgl1'];
			$kd_skpd   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			
			$bulan<10 ? $xbulan = "0$bulan" : $xbulan=$bulan;
			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
	$modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
			
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER $arraybulan[$bulan] $thn_ang DAN $thn_ang_1 </strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td colspan =\"6\" bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td colspan =\"6\" style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td colspan =\"6\" style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
					
			$eku 		= $sal_akhir + $rk_ppkd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_ppkd ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd ='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='D'){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and a.kd_skpd ='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal=='D'){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['seq']) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 70:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 75:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 80:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 85:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 115:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 130:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 135:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 140:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 145:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 155:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 160:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 165:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 190:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 195:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 200:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"45%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 205:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 210:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 215:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 220:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 250:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 255:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 260:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 285:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 290:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 295:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"45%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 300:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 305:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 310:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 315:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 320:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"50%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min003$eku1$min004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 325:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"50%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min003$eku1$min004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 330:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 335:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"45%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min007$eku_tang1$min008</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
								 </tr>";
                        break;	
					default:	
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"57%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					}
				
                                     
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = 'NERACA PPKD';
        $this->template->set('title', 'NERACA PPKD');  
         switch ($cetak)
        {
            case 1;
				echo ("<title>NERACA PPKD $bulan</title>");
				echo $cRet;
				break;
            case 0;
                echo ("<title>NERACA PPKD $bulan</title>");
			    $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}

	function rpt_neraca_unit($cbulan="", $kd_skpd="", $pilih=1){
	        $id   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;
			
			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
			$modtahun= $thn_ang%4;
	 
			if ($modtahun = 0){
				$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
					else {
				$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
			 
			$arraybulan=explode(".",$nilaibulan);
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER $arraybulan[$cbulan] $thn_ang DAN $thn_ang_1 </strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1, isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT isnull(SUM(a.debet),0) AS debet, isnull(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
					
			$eku 		= $sal_akhir + $rk_ppkd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_skpd ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd ='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='D'){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and a.kd_skpd ='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal=='D'){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['seq']) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 65:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 70:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 170:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 300:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 320:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 340:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 370:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 375:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 378:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 380:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 385:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 410:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 415:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 420:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 460:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 465:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c$sal_akhir1$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>
                                 </tr>";
                        break;
					case 470:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min013$rk_ppkd1$min014</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min009$rk_ppkd_lalu1$min010</td>
                                 </tr>";
						break;		 
					case 475:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min003$eku1$min004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 485:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min007$eku_tang1$min008</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;	
					default:	
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					}
				
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA UNIT $kd_skpd / $cbulan");
        $this->template->set('title', ("NERACA UNIT $kd_skpd / $cbulan"));  
         switch ($pilih)
        {
            case 1;
				echo ("<title>NERACA UNIT $cbulan</title>");
				echo $cRet;
				break;
            case 0;
               $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}
		
			
			
    function rpt_neraca($cbulan="", $pilih=1){
	        $id   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;
			
			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$id' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
			$modtahun= $thn_ang%4;
	 
			if ($modtahun = 0){
				$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
					else {
				$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
			 
			$arraybulan=explode(".",$nilaibulan);
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER $arraybulan[$cbulan] $thn_ang DAN $thn_ang_1 </strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=31101011 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT isnull(SUM(a.debet),0) AS debet, isnull(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE kd_skpd<>'$id' AND a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
					
			$eku 		= $sal_akhir + $rk_ppkd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_skpd ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='D'){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and kd_skpd<>'$id' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal=='D'){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['seq']) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 65:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 70:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 170:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 300:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 320:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 340:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 370:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 375:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 378:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 380:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 385:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 410:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 415:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 420:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 460:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 465:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c$sal_akhir1$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>
                                 </tr>";
                        break;
					case 470:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min013$rk_ppkd1$min014</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min009$rk_ppkd_lalu1$min010</td>
                                 </tr>";
						break;		 
					case 475:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min003$eku1$min004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 485:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min007$eku_tang1$min008</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;	
					default:	
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					}
				
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA SKPD Keseluruhan / $cbulan");
        $this->template->set('title', ("NERACA SKPD Keseluruhan / $cbulan"));  
         switch ($pilih)
        {
            case 1;
				echo ("<title>NERACA SKPD $cbulan</title>");
				echo $cRet;
				break;
            case 0;
               $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}

			
			
    function ctk_neraca_saldo()
    {
        $thn_ang = $this->session->userdata('pcThang');
            
           
         $tgl= $_REQUEST['tgl1'];
         
         $tgl_ttd= $_REQUEST['tgl_ttd'];
                  
       
         
         $csql="SELECT a.nama, a.nip FROM ms_ttd a WHERE kode = 'BP' AND a.kd_skpd = '1.20.05.00'";
         $hasil = $this->db->query($csql);
         $trh2 = $hasil->row();          
         $lcNmBP = $trh2->nama;
         $lcNipBP = $trh2->nip;                  

       
            
         $cRet = '';
         $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
         
            <tr>
                <td align=\"center\" colspan=\"4\" style=\"font-size:14px;border: solid 1px white;\"><b>KABUPATEN MAHARDIKA<br>LAPORAN NERACA SALDO</b></td>
            </tr>
              <tr>
                <td align=\"left\" colspan=\"4\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
            </tr>
            <tr>
                <td align=\"center\" colspan=\"4\" style=\"font-size:12px;border: solid 1px white;\"> TANGGAL : ".$this->tanggal_format_indonesia($tgl)."</td>
            </tr>
            
            <tr>
                <td align=\"left\"  style=\"font-size:12px;border: solid 1px white;border-bottom:solid 2px black;\">&nbsp;</td>
                <td align=\"left\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;border-bottom:solid 2px black;\">&nbsp;</td>
            </tr></table>";
       $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
            <thead> 
            <tr>
                <td align=\"center\" rowspan=\"2\" width=\"10%\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\" >Kode Rekening</td>
                <td align=\"center\" rowspan=\"2\" width=\"50%\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\">Nama Rekening</td>
                <td align=\"center\" colspan=\"2\" width=\"40%\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\">Jumlah</td>             
            </tr> 
            <tr>
                
                <td align=\"center\" width=\"20%\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\">Debet</td>
                <td align=\"center\" width=\"20%\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\">Kredit</td>             
            </tr> 
            </thead>         
            <tr>
                <td align=\"center\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">1</td>
                <td align=\"center\"  style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">2</td>
                <td align=\"center\"  style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">3</td>
                <td align=\"center\"  style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">4</td>              
            </tr>";
           
           


                                                       
                
                     $sql = "SELECT * FROM ms_rek5 WHERE LEFT(kd_rek5,1) IN ('1','2','3','4','5','6') ORDER BY kd_rek5";

           
           
                                       
                    $hasil = $this->db->query($sql); 
                    foreach ($hasil->result() as $row)
                    {
                      
                       $kd_rek   =$row->kd_rek5 ;
                       $nama     =$row->nm_rek5;
                       $sn       =$row->sal_n;
                       
                             $sql1 = "SELECT a.kd_rek5,SUM(a.debet)AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher WHERE a.kd_rek5='$kd_rek' and b.tgl_voucher <='$tgl' GROUP BY a.kd_rek5 ";
                             $hasil1 = $this->db->query($sql1); 
                            foreach ($hasil1->result() as $row1)
                            {
                             $lcdebet      =$row1->debet ;
                             $lckredit     =$row1->kredit;
                                if($sn=='0'  ) {
                                    $nilai=$lcdebet-$lckredit;
                                } else{
                                    $nilai=$lckredit-$lcdebet;
                                }
                                 if($sn=='0'  ) {
                                     $cRet .="<tr>
                                          <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">$kd_rek</td>
                                          <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">$nama</td>
                                          <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"> ".number_format($nilai)."</td>
                                          <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">&nbsp;</td>
                                          </tr>";
                                } else{
                                    $cRet .="<tr>
                                          <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">$kd_rek</td>
                                          <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">$nama</td>
                                          <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"> &nbsp;</td>
                                          <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"> ".number_format($nilai)."</td>
                                          </tr>";
                                }  
                               
                            }                     
                     
                    }
                 


  
                                    
       
        
                
        $cRet .='</table>';
                 
         $data['prev']= $cRet;    
         //$this->tukd_model->_mpdf('',$cRet,'10','10',5,'0');
         //$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, 'L');
         $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
    }

	
	function ctk_lpe_pemda_unit($cbulan="", $kd_skpd="", $cetak = 1){
		$id = $this->session->userdata('kdskpd');
        $thn_ang = $this->session->userdata('pcThang');
		$bulan	 = $cbulan;
        $id1     = $this->session->userdata('kdskpd');
        $nmskpd = $this->tukd_model->get_nama($kd_skpd,'nm_skpd','ms_skpd','kd_skpd');
        $nm_skpd =strtoupper($nmskpd);
        $thn_ang_1= $thn_ang-1;   
        
		/*$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }
		*/		
        $skpd = "AND kd_skpd='$id1'";
        $skpd1 = "AND b.kd_skpd='$id1'"; 

// UPDATE LPE TAHUN LALU
    		        
			$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju a INNER JOIN trhju b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0 and kd_skpd='$kd_skpd'");  
	        foreach($query3->result_array() as $res2){
				 $debet=$res2['debet'];
				 $kredit=$res2['kredit'];
                 				 
			 }
			 
		$real=$kredit-$debet+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;
//        $this->db->query(" UPDATE map_lpe_skpd SET thn_m1 = '$real' WHERE nor = '1' ");
//          }
/*		    
			
			$query3 = $this->db->query(" SELECT
										SUM(a.debet) AS debet, SUM(a.kredit) AS kredit
									FROM
										trdju_pkd a
									INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd
									WHERE
										b.kd_skpd = '$kd_skpd'
									AND left(a.kd_rek5,1) = '9'
									AND YEAR (b.tgl_voucher) < '$thn'");  
	        foreach($query3->result_array() as $res21){
				 $debet9=$res21['debet'];
				 $kredit9=$res21['kredit'];
                 				 
			 }
			 
		$query3 = $this->db->query(" SELECT
										SUM(a.debet) AS debet, SUM(a.kredit) AS kredit
									FROM
										trdju_pkd a
									INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd
									WHERE
										b.kd_skpd = '$kd_skpd'
									AND left(a.kd_rek5,1) = '8'
									AND YEAR (b.tgl_voucher) < '$thn'");  
	        foreach($query3->result_array() as $res22){
				 $debet8=$res22['debet'];
				 $kredit8=$res22['kredit'];
                 				 
			 }	 
			 
		$surplus1_1=($kredit8-$debet8)-($debet9-$kredit9);
		$surplus1=number_format($surplus1_1, "2", ".", "");
*/
		//        $this->db->query(" UPDATE map_lpe_skpd SET thn_m1 = '$surplus1' WHERE nor = '2'");
          
//		$this->db->query(" UPDATE map_lpe_skpd SET thn_m1 = '$akhir' WHERE nor = '7'");
		

// end tahun lalu		  
        
/*        $sqlsawal = "SELECT * FROM map_lpe_skpd where nor='7'";
        $queryawal = $this->db->query($sqlsawal);
        $jmlsaldo = $queryawal->row();
        $jmlsal = $jmlsaldo->thn_m1;
        
        $sql41 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,1)='8' $skpd";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        $jmlpendapatan1 = number_format($jmlp->nilai, "2", ".", ",");
*/
//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;

					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
                    

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;
/*		
        $sql51 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,1)='9'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ".", ",");
        $sql523 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,3)='923'";
        $query523 = $this->db->query($sql523);
        $jmlbm = $query523->row();
        $jmlbmbelanja = $jmlbm->nilai;
        $jmlbmbelanja1 = number_format($jmlbmbelanja, "2", ".", ",");
        $sql61 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='71'";
        $query61 = $this->db->query($sql61);
        $jmlpm = $query61->row();
        $jmlpmasuk = $jmlpm->nilai;
        $sql62 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='72'";
        $query62 = $this->db->query($sql62);
        $jmlpk = $query62->row();
        $jmlpkeluar = $jmlpk->nilai;
        $surplus = $jmlpendapatan - $jmlbelanja;
*/						
            $sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
/*        $biaya_net = $jmlpmasuk - $jmlpkeluar;        
        $silpa = ($jmlpendapatan + $jmlpmasuk) - ($jmlbelanja + $jmlpkeluar);
        if ($silpa < 0)
        {
            $a = "(";
            $silpa1 = $silpa * -1;
            $b = ")";
        } else
        {
            $a = "";
            $silpa1 = $silpa;
            $b = "";
        }
*/
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;
					
					if ($surplus_lo_lalu3 < 0){
                    	$lo15="("; $surplus_lo_lalu3=$surplus_lo_lalu3*-1; $lo16=")";}
                    else {
                    	$lo15=""; $lo16="";}						
                    $surplus_lo_lalu31 = number_format($surplus_lo_lalu3,"2",",",".");
					
					if ($selisih_surplus_lo3 < 0){
                    	$lo17="("; $selisih_surplus_lo3=$selisih_surplus_lo3*-1; $lo18=")";}
                    else {
                    	$lo17=""; $lo18="";}
                    $selisih_surplus_lo31 = number_format($selisih_surplus_lo3,"2",",",".");
					
					if ($lpe_lalu1 < 0){
                    	$lalu1="("; $lpe_lalu1=$lpe_lalu1*-1; $lalu2=")";}
                    else {
                    	$lalu1=""; $lpe_lalu1; $lalu2="";}				

					if ($lpe_lalu2 < 0){
                    	$lalu3="("; $lpe_lalu2=$lpe_lalu2*-1; $lalu4=")";}
                    else {
                    	$lalu3=""; $lpe_lalu2; $lalu4="";}

					if ($lpe_lalu3 < 0){
                    	$lalu5="("; $lpe_lalu3=$lpe_lalu3*-1; $lalu6=")";}
                    else {
                    	$lalu5=""; $lpe_lalu3; $lalu6="";}
						
					if ($nilaiDR < 0){
                    	$l000="("; $nilaiDR=$nilaiDR*-1; $p000=")";}
                    else {
                    	$l000=""; $nilaiDR; $p000="";}		

					if ($nilailpe1 < 0){
                    	$l001="("; $nilailpe1=$nilailpe1*-1; $p001=")";}
                    else {
                    	$l001=""; $nilailpe1; $p001="";}

					if ($nilailpe2 < 0){
                    	$l002="("; $nilailpe2=$nilailpe2*-1; $p002=")";}
                    else {
                    	$l002=""; $nilailpe2; $p002="";}

                    if ($surplus_lo3 < 0){
                    	$lo13="("; $surplus_lo3=$surplus_lo3*-1; $lo14=")";}
                    else {
                    	$lo13=""; $lo14="";}		
                    $surplus_lo31 = number_format($surplus_lo3,"2",",",".");
					
					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}

					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}

					if ($real < 0)
					{
						$cx = "("; $real = $real * -1; $dx = ")";
					} else
					{
						$cx = ""; $real; $dx = "";
					}

	 $modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);

    
         $cRet = '';
         $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>LAPORAN PERUBAHAN EKUITAS</strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan] $thn_ang DAN $thn_ang_1</strong></td>
                    </tr>
					<tr>
                         <td align=\"center\"><strong>&nbsp</strong></td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                        
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                        </tr>";
                
                     $sql = "SELECT * FROM map_lpe_skpd  ORDER BY seq";
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {
                      
                       $kd_rek   =$row->nor ;
                       $parent   =$row->parent;
                       $nama     =$row->uraian;
                       $nilai_1    =$row->thn_m1;
                       
					   
/*        if ($nilai_1 < 0)
        {
            $tx = "(";
            $nilai_1 = $nilai_1 * -1;
            $ty = ")";
        } else
        {
            $tx = "";
            $ty = "";
        }
*/
                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> $c1".number_format($sal_awal,"2",",",".")."$d1</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$cx".number_format($real,"2",",",".")."$dx</td>
                                                     </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> $lo13".number_format($surplus_lo3,"2",",",".")."$lo14</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lo15".number_format($surplus_lo_lalu3,"2",",",".")."$lo16</td>
                                                     </tr>";
                                            
                                    break; 
                                     case 3:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     </tr>";
                                            
                                    break; 
                                    case 4: 
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l001".number_format($nilailpe1,"2",",",".")."$p001</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu1".number_format($lpe_lalu2,"2",",",".")."$lalu2</td>
                                                     </tr>";
									break;
                                    case 5:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l000".number_format($nilaiDR,"2",",",".")."$p000</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu3".number_format($lpe_lalu1,"2",",",".")."$lalu4</td>
                                                     </tr>";
									break;
                                    case 6:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l002".number_format($nilailpe2,"2",",",".")."$p002</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu5".number_format($lpe_lalu3,"2",",",".")."$lalu6</td>
                                                     </tr>";
									break;
                                    case 7:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$c".number_format($sal_akhir,"2",",",".")."$d</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$c1".number_format($sal_awal,"2",",",".")."$d1</td>
                                                     </tr>";
                                } 
                       
                    }                           

        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("LPE KONSOL $cbulan");
        $this->template->set('title', 'LPE KONSOL UNIT $cbulan');  
         switch ($cetak)
        {
            case 0;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
				break;
            case 1;
				echo "<title>LPE KONSOL UNIT $cbulan</title>";
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }

    }
   
	function ctk_lpe_pemda($cbulan="", $cetak = 1)
    {
		$kd_skpd = $this->session->userdata('kdskpd');
        $thn_ang = $this->session->userdata('pcThang');
		$bulan	 = $cbulan;
        $id1     = $this->session->userdata('kdskpd');
        $nmskpd = $this->tukd_model->get_nama($id1,'nm_skpd','ms_skpd','kd_skpd');
        $nmskpd =strtoupper($nmskpd);
        $thn_ang_1= $thn_ang-1;   
        
		/*$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }
		*/		
        $skpd = "AND kd_skpd='$id1'";
        $skpd1 = "AND b.kd_skpd='$id1'"; 

// UPDATE LPE TAHUN LALU
    		        
			$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8')";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9')";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju a INNER JOIN trhju b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet=$res2['debet'];
				 $kredit=$res2['kredit'];
                 				 
			 }
			 
		$real=$kredit-$debet+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;
//        $this->db->query(" UPDATE map_lpe_skpd SET thn_m1 = '$real' WHERE nor = '1' ");
//          }
/*		    
			
			$query3 = $this->db->query(" SELECT
										SUM(a.debet) AS debet, SUM(a.kredit) AS kredit
									FROM
										trdju_pkd a
									INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd
									WHERE
										b.kd_skpd = '$kd_skpd'
									AND left(a.kd_rek5,1) = '9'
									AND YEAR (b.tgl_voucher) < '$thn'");  
	        foreach($query3->result_array() as $res21){
				 $debet9=$res21['debet'];
				 $kredit9=$res21['kredit'];
                 				 
			 }
			 
		$query3 = $this->db->query(" SELECT
										SUM(a.debet) AS debet, SUM(a.kredit) AS kredit
									FROM
										trdju_pkd a
									INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd
									WHERE
										b.kd_skpd = '$kd_skpd'
									AND left(a.kd_rek5,1) = '8'
									AND YEAR (b.tgl_voucher) < '$thn'");  
	        foreach($query3->result_array() as $res22){
				 $debet8=$res22['debet'];
				 $kredit8=$res22['kredit'];
                 				 
			 }	 
			 
		$surplus1_1=($kredit8-$debet8)-($debet9-$kredit9);
		$surplus1=number_format($surplus1_1, "2", ".", "");
*/
		//        $this->db->query(" UPDATE map_lpe_skpd SET thn_m1 = '$surplus1' WHERE nor = '2'");
          
//		$this->db->query(" UPDATE map_lpe_skpd SET thn_m1 = '$akhir' WHERE nor = '7'");
		

// end tahun lalu		  
        
/*        $sqlsawal = "SELECT * FROM map_lpe_skpd where nor='7'";
        $queryawal = $this->db->query($sqlsawal);
        $jmlsaldo = $queryawal->row();
        $jmlsal = $jmlsaldo->thn_m1;
        
        $sql41 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,1)='8' $skpd";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        $jmlpendapatan1 = number_format($jmlp->nilai, "2", ".", ",");
*/
//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8')";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8')";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9')";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju a inner join trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9')";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;

					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
                    

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;
/*		
        $sql51 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,1)='9'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ".", ",");
        $sql523 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,3)='923'";
        $query523 = $this->db->query($sql523);
        $jmlbm = $query523->row();
        $jmlbmbelanja = $jmlbm->nilai;
        $jmlbmbelanja1 = number_format($jmlbmbelanja, "2", ".", ",");
        $sql61 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='71'";
        $query61 = $this->db->query($sql61);
        $jmlpm = $query61->row();
        $jmlpmasuk = $jmlpm->nilai;
        $sql62 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='72'";
        $query62 = $this->db->query($sql62);
        $jmlpk = $query62->row();
        $jmlpkeluar = $jmlpk->nilai;
        $surplus = $jmlpendapatan - $jmlbelanja;
*/						
            $sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju a
					inner join trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
/*        $biaya_net = $jmlpmasuk - $jmlpkeluar;        
        $silpa = ($jmlpendapatan + $jmlpmasuk) - ($jmlbelanja + $jmlpkeluar);
        if ($silpa < 0)
        {
            $a = "(";
            $silpa1 = $silpa * -1;
            $b = ")";
        } else
        {
            $a = "";
            $silpa1 = $silpa;
            $b = "";
        }
*/
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;
					
					if ($surplus_lo_lalu3 < 0){
                    	$lo15="("; $surplus_lo_lalu3=$surplus_lo_lalu3*-1; $lo16=")";}
                    else {
                    	$lo15=""; $lo16="";}						
                    $surplus_lo_lalu31 = number_format($surplus_lo_lalu3,"2",",",".");
					
					if ($selisih_surplus_lo3 < 0){
                    	$lo17="("; $selisih_surplus_lo3=$selisih_surplus_lo3*-1; $lo18=")";}
                    else {
                    	$lo17=""; $lo18="";}
                    $selisih_surplus_lo31 = number_format($selisih_surplus_lo3,"2",",",".");
					
					if ($lpe_lalu1 < 0){
                    	$lalu1="("; $lpe_lalu1=$lpe_lalu1*-1; $lalu2=")";}
                    else {
                    	$lalu1=""; $lpe_lalu1; $lalu2="";}				

					if ($lpe_lalu2 < 0){
                    	$lalu3="("; $lpe_lalu2=$lpe_lalu2*-1; $lalu4=")";}
                    else {
                    	$lalu3=""; $lpe_lalu2; $lalu4="";}

					if ($lpe_lalu3 < 0){
                    	$lalu5="("; $lpe_lalu3=$lpe_lalu3*-1; $lalu6=")";}
                    else {
                    	$lalu5=""; $lpe_lalu3; $lalu6="";}
						
					if ($nilaiDR < 0){
                    	$l000="("; $nilaiDR=$nilaiDR*-1; $p000=")";}
                    else {
                    	$l000=""; $nilaiDR; $p000="";}		

					if ($nilailpe1 < 0){
                    	$l001="("; $nilailpe1=$nilailpe1*-1; $p001=")";}
                    else {
                    	$l001=""; $nilailpe1; $p001="";}

					if ($nilailpe2 < 0){
                    	$l002="("; $nilailpe2=$nilailpe2*-1; $p002=")";}
                    else {
                    	$l002=""; $nilailpe2; $p002="";}

                    if ($surplus_lo3 < 0){
                    	$lo13="("; $surplus_lo3=$surplus_lo3*-1; $lo14=")";}
                    else {
                    	$lo13=""; $lo14="";}		
                    $surplus_lo31 = number_format($surplus_lo3,"2",",",".");
					
					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}

					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}

					if ($real < 0)
					{
						$cx = "("; $real = $real * -1; $dx = ")";
					} else
					{
						$cx = ""; $real; $dx = "";
					}

	 $modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);

    
         $cRet = '';
         $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>LAPORAN PERUBAHAN EKUITAS</strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan] $thn_ang DAN $thn_ang_1</strong></td>
                    </tr>
					<tr>
                         <td align=\"center\"><strong>&nbsp;</strong></td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                        
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                        </tr>";
                
                     $sql = "SELECT * FROM map_lpe_skpd  ORDER BY seq";
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {
                      
                       $kd_rek   =$row->nor ;
                       $parent   =$row->parent;
                       $nama     =$row->uraian;
                       $nilai_1    =$row->thn_m1;
                       
					   
/*        if ($nilai_1 < 0)
        {
            $tx = "(";
            $nilai_1 = $nilai_1 * -1;
            $ty = ")";
        } else
        {
            $tx = "";
            $ty = "";
        }
*/
                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> $c1".number_format($sal_awal,"2",",",".")."$d1</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$cx".number_format($real,"2",",",".")."$dx</td>
                                                     </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> $lo13".number_format($surplus_lo3,"2",",",".")."$lo14</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lo15".number_format($surplus_lo_lalu3,"2",",",".")."$lo16</td>
                                                     </tr>";
                                            
                                    break; 
                                     case 3:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     </tr>";
                                            
                                    break; 
                                    case 4: 
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l001".number_format($nilailpe1,"2",",",".")."$p001</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu1".number_format($lpe_lalu2,"2",",",".")."$lalu2</td>
                                                     </tr>";
									break;
                                    case 5:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l000".number_format($nilaiDR,"2",",",".")."$p000</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu3".number_format($lpe_lalu1,"2",",",".")."$lalu4</td>
                                                     </tr>";
									break;
                                    case 6:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l002".number_format($nilailpe2,"2",",",".")."$p002</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu5".number_format($lpe_lalu3,"2",",",".")."$lalu6</td>
                                                     </tr>";
									break;
                                    case 7:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$c".number_format($sal_akhir,"2",",",".")."$d</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$c1".number_format($sal_awal,"2",",",".")."$d1</td>
                                                     </tr>";
                                } 
                       
                    }                           

        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("LPE KONSOL $cbulan");
        $this->template->set('title', 'LPE KONSOL $cbulan');  
         switch ($cetak)
        {
            case 0;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
				break;
            case 1;
				echo "<title>LPE KONSOL $cbulan</title>";
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }

    }
     
	function cetak_lpe_ppkd($cetak = 0)
    {
		$kd_skpd = $this->session->userdata('kdskpd');
        $thn_ang = $this->session->userdata('pcThang');
        $id1     = $this->session->userdata('kdskpd');
        $bulan	 = $_REQUEST['tgl1']; 
		$nmskpd = $this->tukd_model->get_nama($id1,'nm_skpd','ms_skpd','kd_skpd');
        $nmskpd =strtoupper($nmskpd);
        $thn_ang_1= $thn_ang-1;   
        
		/*$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }
		*/		
        $skpd = "AND kd_skpd='$id1'";
        $skpd1 = "AND b.kd_skpd='$id1'"; 

// UPDATE LPE TAHUN LALU
    		        
			$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and left(b.kd_rek5,1)=1 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and left(b.kd_rek5,1)=1 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and left(b.kd_rek5,1)=1 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet=$res2['debet'];
				 $kredit=$res2['kredit'];
                 				 
			 }
			 
		$real=$kredit-$debet+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;
//        $this->db->query(" UPDATE map_lpe_skpd SET thn_m1 = '$real' WHERE nor = '1' ");
//          }
/*		    
			
			$query3 = $this->db->query(" SELECT
										SUM(a.debet) AS debet, SUM(a.kredit) AS kredit
									FROM
										trdju_pkd a
									INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd
									WHERE
										b.kd_skpd = '$kd_skpd'
									AND left(a.kd_rek5,1) = '9'
									AND YEAR (b.tgl_voucher) < '$thn'");  
	        foreach($query3->result_array() as $res21){
				 $debet9=$res21['debet'];
				 $kredit9=$res21['kredit'];
                 				 
			 }
			 
		$query3 = $this->db->query(" SELECT
										SUM(a.debet) AS debet, SUM(a.kredit) AS kredit
									FROM
										trdju_pkd a
									INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd
									WHERE
										b.kd_skpd = '$kd_skpd'
									AND left(a.kd_rek5,1) = '8'
									AND YEAR (b.tgl_voucher) < '$thn'");  
	        foreach($query3->result_array() as $res22){
				 $debet8=$res22['debet'];
				 $kredit8=$res22['kredit'];
                 				 
			 }	 
			 
		$surplus1_1=($kredit8-$debet8)-($debet9-$kredit9);
		$surplus1=number_format($surplus1_1, "2", ".", "");
*/
		//        $this->db->query(" UPDATE map_lpe_skpd SET thn_m1 = '$surplus1' WHERE nor = '2'");
          
//		$this->db->query(" UPDATE map_lpe_skpd SET thn_m1 = '$akhir' WHERE nor = '7'");
		

// end tahun lalu		  
        
/*        $sqlsawal = "SELECT * FROM map_lpe_skpd where nor='7'";
        $queryawal = $this->db->query($sqlsawal);
        $jmlsaldo = $queryawal->row();
        $jmlsal = $jmlsaldo->thn_m1;
        
        $sql41 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,1)='8' $skpd";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        $jmlpendapatan1 = number_format($jmlp->nilai, "2", ".", ",");
*/
//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;

					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
                    

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and left(b.kd_rek5,1)=1 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and left(b.kd_rek5,1)=1 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and left(b.kd_rek5,1)=1 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;
/*		
        $sql51 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,1)='9'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ".", ",");
        $sql523 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,3)='923'";
        $query523 = $this->db->query($sql523);
        $jmlbm = $query523->row();
        $jmlbmbelanja = $jmlbm->nilai;
        $jmlbmbelanja1 = number_format($jmlbmbelanja, "2", ".", ",");
        $sql61 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='71'";
        $query61 = $this->db->query($sql61);
        $jmlpm = $query61->row();
        $jmlpmasuk = $jmlpm->nilai;
        $sql62 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='72'";
        $query62 = $this->db->query($sql62);
        $jmlpk = $query62->row();
        $jmlpkeluar = $jmlpk->nilai;
        $surplus = $jmlpendapatan - $jmlbelanja;
*/						
            $sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and left(b.kd_rek5,1)=1 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and left(b.kd_rek5,1)=1 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and left(b.kd_rek5,1)=1 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
/*        $biaya_net = $jmlpmasuk - $jmlpkeluar;        
        $silpa = ($jmlpendapatan + $jmlpmasuk) - ($jmlbelanja + $jmlpkeluar);
        if ($silpa < 0)
        {
            $a = "(";
            $silpa1 = $silpa * -1;
            $b = ")";
        } else
        {
            $a = "";
            $silpa1 = $silpa;
            $b = "";
        }
*/
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;
					if ($surplus_lo_lalu3 < 0){
                    	$lo15="("; $surplus_lo_lalu3=$surplus_lo_lalu3*-1; $lo16=")";}
                    else {
                    	$lo15=""; $lo16="";}						
                    $surplus_lo_lalu31 = number_format($surplus_lo_lalu3,"2",",",".");
					
					if ($selisih_surplus_lo3 < 0){
                    	$lo17="("; $selisih_surplus_lo3=$selisih_surplus_lo3*-1; $lo18=")";}
                    else {
                    	$lo17=""; $lo18="";}
                    $selisih_surplus_lo31 = number_format($selisih_surplus_lo3,"2",",",".");
					
					if ($lpe_lalu1 < 0){
                    	$lalu1="("; $lpe_lalu1=$lpe_lalu1*-1; $lalu2=")";}
                    else {
                    	$lalu1=""; $lpe_lalu1; $lalu2="";}				

					if ($lpe_lalu2 < 0){
                    	$lalu3="("; $lpe_lalu2=$lpe_lalu2*-1; $lalu4=")";}
                    else {
                    	$lalu3=""; $lpe_lalu2; $lalu4="";}

					if ($lpe_lalu3 < 0){
                    	$lalu5="("; $lpe_lalu3=$lpe_lalu3*-1; $lalu6=")";}
                    else {
                    	$lalu5=""; $lpe_lalu3; $lalu6="";}
						
					if ($nilaiDR < 0){
                    	$l000="("; $nilaiDR=$nilaiDR*-1; $p000=")";}
                    else {
                    	$l000=""; $nilaiDR; $p000="";}		

					if ($nilailpe1 < 0){
                    	$l001="("; $nilailpe1=$nilailpe1*-1; $p001=")";}
                    else {
                    	$l001=""; $nilailpe1; $p001="";}

					if ($nilailpe2 < 0){
                    	$l002="("; $nilailpe2=$nilailpe2*-1; $p002=")";}
                    else {
                    	$l002=""; $nilailpe2; $p002="";}

                    if ($surplus_lo3 < 0){
                    	$lo13="("; $surplus_lo3=$surplus_lo3*-1; $lo14=")";}
                    else {
                    	$lo13=""; $lo14="";}		
                    $surplus_lo31 = number_format($surplus_lo3,"2",",",".");
					
					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}

					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}

					if ($real < 0)
					{
						$cx = "("; $real = $real * -1; $dx = ")";
					} else
					{
						$cx = ""; $real; $dx = "";
					}

	 $modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
					
         $cRet = '';
         $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
         
            <tr>
                <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>
            </tr>
	        <tr>
                <td align=\"center\"><strong>$nmskpd</strong></td>
            </tr>
			<tr>
                <td align=\"center\"><strong>LAPORAN PERUBAHAN EKUITAS</strong></td>
            </tr>
			<tr>
                <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$bulan] $thn_ang DAN $thn_ang_1</strong></td>
            </tr>
              <tr>
                <td align=\"center\">&nbsp;</td>
            </tr>   
        </table>";        
        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">    
					<thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"65%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>$thn_ang_1</b></td> 
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                          
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"65%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                        </tr>";
                
                
                     $sql = "SELECT * FROM map_lpe_skpd  ORDER BY seq";
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {
                      
                       $kd_rek   =$row->nor ;
                       $parent   =$row->parent;
                       $nama     =$row->uraian;
                       $nilai_1    =$row->thn_m1;
                       
					   
/*        if ($nilai_1 < 0)
        {
            $tx = "(";
            $nilai_1 = $nilai_1 * -1;
            $ty = ")";
        } else
        {
            $tx = "";
            $ty = "";
        }
*/
                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> $c1".number_format($sal_awal,"2",",",".")."$d1</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$cx".number_format($real,"2",",",".")."$dx</td>
                                                     </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> $lo13".number_format($surplus_lo3,"2",",",".")."$lo14</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lo15".number_format($surplus_lo_lalu3,"2",",",".")."$lo16</td>
                                                     </tr>";
                                            
                                    break; 
                                     case 3:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     </tr>";
                                            
                                    break; 
                                    case 4: 
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l001".number_format($nilailpe1,"2",",",".")."$p001</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu1".number_format($lpe_lalu2,"2",",",".")."$lalu2</td>
                                                     </tr>";
									break;
                                    case 5:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l000".number_format($nilaiDR,"2",",",".")."$p000</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu3".number_format($lpe_lalu1,"2",",",".")."$lalu4</td>
                                                     </tr>";
									break;
                                    case 6:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l002".number_format($nilailpe2,"2",",",".")."$p002</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu5".number_format($lpe_lalu3,"2",",",".")."$lalu6</td>
                                                     </tr>";
									break;
                                    case 7:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$c".number_format($sal_akhir,"2",",",".")."$d</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$c1".number_format($sal_awal,"2",",",".")."$d1</td>
                                                     </tr>";
                                } 
                       
                    }
                                        

        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = 'LAPORAN PERUBAHAN EKUITAS';
        $this->template->set('title', 'LAPORAN PERUBAHAN EKUITAS');  
         switch ($cetak)
        {
            case 1;
				echo $cRet;
				echo ("<title>LPE $bulan</title>");
				break;
            case 0;
               $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
			   	echo ("<title>LPE $bulan</title>");
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }

    }
    		
	function ctk_lpe_unit($cbulan="", $kd_skpd="", $pilih=1){
		$id = $this->session->userdata('kdskpd');
        $thn_ang = $this->session->userdata('pcThang');
        $id1     = $this->session->userdata('kdskpd');
        $nmskpd = $this->tukd_model->get_nama($kd_skpd,'nm_skpd','ms_skpd','kd_skpd');
        $nmskpd =strtoupper($nmskpd);
        $thn_ang_1= $thn_ang-1;   
        $cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;
		
        $skpd = "AND kd_skpd='$id1'";
        $skpd1 = "AND b.kd_skpd='$id1'"; 

// UPDATE LPE TAHUN LALU
    		        
			$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT isnull(SUM(a.debet),0) AS debet, isnull(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet=$res2['debet'];
				 $kredit=$res2['kredit'];
                 				 
			 }
			 
		$real=$kredit-$debet+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;

					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;
/*		
        $sql51 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,1)='9'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ".", ",");
        $sql523 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,3)='923'";
        $query523 = $this->db->query($sql523);
        $jmlbm = $query523->row();
        $jmlbmbelanja = $jmlbm->nilai;
        $jmlbmbelanja1 = number_format($jmlbmbelanja, "2", ".", ",");
        $sql61 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='71'";
        $query61 = $this->db->query($sql61);
        $jmlpm = $query61->row();
        $jmlpmasuk = $jmlpm->nilai;
        $sql62 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='72'";
        $query62 = $this->db->query($sql62);
        $jmlpk = $query62->row();
        $jmlpkeluar = $jmlpk->nilai;
        $surplus = $jmlpendapatan - $jmlbelanja;
*/						
            $sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
/*        $biaya_net = $jmlpmasuk - $jmlpkeluar;        
        $silpa = ($jmlpendapatan + $jmlpmasuk) - ($jmlbelanja + $jmlpkeluar);
        if ($silpa < 0)
        {
            $a = "(";
            $silpa1 = $silpa * -1;
            $b = ")";
        } else
        {
            $a = "";
            $silpa1 = $silpa;
            $b = "";
        }
*/
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;
					if ($surplus_lo_lalu3 < 0){
                    	$lo15="("; $surplus_lo_lalu3=$surplus_lo_lalu3*-1; $lo16=")";}
                    else {
                    	$lo15=""; $lo16="";}						
                    $surplus_lo_lalu31 = number_format($surplus_lo_lalu3,"2",",",".");
					
					if ($selisih_surplus_lo3 < 0){
                    	$lo17="("; $selisih_surplus_lo3=$selisih_surplus_lo3*-1; $lo18=")";}
                    else {
                    	$lo17=""; $lo18="";}
                    $selisih_surplus_lo31 = number_format($selisih_surplus_lo3,"2",",",".");
					
					if ($lpe_lalu1 < 0){
                    	$lalu1="("; $lpe_lalu1=$lpe_lalu1*-1; $lalu2=")";}
                    else {
                    	$lalu1=""; $lpe_lalu1; $lalu2="";}				

					if ($lpe_lalu2 < 0){
                    	$lalu3="("; $lpe_lalu2=$lpe_lalu2*-1; $lalu4=")";}
                    else {
                    	$lalu3=""; $lpe_lalu2; $lalu4="";}

					if ($lpe_lalu3 < 0){
                    	$lalu5="("; $lpe_lalu3=$lpe_lalu3*-1; $lalu6=")";}
                    else {
                    	$lalu5=""; $lpe_lalu3; $lalu6="";}
						
					if ($nilaiDR < 0){
                    	$l000="("; $nilaiDR=$nilaiDR*-1; $p000=")";}
                    else {
                    	$l000=""; $nilaiDR; $p000="";}		

					if ($nilailpe1 < 0){
                    	$l001="("; $nilailpe1=$nilailpe1*-1; $p001=")";}
                    else {
                    	$l001=""; $nilailpe1; $p001="";}

					if ($nilailpe2 < 0){
                    	$l002="("; $nilailpe2=$nilailpe2*-1; $p002=")";}
                    else {
                    	$l002=""; $nilailpe2; $p002="";}

                    if ($surplus_lo3 < 0){
                    	$lo13="("; $surplus_lo3=$surplus_lo3*-1; $lo14=")";}
                    else {
                    	$lo13=""; $lo14="";}		
                    $surplus_lo31 = number_format($surplus_lo3,"2",",",".");
					
					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}

					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}

					if ($real < 0)
					{
						$cx = "("; $real = $real * -1; $dx = ")";
					} else
					{
						$cx = ""; $real; $dx = "";
					}
		
		 $modtahun= $thn_ang%4;
		 
		 if ($modtahun = 0){
			$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
				else {
			$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
		 
		 $arraybulan=explode(".",$nilaibulan);
		
         $cRet = '';
         $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
         
            <tr>
                <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>
            </tr>
	        <tr>
                <td align=\"center\"><strong>$nmskpd</strong></td>
            </tr>
			<tr>
                <td align=\"center\"><strong>LAPORAN PERUBAHAN EKUITAS</strong></td>
            </tr>
			<tr>
                <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan] $thn_ang DAN $thn_ang_1</strong></td>
            </tr>
              <tr>
                <td align=\"center\">&nbsp;</td>
            </tr>   
        </table>";        
        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">    
					<thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"65%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>$thn_ang_1</b></td> 
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                          
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"65%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                        </tr>";
                
                
                     $sql = "SELECT * FROM map_lpe_skpd  ORDER BY seq";
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {
                      
                       $kd_rek   =$row->nor ;
                       $parent   =$row->parent;
                       $nama     =$row->uraian;
                       $nilai_1    =$row->thn_m1;
                       
					   
/*        if ($nilai_1 < 0)
        {
            $tx = "(";
            $nilai_1 = $nilai_1 * -1;
            $ty = ")";
        } else
        {
            $tx = "";
            $ty = "";
        }
*/
                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> $c1".number_format($sal_awal,"2",",",".")."$d1</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$cx".number_format($real,"2",",",".")."$dx</td>
                                                     </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> $lo13".number_format($surplus_lo3,"2",",",".")."$lo14</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lo15".number_format($surplus_lo_lalu3,"2",",",".")."$lo16</td>
                                                     </tr>";
                                            
                                    break; 
                                     case 3:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     </tr>";
                                            
                                    break; 
                                    case 4: 
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l001".number_format($nilailpe1,"2",",",".")."$p001</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu1".number_format($lpe_lalu2,"2",",",".")."$lalu2</td>
                                                     </tr>";
									break;
                                    case 5:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l000".number_format($nilaiDR,"2",",",".")."$p000</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu3".number_format($lpe_lalu1,"2",",",".")."$lalu4</td>
                                                     </tr>";
									break;
                                    case 6:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l002".number_format($nilailpe2,"2",",",".")."$p002</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu5".number_format($lpe_lalu3,"2",",",".")."$lalu6</td>
                                                     </tr>";
									break;
                                    case 7:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$c".number_format($sal_akhir,"2",",",".")."$d</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$c1".number_format($sal_awal,"2",",",".")."$d1</td>
                                                     </tr>";
                                } 
                       
                    }
                                        

        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("LPE UNIT $kd_skpd / $cbulan");
        $this->template->set('title', 'LPE SKPD $id / $cbulan');  
         switch ($pilih)
        {
            case 1;
				echo ("<title>LPE UNIT $cbulan</title>");
				echo $cRet;
				break;
            case 0;
               $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }

    }
    	
    function ctk_lpe($cbulan="", $pilih=1){
		$id = $this->session->userdata('kdskpd');
        $thn_ang = $this->session->userdata('pcThang');
        $id1     = $this->session->userdata('kdskpd');
        $nmskpd = $this->tukd_model->get_nama($id1,'nm_skpd','ms_skpd','kd_skpd');
        $nmskpd =strtoupper($nmskpd);
        $thn_ang_1= $thn_ang-1;   
        $cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;
		
		/*$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }
		*/		
        $skpd = "AND kd_skpd='$id1'";
        $skpd1 = "AND b.kd_skpd='$id1'"; 

// UPDATE LPE TAHUN LALU
    		        
			$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT isnull(SUM(a.debet),0) AS debet, isnull(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE kd_skpd<>'$id' AND a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet=$res2['debet'];
				 $kredit=$res2['kredit'];
                 				 
			 }
			 
		$real=$kredit-$debet+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;
//        $this->db->query(" UPDATE map_lpe_skpd SET thn_m1 = '$real' WHERE nor = '1' ");
//          }
/*		    
			
			$query3 = $this->db->query(" SELECT
										SUM(a.debet) AS debet, SUM(a.kredit) AS kredit
									FROM
										trdju_pkd a
									INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd
									WHERE
										b.kd_skpd = '$kd_skpd'
									AND left(a.kd_rek5,1) = '9'
									AND YEAR (b.tgl_voucher) < '$thn'");  
	        foreach($query3->result_array() as $res21){
				 $debet9=$res21['debet'];
				 $kredit9=$res21['kredit'];
                 				 
			 }
			 
		$query3 = $this->db->query(" SELECT
										SUM(a.debet) AS debet, SUM(a.kredit) AS kredit
									FROM
										trdju_pkd a
									INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd
									WHERE
										b.kd_skpd = '$kd_skpd'
									AND left(a.kd_rek5,1) = '8'
									AND YEAR (b.tgl_voucher) < '$thn'");  
	        foreach($query3->result_array() as $res22){
				 $debet8=$res22['debet'];
				 $kredit8=$res22['kredit'];
                 				 
			 }	 
			 
		$surplus1_1=($kredit8-$debet8)-($debet9-$kredit9);
		$surplus1=number_format($surplus1_1, "2", ".", "");
*/
		//        $this->db->query(" UPDATE map_lpe_skpd SET thn_m1 = '$surplus1' WHERE nor = '2'");
          
//		$this->db->query(" UPDATE map_lpe_skpd SET thn_m1 = '$akhir' WHERE nor = '7'");
		

// end tahun lalu		  
        
/*        $sqlsawal = "SELECT * FROM map_lpe_skpd where nor='7'";
        $queryawal = $this->db->query($sqlsawal);
        $jmlsaldo = $queryawal->row();
        $jmlsal = $jmlsaldo->thn_m1;
        
        $sql41 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,1)='8' $skpd";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        $jmlpendapatan1 = number_format($jmlp->nilai, "2", ".", ",");
*/
//		created by henri_tb
		$sqllo9="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select isnull(sum(kredit-debet),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd<>'$id'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select isnull(sum(debet-kredit),0) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd<>'$id'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;

					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;
/*		
        $sql51 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,1)='9'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ".", ",");
        $sql523 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,3)='923'";
        $query523 = $this->db->query($sql523);
        $jmlbm = $query523->row();
        $jmlbmbelanja = $jmlbm->nilai;
        $jmlbmbelanja1 = number_format($jmlbmbelanja, "2", ".", ",");
        $sql61 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='71'";
        $query61 = $this->db->query($sql61);
        $jmlpm = $query61->row();
        $jmlpmasuk = $jmlpm->nilai;
        $sql62 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='72'";
        $query62 = $this->db->query($sql62);
        $jmlpk = $query62->row();
        $jmlpkeluar = $jmlpk->nilai;
        $surplus = $jmlpendapatan - $jmlbelanja;
*/						
            $sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd<>'$id'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
/*        $biaya_net = $jmlpmasuk - $jmlpkeluar;        
        $silpa = ($jmlpendapatan + $jmlpmasuk) - ($jmlbelanja + $jmlpkeluar);
        if ($silpa < 0)
        {
            $a = "(";
            $silpa1 = $silpa * -1;
            $b = ")";
        } else
        {
            $a = "";
            $silpa1 = $silpa;
            $b = "";
        }
*/
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;
					
					if ($surplus_lo_lalu3 < 0){
                    	$lo15="("; $surplus_lo_lalu3=$surplus_lo_lalu3*-1; $lo16=")";}
                    else {
                    	$lo15=""; $lo16="";}						
                    $surplus_lo_lalu31 = number_format($surplus_lo_lalu3,"2",",",".");
					
					if ($selisih_surplus_lo3 < 0){
                    	$lo17="("; $selisih_surplus_lo3=$selisih_surplus_lo3*-1; $lo18=")";}
                    else {
                    	$lo17=""; $lo18="";}
                    $selisih_surplus_lo31 = number_format($selisih_surplus_lo3,"2",",",".");
					
					if ($lpe_lalu1 < 0){
                    	$lalu1="("; $lpe_lalu1=$lpe_lalu1*-1; $lalu2=")";}
                    else {
                    	$lalu1=""; $lpe_lalu1; $lalu2="";}				

					if ($lpe_lalu2 < 0){
                    	$lalu3="("; $lpe_lalu2=$lpe_lalu2*-1; $lalu4=")";}
                    else {
                    	$lalu3=""; $lpe_lalu2; $lalu4="";}

					if ($lpe_lalu3 < 0){
                    	$lalu5="("; $lpe_lalu3=$lpe_lalu3*-1; $lalu6=")";}
                    else {
                    	$lalu5=""; $lpe_lalu3; $lalu6="";}
						
					if ($nilaiDR < 0){
                    	$l000="("; $nilaiDR=$nilaiDR*-1; $p000=")";}
                    else {
                    	$l000=""; $nilaiDR; $p000="";}		

					if ($nilailpe1 < 0){
                    	$l001="("; $nilailpe1=$nilailpe1*-1; $p001=")";}
                    else {
                    	$l001=""; $nilailpe1; $p001="";}

					if ($nilailpe2 < 0){
                    	$l002="("; $nilailpe2=$nilailpe2*-1; $p002=")";}
                    else {
                    	$l002=""; $nilailpe2; $p002="";}

                    if ($surplus_lo3 < 0){
                    	$lo13="("; $surplus_lo3=$surplus_lo3*-1; $lo14=")";}
                    else {
                    	$lo13=""; $lo14="";}		
                    $surplus_lo31 = number_format($surplus_lo3,"2",",",".");
					
					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}

					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}

					if ($real < 0)
					{
						$cx = "("; $real = $real * -1; $dx = ")";
					} else
					{
						$cx = ""; $real; $dx = "";
					}
		
		 $modtahun= $thn_ang%4;
		 
		 if ($modtahun = 0){
			$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
				else {
			$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
		 
		 $arraybulan=explode(".",$nilaibulan);
		
         $cRet = '';
         $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
         
            <tr>
                <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>
            </tr>
			<tr>
                <td align=\"center\"><strong>LAPORAN PERUBAHAN EKUITAS</strong></td>
            </tr>
			<tr>
                <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan] $thn_ang DAN $thn_ang_1</strong></td>
            </tr>
              <tr>
                <td align=\"center\">&nbsp;</td>
            </tr>   
        </table>";        
        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">    
					<thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"65%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>$thn_ang_1</b></td> 
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                          
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"65%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                        </tr>";
                
                
                     $sql = "SELECT * FROM map_lpe_skpd  ORDER BY seq";
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {
                      
                       $kd_rek   =$row->nor ;
                       $parent   =$row->parent;
                       $nama     =$row->uraian;
                       $nilai_1    =$row->thn_m1;
                       
					   
/*        if ($nilai_1 < 0)
        {
            $tx = "(";
            $nilai_1 = $nilai_1 * -1;
            $ty = ")";
        } else
        {
            $tx = "";
            $ty = "";
        }
*/
                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> $c1".number_format($sal_awal,"2",",",".")."$d1</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$cx".number_format($real,"2",",",".")."$dx</td>
                                                     </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> $lo13".number_format($surplus_lo3,"2",",",".")."$lo14</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lo15".number_format($surplus_lo_lalu3,"2",",",".")."$lo16</td>
                                                     </tr>";
                                            
                                    break; 
                                     case 3:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     </tr>";
                                            
                                    break; 
                                    case 4: 
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l001".number_format($nilailpe1,"2",",",".")."$p001</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu1".number_format($lpe_lalu2,"2",",",".")."$lalu2</td>
                                                     </tr>";
									break;
                                    case 5:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l000".number_format($nilaiDR,"2",",",".")."$p000</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu3".number_format($lpe_lalu1,"2",",",".")."$lalu4</td>
                                                     </tr>";
									break;
                                    case 6:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$l002".number_format($nilailpe2,"2",",",".")."$p002</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lalu5".number_format($lpe_lalu3,"2",",",".")."$lalu6</td>
                                                     </tr>";
									break;
                                    case 7:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$c".number_format($sal_akhir,"2",",",".")."$d</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$c1".number_format($sal_awal,"2",",",".")."$d1</td>
                                                     </tr>";
                                } 
                       
                    }
                                        

        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("LPE SKPD $id / $cbulan");
        $this->template->set('title', 'LPE SKPD $id / $cbulan');  
         switch ($pilih)
        {
            case 1;
				echo ("<title>LPE SKPD $cbulan</title>");
				echo $cRet;
				break;
            case 0;
               $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }

    }
    
	
     function ctk_lpsal($cetak = 0)
    {
		$kd_skpd = $this->session->userdata('kdskpd');
        $thn_ang = $this->session->userdata('pcThang');
        $id1     = $this->session->userdata('kdskpd');
        $nmskpd = $this->tukd_model->get_nama($id1,'nm_skpd','ms_skpd','kd_skpd');
        $nmskpd =strtoupper($nmskpd);
        $thn_ang_1= $thn_ang-1;   
        
		$cbulan = 12;
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient WHERE kd_skpd='$id1'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    //$tgl=$rowsc->tgl_rka;
                    //$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }
		

		
        $skpd = "AND kd_skpd='$id1'";
        $skpd1 = "AND b.kd_skpd='$id1'";
	
	
			/*$sqlkas_lalu = "SELECT isnull(sum(kredit-debet),0) as nilai FROM 
					trdju_pkd a INNER JOIN trhju_pkd b ON a.kd_unit=b.kd_skpd AND a.no_voucher=b.no_voucher 
					WHERE YEAR(b.tgl_voucher)=$thn_ang AND a.map_real='6110703'";//Henri_TB
            */      
			
			$sqlkas_lalu = "SELECT isnull(thn_m1,0) as nilai FROM map_lpsal where seq='40'";//Henri_TB
					
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $kas_lalu  =$row->nilai;
					}

			$sqlkas = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher AND b.kd_unit=a.kd_skpd where kd_rek5 in (1110101) and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$cbulan'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $kas  =$row->thn_m1;
					}					

		$bulan	= 12;		
		
		$sql62=" SELECT ((pend+pemb)-(belanja+trans)) as silpa FROM
					(SELECT 
					 SUM(CASE WHEN LEFT(a.kd_rek5,1)='4' THEN a.kredit-a.debet ELSE 0 END) as pend
					,SUM(CASE WHEN LEFT(a.kd_rek5,2)='71' THEN a.kredit-a.debet ELSE 0 END) as pemb
					,SUM(CASE WHEN LEFT(a.kd_rek5,1)IN ('5','6') THEN a.debet-a.kredit ELSE 0 END) as belanja
					,SUM(CASE WHEN LEFT(a.kd_rek5,2)='72' THEN a.debet-a.kredit ELSE 0 END) as trans
					FROM trdju a INNER JOIN trhju b ON a.kd_unit=b.kd_skpd AND a.no_voucher=b.no_voucher 
					WHERE YEAR(b.tgl_voucher)=$thn_ang and month(b.tgl_voucher)<=$cbulan
					) a
					 ";
                    $query62 = $this->db->query($sql62);
                    $jmlpk = $query62->row();
                    $silpa = $jmlpk->silpa;
                 
					
					
		/*$sqlsal01="SELECT SUM(a.debet-a.kredit) as nilai FROM 
					trdju_pkd a INNER JOIN trhju_pkd b ON a.kd_unit=b.kd_skpd AND a.no_voucher=b.no_voucher 
					WHERE YEAR(b.tgl_voucher)=$thn_ang AND a.map_real='6110703'
					";//Henri_TB
        */         
		
		$sqlsal01="SELECT isnull(thn_m1*-1,0) as nilai FROM map_lpsal where seq='40'";//Henri_TB
					
                    $hasil = $this->db->query($sqlsal01); 
                    foreach ($hasil->result() as $row)
                    {
                       //$salang  =$row->anggaran;
					   $salnil  =$row->nilai;
					}
		
		$sqlsal06="select sum(kredit-debet) nilai FROM trdju a INNER JOIN trhju b ON a.kd_unit=b.kd_skpd AND a.no_voucher=b.no_voucher 
					WHERE a.kd_rek5='7110101' and YEAR(b.tgl_voucher)=$thn_ang and month(b.tgl_voucher)<=$cbulan";//Henri_TB
                            
                    $hasil = $this->db->query($sqlsal06); 
                    foreach ($hasil->result() as $row)
                    {
                       //$salang  =$row->anggaran;
					   $lain  =$row->nilai;
					}
		
		$lain	= $lain-$kas_lalu;
		$silpa	= $silpa-$lain;
		$sub01	= $kas_lalu+$salnil;
		$sub02	= $sub01+$silpa;
		
		$koreksi = 0;
		
		//$lain = 0;

		$sub03	= $sub02+$koreksi+$lain;
		
		if ($kas_lalu < 0){
                    	$sal01="("; $kas_lalu=$kas_lalu*-1; $sal02=")";
                        }else {
                    	$sal01=""; $sal02="";
                        }

		if ($kas > 0){
                    	$sal03="("; $kas=$kas*-1; $sal04=")";
                        }else {
                    	$sal03=""; $sal04="";
                        }
						
		if ($sub01 < 0){
                    	$sal05="("; $sub01=$sub01*-1; $sal06=")";
                        }else {
                    	$sal05=""; $sal06="";
                        }
		
		if ($sub02 < 0){
                    	$sal07="("; $sub02=$sub02*-1; $sal08=")";
                        }else {
                    	$sal07=""; $sal08="";
                        }

		if ($salnil < 0){
                    	$sal09="(";$salnil=$salnil*-1  ; $sal10=")";
                        }else {
                    	$sal09=""; $sal10="";
                        }

		if ($silpa < 0){
                    	$sal11="("; $silpa=$silpa*-1; $sal12=")";
                        }else {
                    	$sal11=""; $sal12="";
                        }

		if ($sub03 < 0){
                    	$sal13="("; $sub03=$sub03*-1; $sal14=")";
                        }else {
                    	$sal13=""; $sal14="";
                        }
						
        $sub011 =number_format($sub01,"2",",",".");
        $sub021 =number_format($sub02,"2",",",".");
        $kas_lalu1 =number_format($kas_lalu,"2",",",".");
        $kas1 =number_format($kas,"2",",",".");
        $silpa1 =number_format($silpa,"2",",",".");
        $salnil1 =number_format($salnil,"2",",",".");
		
        $koreksi1 =number_format($koreksi,"2",",",".");
        $lain1 =number_format($lain,"2",",",".");
		$sub031 =number_format($sub03,"2",",",".");
		
		$bulan=$cbulan;
			
			
			$modtahun= $thn_ang%4;
	 
			 if ($modtahun = 0){
				$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
					else {
				$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
			 
			 $arraybulan=explode(".",$nilaibulan);
		
		$cRet='';
			$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\" colspan=\"4\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\" colspan=\"4\"><strong>LAPORAN PERUBAHAN SALDO ANGGARAN LEBIH</strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\" colspan=\"4\"><strong>PER $arraybulan[$cbulan] $thn_ang</strong></td>
                    </tr>
					<tr>
                         <td align=\"center\" colspan=\"4\"><strong>&nbsp;</strong></td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>  
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>  
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                          
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                        </tr>";
                
                     $sql = "SELECT * FROM map_lpsal ORDER BY seq";
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {
                      
                       $kd_rek   =$row->nor ;
                       $parent   =$row->parent;
                       $nama     =$row->uraian;
                       $nilai_1_    =$row->thn_m1;
                       
					   
        if ($nilai_1_ < 0)
        {
            $tx = "(";
            $nilai_1a = $nilai_1_ * -1;
            $ty = ")";
        } else
        {
            $tx = "";
            $nilai_1a = $nilai_1_;
            $ty = "";
        }
	  $nilai_1 =number_format($nilai_1a,"2",",",".");


                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$sal01$kas_lalu1$sal02</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$tx$nilai_1$ty</td>
												   </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$sal09$salnil1$sal10</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$tx$nilai_1$ty</td>
                                                     </tr>";
                                            
                                    break; 
                                     case 3:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$sal05$sub011$sal06</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$tx$nilai_1$ty</td>
                                                     </tr>";
                                            
                                    break; 
                                    case 4:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$sal11$silpa1$sal12</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$tx$nilai_1$ty</td>
                                                     </tr>";
									break;
                                    case 5:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$sal07$sub021$sal08</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$tx$nilai_1$ty</td>
                                                     </tr>";
									break;
                                    case 6:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$koreksi1</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$tx$nilai_1$ty</td>
                                                     </tr>";
									break;
                                    case 7:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$lain1</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$tx$nilai_1$ty</td>
                                                     </tr>";
									break;
                                    case 8:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$sal13$sub031$sal14</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$tx$nilai_1$ty</td>
                                                     </tr>";
								} 
                       
                    }                      

        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = 'LAPORAN_PERUBAHAN_EKUITAS';
        $this->template->set('title', 'LAPORAN PERUBAHAN EKUITAS');  
		$cetak=$this->uri->segment(3);
         switch ($cetak)
        {
            case 0;
				echo $cRet;
				break;
            case 1;
               $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
	}

	
	
    function  tanggal_format_indonesia($tgl){
        $tanggal  = explode('-',$tgl); 
        $bulan  = $this-> getBulan($tanggal[1]);
        $tahun  =  $tanggal[0];
        return  $tanggal[2].' '.$bulan.' '.$tahun;

        }
         
        function  tanggal_indonesia($tgl){
        $tanggal  =  substr($tgl,8,2);
        $bulan  = substr($tgl,5,2);
        $tahun  =  substr($tgl,0,4);
        return  $tanggal.'-'.$bulan.'-'.$tahun;

        }
        
        function  getBulan($bln){
        switch  ($bln){
        case  1:
        return  "Januari";
        break;
        case  2:
        return  "Februari";
        break;
        case  3:
        return  "Maret";
        break;
        case  4:
        return  "April";
        break;
        case  5:
        return  "Mei";
        break;
        case  6:
        return  "Juni";
        break;
        case  7:
        return  "Juli";
        break;
        case  8:
        return  "Agustus";
        break;
        case  9:
        return  "September";
        break;
        case  10:
        return  "Oktober";
        break;
        case  11:
        return  "November";
        break;
        case  12:
        return  "Desember";
        break;
    }
    }	 
	
	function rpt_neraca_pemda_org_obyek($cbulan="", $kd_skpd="", $cetak=1){
		//$bulan	 = $_REQUEST['tgl1'];
			$id   	= $this->session->userdata('kdskpd');
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			$bulan	 = $cbulan;
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;

			$sqlsc="SELECT nm_org FROM ms_organisasi where kd_org='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_org;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	/*		       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 

			$sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE a.kd_skpd='$skpd'  ";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
*/				
	$modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
			
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>$nm_skpd</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>NERACA</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER $arraybulan[$bulan] $thn_ang DAN $thn_ang_1 </strong></td>
					</TR>
					</TABLE><br>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>
                            <td colspan =\"7\"bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$thn_ang_1</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							<td style=\"border-top: none;\"></td>
                            <td colspan =\"7\"style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>
                   
                     <tr>	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>
							<td colspan =\"7\"style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"55%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"center\">&nbsp;</td>
                           
                        </tr>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and LEFT(kd_skpd,7)='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and LEFT(kd_skpd,7)='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and LEFT(kd_skpd,7)='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0 and LEFT(kd_skpd,7)='$kd_skpd'");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8') and LEFT(kd_skpd,7)='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and LEFT(kd_skpd,7)='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9') and LEFT(kd_skpd,7)='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and LEFT(kd_skpd,7)='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and LEFT(kd_skpd,7)='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and LEFT(kd_skpd,7)='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a
					inner join trdju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$sqlskpd_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and year(a.tgl_voucher)<=$thn_ang_1 and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd_lalu  =$row->thn_m1;
					}
			
			$sqllcr_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and year(a.tgl_voucher)<=$thn_ang_1 and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx_lalu  =$row->thn_m1;
					}
					
			$sqlast_lalu = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and year(a.tgl_voucher)<=$thn_ang_1 and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx_lalu  =$row->thn_m1;
					}
			
			$lcr_lalu		= $lcrx_lalu-$rk_skpd_lalu;
			$ast_lalu		= $astx_lalu-$rk_skpd_lalu;			
			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
			
			$sqlskpd = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlskpd); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_skpd  =$row->thn_m1;
					}

			$sqllcr = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllcr); 
                    foreach ($hasil->result() as $row)
                    {
                       $lcrx =$row->thn_m1;
					}
					
			$sqlast = "select isnull(sum(debet-kredit),0) thn_m1 from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and LEFT(kd_skpd,7)='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlast); 
                    foreach ($hasil->result() as $row)
                    {
                       $astx  =$row->thn_m1;
					}		
			
			$lcr		= $lcrx-$rk_skpd;
			$ast		= $astx-$rk_skpd;
			$eku 		= $sal_akhir + $rk_ppkd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;					

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
		if ($lcr < 0){
                    	$min015="("; $lcr=$lcr*-1; $min016=")";
                        }else {
                    	$min015=""; $lcr; $min016="";
                        }			

		$lcr1=number_format($lcr,"2",",",".");
		
		if ($lcr_lalu < 0){
                    	$min017="("; $lcr_lalu=$lcr_lalu*-1; $min018=")";
                        }else {
                    	$min017=""; $lcr_lalu; $min018="";
                        }			
		
		$lcr_lalu1=number_format($lcr_lalu,"2",",",".");
		
		if ($ast < 0){
                    	$min019="("; $ast=$ast*-1; $min020=")";
                        }else {
                    	$min019=""; $ast; $min020="";
                        }			

		$ast1=number_format($ast,"2",",",".");
		
		if ($ast_lalu < 0){
                    	$min021="("; $ast_lalu=$ast_lalu*-1; $min022=")";
                        }else {
                    	$min021=""; $ast_lalu; $min022="";
                        }			
		
		$ast_lalu1=number_format($ast_lalu,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, bold, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_obyek ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				$bold=$res['bold'];
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and LEFT(kd_skpd,7)='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal==1){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from trhju_pkd a inner join trdju_pkd b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and LEFT(kd_skpd,7)='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal==1){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['bold']) {
                    case 1:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td colspan =\"7\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 2:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"6\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 3:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
									 <td colspan =\"5\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 4:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 14:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 34:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 15:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"3\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 6:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 16:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"2\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 7:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 17:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
					    break;
					case 11:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td colspan =\"4\"style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c$sal_akhir1$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>
                                 </tr>";
                        break;		
					case 12:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min003$eku1$min004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min001$eku_lalu1$min002</td>
                                 </tr>";
                        break;
					case 13:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"3%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;border-left: none;border-right: none;\" width=\"55%\">$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min007$eku_tang1$min008</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;
					}
			}

			
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA KONSOL OBYEK SKPD $cbulan");
        $this->template->set('title', 'NERACA KONSOL OBYEK SKPD $cbulan');  
         switch ($cetak)
        {
            case 0;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
				break;
            case 1;
				echo "<title>NERACA KONSOL OBYEK UNIT $cbulan</title>";
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
			}	
	
	
	function list_org() {
        $lccr = $this->input->post('q');
        $sql = "SELECT kd_org,nm_org FROM ms_organisasi where upper(kd_org) like upper('%$lccr%') or upper(nm_org) like upper('%$lccr%') order by kd_org ";
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
           
            $result[] = array(
                        'id' => $ii,        
                        'kd_org' => $resulte['kd_org'],  
                        'nm_org' => $resulte['nm_org']
                        );
                        $ii++;
        }
           
        echo json_encode($result);
    	    $query1->free_result();
	}



function skpd_akt() {
		$id  = $this->session->userdata('pcUser'); 
        $lccr = $this->input->post('q');
        $sql = "SELECT kd_skpd,nm_skpd FROM ms_skpd where kd_skpd IN (SELECT kd_skpd FROM user_akt WHERE user_id='$id')AND (upper(kd_skpd) like upper('%$lccr%') or upper(nm_skpd) like upper('%$lccr%')) order by kd_skpd ";
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
           
            $result[] = array(
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],  
                        'nm_skpd' => $resulte['nm_skpd']
                        );
                        $ii++;
        }
           
        echo json_encode($result);
    	    $query1->free_result();
	}
	
	
function reg_spj()
    {
        $data['page_title']= 'Register SPJ Pengeluaran';
        $this->template->set('title', 'Register SPJ Pengeluaran');   
        $this->template->load('template','akuntansi/reg_spj',$data) ; 
    }

	function reg_spj_terima()
    {
        $data['page_title']= 'Register SPJ Penerimaan';
        $this->template->set('title', 'Register SPJ Penerimaan');   
        $this->template->load('template','akuntansi/reg_spj_terima',$data) ; 
    }
	
function load_reg_spj($bulan=''){
	$id  = $this->session->userdata('pcUser'); 
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;
        $kriteria = '';
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where="AND (upper(kd_skpd) like upper('%$kriteria%'))";            
        }
		
        $sql = "SELECT count(*) as tot from trhspj_ppkd WHERE bulan='$bulan' $where" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
        
        $sql = "SELECT * from trhspj_ppkd WHERE bulan='$bulan' AND kd_skpd IN (SELECT kd_skpd FROM user_akt WHERE user_id='$id') $where order by kd_skpd ";
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
            $row[] = array(
                        'id' => $ii,
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'real_up' =>  number_format($resulte['real_up'], "2", ".", ","),
						'real_gj' =>  number_format($resulte['real_gj'], "2", ".", ","),
                        'real_brg' => number_format($resulte['real_brg'], "2", ".", ",") ,
						'tgl_terima' => $resulte['tgl_terima'],        
                        'spj' => $resulte['spj'],
                        'bku' => $resulte['bku'],
						'koran' => $resulte['koran'],
						//'status_sempurna' => $resulte['status_sempurna'],
                        'pajak' => $resulte['pajak'],
						'sts' => $resulte['sts'],
						'ket' => $resulte['ket'],
						'cek' => $resulte['cek']
                        );
                        $ii++;
        }
           
        $result["total"] = $total->tot;
        $result["rows"] = $row; 
        echo json_encode($result);	   
	}

function load_reg_spj_terima($bulan=''){
	$id  = $this->session->userdata('pcUser'); 
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;
        $kriteria = '';
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where="AND (upper(kd_skpd) like upper('%$kriteria%'))";            
        }
		
        $sql = "SELECT count(*) as tot from trhspj_terima_ppkd WHERE bulan='$bulan' $where" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
        
        $sql = "SELECT * from trhspj_terima_ppkd WHERE bulan='$bulan' AND kd_skpd IN (SELECT kd_skpd FROM user_akt WHERE user_id='$id') $where order by kd_skpd ";
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
            $row[] = array(
                        'id' => $ii,
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'real_terima' =>  number_format($resulte['real_terima'], "2", ".", ","),
						'real_setor' =>  number_format($resulte['real_setor'], "2", ".", ","),
                        'sisa' => number_format($resulte['sisa'], "2", ".", ",") ,
						'tgl_terima' => $resulte['tgl_terima'],        
                        'spj' => $resulte['spj'],
                        'bku' => $resulte['bku'],
						'koran' => $resulte['koran'],
						//'status_sempurna' => $resulte['status_sempurna'],
                       
						'sts' => $resulte['sts'],
						'ket' => $resulte['ket'],
						'cek' => $resulte['cek']
                        );
                        $ii++;
        }
           
        $result["total"] = $total->tot;
        $result["rows"] = $row; 
        echo json_encode($result);	   
	}

	
	 function simpan_pengesahan(){
        $kdskpd = $this->input->post('kdskpd');
        $tgl_terima = $this->input->post('tgl_terima');
        $real_gj = $this->input->post('real_gj');
        $real_up = $this->input->post('real_up');
        $real_brg = $this->input->post('real_brg');
		
        $spj = $this->input->post('spj');
        $bku = $this->input->post('bku');
		$koran = $this->input->post('koran');
		$pajak = $this->input->post('pajak');
        $sts = $this->input->post('sts');
        $ket = $this->input->post('ket');
        $cek = $this->input->post('cek');
        $bulan = $this->input->post('bulan');
		$usernm = $this->session->userdata('pcNama');
        $update = date('Y-m-d');
        $sql2 = "UPDATE trhspj_ppkd SET tgl_terima='$tgl_terima',real_up='$real_up',
		real_gj='$real_gj',real_brg='$real_brg',spj='$spj',bku='$bku',koran='$koran',pajak='$pajak',
		sts='$sts',ket='$ket',cek='$cek',username='$usernm',tgl_update='$update' WHERE kd_skpd='$kdskpd' AND bulan='$bulan'";
        $asg = $this->db->query($sql2);
     }
	 
	 function simpan_pengesahan_terima(){
        $kdskpd = $this->input->post('kdskpd');
        $tgl_terima = $this->input->post('tgl_terima');
        $real_terima = $this->input->post('real_terima');
        $real_setor = $this->input->post('real_setor');
        $sisa = $this->input->post('sisa');
		
        $spj = $this->input->post('spj');
        $bku = $this->input->post('bku');
		$koran = $this->input->post('koran');
		
        $sts = $this->input->post('sts');
        $ket = $this->input->post('ket');
        $cek = $this->input->post('cek');
        $bulan = $this->input->post('bulan');
		$usernm = $this->session->userdata('pcNama');
        $update = date('Y-m-d');
        $sql2 = "UPDATE trhspj_terima_ppkd SET tgl_terima='$tgl_terima',real_setor='$real_setor',
		real_terima='$real_terima',sisa='$sisa',spj='$spj',bku='$bku',koran='$koran',
		sts='$sts',ket='$ket',cek='$cek',username='$usernm',tgl_update='$update' WHERE kd_skpd='$kdskpd' AND bulan='$bulan'";
        $asg = $this->db->query($sql2);
     }
	 
     function pilih_ttd_kd() {
        $lccr = $this->input->post('q');
        $sql = "SELECT nip,nama,jabatan,kd_skpd FROM ms_ttd where kode ='GUB' ";
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
           
            $result[] = array(
                        'id' => $ii,        
                        'nip' => $resulte['nip'],  
                        'nama' => $resulte['nama'],  
                        'jabatan' => $resulte['jabatan'],
                        'kd_skpd' => $resulte['kd_skpd']
                        );
                        $ii++;
        }
           
        echo json_encode($result);
     $query1->free_result();	   
	}	


	function ctk_register_spj($bulan='',$ctk=''){
		$cRet ="";	
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
           <tr>
                <td colspan=\"13\" align=\"center\" style=\"border: solid 1px white;\"><b>REGISTER SPJ<br>".strtoupper($this-> getBulan($bulan))." </b>
                </td>
            </tr>
			</table>";
			
		$cRet .="<table style=\"border-collapse:collapse; font-size:12px\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"2\">
            <thead>
			<tr>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"2%\" >No</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"20%\"  >Uraian</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"10%\"  >Tanggal Terima</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"10%\"  >UP/GU/TU</td>
				<td align=\"center\" bgcolor=\"#CCCCCC\" width=\"10%\"  >Gaji</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"10%\"  >LS</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"5%\"  >SPJ</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"5%\"  >BKU</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"5%\"  >Rek. Koran</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"5%\"  >BP. Pajak</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"5%\"  >STS</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"10%\"  >Keterangan</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"3%\"  >Check</td>
            </tr>
			
			</thead>
           ";
         
        
		$csql = "SELECT a.nm_skpd, b.kd_skpd
				,ISNULL(real_up,0) real_up
				,ISNULL(real_gj,0) real_gj
				,ISNULL(real_brg,0) real_brg
				,ISNULL(tgl_terima,'') tgl_terima
				,spj,bku,koran,pajak,sts,ket,cek
				 FROM ms_skpd a 
				LEFT JOIN trhspj_ppkd b ON a.kd_skpd=b.kd_skpd
				WHERE bulan='$bulan' ORDER BY kd_skpd
				";
		$no=0;
         $query = $this->db->query($csql);  
         foreach($query->result_array() as $res){
			 $no=$no+1;
			 $kd_skpd = $res['kd_skpd'];
			 $nm_skpd = $res['nm_skpd'];
			 $real_up = $res['real_up'];
			 $real_gj = $res['real_gj'];
			 $real_brg = $res['real_brg'];
			 $tgl_terima = $res['tgl_terima'];
			 $ket = $res['ket'];
			 /*$spj = $res['spj'];
			 $bku = $res['bku'];
			 $koran = $res['koran'];
			 $pajak = $res['pajak'];
			 $sts = $res['sts'];
			 $cek = $res['cek'];*/
			$tanggal = empty($tgl_terima) || $tgl_terima == '1900-01-01' ? '-' :$this->tukd_model->tanggal_ind($tgl_terima);
			$spj =$res['spj']=='1' ? '&#10003;' : '';
			$bku =$res['bku']=='1' ? '&#10003;' : '';
			$koran =$res['koran']=='1' ? '&#10003;' : '';
			$pajak =$res['pajak']=='1' ? '&#10003;' : '';
			$sts =$res['sts']=='1' ? '&#10003;' : '';
			$cek =$res['cek']=='1' ? '&#10003;' : '';

				   $cRet .="<tr>
							<td align='center' >$no</td>
							<td>$nm_skpd</td>
							<td align='center' >$tanggal</td>
							<td align='right' >".number_format($real_up,"2",",",".")."</td>
							<td align='right' >".number_format($real_gj,"2",",",".")."</td>
							<td align='right' >".number_format($real_brg,"2",",",".")."</td>
							<td align='center' >$spj</td>
							<td align='center' >$bku</td>
							<td align='center' >$koran</td>
							<td align='center' >$pajak</td>
							<td align='center' >$sts</td>
							<td>$ket</td>
							<td align='center' >$cek</td>
						</tr>";
            }
            
         $cRet .=" 
         </table>
         ";

			$data['prev']=$cRet; //'JURNAL UMUM';
			 $judul='Reg_SPJ';
			switch ($ctk){
				case 1;
				echo ("<title>$judul</title>");
				echo $cRet;
				break;
				case 2;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
				case 3;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
	
	} 
    
    
    function ctk_register_spj_terima($bulan='',$ctk=''){
		$cRet ="";	
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
           <tr>
                <td colspan=\"13\" align=\"center\" style=\"border: solid 1px white;\"><b>REGISTER SPJ<br>".strtoupper($this-> getBulan($bulan))." </b>
                </td>
            </tr>
			</table>";
			
		$cRet .="<table style=\"border-collapse:collapse; font-size:12px\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"2\">
            <thead>
			<tr>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"2%\" >No</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"25%\"  >Uraian</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"10%\"  >Tanggal Terima</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"10%\"  >Realisasi Terima</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"10%\"  >Realisasi Setor</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"10%\"  >Sisa</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"5%\"  >SPJ</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"5%\"  >BKU</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"5%\"  >Rek. Koran</td>
               
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"5%\"  >STS</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"10%\"  >Keterangan</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" width=\"3%\"  >Check</td>
            </tr>
			
			</thead>
           ";
         
        
		$csql = "SELECT a.nm_skpd, b.kd_skpd
				,ISNULL(real_terima,0) real_terima
				,ISNULL(real_setor,0) real_setor
				,ISNULL(sisa,0) sisa
				,ISNULL(tgl_terima,'') tgl_terima
				,spj,bku,koran,sts,ket,cek
				 FROM ms_skpd a 
				LEFT JOIN trhspj_terima_ppkd b ON a.kd_skpd=b.kd_skpd
				WHERE bulan='$bulan' ORDER BY kd_skpd
				";
		$no=0;
         $query = $this->db->query($csql);  
         foreach($query->result_array() as $res){
			 $no=$no+1;
			 $kd_skpd = $res['kd_skpd'];
			 $nm_skpd = $res['nm_skpd'];
			 $real_terima = $res['real_terima'];
			 $real_setor = $res['real_setor'];
			 $sisa = $res['sisa'];
			 $tgl_terima = $res['tgl_terima'];
			 $ket = $res['ket'];
			 /*$spj = $res['spj'];
			 $bku = $res['bku'];
			 $koran = $res['koran'];
			 $pajak = $res['pajak'];
			 $sts = $res['sts'];
			 $cek = $res['cek'];*/
			$tanggal = empty($tgl_terima) || $tgl_terima == '1900-01-01' ? '-' :$this->tukd_model->tanggal_ind($tgl_terima);
			$spj =$res['spj']=='1' ? '&#10003;' : '';
			$bku =$res['bku']=='1' ? '&#10003;' : '';
			$koran =$res['koran']=='1' ? '&#10003;' : '';
			//$pajak =$res['pajak']=='1' ? '&#10003;' : '';
			$sts =$res['sts']=='1' ? '&#10003;' : '';
			$cek =$res['cek']=='1' ? '&#10003;' : '';

				   $cRet .="<tr>
							<td align='center' >$no</td>
							<td>$nm_skpd</td>
							<td align='center' >$tanggal</td>
							<td align='right' >".number_format($real_terima,"2",",",".")."</td>
							<td align='right' >".number_format($real_setor,"2",",",".")."</td>
							<td align='right' >".number_format($sisa,"2",",",".")."</td>
							<td align='center' >$spj</td>
							<td align='center' >$bku</td>
							<td align='center' >$koran</td>
							
							<td align='center' >$sts</td>
							<td>$ket</td>
							<td align='center' >$cek</td>
						</tr>";
            }
            
         $cRet .=" 
         </table>
         ";

			$data['prev']=$cRet; //'JURNAL UMUM';
			 $judul='Reg_SPJ_terima';
			switch ($ctk){
				case 1;
				echo ("<title>$judul</title>");
				echo $cRet;
				break;
				case 2;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
				case 3;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;	
			}
	
	} 
    
    
    


	

}

